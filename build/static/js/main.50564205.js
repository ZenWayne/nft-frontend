/*! For license information please see main.50564205.js.LICENSE.txt */
(()=>{var e={5576:(e,t)=>{"use strict";function n(e){if(Array.isArray(e)){const t=[];let r=0;for(let i=0;i<e.length;i++){const o=n(e[i]);t.push(o),r+=o.length}return h(o(r,192),...t)}const t=m(e);return 1===t.length&&t[0]<128?t:h(o(t.length,128),t)}function r(e,t,n){if(n>e.length)throw new Error("invalid RLP (safeSlice): end slice of Uint8Array out-of-bounds");return e.slice(t,n)}function i(e){if(0===e[0])throw new Error("invalid RLP: extra zeros");return u(l(e))}function o(e,t){if(e<56)return Uint8Array.from([e+t]);const n=p(e),r=p(t+55+n.length/2);return Uint8Array.from(d(r+n))}function s(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("undefined"===typeof e||null===e||0===e.length)return Uint8Array.from([]);const n=a(m(e));if(t)return n;if(0!==n.remainder.length)throw new Error("invalid RLP: remainder must be zero");return n.data}function a(e){let t,n,o,s,c;const l=[],u=e[0];if(u<=127)return{data:e.slice(0,1),remainder:e.slice(1)};if(u<=183){if(t=u-127,o=128===u?Uint8Array.from([]):r(e,1,t),2===t&&o[0]<128)throw new Error("invalid RLP encoding: invalid prefix, single byte < 0x80 are not prefixed");return{data:o,remainder:e.slice(t)}}if(u<=191){if(n=u-182,e.length-1<n)throw new Error("invalid RLP: not enough bytes for string length");if(t=i(r(e,1,n)),t<=55)throw new Error("invalid RLP: expected string length to be greater than 55");return o=r(e,n,t+n),{data:o,remainder:e.slice(t+n)}}if(u<=247){for(t=u-191,s=r(e,1,t);s.length;)c=a(s),l.push(c.data),s=c.remainder;return{data:l,remainder:e.slice(t)}}{if(n=u-246,t=i(r(e,1,n)),t<56)throw new Error("invalid RLP: encoded list too short");const o=n+t;if(o>e.length)throw new Error("invalid RLP: total length is larger than the data");for(s=r(e,n,o);s.length;)c=a(s),l.push(c.data),s=c.remainder;return{data:l,remainder:e.slice(o)}}}t.Tj=void 0;const c=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function l(e){let t="";for(let n=0;n<e.length;n++)t+=c[e[n]];return t}function u(e){const t=Number.parseInt(e,16);if(Number.isNaN(t))throw new Error("Invalid byte sequence");return t}function d(e){if("string"!==typeof e)throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const t=new Uint8Array(e.length/2);for(let n=0;n<t.length;n++){const r=2*n;t[n]=u(e.slice(r,r+2))}return t}function h(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(1===t.length)return t[0];const r=t.reduce(((e,t)=>e+t.length),0),i=new Uint8Array(r);for(let o=0,s=0;o<t.length;o++){const e=t[o];i.set(e,s),s+=e.length}return i}function f(e){return(new TextEncoder).encode(e)}function p(e){if(e<0)throw new Error("Invalid integer as argument, must be unsigned!");const t=e.toString(16);return t.length%2?"0".concat(t):t}function g(e){return e.length>=2&&"0"===e[0]&&"x"===e[1]}function m(e){if(e instanceof Uint8Array)return e;if("string"===typeof e)return g(e)?d((t="string"!==typeof(n=e)?n:g(n)?n.slice(2):n).length%2?"0".concat(t):t):f(e);var t,n;if("number"===typeof e||"bigint"===typeof e)return e?d(p(e)):Uint8Array.from([]);if(null===e||void 0===e)return Uint8Array.from([]);throw new Error("toBytes: received unsupported type "+typeof e)}t.Tj={encode:n,decode:s}},405:e=>{"use strict";e.exports=function(e){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var r=0;r<e.length;r++){var i=e.charAt(r),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=r}var s=e.length,a=e.charAt(0),c=Math.log(s)/Math.log(256),l=Math.log(256)/Math.log(s);function u(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var n=0;if(" "!==e[n]){for(var r=0,i=0;e[n]===a;)r++,n++;for(var o=(e.length-n)*c+1>>>0,l=new Uint8Array(o);e[n];){var u=t[e.charCodeAt(n)];if(255===u)return;for(var d=0,h=o-1;(0!==u||d<i)&&-1!==h;h--,d++)u+=s*l[h]>>>0,l[h]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=d,n++}if(" "!==e[n]){for(var f=o-i;f!==o&&0===l[f];)f++;for(var p=new Uint8Array(r+(o-f)),g=r;f!==o;)p[g++]=l[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,o=t.length;i!==o&&0===t[i];)i++,n++;for(var c=(o-i)*l+1>>>0,u=new Uint8Array(c);i!==o;){for(var d=t[i],h=0,f=c-1;(0!==d||h<r)&&-1!==f;f--,h++)d+=256*u[f]>>>0,u[f]=d%s>>>0,d=d/s>>>0;if(0!==d)throw new Error("Non-zero carry");r=h,i++}for(var p=c-r;p!==c&&0===u[p];)p++;for(var g=a.repeat(n);p<c;++p)g+=e.charAt(u[p]);return g},decodeUnsafe:u,decode:function(e){var t=u(e);if(t)return t;throw new Error("Non-base"+s+" character")}}}},1031:(e,t)=>{var n;n=function(e){e.version="1.2.2";var t=function(){for(var e=0,t=new Array(256),n=0;256!=n;++n)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=n)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[n]=e;return"undefined"!==typeof Int32Array?new Int32Array(t):t}(),n=function(e){var t=0,n=0,r=0,i="undefined"!==typeof Int32Array?new Int32Array(4096):new Array(4096);for(r=0;256!=r;++r)i[r]=e[r];for(r=0;256!=r;++r)for(n=e[r],t=256+r;t<4096;t+=256)n=i[t]=n>>>8^e[255&n];var o=[];for(r=1;16!=r;++r)o[r-1]="undefined"!==typeof Int32Array?i.subarray(256*r,256*r+256):i.slice(256*r,256*r+256);return o}(t),r=n[0],i=n[1],o=n[2],s=n[3],a=n[4],c=n[5],l=n[6],u=n[7],d=n[8],h=n[9],f=n[10],p=n[11],g=n[12],m=n[13],v=n[14];e.table=t,e.bstr=function(e,n){for(var r=~n,i=0,o=e.length;i<o;)r=r>>>8^t[255&(r^e.charCodeAt(i++))];return~r},e.buf=function(e,n){for(var y=~n,w=e.length-15,b=0;b<w;)y=v[e[b++]^255&y]^m[e[b++]^y>>8&255]^g[e[b++]^y>>16&255]^p[e[b++]^y>>>24]^f[e[b++]]^h[e[b++]]^d[e[b++]]^u[e[b++]]^l[e[b++]]^c[e[b++]]^a[e[b++]]^s[e[b++]]^o[e[b++]]^i[e[b++]]^r[e[b++]]^t[e[b++]];for(w+=15;b<w;)y=y>>>8^t[255&(y^e[b++])];return~y},e.str=function(e,n){for(var r=~n,i=0,o=e.length,s=0,a=0;i<o;)(s=e.charCodeAt(i++))<128?r=r>>>8^t[255&(r^s)]:s<2048?r=(r=r>>>8^t[255&(r^(192|s>>6&31))])>>>8^t[255&(r^(128|63&s))]:s>=55296&&s<57344?(s=64+(1023&s),a=1023&e.charCodeAt(i++),r=(r=(r=(r=r>>>8^t[255&(r^(240|s>>8&7))])>>>8^t[255&(r^(128|s>>2&63))])>>>8^t[255&(r^(128|a>>6&15|(3&s)<<4))])>>>8^t[255&(r^(128|63&a))]):r=(r=(r=r>>>8^t[255&(r^(224|s>>12&15))])>>>8^t[255&(r^(128|s>>6&63))])>>>8^t[255&(r^(128|63&s))];return~r}},"undefined"===typeof DO_NOT_EXPORT_CRC?n(t):n({})},9038:(e,t,n)=>{var r="undefined"!==typeof globalThis&&globalThis||"undefined"!==typeof self&&self||"undefined"!==typeof n.g&&n.g,i=function(){function e(){this.fetch=!1,this.DOMException=r.DOMException}return e.prototype=r,new e}();!function(e){!function(t){var n="undefined"!==typeof e&&e||"undefined"!==typeof self&&self||"undefined"!==typeof n&&n,r="URLSearchParams"in n,i="Symbol"in n&&"iterator"in Symbol,o="FileReader"in n&&"Blob"in n&&function(){try{return new Blob,!0}catch(e){return!1}}(),s="FormData"in n,a="ArrayBuffer"in n;if(a)var c=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],l=ArrayBuffer.isView||function(e){return e&&c.indexOf(Object.prototype.toString.call(e))>-1};function u(e){if("string"!==typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||""===e)throw new TypeError('Invalid character in header field name: "'+e+'"');return e.toLowerCase()}function d(e){return"string"!==typeof e&&(e=String(e)),e}function h(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return i&&(t[Symbol.iterator]=function(){return t}),t}function f(e){this.map={},e instanceof f?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function p(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function g(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function m(e){var t=new FileReader,n=g(t);return t.readAsArrayBuffer(e),n}function v(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function y(){return this.bodyUsed=!1,this._initBody=function(e){var t;this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?"string"===typeof e?this._bodyText=e:o&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:s&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:r&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():a&&o&&((t=e)&&DataView.prototype.isPrototypeOf(t))?(this._bodyArrayBuffer=v(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):a&&(ArrayBuffer.prototype.isPrototypeOf(e)||l(e))?this._bodyArrayBuffer=v(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"===typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):r&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},o&&(this.blob=function(){var e=p(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var e=p(this);return e||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}return this.blob().then(m)}),this.text=function(){var e=p(this);if(e)return e;if(this._bodyBlob)return function(e){var t=new FileReader,n=g(t);return t.readAsText(e),n}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},s&&(this.formData=function(){return this.text().then(E)}),this.json=function(){return this.text().then(JSON.parse)},this}f.prototype.append=function(e,t){e=u(e),t=d(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},f.prototype.delete=function(e){delete this.map[u(e)]},f.prototype.get=function(e){return e=u(e),this.has(e)?this.map[e]:null},f.prototype.has=function(e){return this.map.hasOwnProperty(u(e))},f.prototype.set=function(e,t){this.map[u(e)]=d(t)},f.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},f.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),h(e)},f.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),h(e)},f.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),h(e)},i&&(f.prototype[Symbol.iterator]=f.prototype.entries);var w=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function b(e,t){if(!(this instanceof b))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var n=(t=t||{}).body;if(e instanceof b){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new f(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,n||null==e._bodyInit||(n=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new f(t.headers)),this.method=function(e){var t=e.toUpperCase();return w.indexOf(t)>-1?t:e}(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(n),("GET"===this.method||"HEAD"===this.method)&&("no-store"===t.cache||"no-cache"===t.cache)){var r=/([?&])_=[^&]*/;if(r.test(this.url))this.url=this.url.replace(r,"$1_="+(new Date).getTime());else{this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}}function E(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}})),t}function k(e){var t=new f;return e.replace(/\r?\n[\t ]+/g," ").split("\r").map((function(e){return 0===e.indexOf("\n")?e.substr(1,e.length):e})).forEach((function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();t.append(r,i)}})),t}function A(e,t){if(!(this instanceof A))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText=void 0===t.statusText?"":""+t.statusText,this.headers=new f(t.headers),this.url=t.url||"",this._initBody(e)}b.prototype.clone=function(){return new b(this,{body:this._bodyInit})},y.call(b.prototype),y.call(A.prototype),A.prototype.clone=function(){return new A(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},A.error=function(){var e=new A(null,{status:0,statusText:""});return e.type="error",e};var S=[301,302,303,307,308];A.redirect=function(e,t){if(-1===S.indexOf(t))throw new RangeError("Invalid status code");return new A(null,{status:t,headers:{location:e}})},t.DOMException=n.DOMException;try{new t.DOMException}catch(_){t.DOMException=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function x(e,r){return new Promise((function(i,s){var c=new b(e,r);if(c.signal&&c.signal.aborted)return s(new t.DOMException("Aborted","AbortError"));var l=new XMLHttpRequest;function u(){l.abort()}l.onload=function(){var e={status:l.status,statusText:l.statusText,headers:k(l.getAllResponseHeaders()||"")};e.url="responseURL"in l?l.responseURL:e.headers.get("X-Request-URL");var t="response"in l?l.response:l.responseText;setTimeout((function(){i(new A(t,e))}),0)},l.onerror=function(){setTimeout((function(){s(new TypeError("Network request failed"))}),0)},l.ontimeout=function(){setTimeout((function(){s(new TypeError("Network request failed"))}),0)},l.onabort=function(){setTimeout((function(){s(new t.DOMException("Aborted","AbortError"))}),0)},l.open(c.method,function(e){try{return""===e&&n.location.href?n.location.href:e}catch(t){return e}}(c.url),!0),"include"===c.credentials?l.withCredentials=!0:"omit"===c.credentials&&(l.withCredentials=!1),"responseType"in l&&(o?l.responseType="blob":a&&c.headers.get("Content-Type")&&-1!==c.headers.get("Content-Type").indexOf("application/octet-stream")&&(l.responseType="arraybuffer")),!r||"object"!==typeof r.headers||r.headers instanceof f?c.headers.forEach((function(e,t){l.setRequestHeader(t,e)})):Object.getOwnPropertyNames(r.headers).forEach((function(e){l.setRequestHeader(e,d(r.headers[e]))})),c.signal&&(c.signal.addEventListener("abort",u),l.onreadystatechange=function(){4===l.readyState&&c.signal.removeEventListener("abort",u)}),l.send("undefined"===typeof c._bodyInit?null:c._bodyInit)}))}x.polyfill=!0,n.fetch||(n.fetch=x,n.Headers=f,n.Request=b,n.Response=A),t.Headers=f,t.Request=b,t.Response=A,t.fetch=x}({})}(i),i.fetch.ponyfill=!0,delete i.fetch.polyfill;var o=r.fetch?r:i;(t=o.fetch).default=o.fetch,t.fetch=o.fetch,t.Headers=o.Headers,t.Request=o.Request,t.Response=o.Response,e.exports=t},6522:(e,t,n)=>{t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(r++,"%c"===e&&(i=r))})),t.splice(i,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(n){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(n){}!e&&"undefined"!==typeof process&&"env"in process&&(e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.DEBUG);return e},t.useColors=function(){if("undefined"!==typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=n(5237)(t);const{formatters:r}=e.exports;r.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}},5237:(e,t,n)=>{e.exports=function(e){function t(e){let n,i,o,s=null;function a(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];if(!a.enabled)return;const o=a,s=Number(new Date),c=s-(n||s);o.diff=c,o.prev=n,o.curr=s,n=s,r[0]=t.coerce(r[0]),"string"!==typeof r[0]&&r.unshift("%O");let l=0;r[0]=r[0].replace(/%([a-zA-Z%])/g,((e,n)=>{if("%%"===e)return"%";l++;const i=t.formatters[n];if("function"===typeof i){const t=r[l];e=i.call(o,t),r.splice(l,1),l--}return e})),t.formatArgs.call(o,r);(o.log||t.log).apply(o,r)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=r,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(i!==t.namespaces&&(i=t.namespaces,o=t.enabled(e)),o),set:e=>{s=e}}),"function"===typeof t.init&&t.init(a),a}function r(e,n){const r=t(this.namespace+("undefined"===typeof n?":":n)+e);return r.log=this.log,r}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(i),...t.skips.map(i).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const r=("string"===typeof e?e:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(7340),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((n=>{t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}},4823:e=>{"use strict";function t(e,t){for(const n in t)Object.defineProperty(e,n,{value:t[n],enumerable:!0,configurable:!0});return e}e.exports=function(e,n,r){if(!e||"string"===typeof e)throw new TypeError("Please pass an Error to err-code");r||(r={}),"object"===typeof n&&(r=n,n=""),n&&(r.code=n);try{return t(e,r)}catch(i){r.message=e.message,r.stack=e.stack;const n=function(){};n.prototype=Object.create(Object.getPrototypeOf(e));return t(new n,r)}}},2605:(e,t,n)=>{"use strict";const r=n(9020);t.PP=r.EventIterator,r.EventIterator},9020:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(){this.pullQueue=[],this.pushQueue=[],this.eventHandlers={},this.isPaused=!1,this.isStopped=!1}push(e){if(this.isStopped)return;const t={value:e,done:!1};if(this.pullQueue.length){const e=this.pullQueue.shift();e&&e.resolve(t)}else this.pushQueue.push(Promise.resolve(t)),void 0!==this.highWaterMark&&this.pushQueue.length>=this.highWaterMark&&!this.isPaused&&(this.isPaused=!0,this.eventHandlers.highWater?this.eventHandlers.highWater():console&&console.warn("EventIterator queue reached ".concat(this.pushQueue.length," items")))}stop(){if(!this.isStopped){this.isStopped=!0,this.remove();for(const e of this.pullQueue)e.resolve({value:void 0,done:!0});this.pullQueue.length=0}}fail(e){if(!this.isStopped)if(this.isStopped=!0,this.remove(),this.pullQueue.length){for(const t of this.pullQueue)t.reject(e);this.pullQueue.length=0}else{const t=Promise.reject(e);t.catch((()=>{})),this.pushQueue.push(t)}}remove(){Promise.resolve().then((()=>{this.removeCallback&&this.removeCallback()}))}[Symbol.asyncIterator](){return{next:e=>{const t=this.pushQueue.shift();return t?(void 0!==this.lowWaterMark&&this.pushQueue.length<=this.lowWaterMark&&this.isPaused&&(this.isPaused=!1,this.eventHandlers.lowWater&&this.eventHandlers.lowWater()),t):this.isStopped?Promise.resolve({value:void 0,done:!0}):new Promise(((e,t)=>{this.pullQueue.push({resolve:e,reject:t})}))},return:()=>(this.isStopped=!0,this.pushQueue.length=0,this.remove(),Promise.resolve({value:void 0,done:!0}))}}}class r{constructor(e){let{highWaterMark:t=100,lowWaterMark:r=1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=new n;i.highWaterMark=t,i.lowWaterMark=r,i.removeCallback=e({push:e=>i.push(e),stop:()=>i.stop(),fail:e=>i.fail(e),on:(e,t)=>{i.eventHandlers[e]=t}})||(()=>{}),this[Symbol.asyncIterator]=()=>i[Symbol.asyncIterator](),Object.freeze(this)}}t.EventIterator=r,t.default=r},101:e=>{e.exports=function(e){if(!e)throw Error("hashlru must have a max value, of type number, greater than 0");var t=0,n=Object.create(null),r=Object.create(null);function i(i,o){n[i]=o,++t>=e&&(t=0,r=n,n=Object.create(null))}return{has:function(e){return void 0!==n[e]||void 0!==r[e]},remove:function(e){void 0!==n[e]&&(n[e]=void 0),void 0!==r[e]&&(r[e]=void 0)},get:function(e){var t=n[e];return void 0!==t?t:void 0!==(t=r[e])?(i(e,t),t):void 0},set:function(e,t){void 0!==n[e]?n[e]=t:i(e,t)},clear:function(){n=Object.create(null),r=Object.create(null)}}}},2740:e=>{"use strict";e.exports=function(e,t,n,r,i,o,s,a){if(!e){var c;if(void 0===t)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var l=[n,r,i,o,s,a],u=0;(c=new Error(t.replace(/%s/g,(function(){return l[u++]})))).name="Invariant Violation"}throw c.framesToPop=1,c}}},4053:e=>{e.exports=function(){return"undefined"!==typeof window&&"object"===typeof window.process&&"renderer"===window.process.type||(!("undefined"===typeof process||"object"!==typeof process.versions||!process.versions.electron)||"object"===typeof navigator&&"string"===typeof navigator.userAgent&&navigator.userAgent.indexOf("Electron")>=0)}},8355:function(e,t,n){"use strict";const r=n(2142),{hasOwnProperty:i}=Object.prototype,{propertyIsEnumerable:o}=Object,s=(e,t,n)=>Object.defineProperty(e,t,{value:n,writable:!0,enumerable:!0,configurable:!0}),a=this,c={concatArrays:!1,ignoreUndefined:!1},l=e=>{const t=[];for(const n in e)i.call(e,n)&&t.push(n);if(Object.getOwnPropertySymbols){const n=Object.getOwnPropertySymbols(e);for(const r of n)o.call(e,r)&&t.push(r)}return t};function u(e){return Array.isArray(e)?function(e){const t=e.slice(0,0);return l(e).forEach((n=>{s(t,n,u(e[n]))})),t}(e):r(e)?function(e){const t=null===Object.getPrototypeOf(e)?Object.create(null):{};return l(e).forEach((n=>{s(t,n,u(e[n]))})),t}(e):e}const d=(e,t,n,r)=>(n.forEach((n=>{"undefined"===typeof t[n]&&r.ignoreUndefined||(n in e&&e[n]!==Object.getPrototypeOf(e)?s(e,n,f(e[n],t[n],r)):s(e,n,u(t[n])))})),e),h=(e,t,n)=>{let r=e.slice(0,0),o=0;return[e,t].forEach((t=>{const a=[];for(let n=0;n<t.length;n++)i.call(t,n)&&(a.push(String(n)),s(r,o++,t===e?t[n]:u(t[n])));r=d(r,t,l(t).filter((e=>!a.includes(e))),n)})),r};function f(e,t,n){return n.concatArrays&&Array.isArray(e)&&Array.isArray(t)?h(e,t,n):r(t)&&r(e)?d(e,t,l(t),n):u(t)}e.exports=function(){const e=f(u(c),this!==a&&this||{},c);let t={_:{}};for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];for(const s of i)if(void 0!==s){if(!r(s))throw new TypeError("`"+s+"` is not an Option Object");t=f(t,{_:s},e)}return t._}},2142:e=>{"use strict";e.exports=e=>{if("[object Object]"!==Object.prototype.toString.call(e))return!1;const t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}},7340:e=>{var t=1e3,n=60*t,r=60*n,i=24*r,o=7*i,s=365.25*i;function a(e,t,n,r){var i=t>=1.5*n;return Math.round(e/n)+" "+r+(i?"s":"")}e.exports=function(e,c){c=c||{};var l=typeof e;if("string"===l&&e.length>0)return function(e){if((e=String(e)).length>100)return;var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!a)return;var c=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*s;case"weeks":case"week":case"w":return c*o;case"days":case"day":case"d":return c*i;case"hours":case"hour":case"hrs":case"hr":case"h":return c*r;case"minutes":case"minute":case"mins":case"min":case"m":return c*n;case"seconds":case"second":case"secs":case"sec":case"s":return c*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}(e);if("number"===l&&isFinite(e))return c.long?function(e){var o=Math.abs(e);if(o>=i)return a(e,o,i,"day");if(o>=r)return a(e,o,r,"hour");if(o>=n)return a(e,o,n,"minute");if(o>=t)return a(e,o,t,"second");return e+" ms"}(e):function(e){var o=Math.abs(e);if(o>=i)return Math.round(e/i)+"d";if(o>=r)return Math.round(e/r)+"h";if(o>=n)return Math.round(e/n)+"m";if(o>=t)return Math.round(e/t)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},3540:(e,t,n)=>{"use strict";const{encodeText:r}=n(3065);e.exports=class{constructor(e,t,n,i){this.name=e,this.code=t,this.codeBuf=r(this.code),this.alphabet=i,this.codec=n(i)}encode(e){return this.codec.encode(e)}decode(e){for(const t of e)if(this.alphabet&&this.alphabet.indexOf(t)<0)throw new Error("invalid character '".concat(t,"' in '").concat(e,"'"));return this.codec.decode(e)}}},1240:(e,t,n)=>{"use strict";const r=n(405),i=n(3540),{rfc4648:o}=n(950),{decodeText:s,encodeText:a}=n(3065),c=[["identity","\0",()=>({encode:s,decode:a}),""],["base2","0",o(1),"01"],["base8","7",o(3),"01234567"],["base10","9",r,"0123456789"],["base16","f",o(4),"0123456789abcdef"],["base16upper","F",o(4),"0123456789ABCDEF"],["base32hex","v",o(5),"0123456789abcdefghijklmnopqrstuv"],["base32hexupper","V",o(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV"],["base32hexpad","t",o(5),"0123456789abcdefghijklmnopqrstuv="],["base32hexpadupper","T",o(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV="],["base32","b",o(5),"abcdefghijklmnopqrstuvwxyz234567"],["base32upper","B",o(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"],["base32pad","c",o(5),"abcdefghijklmnopqrstuvwxyz234567="],["base32padupper","C",o(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567="],["base32z","h",o(5),"ybndrfg8ejkmcpqxot1uwisza345h769"],["base36","k",r,"0123456789abcdefghijklmnopqrstuvwxyz"],["base36upper","K",r,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"],["base58btc","z",r,"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"],["base58flickr","Z",r,"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"],["base64","m",o(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"],["base64pad","M",o(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="],["base64url","u",o(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"],["base64urlpad","U",o(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_="]],l=c.reduce(((e,t)=>(e[t[0]]=new i(t[0],t[1],t[2],t[3]),e)),{}),u=c.reduce(((e,t)=>(e[t[1]]=l[t[0]],e)),{});e.exports={names:l,codes:u}},7841:(e,t,n)=>{"use strict";const r=n(1240),{encodeText:i,decodeText:o,concat:s}=n(3065);function a(e){if(Object.prototype.hasOwnProperty.call(r.names,e))return r.names[e];if(Object.prototype.hasOwnProperty.call(r.codes,e))return r.codes[e];throw new Error("Unsupported encoding: ".concat(e))}(t=e.exports=function(e,t){if(!t)throw new Error("requires an encoded Uint8Array");const{name:n,codeBuf:r}=a(e);return function(e,t){const n=a(e);n.decode(o(t))}(n,t),s([r,t],r.length+t.length)}).encode=function(e,t){const n=a(e),r=i(n.encode(t));return s([n.codeBuf,r],n.codeBuf.length+r.length)},t.decode=function(e){e instanceof Uint8Array&&(e=o(e));const t=e[0];return["f","F","v","V","t","T","b","B","c","C","h","k","K"].includes(t)&&(e=e.toLowerCase()),a(e[0]).decode(e.substring(1))},t.isEncoded=function(e){if(e instanceof Uint8Array&&(e=o(e)),"[object String]"!==Object.prototype.toString.call(e))return!1;try{return a(e[0]).name}catch(t){return!1}},t.encoding=a,t.encodingFromData=function(e){return e instanceof Uint8Array&&(e=o(e)),a(e[0])};const c=Object.freeze(r.names),l=Object.freeze(r.codes);t.names=c,t.codes=l},950:e=>{"use strict";e.exports={rfc4648:e=>t=>({encode:n=>((e,t,n)=>{const r="="===t[t.length-1],i=(1<<n)-1;let o="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>n;)s-=n,o+=t[i&a>>s];if(s&&(o+=t[i&a<<n-s]),r)for(;o.length*n&7;)o+="=";return o})(n,t,e),decode:n=>((e,t,n)=>{const r={};for(let l=0;l<t.length;++l)r[t[l]]=l;let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*n/8|0);let s=0,a=0,c=0;for(let l=0;l<i;++l){const t=r[e[l]];if(void 0===t)throw new SyntaxError("Invalid character "+e[l]);a=a<<n|t,s+=n,s>=8&&(s-=8,o[c++]=255&a>>s)}if(s>=n||255&a<<8-s)throw new SyntaxError("Unexpected end of data");return o})(n,t,e)})}},3065:e=>{"use strict";const t=new TextDecoder,n=new TextEncoder;e.exports={decodeText:e=>t.decode(e),encodeText:e=>n.encode(e),concat:function(e,t){const n=new Uint8Array(t);let r=0;for(const i of e)n.set(i,r),r+=i.length;return n}}},6797:e=>{e.exports=function e(r,i){var o,s=0,a=0,c=i=i||0,l=r.length;do{if(c>=l)throw e.bytes=0,new RangeError("Could not decode varint");o=r[c++],s+=a<28?(o&n)<<a:(o&n)*Math.pow(2,a),a+=7}while(o>=t);return e.bytes=c-i,s};var t=128,n=127},3525:e=>{e.exports=function e(i,o,s){o=o||[];var a=s=s||0;for(;i>=r;)o[s++]=255&i|t,i/=128;for(;i&n;)o[s++]=255&i|t,i>>>=7;return o[s]=0|i,e.bytes=s-a+1,o};var t=128,n=-128,r=Math.pow(2,31)},3475:(e,t,n)=>{e.exports={encode:n(3525),decode:n(6797),encodingLength:n(6395)}},6395:e=>{var t=Math.pow(2,7),n=Math.pow(2,14),r=Math.pow(2,21),i=Math.pow(2,28),o=Math.pow(2,35),s=Math.pow(2,42),a=Math.pow(2,49),c=Math.pow(2,56),l=Math.pow(2,63);e.exports=function(e){return e<t?1:e<n?2:e<r?3:e<i?4:e<o?5:e<s?6:e<a?7:e<c?8:e<l?9:10}},3137:e=>{"use strict";const t=Object.freeze({identity:0,sha1:17,"sha2-256":18,"sha2-512":19,"sha3-512":20,"sha3-384":21,"sha3-256":22,"sha3-224":23,"shake-128":24,"shake-256":25,"keccak-224":26,"keccak-256":27,"keccak-384":28,"keccak-512":29,blake3:30,"murmur3-128":34,"murmur3-32":35,"dbl-sha2-256":86,md4:212,md5:213,bmt:214,"sha2-256-trunc254-padded":4114,"ripemd-128":4178,"ripemd-160":4179,"ripemd-256":4180,"ripemd-320":4181,x11:4352,kangarootwelve:7425,"sm3-256":21325,"blake2b-8":45569,"blake2b-16":45570,"blake2b-24":45571,"blake2b-32":45572,"blake2b-40":45573,"blake2b-48":45574,"blake2b-56":45575,"blake2b-64":45576,"blake2b-72":45577,"blake2b-80":45578,"blake2b-88":45579,"blake2b-96":45580,"blake2b-104":45581,"blake2b-112":45582,"blake2b-120":45583,"blake2b-128":45584,"blake2b-136":45585,"blake2b-144":45586,"blake2b-152":45587,"blake2b-160":45588,"blake2b-168":45589,"blake2b-176":45590,"blake2b-184":45591,"blake2b-192":45592,"blake2b-200":45593,"blake2b-208":45594,"blake2b-216":45595,"blake2b-224":45596,"blake2b-232":45597,"blake2b-240":45598,"blake2b-248":45599,"blake2b-256":45600,"blake2b-264":45601,"blake2b-272":45602,"blake2b-280":45603,"blake2b-288":45604,"blake2b-296":45605,"blake2b-304":45606,"blake2b-312":45607,"blake2b-320":45608,"blake2b-328":45609,"blake2b-336":45610,"blake2b-344":45611,"blake2b-352":45612,"blake2b-360":45613,"blake2b-368":45614,"blake2b-376":45615,"blake2b-384":45616,"blake2b-392":45617,"blake2b-400":45618,"blake2b-408":45619,"blake2b-416":45620,"blake2b-424":45621,"blake2b-432":45622,"blake2b-440":45623,"blake2b-448":45624,"blake2b-456":45625,"blake2b-464":45626,"blake2b-472":45627,"blake2b-480":45628,"blake2b-488":45629,"blake2b-496":45630,"blake2b-504":45631,"blake2b-512":45632,"blake2s-8":45633,"blake2s-16":45634,"blake2s-24":45635,"blake2s-32":45636,"blake2s-40":45637,"blake2s-48":45638,"blake2s-56":45639,"blake2s-64":45640,"blake2s-72":45641,"blake2s-80":45642,"blake2s-88":45643,"blake2s-96":45644,"blake2s-104":45645,"blake2s-112":45646,"blake2s-120":45647,"blake2s-128":45648,"blake2s-136":45649,"blake2s-144":45650,"blake2s-152":45651,"blake2s-160":45652,"blake2s-168":45653,"blake2s-176":45654,"blake2s-184":45655,"blake2s-192":45656,"blake2s-200":45657,"blake2s-208":45658,"blake2s-216":45659,"blake2s-224":45660,"blake2s-232":45661,"blake2s-240":45662,"blake2s-248":45663,"blake2s-256":45664,"skein256-8":45825,"skein256-16":45826,"skein256-24":45827,"skein256-32":45828,"skein256-40":45829,"skein256-48":45830,"skein256-56":45831,"skein256-64":45832,"skein256-72":45833,"skein256-80":45834,"skein256-88":45835,"skein256-96":45836,"skein256-104":45837,"skein256-112":45838,"skein256-120":45839,"skein256-128":45840,"skein256-136":45841,"skein256-144":45842,"skein256-152":45843,"skein256-160":45844,"skein256-168":45845,"skein256-176":45846,"skein256-184":45847,"skein256-192":45848,"skein256-200":45849,"skein256-208":45850,"skein256-216":45851,"skein256-224":45852,"skein256-232":45853,"skein256-240":45854,"skein256-248":45855,"skein256-256":45856,"skein512-8":45857,"skein512-16":45858,"skein512-24":45859,"skein512-32":45860,"skein512-40":45861,"skein512-48":45862,"skein512-56":45863,"skein512-64":45864,"skein512-72":45865,"skein512-80":45866,"skein512-88":45867,"skein512-96":45868,"skein512-104":45869,"skein512-112":45870,"skein512-120":45871,"skein512-128":45872,"skein512-136":45873,"skein512-144":45874,"skein512-152":45875,"skein512-160":45876,"skein512-168":45877,"skein512-176":45878,"skein512-184":45879,"skein512-192":45880,"skein512-200":45881,"skein512-208":45882,"skein512-216":45883,"skein512-224":45884,"skein512-232":45885,"skein512-240":45886,"skein512-248":45887,"skein512-256":45888,"skein512-264":45889,"skein512-272":45890,"skein512-280":45891,"skein512-288":45892,"skein512-296":45893,"skein512-304":45894,"skein512-312":45895,"skein512-320":45896,"skein512-328":45897,"skein512-336":45898,"skein512-344":45899,"skein512-352":45900,"skein512-360":45901,"skein512-368":45902,"skein512-376":45903,"skein512-384":45904,"skein512-392":45905,"skein512-400":45906,"skein512-408":45907,"skein512-416":45908,"skein512-424":45909,"skein512-432":45910,"skein512-440":45911,"skein512-448":45912,"skein512-456":45913,"skein512-464":45914,"skein512-472":45915,"skein512-480":45916,"skein512-488":45917,"skein512-496":45918,"skein512-504":45919,"skein512-512":45920,"skein1024-8":45921,"skein1024-16":45922,"skein1024-24":45923,"skein1024-32":45924,"skein1024-40":45925,"skein1024-48":45926,"skein1024-56":45927,"skein1024-64":45928,"skein1024-72":45929,"skein1024-80":45930,"skein1024-88":45931,"skein1024-96":45932,"skein1024-104":45933,"skein1024-112":45934,"skein1024-120":45935,"skein1024-128":45936,"skein1024-136":45937,"skein1024-144":45938,"skein1024-152":45939,"skein1024-160":45940,"skein1024-168":45941,"skein1024-176":45942,"skein1024-184":45943,"skein1024-192":45944,"skein1024-200":45945,"skein1024-208":45946,"skein1024-216":45947,"skein1024-224":45948,"skein1024-232":45949,"skein1024-240":45950,"skein1024-248":45951,"skein1024-256":45952,"skein1024-264":45953,"skein1024-272":45954,"skein1024-280":45955,"skein1024-288":45956,"skein1024-296":45957,"skein1024-304":45958,"skein1024-312":45959,"skein1024-320":45960,"skein1024-328":45961,"skein1024-336":45962,"skein1024-344":45963,"skein1024-352":45964,"skein1024-360":45965,"skein1024-368":45966,"skein1024-376":45967,"skein1024-384":45968,"skein1024-392":45969,"skein1024-400":45970,"skein1024-408":45971,"skein1024-416":45972,"skein1024-424":45973,"skein1024-432":45974,"skein1024-440":45975,"skein1024-448":45976,"skein1024-456":45977,"skein1024-464":45978,"skein1024-472":45979,"skein1024-480":45980,"skein1024-488":45981,"skein1024-496":45982,"skein1024-504":45983,"skein1024-512":45984,"skein1024-520":45985,"skein1024-528":45986,"skein1024-536":45987,"skein1024-544":45988,"skein1024-552":45989,"skein1024-560":45990,"skein1024-568":45991,"skein1024-576":45992,"skein1024-584":45993,"skein1024-592":45994,"skein1024-600":45995,"skein1024-608":45996,"skein1024-616":45997,"skein1024-624":45998,"skein1024-632":45999,"skein1024-640":46e3,"skein1024-648":46001,"skein1024-656":46002,"skein1024-664":46003,"skein1024-672":46004,"skein1024-680":46005,"skein1024-688":46006,"skein1024-696":46007,"skein1024-704":46008,"skein1024-712":46009,"skein1024-720":46010,"skein1024-728":46011,"skein1024-736":46012,"skein1024-744":46013,"skein1024-752":46014,"skein1024-760":46015,"skein1024-768":46016,"skein1024-776":46017,"skein1024-784":46018,"skein1024-792":46019,"skein1024-800":46020,"skein1024-808":46021,"skein1024-816":46022,"skein1024-824":46023,"skein1024-832":46024,"skein1024-840":46025,"skein1024-848":46026,"skein1024-856":46027,"skein1024-864":46028,"skein1024-872":46029,"skein1024-880":46030,"skein1024-888":46031,"skein1024-896":46032,"skein1024-904":46033,"skein1024-912":46034,"skein1024-920":46035,"skein1024-928":46036,"skein1024-936":46037,"skein1024-944":46038,"skein1024-952":46039,"skein1024-960":46040,"skein1024-968":46041,"skein1024-976":46042,"skein1024-984":46043,"skein1024-992":46044,"skein1024-1000":46045,"skein1024-1008":46046,"skein1024-1016":46047,"skein1024-1024":46048,"poseidon-bls12_381-a2-fc1":46081,"poseidon-bls12_381-a2-fc1-sc":46082});e.exports={names:t}},3180:(e,t,n)=>{"use strict";const r=n(7841),i=n(3475),{names:o}=n(3137),{toString:s}=n(6232),{fromString:a}=n(223),{concat:c}=n(17),l={};for(const g in o){const e=g;l[o[e]]=e}function u(e){if(!(e instanceof Uint8Array))throw new Error("multihash must be a Uint8Array");if(e.length<2)throw new Error("multihash too short. must be > 2 bytes.");const t=i.decode(e);if(!f(t))throw new Error("multihash unknown function code: 0x".concat(t.toString(16)));e=e.slice(i.decode.bytes);const n=i.decode(e);if(n<0)throw new Error("multihash invalid length: ".concat(n));if((e=e.slice(i.decode.bytes)).length!==n)throw new Error("multihash length inconsistent: 0x".concat(s(e,"base16")));return{code:t,name:l[t],length:n,digest:e}}function d(e){let t=e;if("string"===typeof e){if(void 0===o[e])throw new Error("Unrecognized hash function named: ".concat(e));t=o[e]}if("number"!==typeof t)throw new Error("Hash function code should be a number. Got: ".concat(t));if(void 0===l[t]&&!h(t))throw new Error("Unrecognized function code: ".concat(t));return t}function h(e){return e>0&&e<16}function f(e){return!!h(e)||!!l[e]}function p(e){u(e)}Object.freeze(l),e.exports={names:o,codes:l,toHexString:function(e){if(!(e instanceof Uint8Array))throw new Error("must be passed a Uint8Array");return s(e,"base16")},fromHexString:function(e){return a(e,"base16")},toB58String:function(e){if(!(e instanceof Uint8Array))throw new Error("must be passed a Uint8Array");return s(r.encode("base58btc",e)).slice(1)},fromB58String:function(e){const t=e instanceof Uint8Array?s(e):e;return r.decode("z"+t)},decode:u,encode:function(e,t,n){if(!e||void 0===t)throw new Error("multihash encode requires at least two args: digest, code");const r=d(t);if(!(e instanceof Uint8Array))throw new Error("digest should be a Uint8Array");if(null==n&&(n=e.length),n&&e.length!==n)throw new Error("digest length should be equal to specified length.");const o=i.encode(r),s=i.encode(n);return c([o,s,e],o.length+s.length+e.length)},coerceCode:d,isAppCode:h,validate:p,prefix:function(e){return p(e),e.subarray(0,2)},isValidCode:f}},2962:(e,t,n)=>{e.exports=n(892)},892:function(e,t){!function(n,r){"use strict";var i={version:"3.0.0",x86:{},x64:{},inputValidation:!0};function o(e){if(!Array.isArray(e)&&!ArrayBuffer.isView(e))return!1;for(var t=0;t<e.length;t++)if(!Number.isInteger(e[t])||e[t]<0||e[t]>255)return!1;return!0}function s(e,t){return(65535&e)*t+(((e>>>16)*t&65535)<<16)}function a(e,t){return e<<t|e>>>32-t}function c(e){return e=s(e^=e>>>16,2246822507),e=s(e^=e>>>13,3266489909),e^=e>>>16}function l(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var n=[0,0,0,0];return n[3]+=e[3]+t[3],n[2]+=n[3]>>>16,n[3]&=65535,n[2]+=e[2]+t[2],n[1]+=n[2]>>>16,n[2]&=65535,n[1]+=e[1]+t[1],n[0]+=n[1]>>>16,n[1]&=65535,n[0]+=e[0]+t[0],n[0]&=65535,[n[0]<<16|n[1],n[2]<<16|n[3]]}function u(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var n=[0,0,0,0];return n[3]+=e[3]*t[3],n[2]+=n[3]>>>16,n[3]&=65535,n[2]+=e[2]*t[3],n[1]+=n[2]>>>16,n[2]&=65535,n[2]+=e[3]*t[2],n[1]+=n[2]>>>16,n[2]&=65535,n[1]+=e[1]*t[3],n[0]+=n[1]>>>16,n[1]&=65535,n[1]+=e[2]*t[2],n[0]+=n[1]>>>16,n[1]&=65535,n[1]+=e[3]*t[1],n[0]+=n[1]>>>16,n[1]&=65535,n[0]+=e[0]*t[3]+e[1]*t[2]+e[2]*t[1]+e[3]*t[0],n[0]&=65535,[n[0]<<16|n[1],n[2]<<16|n[3]]}function d(e,t){return 32===(t%=64)?[e[1],e[0]]:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t|e[0]>>>32-t]:(t-=32,[e[1]<<t|e[0]>>>32-t,e[0]<<t|e[1]>>>32-t])}function h(e,t){return 0===(t%=64)?e:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t]:[e[1]<<t-32,0]}function f(e,t){return[e[0]^t[0],e[1]^t[1]]}function p(e){return e=f(e,[0,e[0]>>>1]),e=f(e=u(e,[4283543511,3981806797]),[0,e[0]>>>1]),e=f(e=u(e,[3301882366,444984403]),[0,e[0]>>>1])}i.x86.hash32=function(e,t){if(i.inputValidation&&!o(e))return r;t=t||0;for(var n=e.length%4,l=e.length-n,u=t,d=0,h=3432918353,f=461845907,p=0;p<l;p+=4)d=s(d=e[p]|e[p+1]<<8|e[p+2]<<16|e[p+3]<<24,h),d=s(d=a(d,15),f),u=s(u=a(u^=d,13),5)+3864292196;switch(d=0,n){case 3:d^=e[p+2]<<16;case 2:d^=e[p+1]<<8;case 1:d=s(d^=e[p],h),u^=d=s(d=a(d,15),f)}return(u=c(u^=e.length))>>>0},i.x86.hash128=function(e,t){if(i.inputValidation&&!o(e))return r;t=t||0;for(var n=e.length%16,l=e.length-n,u=t,d=t,h=t,f=t,p=0,g=0,m=0,v=0,y=597399067,w=2869860233,b=951274213,E=2716044179,k=0;k<l;k+=16)p=e[k]|e[k+1]<<8|e[k+2]<<16|e[k+3]<<24,g=e[k+4]|e[k+5]<<8|e[k+6]<<16|e[k+7]<<24,m=e[k+8]|e[k+9]<<8|e[k+10]<<16|e[k+11]<<24,v=e[k+12]|e[k+13]<<8|e[k+14]<<16|e[k+15]<<24,p=a(p=s(p,y),15),u=a(u^=p=s(p,w),19),u=s(u+=d,5)+1444728091,g=a(g=s(g,w),16),d=a(d^=g=s(g,b),17),d=s(d+=h,5)+197830471,m=a(m=s(m,b),17),h=a(h^=m=s(m,E),15),h=s(h+=f,5)+2530024501,v=a(v=s(v,E),18),f=a(f^=v=s(v,y),13),f=s(f+=u,5)+850148119;switch(p=0,g=0,m=0,v=0,n){case 15:v^=e[k+14]<<16;case 14:v^=e[k+13]<<8;case 13:v=s(v^=e[k+12],E),f^=v=s(v=a(v,18),y);case 12:m^=e[k+11]<<24;case 11:m^=e[k+10]<<16;case 10:m^=e[k+9]<<8;case 9:m=s(m^=e[k+8],b),h^=m=s(m=a(m,17),E);case 8:g^=e[k+7]<<24;case 7:g^=e[k+6]<<16;case 6:g^=e[k+5]<<8;case 5:g=s(g^=e[k+4],w),d^=g=s(g=a(g,16),b);case 4:p^=e[k+3]<<24;case 3:p^=e[k+2]<<16;case 2:p^=e[k+1]<<8;case 1:p=s(p^=e[k],y),u^=p=s(p=a(p,15),w)}return u^=e.length,u+=d^=e.length,u+=h^=e.length,d+=u+=f^=e.length,h+=u,f+=u,u=c(u),u+=d=c(d),u+=h=c(h),d+=u+=f=c(f),h+=u,f+=u,("00000000"+(u>>>0).toString(16)).slice(-8)+("00000000"+(d>>>0).toString(16)).slice(-8)+("00000000"+(h>>>0).toString(16)).slice(-8)+("00000000"+(f>>>0).toString(16)).slice(-8)},i.x64.hash128=function(e,t){if(i.inputValidation&&!o(e))return r;t=t||0;for(var n=e.length%16,s=e.length-n,a=[0,t],c=[0,t],g=[0,0],m=[0,0],v=[2277735313,289559509],y=[1291169091,658871167],w=0;w<s;w+=16)g=[e[w+4]|e[w+5]<<8|e[w+6]<<16|e[w+7]<<24,e[w]|e[w+1]<<8|e[w+2]<<16|e[w+3]<<24],m=[e[w+12]|e[w+13]<<8|e[w+14]<<16|e[w+15]<<24,e[w+8]|e[w+9]<<8|e[w+10]<<16|e[w+11]<<24],g=d(g=u(g,v),31),a=l(a=d(a=f(a,g=u(g,y)),27),c),a=l(u(a,[0,5]),[0,1390208809]),m=d(m=u(m,y),33),c=l(c=d(c=f(c,m=u(m,v)),31),a),c=l(u(c,[0,5]),[0,944331445]);switch(g=[0,0],m=[0,0],n){case 15:m=f(m,h([0,e[w+14]],48));case 14:m=f(m,h([0,e[w+13]],40));case 13:m=f(m,h([0,e[w+12]],32));case 12:m=f(m,h([0,e[w+11]],24));case 11:m=f(m,h([0,e[w+10]],16));case 10:m=f(m,h([0,e[w+9]],8));case 9:m=u(m=f(m,[0,e[w+8]]),y),c=f(c,m=u(m=d(m,33),v));case 8:g=f(g,h([0,e[w+7]],56));case 7:g=f(g,h([0,e[w+6]],48));case 6:g=f(g,h([0,e[w+5]],40));case 5:g=f(g,h([0,e[w+4]],32));case 4:g=f(g,h([0,e[w+3]],24));case 3:g=f(g,h([0,e[w+2]],16));case 2:g=f(g,h([0,e[w+1]],8));case 1:g=u(g=f(g,[0,e[w]]),v),a=f(a,g=u(g=d(g,31),y))}return a=l(a=f(a,[0,e.length]),c=f(c,[0,e.length])),c=l(c,a),a=l(a=p(a),c=p(c)),c=l(c,a),("00000000"+(a[0]>>>0).toString(16)).slice(-8)+("00000000"+(a[1]>>>0).toString(16)).slice(-8)+("00000000"+(c[0]>>>0).toString(16)).slice(-8)+("00000000"+(c[1]>>>0).toString(16)).slice(-8)},e.exports&&(t=e.exports=i),t.murmurHash3=i}()},7364:function(e,t){(function(){var e,n,r,i,o,s,a,c;c=function(e){return[(e&255<<24)>>>24,(e&255<<16)>>>16,(65280&e)>>>8,255&e].join(".")},a=function(e){var t,r,i,o,s,a;for(t=[],i=o=0;o<=3&&0!==e.length;i=++o){if(i>0){if("."!==e[0])throw new Error("Invalid IP");e=e.substring(1)}s=(a=n(e))[0],r=a[1],e=e.substring(r),t.push(s)}if(0!==e.length)throw new Error("Invalid IP");switch(t.length){case 1:if(t[0]>4294967295)throw new Error("Invalid IP");return t[0]>>>0;case 2:if(t[0]>255||t[1]>16777215)throw new Error("Invalid IP");return(t[0]<<24|t[1])>>>0;case 3:if(t[0]>255||t[1]>255||t[2]>65535)throw new Error("Invalid IP");return(t[0]<<24|t[1]<<16|t[2])>>>0;case 4:if(t[0]>255||t[1]>255||t[2]>255||t[3]>255)throw new Error("Invalid IP");return(t[0]<<24|t[1]<<16|t[2]<<8|t[3])>>>0;default:throw new Error("Invalid IP")}},i=(r=function(e){return e.charCodeAt(0)})("0"),s=r("a"),o=r("A"),n=function(e){var t,n,a,c,l;for(c=0,t=10,n="9",a=0,e.length>1&&"0"===e[a]&&("x"===e[a+1]||"X"===e[a+1]?(a+=2,t=16):"0"<=e[a+1]&&e[a+1]<="9"&&(a++,t=8,n="7")),l=a;a<e.length;){if("0"<=e[a]&&e[a]<=n)c=c*t+(r(e[a])-i)>>>0;else{if(16!==t)break;if("a"<=e[a]&&e[a]<="f")c=c*t+(10+r(e[a])-s)>>>0;else{if(!("A"<=e[a]&&e[a]<="F"))break;c=c*t+(10+r(e[a])-o)>>>0}}if(c>4294967295)throw new Error("too large");a++}if(a===l)throw new Error("empty octet");return[c,a]},e=function(){function e(e,t){var n,r,i;if("string"!==typeof e)throw new Error("Missing `net' parameter");if(t||(i=e.split("/",2),e=i[0],t=i[1]),t||(t=32),"string"===typeof t&&t.indexOf(".")>-1){try{this.maskLong=a(t)}catch(o){throw o,new Error("Invalid mask: "+t)}for(n=r=32;r>=0;n=--r)if(this.maskLong===4294967295<<32-n>>>0){this.bitmask=n;break}}else{if(!t&&0!==t)throw new Error("Invalid mask: empty");this.bitmask=parseInt(t,10),this.maskLong=0,this.bitmask>0&&(this.maskLong=4294967295<<32-this.bitmask>>>0)}try{this.netLong=(a(e)&this.maskLong)>>>0}catch(o){throw o,new Error("Invalid net address: "+e)}if(!(this.bitmask<=32))throw new Error("Invalid mask for ip4: "+t);this.size=Math.pow(2,32-this.bitmask),this.base=c(this.netLong),this.mask=c(this.maskLong),this.hostmask=c(~this.maskLong),this.first=this.bitmask<=30?c(this.netLong+1):this.base,this.last=this.bitmask<=30?c(this.netLong+this.size-2):c(this.netLong+this.size-1),this.broadcast=this.bitmask<=30?c(this.netLong+this.size-1):void 0}return e.prototype.contains=function(t){return"string"===typeof t&&(t.indexOf("/")>0||4!==t.split(".").length)&&(t=new e(t)),t instanceof e?this.contains(t.base)&&this.contains(t.broadcast||t.last):(a(t)&this.maskLong)>>>0===(this.netLong&this.maskLong)>>>0},e.prototype.next=function(t){return null==t&&(t=1),new e(c(this.netLong+this.size*t),this.mask)},e.prototype.forEach=function(e){var t,n,r;for(r=a(this.first),n=a(this.last),t=0;r<=n;)e(c(r),r,t),t++,r++},e.prototype.toString=function(){return this.base+"/"+this.bitmask},e}(),t.ip2long=a,t.long2ip=c,t.Netmask=e}).call(this)},7465:e=>{"use strict";var t=Object.prototype.hasOwnProperty,n="~";function r(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function o(e,t,r,o,s){if("function"!==typeof r)throw new TypeError("The listener must be a function");var a=new i(r,o||e,s),c=n?n+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function s(e,t){0===--e._eventsCount?e._events=new r:delete e._events[t]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),a.prototype.eventNames=function(){var e,r,i=[];if(0===this._eventsCount)return i;for(r in e=this._events)t.call(e,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},a.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,o=r.length,s=new Array(o);i<o;i++)s[i]=r[i].fn;return s},a.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},a.prototype.emit=function(e,t,r,i,o,s){var a=n?n+e:e;if(!this._events[a])return!1;var c,l,u=this._events[a],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,r),!0;case 4:return u.fn.call(u.context,t,r,i),!0;case 5:return u.fn.call(u.context,t,r,i,o),!0;case 6:return u.fn.call(u.context,t,r,i,o,s),!0}for(l=1,c=new Array(d-1);l<d;l++)c[l-1]=arguments[l];u.fn.apply(u.context,c)}else{var h,f=u.length;for(l=0;l<f;l++)switch(u[l].once&&this.removeListener(e,u[l].fn,void 0,!0),d){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,t);break;case 3:u[l].fn.call(u[l].context,t,r);break;case 4:u[l].fn.call(u[l].context,t,r,i);break;default:if(!c)for(h=1,c=new Array(d-1);h<d;h++)c[h-1]=arguments[h];u[l].fn.apply(u[l].context,c)}}return!0},a.prototype.on=function(e,t,n){return o(this,e,t,n,!1)},a.prototype.once=function(e,t,n){return o(this,e,t,n,!0)},a.prototype.removeListener=function(e,t,r,i){var o=n?n+e:e;if(!this._events[o])return this;if(!t)return s(this,o),this;var a=this._events[o];if(a.fn)a.fn!==t||i&&!a.once||r&&a.context!==r||s(this,o);else{for(var c=0,l=[],u=a.length;c<u;c++)(a[c].fn!==t||i&&!a[c].once||r&&a[c].context!==r)&&l.push(a[c]);l.length?this._events[o]=1===l.length?l[0]:l:s(this,o)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&s(this,t)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a},9197:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,o.default)((function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=null;return t.forEach((function(e){if(null==i){var t=e.apply(void 0,n);null!=t&&(i=t)}})),i}))};var r,i=n(3534),o=(r=i)&&r.__esModule?r:{default:r};e.exports=t.default},3534:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){function t(t,n,r,i,o,s){var a=i||"<<anonymous>>",c=s||r;if(null==n[r])return t?new Error("Required "+o+" `"+c+"` was not specified in `"+a+"`."):null;for(var l=arguments.length,u=Array(l>6?l-6:0),d=6;d<l;d++)u[d-6]=arguments[d];return e.apply(void 0,[n,r,a,o,c].concat(u))}var n=t.bind(null,!1);return n.isRequired=t.bind(null,!0),n},e.exports=t.default},1497:(e,t,n)=>{"use strict";var r=n(3218);function i(){}function o(){}o.resetWarningCache=i,e.exports=function(){function e(e,t,n,i,o,s){if(s!==r){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:i};return n.PropTypes=n,n}},5173:(e,t,n)=>{e.exports=n(1497)()},3218:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},8275:(e,t)=>{"use strict";class n{static isArrayBuffer(e){return"[object ArrayBuffer]"===Object.prototype.toString.call(e)}static toArrayBuffer(e){return this.isArrayBuffer(e)?e:e.byteLength===e.buffer.byteLength||0===e.byteOffset&&e.byteLength===e.buffer.byteLength?e.buffer:this.toUint8Array(e.buffer).slice(e.byteOffset,e.byteOffset+e.byteLength).buffer}static toUint8Array(e){return this.toView(e,Uint8Array)}static toView(e,t){if(e.constructor===t)return e;if(this.isArrayBuffer(e))return new t(e);if(this.isArrayBufferView(e))return new t(e.buffer,e.byteOffset,e.byteLength);throw new TypeError("The provided value is not of type '(ArrayBuffer or ArrayBufferView)'")}static isBufferSource(e){return this.isArrayBufferView(e)||this.isArrayBuffer(e)}static isArrayBufferView(e){return ArrayBuffer.isView(e)||e&&this.isArrayBuffer(e.buffer)}static isEqual(e,t){const r=n.toUint8Array(e),i=n.toUint8Array(t);if(r.length!==i.byteLength)return!1;for(let n=0;n<r.length;n++)if(r[n]!==i[n])return!1;return!0}static concat(){let e;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];e=!Array.isArray(n[0])||n[1]instanceof Function?Array.isArray(n[0])&&n[1]instanceof Function?n[0]:n[n.length-1]instanceof Function?n.slice(0,n.length-1):n:n[0];let i=0;for(const a of e)i+=a.byteLength;const o=new Uint8Array(i);let s=0;for(const a of e){const e=this.toUint8Array(a);o.set(e,s),s+=e.length}return n[n.length-1]instanceof Function?this.toView(o,n[n.length-1]):o.buffer}}const r="string",i=/^[0-9a-f]+$/i,o=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/,s=/^[a-zA-Z0-9-_]+$/;class a{static fromString(e){const t=unescape(encodeURIComponent(e)),n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n.buffer}static toString(e){const t=n.toUint8Array(e);let r="";for(let n=0;n<t.length;n++)r+=String.fromCharCode(t[n]);return decodeURIComponent(escape(r))}}class c{static toString(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=n.toArrayBuffer(e),i=new DataView(r);let o="";for(let n=0;n<r.byteLength;n+=2){const e=i.getUint16(n,t);o+=String.fromCharCode(e)}return o}static fromString(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=new ArrayBuffer(2*e.length),r=new DataView(n);for(let i=0;i<e.length;i++)r.setUint16(2*i,e.charCodeAt(i),t);return n}}class l{static isHex(e){return typeof e===r&&i.test(e)}static isBase64(e){return typeof e===r&&o.test(e)}static isBase64Url(e){return typeof e===r&&s.test(e)}static ToString(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8";const r=n.toUint8Array(e);switch(t.toLowerCase()){case"utf8":return this.ToUtf8String(r);case"binary":return this.ToBinary(r);case"hex":return this.ToHex(r);case"base64":return this.ToBase64(r);case"base64url":return this.ToBase64Url(r);case"utf16le":return c.toString(r,!0);case"utf16":case"utf16be":return c.toString(r);default:throw new Error("Unknown type of encoding '".concat(t,"'"))}}static FromString(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8";if(!e)return new ArrayBuffer(0);switch(t.toLowerCase()){case"utf8":return this.FromUtf8String(e);case"binary":return this.FromBinary(e);case"hex":return this.FromHex(e);case"base64":return this.FromBase64(e);case"base64url":return this.FromBase64Url(e);case"utf16le":return c.fromString(e,!0);case"utf16":case"utf16be":return c.fromString(e);default:throw new Error("Unknown type of encoding '".concat(t,"'"))}}static ToBase64(e){const t=n.toUint8Array(e);if("undefined"!==typeof btoa){const e=this.ToString(t,"binary");return btoa(e)}return Buffer.from(t).toString("base64")}static FromBase64(e){const t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!l.isBase64(t))throw new TypeError("Argument 'base64Text' is not Base64 encoded");return"undefined"!==typeof atob?this.FromBinary(atob(t)):new Uint8Array(Buffer.from(t,"base64")).buffer}static FromBase64Url(e){const t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!l.isBase64Url(t))throw new TypeError("Argument 'base64url' is not Base64Url encoded");return this.FromBase64(this.Base64Padding(t.replace(/\-/g,"+").replace(/\_/g,"/")))}static ToBase64Url(e){return this.ToBase64(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}static FromUtf8String(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l.DEFAULT_UTF8_ENCODING;switch(t){case"ascii":return this.FromBinary(e);case"utf8":return a.fromString(e);case"utf16":case"utf16be":return c.fromString(e);case"utf16le":case"usc2":return c.fromString(e,!0);default:throw new Error("Unknown type of encoding '".concat(t,"'"))}}static ToUtf8String(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l.DEFAULT_UTF8_ENCODING;switch(t){case"ascii":return this.ToBinary(e);case"utf8":return a.toString(e);case"utf16":case"utf16be":return c.toString(e);case"utf16le":case"usc2":return c.toString(e,!0);default:throw new Error("Unknown type of encoding '".concat(t,"'"))}}static FromBinary(e){const t=e.length,n=new Uint8Array(t);for(let r=0;r<t;r++)n[r]=e.charCodeAt(r);return n.buffer}static ToBinary(e){const t=n.toUint8Array(e);let r="";for(let n=0;n<t.length;n++)r+=String.fromCharCode(t[n]);return r}static ToHex(e){const t=n.toUint8Array(e);let r="";const i=t.length;for(let n=0;n<i;n++){const e=t[n];e<16&&(r+="0"),r+=e.toString(16)}return r}static FromHex(e){let t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!l.isHex(t))throw new TypeError("Argument 'hexString' is not HEX encoded");t.length%2&&(t="0".concat(t));const n=new Uint8Array(t.length/2);for(let r=0;r<t.length;r+=2){const e=t.slice(r,r+2);n[r/2]=parseInt(e,16)}return n.buffer}static ToUtf16String(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return c.toString(e,t)}static FromUtf16String(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return c.fromString(e,t)}static Base64Padding(e){const t=4-e.length%4;if(t<4)for(let n=0;n<t;n++)e+="=";return e}static formatString(e){return(null===e||void 0===e?void 0:e.replace(/[\n\r\t ]/g,""))||""}}l.DEFAULT_UTF8_ENCODING="utf8",t._H=n,t.U$=l},2730:(e,t,n)=>{"use strict";var r=n(5043),i=n(8853);function o(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,a={};function c(e,t){l(e,t),l(e+"Capture",t)}function l(e,t){for(a[e]=t,e=0;e<t.length;e++)s.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function g(e,t,n,r,i,o,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=s}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){m[e]=new g(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];m[t]=new g(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){m[e]=new g(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){m[e]=new g(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){m[e]=new g(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){m[e]=new g(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){m[e]=new g(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){m[e]=new g(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){m[e]=new g(e,5,!1,e.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function w(e,t,n,r){var i=m.hasOwnProperty(t)?m[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!d.call(p,e)||!d.call(f,e)&&(h.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(v,y);m[t]=new g(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(v,y);m[t]=new g(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(v,y);m[t]=new g(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!1,!1)})),m.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!0,!0)}));var b=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,E=Symbol.for("react.element"),k=Symbol.for("react.portal"),A=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),x=Symbol.for("react.profiler"),_=Symbol.for("react.provider"),I=Symbol.for("react.context"),R=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),T=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),N=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var B=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var D=Symbol.iterator;function O(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=D&&e[D]||e["@@iterator"])?e:null}var L,M=Object.assign;function F(e){if(void 0===L)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);L=t&&t[1]||""}return"\n"+L+e}var U=!1;function j(e,t){if(!e||U)return"";U=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var r=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){r=l}e.call(t.prototype)}else{try{throw Error()}catch(l){r=l}e()}}catch(l){if(l&&r&&"string"===typeof l.stack){for(var i=l.stack.split("\n"),o=r.stack.split("\n"),s=i.length-1,a=o.length-1;1<=s&&0<=a&&i[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(i[s]!==o[a]){if(1!==s||1!==a)do{if(s--,0>--a||i[s]!==o[a]){var c="\n"+i[s].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}}while(1<=s&&0<=a);break}}}finally{U=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?F(e):""}function H(e){switch(e.tag){case 5:return F(e.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return e=j(e.type,!1);case 11:return e=j(e.type.render,!1);case 1:return e=j(e.type,!0);default:return""}}function z(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case A:return"Fragment";case k:return"Portal";case x:return"Profiler";case S:return"StrictMode";case C:return"Suspense";case T:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case I:return(e.displayName||"Context")+".Consumer";case _:return(e._context.displayName||"Context")+".Provider";case R:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case P:return null!==(t=e.displayName||null)?t:z(e.type)||"Memo";case N:t=e._payload,e=e._init;try{return z(e(t))}catch(n){}}return null}function V(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return z(t);case 8:return t===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function q(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function G(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function K(e){e._valueTracker||(e._valueTracker=function(e){var t=G(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function W(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=G(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Q(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var n=t.checked;return M({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Z(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=q(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function J(e,t){null!=(t=t.checked)&&w(e,"checked",t,!1)}function X(e,t){J(e,t);var n=q(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,q(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function $(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&Q(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+q(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(o(91));return M({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(o(92));if(te(n)){if(1<n.length)throw Error(o(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:q(n)}}function oe(e,t){var n=q(t.value),r=q(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function se(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ae(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ce(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ae(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var le,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((le=le||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=le.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function ge(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function me(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=ge(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(fe).forEach((function(e){pe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]}))}));var ve=M({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(o(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(o(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(o(62))}}function we(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var be=null;function Ee(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var ke=null,Ae=null,Se=null;function xe(e){if(e=wi(e)){if("function"!==typeof ke)throw Error(o(280));var t=e.stateNode;t&&(t=Ei(t),ke(e.stateNode,e.type,t))}}function _e(e){Ae?Se?Se.push(e):Se=[e]:Ae=e}function Ie(){if(Ae){var e=Ae,t=Se;if(Se=Ae=null,xe(e),t)for(e=0;e<t.length;e++)xe(t[e])}}function Re(e,t){return e(t)}function Ce(){}var Te=!1;function Pe(e,t,n){if(Te)return e(t,n);Te=!0;try{return Re(e,t,n)}finally{Te=!1,(null!==Ae||null!==Se)&&(Ce(),Ie())}}function Ne(e,t){var n=e.stateNode;if(null===n)return null;var r=Ei(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(o(231,t,typeof n));return n}var Be=!1;if(u)try{var De={};Object.defineProperty(De,"passive",{get:function(){Be=!0}}),window.addEventListener("test",De,De),window.removeEventListener("test",De,De)}catch(ue){Be=!1}function Oe(e,t,n,r,i,o,s,a,c){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(u){this.onError(u)}}var Le=!1,Me=null,Fe=!1,Ue=null,je={onError:function(e){Le=!0,Me=e}};function He(e,t,n,r,i,o,s,a,c){Le=!1,Me=null,Oe.apply(je,arguments)}function ze(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ve(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function qe(e){if(ze(e)!==e)throw Error(o(188))}function Ge(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=ze(e)))throw Error(o(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var s=i.alternate;if(null===s){if(null!==(r=i.return)){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return qe(i),e;if(s===r)return qe(i),t;s=s.sibling}throw Error(o(188))}if(n.return!==r.return)n=i,r=s;else{for(var a=!1,c=i.child;c;){if(c===n){a=!0,n=i,r=s;break}if(c===r){a=!0,r=i,n=s;break}c=c.sibling}if(!a){for(c=s.child;c;){if(c===n){a=!0,n=s,r=i;break}if(c===r){a=!0,r=s,n=i;break}c=c.sibling}if(!a)throw Error(o(189))}}if(n.alternate!==r)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?e:t}(e))?Ke(e):null}function Ke(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ke(e);if(null!==t)return t;e=e.sibling}return null}var We=i.unstable_scheduleCallback,Qe=i.unstable_cancelCallback,Ye=i.unstable_shouldYield,Ze=i.unstable_requestPaint,Je=i.unstable_now,Xe=i.unstable_getCurrentPriorityLevel,$e=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,ot=null;var st=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(at(e)/ct|0)|0},at=Math.log,ct=Math.LN2;var lt=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,o=e.pingedLanes,s=268435455&n;if(0!==s){var a=s&~i;0!==a?r=dt(a):0!==(o&=s)&&(r=dt(o))}else 0!==(s=n&~i)?r=dt(s):0!==o&&(r=dt(o));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(o=t&-t)||16===i&&0!==(4194240&o)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-st(t)),r|=e[n],t&=~i;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function gt(){var e=lt;return 0===(4194240&(lt<<=1))&&(lt=64),e}function mt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-st(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-st(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var wt=0;function bt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var Et,kt,At,St,xt,_t=!1,It=[],Rt=null,Ct=null,Tt=null,Pt=new Map,Nt=new Map,Bt=[],Dt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ot(e,t){switch(e){case"focusin":case"focusout":Rt=null;break;case"dragenter":case"dragleave":Ct=null;break;case"mouseover":case"mouseout":Tt=null;break;case"pointerover":case"pointerout":Pt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Nt.delete(t.pointerId)}}function Lt(e,t,n,r,i,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},null!==t&&(null!==(t=wi(t))&&kt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Mt(e){var t=yi(e.target);if(null!==t){var n=ze(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ve(n)))return e.blockedOn=t,void xt(e.priority,(function(){At(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ft(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=wi(n))&&kt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);be=r,n.target.dispatchEvent(r),be=null,t.shift()}return!0}function Ut(e,t,n){Ft(e)&&n.delete(t)}function jt(){_t=!1,null!==Rt&&Ft(Rt)&&(Rt=null),null!==Ct&&Ft(Ct)&&(Ct=null),null!==Tt&&Ft(Tt)&&(Tt=null),Pt.forEach(Ut),Nt.forEach(Ut)}function Ht(e,t){e.blockedOn===t&&(e.blockedOn=null,_t||(_t=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,jt)))}function zt(e){function t(t){return Ht(t,e)}if(0<It.length){Ht(It[0],e);for(var n=1;n<It.length;n++){var r=It[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Rt&&Ht(Rt,e),null!==Ct&&Ht(Ct,e),null!==Tt&&Ht(Tt,e),Pt.forEach(t),Nt.forEach(t),n=0;n<Bt.length;n++)(r=Bt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Bt.length&&null===(n=Bt[0]).blockedOn;)Mt(n),null===n.blockedOn&&Bt.shift()}var Vt=b.ReactCurrentBatchConfig,qt=!0;function Gt(e,t,n,r){var i=wt,o=Vt.transition;Vt.transition=null;try{wt=1,Wt(e,t,n,r)}finally{wt=i,Vt.transition=o}}function Kt(e,t,n,r){var i=wt,o=Vt.transition;Vt.transition=null;try{wt=4,Wt(e,t,n,r)}finally{wt=i,Vt.transition=o}}function Wt(e,t,n,r){if(qt){var i=Yt(e,t,n,r);if(null===i)qr(e,t,r,Qt,n),Ot(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return Rt=Lt(Rt,e,t,n,r,i),!0;case"dragenter":return Ct=Lt(Ct,e,t,n,r,i),!0;case"mouseover":return Tt=Lt(Tt,e,t,n,r,i),!0;case"pointerover":var o=i.pointerId;return Pt.set(o,Lt(Pt.get(o)||null,e,t,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,Nt.set(o,Lt(Nt.get(o)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Ot(e,r),4&t&&-1<Dt.indexOf(e)){for(;null!==i;){var o=wi(i);if(null!==o&&Et(o),null===(o=Yt(e,t,n,r))&&qr(e,t,r,Qt,n),o===i)break;i=o}null!==i&&r.stopPropagation()}else qr(e,t,r,null,n)}}var Qt=null;function Yt(e,t,n,r){if(Qt=null,null!==(e=yi(e=Ee(r))))if(null===(t=ze(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Ve(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Qt=e,null}function Zt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xe()){case $e:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Jt=null,Xt=null,$t=null;function en(){if($t)return $t;var e,t,n=Xt,r=n.length,i="value"in Jt?Jt.value:Jt.textContent,o=i.length;for(e=0;e<r&&n[e]===i[e];e++);var s=r-e;for(t=1;t<=s&&n[r-t]===i[o-t];t++);return $t=i.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function on(e){function t(t,n,r,i,o){for(var s in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(i):i[s]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return M(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var sn,an,cn,ln={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=on(ln),dn=M({},ln,{view:0,detail:0}),hn=on(dn),fn=M({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==cn&&(cn&&"mousemove"===e.type?(sn=e.screenX-cn.screenX,an=e.screenY-cn.screenY):an=sn=0,cn=e),sn)},movementY:function(e){return"movementY"in e?e.movementY:an}}),pn=on(fn),gn=on(M({},fn,{dataTransfer:0})),mn=on(M({},dn,{relatedTarget:0})),vn=on(M({},ln,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=M({},ln,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),wn=on(yn),bn=on(M({},ln,{data:0})),En={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},An={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=An[e])&&!!t[e]}function xn(){return Sn}var _n=M({},dn,{key:function(e){if(e.key){var t=En[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?kn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),In=on(_n),Rn=on(M({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Cn=on(M({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xn})),Tn=on(M({},ln,{propertyName:0,elapsedTime:0,pseudoElement:0})),Pn=M({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Nn=on(Pn),Bn=[9,13,27,32],Dn=u&&"CompositionEvent"in window,On=null;u&&"documentMode"in document&&(On=document.documentMode);var Ln=u&&"TextEvent"in window&&!On,Mn=u&&(!Dn||On&&8<On&&11>=On),Fn=String.fromCharCode(32),Un=!1;function jn(e,t){switch(e){case"keyup":return-1!==Bn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Hn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var zn=!1;var Vn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Vn[e.type]:"textarea"===t}function Gn(e,t,n,r){_e(r),0<(t=Kr(t,"onChange")).length&&(n=new un("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Kn=null,Wn=null;function Qn(e){Fr(e,0)}function Yn(e){if(W(bi(e)))return e}function Zn(e,t){if("change"===e)return t}var Jn=!1;if(u){var Xn;if(u){var $n="oninput"in document;if(!$n){var er=document.createElement("div");er.setAttribute("oninput","return;"),$n="function"===typeof er.oninput}Xn=$n}else Xn=!1;Jn=Xn&&(!document.documentMode||9<document.documentMode)}function tr(){Kn&&(Kn.detachEvent("onpropertychange",nr),Wn=Kn=null)}function nr(e){if("value"===e.propertyName&&Yn(Wn)){var t=[];Gn(t,Wn,e,Ee(e)),Pe(Qn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Wn=n,(Kn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Yn(Wn)}function or(e,t){if("click"===e)return Yn(t)}function sr(e,t){if("input"===e||"change"===e)return Yn(t)}var ar="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function cr(e,t){if(ar(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!d.call(t,i)||!ar(e[i],t[i]))return!1}return!0}function lr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ur(e,t){var n,r=lr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=lr(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=Q();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=Q((e=t.contentWindow).document)}return t}function fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&dr(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=void 0===r.end?o:Math.min(r.end,i),!e.extend&&o>r&&(i=r,r=o,o=i),i=ur(n,o);var s=ur(n,r);i&&s&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),o>r?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var gr=u&&"documentMode"in document&&11>=document.documentMode,mr=null,vr=null,yr=null,wr=!1;function br(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;wr||null==mr||mr!==Q(r)||("selectionStart"in(r=mr)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&cr(yr,r)||(yr=r,0<(r=Kr(vr,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=mr)))}function Er(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var kr={animationend:Er("Animation","AnimationEnd"),animationiteration:Er("Animation","AnimationIteration"),animationstart:Er("Animation","AnimationStart"),transitionend:Er("Transition","TransitionEnd")},Ar={},Sr={};function xr(e){if(Ar[e])return Ar[e];if(!kr[e])return e;var t,n=kr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Sr)return Ar[e]=n[t];return e}u&&(Sr=document.createElement("div").style,"AnimationEvent"in window||(delete kr.animationend.animation,delete kr.animationiteration.animation,delete kr.animationstart.animation),"TransitionEvent"in window||delete kr.transitionend.transition);var _r=xr("animationend"),Ir=xr("animationiteration"),Rr=xr("animationstart"),Cr=xr("transitionend"),Tr=new Map,Pr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Nr(e,t){Tr.set(e,t),c(t,[e])}for(var Br=0;Br<Pr.length;Br++){var Dr=Pr[Br];Nr(Dr.toLowerCase(),"on"+(Dr[0].toUpperCase()+Dr.slice(1)))}Nr(_r,"onAnimationEnd"),Nr(Ir,"onAnimationIteration"),Nr(Rr,"onAnimationStart"),Nr("dblclick","onDoubleClick"),Nr("focusin","onFocus"),Nr("focusout","onBlur"),Nr(Cr,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),c("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),c("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),c("onBeforeInput",["compositionend","keypress","textInput","paste"]),c("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Or="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Lr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Or));function Mr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,s,a,c,l){if(He.apply(this,arguments),Le){if(!Le)throw Error(o(198));var u=Me;Le=!1,Me=null,Fe||(Fe=!0,Ue=u)}}(r,t,void 0,e),e.currentTarget=null}function Fr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var s=r.length-1;0<=s;s--){var a=r[s],c=a.instance,l=a.currentTarget;if(a=a.listener,c!==o&&i.isPropagationStopped())break e;Mr(i,a,l),o=c}else for(s=0;s<r.length;s++){if(c=(a=r[s]).instance,l=a.currentTarget,a=a.listener,c!==o&&i.isPropagationStopped())break e;Mr(i,a,l),o=c}}}if(Fe)throw e=Ue,Fe=!1,Ue=null,e}function Ur(e,t){var n=t[gi];void 0===n&&(n=t[gi]=new Set);var r=e+"__bubble";n.has(r)||(Vr(t,e,2,!1),n.add(r))}function jr(e,t,n){var r=0;t&&(r|=4),Vr(n,e,r,t)}var Hr="_reactListening"+Math.random().toString(36).slice(2);function zr(e){if(!e[Hr]){e[Hr]=!0,s.forEach((function(t){"selectionchange"!==t&&(Lr.has(t)||jr(t,!1,e),jr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Hr]||(t[Hr]=!0,jr("selectionchange",!1,t))}}function Vr(e,t,n,r){switch(Zt(t)){case 1:var i=Gt;break;case 4:i=Kt;break;default:i=Wt}n=i.bind(null,t,n,e),i=void 0,!Be||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function qr(e,t,n,r,i){var o=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var s=r.tag;if(3===s||4===s){var a=r.stateNode.containerInfo;if(a===i||8===a.nodeType&&a.parentNode===i)break;if(4===s)for(s=r.return;null!==s;){var c=s.tag;if((3===c||4===c)&&((c=s.stateNode.containerInfo)===i||8===c.nodeType&&c.parentNode===i))return;s=s.return}for(;null!==a;){if(null===(s=yi(a)))return;if(5===(c=s.tag)||6===c){r=o=s;continue e}a=a.parentNode}}r=r.return}Pe((function(){var r=o,i=Ee(n),s=[];e:{var a=Tr.get(e);if(void 0!==a){var c=un,l=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":c=In;break;case"focusin":l="focus",c=mn;break;case"focusout":l="blur",c=mn;break;case"beforeblur":case"afterblur":c=mn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=gn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=Cn;break;case _r:case Ir:case Rr:c=vn;break;case Cr:c=Tn;break;case"scroll":c=hn;break;case"wheel":c=Nn;break;case"copy":case"cut":case"paste":c=wn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=Rn}var u=0!==(4&t),d=!u&&"scroll"===e,h=u?null!==a?a+"Capture":null:a;u=[];for(var f,p=r;null!==p;){var g=(f=p).stateNode;if(5===f.tag&&null!==g&&(f=g,null!==h&&(null!=(g=Ne(p,h))&&u.push(Gr(p,g,f)))),d)break;p=p.return}0<u.length&&(a=new c(a,l,null,n,i),s.push({event:a,listeners:u}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===be||!(l=n.relatedTarget||n.fromElement)||!yi(l)&&!l[pi])&&(c||a)&&(a=i.window===i?i:(a=i.ownerDocument)?a.defaultView||a.parentWindow:window,c?(c=r,null!==(l=(l=n.relatedTarget||n.toElement)?yi(l):null)&&(l!==(d=ze(l))||5!==l.tag&&6!==l.tag)&&(l=null)):(c=null,l=r),c!==l)){if(u=pn,g="onMouseLeave",h="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=Rn,g="onPointerLeave",h="onPointerEnter",p="pointer"),d=null==c?a:bi(c),f=null==l?a:bi(l),(a=new u(g,p+"leave",c,n,i)).target=d,a.relatedTarget=f,g=null,yi(i)===r&&((u=new u(h,p+"enter",l,n,i)).target=f,u.relatedTarget=d,g=u),d=g,c&&l)e:{for(h=l,p=0,f=u=c;f;f=Wr(f))p++;for(f=0,g=h;g;g=Wr(g))f++;for(;0<p-f;)u=Wr(u),p--;for(;0<f-p;)h=Wr(h),f--;for(;p--;){if(u===h||null!==h&&u===h.alternate)break e;u=Wr(u),h=Wr(h)}u=null}else u=null;null!==c&&Qr(s,a,c,u,!1),null!==l&&null!==d&&Qr(s,d,l,u,!0)}if("select"===(c=(a=r?bi(r):window).nodeName&&a.nodeName.toLowerCase())||"input"===c&&"file"===a.type)var m=Zn;else if(qn(a))if(Jn)m=sr;else{m=ir;var v=rr}else(c=a.nodeName)&&"input"===c.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(m=or);switch(m&&(m=m(e,r))?Gn(s,m,n,i):(v&&v(e,a,r),"focusout"===e&&(v=a._wrapperState)&&v.controlled&&"number"===a.type&&ee(a,"number",a.value)),v=r?bi(r):window,e){case"focusin":(qn(v)||"true"===v.contentEditable)&&(mr=v,vr=r,yr=null);break;case"focusout":yr=vr=mr=null;break;case"mousedown":wr=!0;break;case"contextmenu":case"mouseup":case"dragend":wr=!1,br(s,n,i);break;case"selectionchange":if(gr)break;case"keydown":case"keyup":br(s,n,i)}var y;if(Dn)e:{switch(e){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else zn?jn(e,n)&&(w="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(w="onCompositionStart");w&&(Mn&&"ko"!==n.locale&&(zn||"onCompositionStart"!==w?"onCompositionEnd"===w&&zn&&(y=en()):(Xt="value"in(Jt=i)?Jt.value:Jt.textContent,zn=!0)),0<(v=Kr(r,w)).length&&(w=new bn(w,e,null,n,i),s.push({event:w,listeners:v}),y?w.data=y:null!==(y=Hn(n))&&(w.data=y))),(y=Ln?function(e,t){switch(e){case"compositionend":return Hn(t);case"keypress":return 32!==t.which?null:(Un=!0,Fn);case"textInput":return(e=t.data)===Fn&&Un?null:e;default:return null}}(e,n):function(e,t){if(zn)return"compositionend"===e||!Dn&&jn(e,t)?(e=en(),$t=Xt=Jt=null,zn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Mn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Kr(r,"onBeforeInput")).length&&(i=new bn("onBeforeInput","beforeinput",null,n,i),s.push({event:i,listeners:r}),i.data=y))}Fr(s,t)}))}function Gr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Kr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,o=i.stateNode;5===i.tag&&null!==o&&(i=o,null!=(o=Ne(e,n))&&r.unshift(Gr(e,o,i)),null!=(o=Ne(e,t))&&r.push(Gr(e,o,i))),e=e.return}return r}function Wr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Qr(e,t,n,r,i){for(var o=t._reactName,s=[];null!==n&&n!==r;){var a=n,c=a.alternate,l=a.stateNode;if(null!==c&&c===r)break;5===a.tag&&null!==l&&(a=l,i?null!=(c=Ne(n,o))&&s.unshift(Gr(n,c,a)):i||null!=(c=Ne(n,o))&&s.push(Gr(n,c,a))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var Yr=/\r\n?/g,Zr=/\u0000|\uFFFD/g;function Jr(e){return("string"===typeof e?e:""+e).replace(Yr,"\n").replace(Zr,"")}function Xr(e,t,n){if(t=Jr(t),Jr(e)!==t&&n)throw Error(o(425))}function $r(){}var ei=null,ti=null;function ni(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ri="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,oi="function"===typeof Promise?Promise:void 0,si="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof oi?function(e){return oi.resolve(null).then(e).catch(ai)}:ri;function ai(e){setTimeout((function(){throw e}))}function ci(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void zt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);zt(t)}function li(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ui(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var di=Math.random().toString(36).slice(2),hi="__reactFiber$"+di,fi="__reactProps$"+di,pi="__reactContainer$"+di,gi="__reactEvents$"+di,mi="__reactListeners$"+di,vi="__reactHandles$"+di;function yi(e){var t=e[hi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pi]||n[hi]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ui(e);null!==e;){if(n=e[hi])return n;e=ui(e)}return t}n=(e=n).parentNode}return null}function wi(e){return!(e=e[hi]||e[pi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function bi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(o(33))}function Ei(e){return e[fi]||null}var ki=[],Ai=-1;function Si(e){return{current:e}}function xi(e){0>Ai||(e.current=ki[Ai],ki[Ai]=null,Ai--)}function _i(e,t){Ai++,ki[Ai]=e.current,e.current=t}var Ii={},Ri=Si(Ii),Ci=Si(!1),Ti=Ii;function Pi(e,t){var n=e.type.contextTypes;if(!n)return Ii;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in n)o[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Ni(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Bi(){xi(Ci),xi(Ri)}function Di(e,t,n){if(Ri.current!==Ii)throw Error(o(168));_i(Ri,t),_i(Ci,n)}function Oi(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(o(108,V(e)||"Unknown",i));return M({},n,r)}function Li(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ii,Ti=Ri.current,_i(Ri,e),_i(Ci,Ci.current),!0}function Mi(e,t,n){var r=e.stateNode;if(!r)throw Error(o(169));n?(e=Oi(e,t,Ti),r.__reactInternalMemoizedMergedChildContext=e,xi(Ci),xi(Ri),_i(Ri,e)):xi(Ci),_i(Ci,n)}var Fi=null,Ui=!1,ji=!1;function Hi(e){null===Fi?Fi=[e]:Fi.push(e)}function zi(){if(!ji&&null!==Fi){ji=!0;var e=0,t=wt;try{var n=Fi;for(wt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Fi=null,Ui=!1}catch(i){throw null!==Fi&&(Fi=Fi.slice(e+1)),We($e,zi),i}finally{wt=t,ji=!1}}return null}var Vi=[],qi=0,Gi=null,Ki=0,Wi=[],Qi=0,Yi=null,Zi=1,Ji="";function Xi(e,t){Vi[qi++]=Ki,Vi[qi++]=Gi,Gi=e,Ki=t}function $i(e,t,n){Wi[Qi++]=Zi,Wi[Qi++]=Ji,Wi[Qi++]=Yi,Yi=e;var r=Zi;e=Ji;var i=32-st(r)-1;r&=~(1<<i),n+=1;var o=32-st(t)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,Zi=1<<32-st(t)+i|n<<i|r,Ji=o+e}else Zi=1<<o|n<<i|r,Ji=e}function eo(e){null!==e.return&&(Xi(e,1),$i(e,1,0))}function to(e){for(;e===Gi;)Gi=Vi[--qi],Vi[qi]=null,Ki=Vi[--qi],Vi[qi]=null;for(;e===Yi;)Yi=Wi[--Qi],Wi[Qi]=null,Ji=Wi[--Qi],Wi[Qi]=null,Zi=Wi[--Qi],Wi[Qi]=null}var no=null,ro=null,io=!1,oo=null;function so(e,t){var n=Pl(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function ao(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,no=e,ro=li(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,no=e,ro=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Yi?{id:Zi,overflow:Ji}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Pl(18,null,null,0)).stateNode=t,n.return=e,e.child=n,no=e,ro=null,!0);default:return!1}}function co(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function lo(e){if(io){var t=ro;if(t){var n=t;if(!ao(e,t)){if(co(e))throw Error(o(418));t=li(n.nextSibling);var r=no;t&&ao(e,t)?so(r,n):(e.flags=-4097&e.flags|2,io=!1,no=e)}}else{if(co(e))throw Error(o(418));e.flags=-4097&e.flags|2,io=!1,no=e}}}function uo(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;no=e}function ho(e){if(e!==no)return!1;if(!io)return uo(e),io=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ni(e.type,e.memoizedProps)),t&&(t=ro)){if(co(e))throw fo(),Error(o(418));for(;t;)so(e,t),t=li(t.nextSibling)}if(uo(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ro=li(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ro=null}}else ro=no?li(e.stateNode.nextSibling):null;return!0}function fo(){for(var e=ro;e;)e=li(e.nextSibling)}function po(){ro=no=null,io=!1}function go(e){null===oo?oo=[e]:oo.push(e)}var mo=b.ReactCurrentBatchConfig;function vo(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(o(309));var r=n.stateNode}if(!r)throw Error(o(147,e));var i=r,s=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===s?t.ref:(t=function(e){var t=i.refs;null===e?delete t[s]:t[s]=e},t._stringRef=s,t)}if("string"!==typeof e)throw Error(o(284));if(!n._owner)throw Error(o(290,e))}return e}function yo(e,t){throw e=Object.prototype.toString.call(t),Error(o(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function wo(e){return(0,e._init)(e._payload)}function bo(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Bl(e,t)).index=0,e.sibling=null,e}function s(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function c(e,t,n,r){return null===t||6!==t.tag?((t=Ml(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function l(e,t,n,r){var o=n.type;return o===A?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===N&&wo(o)===t.type)?((r=i(t,n.props)).ref=vo(e,t,n),r.return=e,r):((r=Dl(n.type,n.key,n.props,null,e.mode,r)).ref=vo(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Fl(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function d(e,t,n,r,o){return null===t||7!==t.tag?((t=Ol(n,e.mode,r,o)).return=e,t):((t=i(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Ml(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case E:return(n=Dl(t.type,t.key,t.props,null,e.mode,n)).ref=vo(e,null,t),n.return=e,n;case k:return(t=Fl(t,e.mode,n)).return=e,t;case N:return h(e,(0,t._init)(t._payload),n)}if(te(t)||O(t))return(t=Ol(t,e.mode,n,null)).return=e,t;yo(e,t)}return null}function f(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:c(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case E:return n.key===i?l(e,t,n,r):null;case k:return n.key===i?u(e,t,n,r):null;case N:return f(e,t,(i=n._init)(n._payload),r)}if(te(n)||O(n))return null!==i?null:d(e,t,n,r,null);yo(e,n)}return null}function p(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return c(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case E:return l(t,e=e.get(null===r.key?n:r.key)||null,r,i);case k:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case N:return p(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||O(r))return d(t,e=e.get(n)||null,r,i,null);yo(t,r)}return null}function g(i,o,a,c){for(var l=null,u=null,d=o,g=o=0,m=null;null!==d&&g<a.length;g++){d.index>g?(m=d,d=null):m=d.sibling;var v=f(i,d,a[g],c);if(null===v){null===d&&(d=m);break}e&&d&&null===v.alternate&&t(i,d),o=s(v,o,g),null===u?l=v:u.sibling=v,u=v,d=m}if(g===a.length)return n(i,d),io&&Xi(i,g),l;if(null===d){for(;g<a.length;g++)null!==(d=h(i,a[g],c))&&(o=s(d,o,g),null===u?l=d:u.sibling=d,u=d);return io&&Xi(i,g),l}for(d=r(i,d);g<a.length;g++)null!==(m=p(d,i,g,a[g],c))&&(e&&null!==m.alternate&&d.delete(null===m.key?g:m.key),o=s(m,o,g),null===u?l=m:u.sibling=m,u=m);return e&&d.forEach((function(e){return t(i,e)})),io&&Xi(i,g),l}function m(i,a,c,l){var u=O(c);if("function"!==typeof u)throw Error(o(150));if(null==(c=u.call(c)))throw Error(o(151));for(var d=u=null,g=a,m=a=0,v=null,y=c.next();null!==g&&!y.done;m++,y=c.next()){g.index>m?(v=g,g=null):v=g.sibling;var w=f(i,g,y.value,l);if(null===w){null===g&&(g=v);break}e&&g&&null===w.alternate&&t(i,g),a=s(w,a,m),null===d?u=w:d.sibling=w,d=w,g=v}if(y.done)return n(i,g),io&&Xi(i,m),u;if(null===g){for(;!y.done;m++,y=c.next())null!==(y=h(i,y.value,l))&&(a=s(y,a,m),null===d?u=y:d.sibling=y,d=y);return io&&Xi(i,m),u}for(g=r(i,g);!y.done;m++,y=c.next())null!==(y=p(g,i,m,y.value,l))&&(e&&null!==y.alternate&&g.delete(null===y.key?m:y.key),a=s(y,a,m),null===d?u=y:d.sibling=y,d=y);return e&&g.forEach((function(e){return t(i,e)})),io&&Xi(i,m),u}return function e(r,o,s,c){if("object"===typeof s&&null!==s&&s.type===A&&null===s.key&&(s=s.props.children),"object"===typeof s&&null!==s){switch(s.$$typeof){case E:e:{for(var l=s.key,u=o;null!==u;){if(u.key===l){if((l=s.type)===A){if(7===u.tag){n(r,u.sibling),(o=i(u,s.props.children)).return=r,r=o;break e}}else if(u.elementType===l||"object"===typeof l&&null!==l&&l.$$typeof===N&&wo(l)===u.type){n(r,u.sibling),(o=i(u,s.props)).ref=vo(r,u,s),o.return=r,r=o;break e}n(r,u);break}t(r,u),u=u.sibling}s.type===A?((o=Ol(s.props.children,r.mode,c,s.key)).return=r,r=o):((c=Dl(s.type,s.key,s.props,null,r.mode,c)).ref=vo(r,o,s),c.return=r,r=c)}return a(r);case k:e:{for(u=s.key;null!==o;){if(o.key===u){if(4===o.tag&&o.stateNode.containerInfo===s.containerInfo&&o.stateNode.implementation===s.implementation){n(r,o.sibling),(o=i(o,s.children||[])).return=r,r=o;break e}n(r,o);break}t(r,o),o=o.sibling}(o=Fl(s,r.mode,c)).return=r,r=o}return a(r);case N:return e(r,o,(u=s._init)(s._payload),c)}if(te(s))return g(r,o,s,c);if(O(s))return m(r,o,s,c);yo(r,s)}return"string"===typeof s&&""!==s||"number"===typeof s?(s=""+s,null!==o&&6===o.tag?(n(r,o.sibling),(o=i(o,s)).return=r,r=o):(n(r,o),(o=Ml(s,r.mode,c)).return=r,r=o),a(r)):n(r,o)}}var Eo=bo(!0),ko=bo(!1),Ao=Si(null),So=null,xo=null,_o=null;function Io(){_o=xo=So=null}function Ro(e){var t=Ao.current;xi(Ao),e._currentValue=t}function Co(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function To(e,t){So=e,_o=xo=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(wa=!0),e.firstContext=null)}function Po(e){var t=e._currentValue;if(_o!==e)if(e={context:e,memoizedValue:t,next:null},null===xo){if(null===So)throw Error(o(308));xo=e,So.dependencies={lanes:0,firstContext:e}}else xo=xo.next=e;return t}var No=null;function Bo(e){null===No?No=[e]:No.push(e)}function Do(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,Bo(t)):(n.next=i.next,i.next=n),t.interleaved=n,Oo(e,r)}function Oo(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Lo=!1;function Mo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Fo(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Uo(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function jo(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Rc)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Oo(e,n)}return null===(i=r.interleaved)?(t.next=t,Bo(r)):(t.next=i.next,i.next=t),r.interleaved=t,Oo(e,n)}function Ho(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function zo(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?i=o=s:o=o.next=s,n=n.next}while(null!==n);null===o?i=o=t:o=o.next=t}else i=o=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Vo(e,t,n,r){var i=e.updateQueue;Lo=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,a=i.shared.pending;if(null!==a){i.shared.pending=null;var c=a,l=c.next;c.next=null,null===s?o=l:s.next=l,s=c;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===a?u.firstBaseUpdate=l:a.next=l,u.lastBaseUpdate=c))}if(null!==o){var d=i.baseState;for(s=0,u=l=c=null,a=o;;){var h=a.lane,f=a.eventTime;if((r&h)===h){null!==u&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=e,g=a;switch(h=t,f=n,g.tag){case 1:if("function"===typeof(p=g.payload)){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(h="function"===typeof(p=g.payload)?p.call(f,d,h):p)||void 0===h)break e;d=M({},d,h);break e;case 2:Lo=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(h=i.effects)?i.effects=[a]:h.push(a))}else f={eventTime:f,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(l=u=f,c=d):u=u.next=f,s|=h;if(null===(a=a.next)){if(null===(a=i.shared.pending))break;a=(h=a).next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}if(null===u&&(c=d),i.baseState=c,i.firstBaseUpdate=l,i.lastBaseUpdate=u,null!==(t=i.shared.interleaved)){i=t;do{s|=i.lane,i=i.next}while(i!==t)}else null===o&&(i.shared.lanes=0);Lc|=s,e.lanes=s,e.memoizedState=d}}function qo(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(o(191,i));i.call(r)}}}var Go={},Ko=Si(Go),Wo=Si(Go),Qo=Si(Go);function Yo(e){if(e===Go)throw Error(o(174));return e}function Zo(e,t){switch(_i(Qo,t),_i(Wo,e),_i(Ko,Go),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ce(null,"");break;default:t=ce(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}xi(Ko),_i(Ko,t)}function Jo(){xi(Ko),xi(Wo),xi(Qo)}function Xo(e){Yo(Qo.current);var t=Yo(Ko.current),n=ce(t,e.type);t!==n&&(_i(Wo,e),_i(Ko,n))}function $o(e){Wo.current===e&&(xi(Ko),xi(Wo))}var es=Si(0);function ts(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ns=[];function rs(){for(var e=0;e<ns.length;e++)ns[e]._workInProgressVersionPrimary=null;ns.length=0}var is=b.ReactCurrentDispatcher,os=b.ReactCurrentBatchConfig,ss=0,as=null,cs=null,ls=null,us=!1,ds=!1,hs=0,fs=0;function ps(){throw Error(o(321))}function gs(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ar(e[n],t[n]))return!1;return!0}function ms(e,t,n,r,i,s){if(ss=s,as=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,is.current=null===e||null===e.memoizedState?$s:ea,e=n(r,i),ds){s=0;do{if(ds=!1,hs=0,25<=s)throw Error(o(301));s+=1,ls=cs=null,t.updateQueue=null,is.current=ta,e=n(r,i)}while(ds)}if(is.current=Xs,t=null!==cs&&null!==cs.next,ss=0,ls=cs=as=null,us=!1,t)throw Error(o(300));return e}function vs(){var e=0!==hs;return hs=0,e}function ys(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ls?as.memoizedState=ls=e:ls=ls.next=e,ls}function ws(){if(null===cs){var e=as.alternate;e=null!==e?e.memoizedState:null}else e=cs.next;var t=null===ls?as.memoizedState:ls.next;if(null!==t)ls=t,cs=e;else{if(null===e)throw Error(o(310));e={memoizedState:(cs=e).memoizedState,baseState:cs.baseState,baseQueue:cs.baseQueue,queue:cs.queue,next:null},null===ls?as.memoizedState=ls=e:ls=ls.next=e}return ls}function bs(e,t){return"function"===typeof t?t(e):t}function Es(e){var t=ws(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=cs,i=r.baseQueue,s=n.pending;if(null!==s){if(null!==i){var a=i.next;i.next=s.next,s.next=a}r.baseQueue=i=s,n.pending=null}if(null!==i){s=i.next,r=r.baseState;var c=a=null,l=null,u=s;do{var d=u.lane;if((ss&d)===d)null!==l&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===l?(c=l=h,a=r):l=l.next=h,as.lanes|=d,Lc|=d}u=u.next}while(null!==u&&u!==s);null===l?a=r:l.next=c,ar(r,t.memoizedState)||(wa=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=l,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{s=i.lane,as.lanes|=s,Lc|=s,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function ks(e){var t=ws(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,s=t.memoizedState;if(null!==i){n.pending=null;var a=i=i.next;do{s=e(s,a.action),a=a.next}while(a!==i);ar(s,t.memoizedState)||(wa=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function As(){}function Ss(e,t){var n=as,r=ws(),i=t(),s=!ar(r.memoizedState,i);if(s&&(r.memoizedState=i,wa=!0),r=r.queue,Ls(Is.bind(null,n,r,e),[e]),r.getSnapshot!==t||s||null!==ls&&1&ls.memoizedState.tag){if(n.flags|=2048,Ps(9,_s.bind(null,n,r,i,t),void 0,null),null===Cc)throw Error(o(349));0!==(30&ss)||xs(n,t,i)}return i}function xs(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=as.updateQueue)?(t={lastEffect:null,stores:null},as.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function _s(e,t,n,r){t.value=n,t.getSnapshot=r,Rs(t)&&Cs(e)}function Is(e,t,n){return n((function(){Rs(t)&&Cs(e)}))}function Rs(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ar(e,n)}catch(r){return!0}}function Cs(e){var t=Oo(e,1);null!==t&&nl(t,e,1,-1)}function Ts(e){var t=ys();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bs,lastRenderedState:e},t.queue=e,e=e.dispatch=Qs.bind(null,as,e),[t.memoizedState,e]}function Ps(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=as.updateQueue)?(t={lastEffect:null,stores:null},as.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Ns(){return ws().memoizedState}function Bs(e,t,n,r){var i=ys();as.flags|=e,i.memoizedState=Ps(1|t,n,void 0,void 0===r?null:r)}function Ds(e,t,n,r){var i=ws();r=void 0===r?null:r;var o=void 0;if(null!==cs){var s=cs.memoizedState;if(o=s.destroy,null!==r&&gs(r,s.deps))return void(i.memoizedState=Ps(t,n,o,r))}as.flags|=e,i.memoizedState=Ps(1|t,n,o,r)}function Os(e,t){return Bs(8390656,8,e,t)}function Ls(e,t){return Ds(2048,8,e,t)}function Ms(e,t){return Ds(4,2,e,t)}function Fs(e,t){return Ds(4,4,e,t)}function Us(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function js(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ds(4,4,Us.bind(null,t,e),n)}function Hs(){}function zs(e,t){var n=ws();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&gs(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Vs(e,t){var n=ws();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&gs(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function qs(e,t,n){return 0===(21&ss)?(e.baseState&&(e.baseState=!1,wa=!0),e.memoizedState=n):(ar(n,t)||(n=gt(),as.lanes|=n,Lc|=n,e.baseState=!0),t)}function Gs(e,t){var n=wt;wt=0!==n&&4>n?n:4,e(!0);var r=os.transition;os.transition={};try{e(!1),t()}finally{wt=n,os.transition=r}}function Ks(){return ws().memoizedState}function Ws(e,t,n){var r=tl(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Ys(e))Zs(t,n);else if(null!==(n=Do(e,t,n,r))){nl(n,e,r,el()),Js(n,t,r)}}function Qs(e,t,n){var r=tl(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ys(e))Zs(t,i);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var s=t.lastRenderedState,a=o(s,n);if(i.hasEagerState=!0,i.eagerState=a,ar(a,s)){var c=t.interleaved;return null===c?(i.next=i,Bo(t)):(i.next=c.next,c.next=i),void(t.interleaved=i)}}catch(l){}null!==(n=Do(e,t,i,r))&&(nl(n,e,r,i=el()),Js(n,t,r))}}function Ys(e){var t=e.alternate;return e===as||null!==t&&t===as}function Zs(e,t){ds=us=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Js(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var Xs={readContext:Po,useCallback:ps,useContext:ps,useEffect:ps,useImperativeHandle:ps,useInsertionEffect:ps,useLayoutEffect:ps,useMemo:ps,useReducer:ps,useRef:ps,useState:ps,useDebugValue:ps,useDeferredValue:ps,useTransition:ps,useMutableSource:ps,useSyncExternalStore:ps,useId:ps,unstable_isNewReconciler:!1},$s={readContext:Po,useCallback:function(e,t){return ys().memoizedState=[e,void 0===t?null:t],e},useContext:Po,useEffect:Os,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Bs(4194308,4,Us.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Bs(4194308,4,e,t)},useInsertionEffect:function(e,t){return Bs(4,2,e,t)},useMemo:function(e,t){var n=ys();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=ys();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Ws.bind(null,as,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},ys().memoizedState=e},useState:Ts,useDebugValue:Hs,useDeferredValue:function(e){return ys().memoizedState=e},useTransition:function(){var e=Ts(!1),t=e[0];return e=Gs.bind(null,e[1]),ys().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=as,i=ys();if(io){if(void 0===n)throw Error(o(407));n=n()}else{if(n=t(),null===Cc)throw Error(o(349));0!==(30&ss)||xs(r,t,n)}i.memoizedState=n;var s={value:n,getSnapshot:t};return i.queue=s,Os(Is.bind(null,r,s,e),[e]),r.flags|=2048,Ps(9,_s.bind(null,r,s,n,t),void 0,null),n},useId:function(){var e=ys(),t=Cc.identifierPrefix;if(io){var n=Ji;t=":"+t+"R"+(n=(Zi&~(1<<32-st(Zi)-1)).toString(32)+n),0<(n=hs++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=fs++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ea={readContext:Po,useCallback:zs,useContext:Po,useEffect:Ls,useImperativeHandle:js,useInsertionEffect:Ms,useLayoutEffect:Fs,useMemo:Vs,useReducer:Es,useRef:Ns,useState:function(){return Es(bs)},useDebugValue:Hs,useDeferredValue:function(e){return qs(ws(),cs.memoizedState,e)},useTransition:function(){return[Es(bs)[0],ws().memoizedState]},useMutableSource:As,useSyncExternalStore:Ss,useId:Ks,unstable_isNewReconciler:!1},ta={readContext:Po,useCallback:zs,useContext:Po,useEffect:Ls,useImperativeHandle:js,useInsertionEffect:Ms,useLayoutEffect:Fs,useMemo:Vs,useReducer:ks,useRef:Ns,useState:function(){return ks(bs)},useDebugValue:Hs,useDeferredValue:function(e){var t=ws();return null===cs?t.memoizedState=e:qs(t,cs.memoizedState,e)},useTransition:function(){return[ks(bs)[0],ws().memoizedState]},useMutableSource:As,useSyncExternalStore:Ss,useId:Ks,unstable_isNewReconciler:!1};function na(e,t){if(e&&e.defaultProps){for(var n in t=M({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function ra(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:M({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ia={isMounted:function(e){return!!(e=e._reactInternals)&&ze(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=el(),i=tl(e),o=Uo(r,i);o.payload=t,void 0!==n&&null!==n&&(o.callback=n),null!==(t=jo(e,o,i))&&(nl(t,e,i,r),Ho(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=el(),i=tl(e),o=Uo(r,i);o.tag=1,o.payload=t,void 0!==n&&null!==n&&(o.callback=n),null!==(t=jo(e,o,i))&&(nl(t,e,i,r),Ho(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=el(),r=tl(e),i=Uo(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=jo(e,i,r))&&(nl(t,e,r,n),Ho(t,e,r))}};function oa(e,t,n,r,i,o,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,s):!t.prototype||!t.prototype.isPureReactComponent||(!cr(n,r)||!cr(i,o))}function sa(e,t,n){var r=!1,i=Ii,o=t.contextType;return"object"===typeof o&&null!==o?o=Po(o):(i=Ni(t)?Ti:Ri.current,o=(r=null!==(r=t.contextTypes)&&void 0!==r)?Pi(e,i):Ii),t=new t(n,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ia,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function aa(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ia.enqueueReplaceState(t,t.state,null)}function ca(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},Mo(e);var o=t.contextType;"object"===typeof o&&null!==o?i.context=Po(o):(o=Ni(t)?Ti:Ri.current,i.context=Pi(e,o)),i.state=e.memoizedState,"function"===typeof(o=t.getDerivedStateFromProps)&&(ra(e,t,o,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&ia.enqueueReplaceState(i,i.state,null),Vo(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function la(e,t){try{var n="",r=t;do{n+=H(r),r=r.return}while(r);var i=n}catch(o){i="\nError generating stack: "+o.message+"\n"+o.stack}return{value:e,source:t,stack:i,digest:null}}function ua(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function da(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var ha="function"===typeof WeakMap?WeakMap:Map;function fa(e,t,n){(n=Uo(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){qc||(qc=!0,Gc=r),da(0,t)},n}function pa(e,t,n){(n=Uo(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){da(0,t)}}var o=e.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(n.callback=function(){da(0,t),"function"!==typeof r&&(null===Kc?Kc=new Set([this]):Kc.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ga(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new ha;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=xl.bind(null,e,t,n),t.then(e,e))}function ma(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function va(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Uo(-1,1)).tag=2,jo(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var ya=b.ReactCurrentOwner,wa=!1;function ba(e,t,n,r){t.child=null===e?ko(t,null,n,r):Eo(t,e.child,n,r)}function Ea(e,t,n,r,i){n=n.render;var o=t.ref;return To(t,i),r=ms(e,t,n,r,o,i),n=vs(),null===e||wa?(io&&n&&eo(t),t.flags|=1,ba(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,qa(e,t,i))}function ka(e,t,n,r,i){if(null===e){var o=n.type;return"function"!==typeof o||Nl(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Dl(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,Aa(e,t,o,r,i))}if(o=e.child,0===(e.lanes&i)){var s=o.memoizedProps;if((n=null!==(n=n.compare)?n:cr)(s,r)&&e.ref===t.ref)return qa(e,t,i)}return t.flags|=1,(e=Bl(o,r)).ref=t.ref,e.return=t,t.child=e}function Aa(e,t,n,r,i){if(null!==e){var o=e.memoizedProps;if(cr(o,r)&&e.ref===t.ref){if(wa=!1,t.pendingProps=r=o,0===(e.lanes&i))return t.lanes=e.lanes,qa(e,t,i);0!==(131072&e.flags)&&(wa=!0)}}return _a(e,t,n,r,i)}function Sa(e,t,n){var r=t.pendingProps,i=r.children,o=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},_i(Bc,Nc),Nc|=n;else{if(0===(1073741824&n))return e=null!==o?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,_i(Bc,Nc),Nc|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==o?o.baseLanes:n,_i(Bc,Nc),Nc|=r}else null!==o?(r=o.baseLanes|n,t.memoizedState=null):r=n,_i(Bc,Nc),Nc|=r;return ba(e,t,i,n),t.child}function xa(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function _a(e,t,n,r,i){var o=Ni(n)?Ti:Ri.current;return o=Pi(t,o),To(t,i),n=ms(e,t,n,r,o,i),r=vs(),null===e||wa?(io&&r&&eo(t),t.flags|=1,ba(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,qa(e,t,i))}function Ia(e,t,n,r,i){if(Ni(n)){var o=!0;Li(t)}else o=!1;if(To(t,i),null===t.stateNode)Va(e,t),sa(t,n,r),ca(t,n,r,i),r=!0;else if(null===e){var s=t.stateNode,a=t.memoizedProps;s.props=a;var c=s.context,l=n.contextType;"object"===typeof l&&null!==l?l=Po(l):l=Pi(t,l=Ni(n)?Ti:Ri.current);var u=n.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof s.getSnapshotBeforeUpdate;d||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a!==r||c!==l)&&aa(t,s,r,l),Lo=!1;var h=t.memoizedState;s.state=h,Vo(t,r,s,i),c=t.memoizedState,a!==r||h!==c||Ci.current||Lo?("function"===typeof u&&(ra(t,n,u,r),c=t.memoizedState),(a=Lo||oa(t,n,a,r,h,c,l))?(d||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),s.props=r,s.state=c,s.context=l,r=a):("function"===typeof s.componentDidMount&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,Fo(e,t),a=t.memoizedProps,l=t.type===t.elementType?a:na(t.type,a),s.props=l,d=t.pendingProps,h=s.context,"object"===typeof(c=n.contextType)&&null!==c?c=Po(c):c=Pi(t,c=Ni(n)?Ti:Ri.current);var f=n.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a!==d||h!==c)&&aa(t,s,r,c),Lo=!1,h=t.memoizedState,s.state=h,Vo(t,r,s,i);var p=t.memoizedState;a!==d||h!==p||Ci.current||Lo?("function"===typeof f&&(ra(t,n,f,r),p=t.memoizedState),(l=Lo||oa(t,n,l,r,h,p,c)||!1)?(u||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(r,p,c),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,p,c)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),s.props=r,s.state=p,s.context=c,r=l):("function"!==typeof s.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return Ra(e,t,n,r,o,i)}function Ra(e,t,n,r,i,o){xa(e,t);var s=0!==(128&t.flags);if(!r&&!s)return i&&Mi(t,n,!1),qa(e,t,o);r=t.stateNode,ya.current=t;var a=s&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&s?(t.child=Eo(t,e.child,null,o),t.child=Eo(t,null,a,o)):ba(e,t,a,o),t.memoizedState=r.state,i&&Mi(t,n,!0),t.child}function Ca(e){var t=e.stateNode;t.pendingContext?Di(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Di(0,t.context,!1),Zo(e,t.containerInfo)}function Ta(e,t,n,r,i){return po(),go(i),t.flags|=256,ba(e,t,n,r),t.child}var Pa,Na,Ba,Da,Oa={dehydrated:null,treeContext:null,retryLane:0};function La(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ma(e,t,n){var r,i=t.pendingProps,s=es.current,a=!1,c=0!==(128&t.flags);if((r=c)||(r=(null===e||null!==e.memoizedState)&&0!==(2&s)),r?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),_i(es,1&s),null===e)return lo(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(c=i.children,e=i.fallback,a?(i=t.mode,a=t.child,c={mode:"hidden",children:c},0===(1&i)&&null!==a?(a.childLanes=0,a.pendingProps=c):a=Ll(c,i,0,null),e=Ol(e,i,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=La(n),t.memoizedState=Oa,e):Fa(t,c));if(null!==(s=e.memoizedState)&&null!==(r=s.dehydrated))return function(e,t,n,r,i,s,a){if(n)return 256&t.flags?(t.flags&=-257,Ua(e,t,a,r=ua(Error(o(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=r.fallback,i=t.mode,r=Ll({mode:"visible",children:r.children},i,0,null),(s=Ol(s,i,a,null)).flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,0!==(1&t.mode)&&Eo(t,e.child,null,a),t.child.memoizedState=La(a),t.memoizedState=Oa,s);if(0===(1&t.mode))return Ua(e,t,a,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var c=r.dgst;return r=c,Ua(e,t,a,r=ua(s=Error(o(419)),r,void 0))}if(c=0!==(a&e.childLanes),wa||c){if(null!==(r=Cc)){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|a))?0:i)&&i!==s.retryLane&&(s.retryLane=i,Oo(e,i),nl(r,e,i,-1))}return gl(),Ua(e,t,a,r=ua(Error(o(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Il.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,ro=li(i.nextSibling),no=t,io=!0,oo=null,null!==e&&(Wi[Qi++]=Zi,Wi[Qi++]=Ji,Wi[Qi++]=Yi,Zi=e.id,Ji=e.overflow,Yi=t),t=Fa(t,r.children),t.flags|=4096,t)}(e,t,c,i,r,s,n);if(a){a=i.fallback,c=t.mode,r=(s=e.child).sibling;var l={mode:"hidden",children:i.children};return 0===(1&c)&&t.child!==s?((i=t.child).childLanes=0,i.pendingProps=l,t.deletions=null):(i=Bl(s,l)).subtreeFlags=14680064&s.subtreeFlags,null!==r?a=Bl(r,a):(a=Ol(a,c,n,null)).flags|=2,a.return=t,i.return=t,i.sibling=a,t.child=i,i=a,a=t.child,c=null===(c=e.child.memoizedState)?La(n):{baseLanes:c.baseLanes|n,cachePool:null,transitions:c.transitions},a.memoizedState=c,a.childLanes=e.childLanes&~n,t.memoizedState=Oa,i}return e=(a=e.child).sibling,i=Bl(a,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Fa(e,t){return(t=Ll({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Ua(e,t,n,r){return null!==r&&go(r),Eo(t,e.child,null,n),(e=Fa(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function ja(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Co(e.return,t,n)}function Ha(e,t,n,r,i){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function za(e,t,n){var r=t.pendingProps,i=r.revealOrder,o=r.tail;if(ba(e,t,r.children,n),0!==(2&(r=es.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&ja(e,n,t);else if(19===e.tag)ja(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(_i(es,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===ts(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Ha(t,!1,i,n,o);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===ts(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Ha(t,!0,n,null,o);break;case"together":Ha(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Va(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function qa(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Lc|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(n=Bl(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Bl(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Ga(e,t){if(!io)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ka(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Wa(e,t,n){var r=t.pendingProps;switch(to(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ka(t),null;case 1:case 17:return Ni(t.type)&&Bi(),Ka(t),null;case 3:return r=t.stateNode,Jo(),xi(Ci),xi(Ri),rs(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ho(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==oo&&(sl(oo),oo=null))),Na(e,t),Ka(t),null;case 5:$o(t);var i=Yo(Qo.current);if(n=t.type,null!==e&&null!=t.stateNode)Ba(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(o(166));return Ka(t),null}if(e=Yo(Ko.current),ho(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[hi]=t,r[fi]=s,e=0!==(1&t.mode),n){case"dialog":Ur("cancel",r),Ur("close",r);break;case"iframe":case"object":case"embed":Ur("load",r);break;case"video":case"audio":for(i=0;i<Or.length;i++)Ur(Or[i],r);break;case"source":Ur("error",r);break;case"img":case"image":case"link":Ur("error",r),Ur("load",r);break;case"details":Ur("toggle",r);break;case"input":Z(r,s),Ur("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Ur("invalid",r);break;case"textarea":ie(r,s),Ur("invalid",r)}for(var c in ye(n,s),i=null,s)if(s.hasOwnProperty(c)){var l=s[c];"children"===c?"string"===typeof l?r.textContent!==l&&(!0!==s.suppressHydrationWarning&&Xr(r.textContent,l,e),i=["children",l]):"number"===typeof l&&r.textContent!==""+l&&(!0!==s.suppressHydrationWarning&&Xr(r.textContent,l,e),i=["children",""+l]):a.hasOwnProperty(c)&&null!=l&&"onScroll"===c&&Ur("scroll",r)}switch(n){case"input":K(r),$(r,s,!0);break;case"textarea":K(r),se(r);break;case"select":case"option":break;default:"function"===typeof s.onClick&&(r.onclick=$r)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{c=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ae(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=c.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=c.createElement(n,{is:r.is}):(e=c.createElement(n),"select"===n&&(c=e,r.multiple?c.multiple=!0:r.size&&(c.size=r.size))):e=c.createElementNS(e,n),e[hi]=t,e[fi]=r,Pa(e,t,!1,!1),t.stateNode=e;e:{switch(c=we(n,r),n){case"dialog":Ur("cancel",e),Ur("close",e),i=r;break;case"iframe":case"object":case"embed":Ur("load",e),i=r;break;case"video":case"audio":for(i=0;i<Or.length;i++)Ur(Or[i],e);i=r;break;case"source":Ur("error",e),i=r;break;case"img":case"image":case"link":Ur("error",e),Ur("load",e),i=r;break;case"details":Ur("toggle",e),i=r;break;case"input":Z(e,r),i=Y(e,r),Ur("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=M({},r,{value:void 0}),Ur("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),Ur("invalid",e)}for(s in ye(n,i),l=i)if(l.hasOwnProperty(s)){var u=l[s];"style"===s?me(e,u):"dangerouslySetInnerHTML"===s?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===s?"string"===typeof u?("textarea"!==n||""!==u)&&he(e,u):"number"===typeof u&&he(e,""+u):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(a.hasOwnProperty(s)?null!=u&&"onScroll"===s&&Ur("scroll",e):null!=u&&w(e,s,u,c))}switch(n){case"input":K(e),$(e,r,!1);break;case"textarea":K(e),se(e);break;case"option":null!=r.value&&e.setAttribute("value",""+q(r.value));break;case"select":e.multiple=!!r.multiple,null!=(s=r.value)?ne(e,!!r.multiple,s,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=$r)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ka(t),null;case 6:if(e&&null!=t.stateNode)Da(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(o(166));if(n=Yo(Qo.current),Yo(Ko.current),ho(t)){if(r=t.stateNode,n=t.memoizedProps,r[hi]=t,(s=r.nodeValue!==n)&&null!==(e=no))switch(e.tag){case 3:Xr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Xr(r.nodeValue,n,0!==(1&e.mode))}s&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[hi]=t,t.stateNode=r}return Ka(t),null;case 13:if(xi(es),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(io&&null!==ro&&0!==(1&t.mode)&&0===(128&t.flags))fo(),po(),t.flags|=98560,s=!1;else if(s=ho(t),null!==r&&null!==r.dehydrated){if(null===e){if(!s)throw Error(o(318));if(!(s=null!==(s=t.memoizedState)?s.dehydrated:null))throw Error(o(317));s[hi]=t}else po(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ka(t),s=!1}else null!==oo&&(sl(oo),oo=null),s=!0;if(!s)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&es.current)?0===Dc&&(Dc=3):gl())),null!==t.updateQueue&&(t.flags|=4),Ka(t),null);case 4:return Jo(),Na(e,t),null===e&&zr(t.stateNode.containerInfo),Ka(t),null;case 10:return Ro(t.type._context),Ka(t),null;case 19:if(xi(es),null===(s=t.memoizedState))return Ka(t),null;if(r=0!==(128&t.flags),null===(c=s.rendering))if(r)Ga(s,!1);else{if(0!==Dc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(c=ts(e))){for(t.flags|=128,Ga(s,!1),null!==(r=c.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(s=n).flags&=14680066,null===(c=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=c.childLanes,s.lanes=c.lanes,s.child=c.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=c.memoizedProps,s.memoizedState=c.memoizedState,s.updateQueue=c.updateQueue,s.type=c.type,e=c.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return _i(es,1&es.current|2),t.child}e=e.sibling}null!==s.tail&&Je()>zc&&(t.flags|=128,r=!0,Ga(s,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ts(c))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Ga(s,!0),null===s.tail&&"hidden"===s.tailMode&&!c.alternate&&!io)return Ka(t),null}else 2*Je()-s.renderingStartTime>zc&&1073741824!==n&&(t.flags|=128,r=!0,Ga(s,!1),t.lanes=4194304);s.isBackwards?(c.sibling=t.child,t.child=c):(null!==(n=s.last)?n.sibling=c:t.child=c,s.last=c)}return null!==s.tail?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Je(),t.sibling=null,n=es.current,_i(es,r?1&n|2:1&n),t):(Ka(t),null);case 22:case 23:return dl(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Nc)&&(Ka(t),6&t.subtreeFlags&&(t.flags|=8192)):Ka(t),null;case 24:case 25:return null}throw Error(o(156,t.tag))}function Qa(e,t){switch(to(t),t.tag){case 1:return Ni(t.type)&&Bi(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Jo(),xi(Ci),xi(Ri),rs(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return $o(t),null;case 13:if(xi(es),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(o(340));po()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return xi(es),null;case 4:return Jo(),null;case 10:return Ro(t.type._context),null;case 22:case 23:return dl(),null;default:return null}}Pa=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Na=function(){},Ba=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Yo(Ko.current);var o,s=null;switch(n){case"input":i=Y(e,i),r=Y(e,r),s=[];break;case"select":i=M({},i,{value:void 0}),r=M({},r,{value:void 0}),s=[];break;case"textarea":i=re(e,i),r=re(e,r),s=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=$r)}for(u in ye(n,r),n=null,i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&null!=i[u])if("style"===u){var c=i[u];for(o in c)c.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(a.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(c=null!=i?i[u]:void 0,r.hasOwnProperty(u)&&l!==c&&(null!=l||null!=c))if("style"===u)if(c){for(o in c)!c.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&c[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(u,n)),n=l;else"dangerouslySetInnerHTML"===u?(l=l?l.__html:void 0,c=c?c.__html:void 0,null!=l&&c!==l&&(s=s||[]).push(u,l)):"children"===u?"string"!==typeof l&&"number"!==typeof l||(s=s||[]).push(u,""+l):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(a.hasOwnProperty(u)?(null!=l&&"onScroll"===u&&Ur("scroll",e),s||c===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(t.updateQueue=u)&&(t.flags|=4)}},Da=function(e,t,n,r){n!==r&&(t.flags|=4)};var Ya=!1,Za=!1,Ja="function"===typeof WeakSet?WeakSet:Set,Xa=null;function $a(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Sl(e,t,r)}else n.current=null}function ec(e,t,n){try{n()}catch(r){Sl(e,t,r)}}var tc=!1;function nc(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var o=i.destroy;i.destroy=void 0,void 0!==o&&ec(t,n,o)}i=i.next}while(i!==r)}}function rc(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function ic(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function oc(e){var t=e.alternate;null!==t&&(e.alternate=null,oc(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[hi],delete t[fi],delete t[gi],delete t[mi],delete t[vi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function sc(e){return 5===e.tag||3===e.tag||4===e.tag}function ac(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||sc(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cc(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=$r));else if(4!==r&&null!==(e=e.child))for(cc(e,t,n),e=e.sibling;null!==e;)cc(e,t,n),e=e.sibling}function lc(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(lc(e,t,n),e=e.sibling;null!==e;)lc(e,t,n),e=e.sibling}var uc=null,dc=!1;function hc(e,t,n){for(n=n.child;null!==n;)fc(e,t,n),n=n.sibling}function fc(e,t,n){if(ot&&"function"===typeof ot.onCommitFiberUnmount)try{ot.onCommitFiberUnmount(it,n)}catch(a){}switch(n.tag){case 5:Za||$a(n,t);case 6:var r=uc,i=dc;uc=null,hc(e,t,n),dc=i,null!==(uc=r)&&(dc?(e=uc,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):uc.removeChild(n.stateNode));break;case 18:null!==uc&&(dc?(e=uc,n=n.stateNode,8===e.nodeType?ci(e.parentNode,n):1===e.nodeType&&ci(e,n),zt(e)):ci(uc,n.stateNode));break;case 4:r=uc,i=dc,uc=n.stateNode.containerInfo,dc=!0,hc(e,t,n),uc=r,dc=i;break;case 0:case 11:case 14:case 15:if(!Za&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var o=i,s=o.destroy;o=o.tag,void 0!==s&&(0!==(2&o)||0!==(4&o))&&ec(n,t,s),i=i.next}while(i!==r)}hc(e,t,n);break;case 1:if(!Za&&($a(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Sl(n,t,a)}hc(e,t,n);break;case 21:hc(e,t,n);break;case 22:1&n.mode?(Za=(r=Za)||null!==n.memoizedState,hc(e,t,n),Za=r):hc(e,t,n);break;default:hc(e,t,n)}}function pc(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Ja),t.forEach((function(t){var r=Rl.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function gc(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var s=e,a=t,c=a;e:for(;null!==c;){switch(c.tag){case 5:uc=c.stateNode,dc=!1;break e;case 3:case 4:uc=c.stateNode.containerInfo,dc=!0;break e}c=c.return}if(null===uc)throw Error(o(160));fc(s,a,i),uc=null,dc=!1;var l=i.alternate;null!==l&&(l.return=null),i.return=null}catch(u){Sl(i,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)mc(t,e),t=t.sibling}function mc(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gc(t,e),vc(e),4&r){try{nc(3,e,e.return),rc(3,e)}catch(m){Sl(e,e.return,m)}try{nc(5,e,e.return)}catch(m){Sl(e,e.return,m)}}break;case 1:gc(t,e),vc(e),512&r&&null!==n&&$a(n,n.return);break;case 5:if(gc(t,e),vc(e),512&r&&null!==n&&$a(n,n.return),32&e.flags){var i=e.stateNode;try{he(i,"")}catch(m){Sl(e,e.return,m)}}if(4&r&&null!=(i=e.stateNode)){var s=e.memoizedProps,a=null!==n?n.memoizedProps:s,c=e.type,l=e.updateQueue;if(e.updateQueue=null,null!==l)try{"input"===c&&"radio"===s.type&&null!=s.name&&J(i,s),we(c,a);var u=we(c,s);for(a=0;a<l.length;a+=2){var d=l[a],h=l[a+1];"style"===d?me(i,h):"dangerouslySetInnerHTML"===d?de(i,h):"children"===d?he(i,h):w(i,d,h,u)}switch(c){case"input":X(i,s);break;case"textarea":oe(i,s);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var p=s.value;null!=p?ne(i,!!s.multiple,p,!1):f!==!!s.multiple&&(null!=s.defaultValue?ne(i,!!s.multiple,s.defaultValue,!0):ne(i,!!s.multiple,s.multiple?[]:"",!1))}i[fi]=s}catch(m){Sl(e,e.return,m)}}break;case 6:if(gc(t,e),vc(e),4&r){if(null===e.stateNode)throw Error(o(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(m){Sl(e,e.return,m)}}break;case 3:if(gc(t,e),vc(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{zt(t.containerInfo)}catch(m){Sl(e,e.return,m)}break;case 4:default:gc(t,e),vc(e);break;case 13:gc(t,e),vc(e),8192&(i=e.child).flags&&(s=null!==i.memoizedState,i.stateNode.isHidden=s,!s||null!==i.alternate&&null!==i.alternate.memoizedState||(Hc=Je())),4&r&&pc(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Za=(u=Za)||d,gc(t,e),Za=u):gc(t,e),vc(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&0!==(1&e.mode))for(Xa=e,d=e.child;null!==d;){for(h=Xa=d;null!==Xa;){switch(p=(f=Xa).child,f.tag){case 0:case 11:case 14:case 15:nc(4,f,f.return);break;case 1:$a(f,f.return);var g=f.stateNode;if("function"===typeof g.componentWillUnmount){r=f,n=f.return;try{t=r,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(m){Sl(r,n,m)}}break;case 5:$a(f,f.return);break;case 22:if(null!==f.memoizedState){Ec(h);continue}}null!==p?(p.return=f,Xa=p):Ec(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{i=h.stateNode,u?"function"===typeof(s=i.style).setProperty?s.setProperty("display","none","important"):s.display="none":(c=h.stateNode,a=void 0!==(l=h.memoizedProps.style)&&null!==l&&l.hasOwnProperty("display")?l.display:null,c.style.display=ge("display",a))}catch(m){Sl(e,e.return,m)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(m){Sl(e,e.return,m)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:gc(t,e),vc(e),4&r&&pc(e);case 21:}}function vc(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(sc(n)){var r=n;break e}n=n.return}throw Error(o(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(he(i,""),r.flags&=-33),lc(e,ac(e),i);break;case 3:case 4:var s=r.stateNode.containerInfo;cc(e,ac(e),s);break;default:throw Error(o(161))}}catch(a){Sl(e,e.return,a)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yc(e,t,n){Xa=e,wc(e,t,n)}function wc(e,t,n){for(var r=0!==(1&e.mode);null!==Xa;){var i=Xa,o=i.child;if(22===i.tag&&r){var s=null!==i.memoizedState||Ya;if(!s){var a=i.alternate,c=null!==a&&null!==a.memoizedState||Za;a=Ya;var l=Za;if(Ya=s,(Za=c)&&!l)for(Xa=i;null!==Xa;)c=(s=Xa).child,22===s.tag&&null!==s.memoizedState?kc(i):null!==c?(c.return=s,Xa=c):kc(i);for(;null!==o;)Xa=o,wc(o,t,n),o=o.sibling;Xa=i,Ya=a,Za=l}bc(e)}else 0!==(8772&i.subtreeFlags)&&null!==o?(o.return=i,Xa=o):bc(e)}}function bc(e){for(;null!==Xa;){var t=Xa;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Za||rc(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Za)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:na(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&qo(t,s,r);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}qo(t,a,n)}break;case 5:var c=t.stateNode;if(null===n&&4&t.flags){n=c;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&zt(h)}}}break;default:throw Error(o(163))}Za||512&t.flags&&ic(t)}catch(f){Sl(t,t.return,f)}}if(t===e){Xa=null;break}if(null!==(n=t.sibling)){n.return=t.return,Xa=n;break}Xa=t.return}}function Ec(e){for(;null!==Xa;){var t=Xa;if(t===e){Xa=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Xa=n;break}Xa=t.return}}function kc(e){for(;null!==Xa;){var t=Xa;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rc(4,t)}catch(c){Sl(t,n,c)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(c){Sl(t,i,c)}}var o=t.return;try{ic(t)}catch(c){Sl(t,o,c)}break;case 5:var s=t.return;try{ic(t)}catch(c){Sl(t,s,c)}}}catch(c){Sl(t,t.return,c)}if(t===e){Xa=null;break}var a=t.sibling;if(null!==a){a.return=t.return,Xa=a;break}Xa=t.return}}var Ac,Sc=Math.ceil,xc=b.ReactCurrentDispatcher,_c=b.ReactCurrentOwner,Ic=b.ReactCurrentBatchConfig,Rc=0,Cc=null,Tc=null,Pc=0,Nc=0,Bc=Si(0),Dc=0,Oc=null,Lc=0,Mc=0,Fc=0,Uc=null,jc=null,Hc=0,zc=1/0,Vc=null,qc=!1,Gc=null,Kc=null,Wc=!1,Qc=null,Yc=0,Zc=0,Jc=null,Xc=-1,$c=0;function el(){return 0!==(6&Rc)?Je():-1!==Xc?Xc:Xc=Je()}function tl(e){return 0===(1&e.mode)?1:0!==(2&Rc)&&0!==Pc?Pc&-Pc:null!==mo.transition?(0===$c&&($c=gt()),$c):0!==(e=wt)?e:e=void 0===(e=window.event)?16:Zt(e.type)}function nl(e,t,n,r){if(50<Zc)throw Zc=0,Jc=null,Error(o(185));vt(e,n,r),0!==(2&Rc)&&e===Cc||(e===Cc&&(0===(2&Rc)&&(Mc|=n),4===Dc&&al(e,Pc)),rl(e,r),1===n&&0===Rc&&0===(1&t.mode)&&(zc=Je()+500,Ui&&zi()))}function rl(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,o=e.pendingLanes;0<o;){var s=31-st(o),a=1<<s,c=i[s];-1===c?0!==(a&n)&&0===(a&r)||(i[s]=ft(a,t)):c<=t&&(e.expiredLanes|=a),o&=~a}}(e,t);var r=ht(e,e===Cc?Pc:0);if(0===r)null!==n&&Qe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Qe(n),1===t)0===e.tag?function(e){Ui=!0,Hi(e)}(cl.bind(null,e)):Hi(cl.bind(null,e)),si((function(){0===(6&Rc)&&zi()})),n=null;else{switch(bt(r)){case 1:n=$e;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Cl(n,il.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function il(e,t){if(Xc=-1,$c=0,0!==(6&Rc))throw Error(o(327));var n=e.callbackNode;if(kl()&&e.callbackNode!==n)return null;var r=ht(e,e===Cc?Pc:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=ml(e,r);else{t=r;var i=Rc;Rc|=2;var s=pl();for(Cc===e&&Pc===t||(Vc=null,zc=Je()+500,hl(e,t));;)try{yl();break}catch(c){fl(e,c)}Io(),xc.current=s,Rc=i,null!==Tc?t=0:(Cc=null,Pc=0,t=Dc)}if(0!==t){if(2===t&&(0!==(i=pt(e))&&(r=i,t=ol(e,i))),1===t)throw n=Oc,hl(e,0),al(e,r),rl(e,Je()),n;if(6===t)al(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!ar(o(),i))return!1}catch(a){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=ml(e,r))&&(0!==(s=pt(e))&&(r=s,t=ol(e,s))),1===t))throw n=Oc,hl(e,0),al(e,r),rl(e,Je()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(o(345));case 2:case 5:El(e,jc,Vc);break;case 3:if(al(e,r),(130023424&r)===r&&10<(t=Hc+500-Je())){if(0!==ht(e,0))break;if(((i=e.suspendedLanes)&r)!==r){el(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ri(El.bind(null,e,jc,Vc),t);break}El(e,jc,Vc);break;case 4:if(al(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var a=31-st(r);s=1<<a,(a=t[a])>i&&(i=a),r&=~s}if(r=i,10<(r=(120>(r=Je()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Sc(r/1960))-r)){e.timeoutHandle=ri(El.bind(null,e,jc,Vc),r);break}El(e,jc,Vc);break;default:throw Error(o(329))}}}return rl(e,Je()),e.callbackNode===n?il.bind(null,e):null}function ol(e,t){var n=Uc;return e.current.memoizedState.isDehydrated&&(hl(e,t).flags|=256),2!==(e=ml(e,t))&&(t=jc,jc=n,null!==t&&sl(t)),e}function sl(e){null===jc?jc=e:jc.push.apply(jc,e)}function al(e,t){for(t&=~Fc,t&=~Mc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-st(t),r=1<<n;e[n]=-1,t&=~r}}function cl(e){if(0!==(6&Rc))throw Error(o(327));kl();var t=ht(e,0);if(0===(1&t))return rl(e,Je()),null;var n=ml(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=ol(e,r))}if(1===n)throw n=Oc,hl(e,0),al(e,t),rl(e,Je()),n;if(6===n)throw Error(o(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,El(e,jc,Vc),rl(e,Je()),null}function ll(e,t){var n=Rc;Rc|=1;try{return e(t)}finally{0===(Rc=n)&&(zc=Je()+500,Ui&&zi())}}function ul(e){null!==Qc&&0===Qc.tag&&0===(6&Rc)&&kl();var t=Rc;Rc|=1;var n=Ic.transition,r=wt;try{if(Ic.transition=null,wt=1,e)return e()}finally{wt=r,Ic.transition=n,0===(6&(Rc=t))&&zi()}}function dl(){Nc=Bc.current,xi(Bc)}function hl(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ii(n)),null!==Tc)for(n=Tc.return;null!==n;){var r=n;switch(to(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Bi();break;case 3:Jo(),xi(Ci),xi(Ri),rs();break;case 5:$o(r);break;case 4:Jo();break;case 13:case 19:xi(es);break;case 10:Ro(r.type._context);break;case 22:case 23:dl()}n=n.return}if(Cc=e,Tc=e=Bl(e.current,null),Pc=Nc=t,Dc=0,Oc=null,Fc=Mc=Lc=0,jc=Uc=null,null!==No){for(t=0;t<No.length;t++)if(null!==(r=(n=No[t]).interleaved)){n.interleaved=null;var i=r.next,o=n.pending;if(null!==o){var s=o.next;o.next=i,r.next=s}n.pending=r}No=null}return e}function fl(e,t){for(;;){var n=Tc;try{if(Io(),is.current=Xs,us){for(var r=as.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}us=!1}if(ss=0,ls=cs=as=null,ds=!1,hs=0,_c.current=null,null===n||null===n.return){Dc=1,Oc=t,Tc=null;break}e:{var s=e,a=n.return,c=n,l=t;if(t=Pc,c.flags|=32768,null!==l&&"object"===typeof l&&"function"===typeof l.then){var u=l,d=c,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=ma(a);if(null!==p){p.flags&=-257,va(p,a,c,0,t),1&p.mode&&ga(s,u,t),l=u;var g=(t=p).updateQueue;if(null===g){var m=new Set;m.add(l),t.updateQueue=m}else g.add(l);break e}if(0===(1&t)){ga(s,u,t),gl();break e}l=Error(o(426))}else if(io&&1&c.mode){var v=ma(a);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),va(v,a,c,0,t),go(la(l,c));break e}}s=l=la(l,c),4!==Dc&&(Dc=2),null===Uc?Uc=[s]:Uc.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t,zo(s,fa(0,l,t));break e;case 1:c=l;var y=s.type,w=s.stateNode;if(0===(128&s.flags)&&("function"===typeof y.getDerivedStateFromError||null!==w&&"function"===typeof w.componentDidCatch&&(null===Kc||!Kc.has(w)))){s.flags|=65536,t&=-t,s.lanes|=t,zo(s,pa(s,c,t));break e}}s=s.return}while(null!==s)}bl(n)}catch(b){t=b,Tc===n&&null!==n&&(Tc=n=n.return);continue}break}}function pl(){var e=xc.current;return xc.current=Xs,null===e?Xs:e}function gl(){0!==Dc&&3!==Dc&&2!==Dc||(Dc=4),null===Cc||0===(268435455&Lc)&&0===(268435455&Mc)||al(Cc,Pc)}function ml(e,t){var n=Rc;Rc|=2;var r=pl();for(Cc===e&&Pc===t||(Vc=null,hl(e,t));;)try{vl();break}catch(i){fl(e,i)}if(Io(),Rc=n,xc.current=r,null!==Tc)throw Error(o(261));return Cc=null,Pc=0,Dc}function vl(){for(;null!==Tc;)wl(Tc)}function yl(){for(;null!==Tc&&!Ye();)wl(Tc)}function wl(e){var t=Ac(e.alternate,e,Nc);e.memoizedProps=e.pendingProps,null===t?bl(e):Tc=t,_c.current=null}function bl(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Wa(n,t,Nc)))return void(Tc=n)}else{if(null!==(n=Qa(n,t)))return n.flags&=32767,void(Tc=n);if(null===e)return Dc=6,void(Tc=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Tc=t);Tc=t=e}while(null!==t);0===Dc&&(Dc=5)}function El(e,t,n){var r=wt,i=Ic.transition;try{Ic.transition=null,wt=1,function(e,t,n,r){do{kl()}while(null!==Qc);if(0!==(6&Rc))throw Error(o(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(o(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-st(n),o=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~o}}(e,s),e===Cc&&(Tc=Cc=null,Pc=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Wc||(Wc=!0,Cl(tt,(function(){return kl(),null}))),s=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||s){s=Ic.transition,Ic.transition=null;var a=wt;wt=1;var c=Rc;Rc|=4,_c.current=null,function(e,t){if(ei=qt,fr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch(E){n=null;break e}var a=0,c=-1,l=-1,u=0,d=0,h=e,f=null;t:for(;;){for(var p;h!==n||0!==i&&3!==h.nodeType||(c=a+i),h!==s||0!==r&&3!==h.nodeType||(l=a+r),3===h.nodeType&&(a+=h.nodeValue.length),null!==(p=h.firstChild);)f=h,h=p;for(;;){if(h===e)break t;if(f===n&&++u===i&&(c=a),f===s&&++d===r&&(l=a),null!==(p=h.nextSibling))break;f=(h=f).parentNode}h=p}n=-1===c||-1===l?null:{start:c,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(ti={focusedElem:e,selectionRange:n},qt=!1,Xa=t;null!==Xa;)if(e=(t=Xa).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Xa=e;else for(;null!==Xa;){t=Xa;try{var g=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==g){var m=g.memoizedProps,v=g.memoizedState,y=t.stateNode,w=y.getSnapshotBeforeUpdate(t.elementType===t.type?m:na(t.type,m),v);y.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var b=t.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(o(163))}}catch(E){Sl(t,t.return,E)}if(null!==(e=t.sibling)){e.return=t.return,Xa=e;break}Xa=t.return}g=tc,tc=!1}(e,n),mc(n,e),pr(ti),qt=!!ei,ti=ei=null,e.current=n,yc(n,e,i),Ze(),Rc=c,wt=a,Ic.transition=s}else e.current=n;if(Wc&&(Wc=!1,Qc=e,Yc=i),s=e.pendingLanes,0===s&&(Kc=null),function(e){if(ot&&"function"===typeof ot.onCommitFiberRoot)try{ot.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rl(e,Je()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(qc)throw qc=!1,e=Gc,Gc=null,e;0!==(1&Yc)&&0!==e.tag&&kl(),s=e.pendingLanes,0!==(1&s)?e===Jc?Zc++:(Zc=0,Jc=e):Zc=0,zi()}(e,t,n,r)}finally{Ic.transition=i,wt=r}return null}function kl(){if(null!==Qc){var e=bt(Yc),t=Ic.transition,n=wt;try{if(Ic.transition=null,wt=16>e?16:e,null===Qc)var r=!1;else{if(e=Qc,Qc=null,Yc=0,0!==(6&Rc))throw Error(o(331));var i=Rc;for(Rc|=4,Xa=e.current;null!==Xa;){var s=Xa,a=s.child;if(0!==(16&Xa.flags)){var c=s.deletions;if(null!==c){for(var l=0;l<c.length;l++){var u=c[l];for(Xa=u;null!==Xa;){var d=Xa;switch(d.tag){case 0:case 11:case 15:nc(8,d,s)}var h=d.child;if(null!==h)h.return=d,Xa=h;else for(;null!==Xa;){var f=(d=Xa).sibling,p=d.return;if(oc(d),d===u){Xa=null;break}if(null!==f){f.return=p,Xa=f;break}Xa=p}}}var g=s.alternate;if(null!==g){var m=g.child;if(null!==m){g.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(null!==m)}}Xa=s}}if(0!==(2064&s.subtreeFlags)&&null!==a)a.return=s,Xa=a;else e:for(;null!==Xa;){if(0!==(2048&(s=Xa).flags))switch(s.tag){case 0:case 11:case 15:nc(9,s,s.return)}var y=s.sibling;if(null!==y){y.return=s.return,Xa=y;break e}Xa=s.return}}var w=e.current;for(Xa=w;null!==Xa;){var b=(a=Xa).child;if(0!==(2064&a.subtreeFlags)&&null!==b)b.return=a,Xa=b;else e:for(a=w;null!==Xa;){if(0!==(2048&(c=Xa).flags))try{switch(c.tag){case 0:case 11:case 15:rc(9,c)}}catch(k){Sl(c,c.return,k)}if(c===a){Xa=null;break e}var E=c.sibling;if(null!==E){E.return=c.return,Xa=E;break e}Xa=c.return}}if(Rc=i,zi(),ot&&"function"===typeof ot.onPostCommitFiberRoot)try{ot.onPostCommitFiberRoot(it,e)}catch(k){}r=!0}return r}finally{wt=n,Ic.transition=t}}return!1}function Al(e,t,n){e=jo(e,t=fa(0,t=la(n,t),1),1),t=el(),null!==e&&(vt(e,1,t),rl(e,t))}function Sl(e,t,n){if(3===e.tag)Al(e,e,n);else for(;null!==t;){if(3===t.tag){Al(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Kc||!Kc.has(r))){t=jo(t,e=pa(t,e=la(n,e),1),1),e=el(),null!==t&&(vt(t,1,e),rl(t,e));break}}t=t.return}}function xl(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=el(),e.pingedLanes|=e.suspendedLanes&n,Cc===e&&(Pc&n)===n&&(4===Dc||3===Dc&&(130023424&Pc)===Pc&&500>Je()-Hc?hl(e,0):Fc|=n),rl(e,t)}function _l(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=el();null!==(e=Oo(e,t))&&(vt(e,t,n),rl(e,n))}function Il(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),_l(e,n)}function Rl(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(o(314))}null!==r&&r.delete(t),_l(e,n)}function Cl(e,t){return We(e,t)}function Tl(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pl(e,t,n,r){return new Tl(e,t,n,r)}function Nl(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Bl(e,t){var n=e.alternate;return null===n?((n=Pl(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Dl(e,t,n,r,i,s){var a=2;if(r=e,"function"===typeof e)Nl(e)&&(a=1);else if("string"===typeof e)a=5;else e:switch(e){case A:return Ol(n.children,i,s,t);case S:a=8,i|=8;break;case x:return(e=Pl(12,n,t,2|i)).elementType=x,e.lanes=s,e;case C:return(e=Pl(13,n,t,i)).elementType=C,e.lanes=s,e;case T:return(e=Pl(19,n,t,i)).elementType=T,e.lanes=s,e;case B:return Ll(n,i,s,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case _:a=10;break e;case I:a=9;break e;case R:a=11;break e;case P:a=14;break e;case N:a=16,r=null;break e}throw Error(o(130,null==e?e:typeof e,""))}return(t=Pl(a,n,t,i)).elementType=e,t.type=r,t.lanes=s,t}function Ol(e,t,n,r){return(e=Pl(7,e,r,t)).lanes=n,e}function Ll(e,t,n,r){return(e=Pl(22,e,r,t)).elementType=B,e.lanes=n,e.stateNode={isHidden:!1},e}function Ml(e,t,n){return(e=Pl(6,e,null,t)).lanes=n,e}function Fl(e,t,n){return(t=Pl(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Ul(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mt(0),this.expirationTimes=mt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function jl(e,t,n,r,i,o,s,a,c){return e=new Ul(e,t,n,a,c),1===t?(t=1,!0===o&&(t|=8)):t=0,o=Pl(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Mo(o),e}function Hl(e){if(!e)return Ii;e:{if(ze(e=e._reactInternals)!==e||1!==e.tag)throw Error(o(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ni(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(o(171))}if(1===e.tag){var n=e.type;if(Ni(n))return Oi(e,n,t)}return t}function zl(e,t,n,r,i,o,s,a,c){return(e=jl(n,r,!0,e,0,o,0,a,c)).context=Hl(null),n=e.current,(o=Uo(r=el(),i=tl(n))).callback=void 0!==t&&null!==t?t:null,jo(n,o,i),e.current.lanes=i,vt(e,i,r),rl(e,r),e}function Vl(e,t,n,r){var i=t.current,o=el(),s=tl(i);return n=Hl(n),null===t.context?t.context=n:t.pendingContext=n,(t=Uo(o,s)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=jo(i,t,s))&&(nl(e,i,s,o),Ho(e,i,s)),s}function ql(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Gl(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Kl(e,t){Gl(e,t),(e=e.alternate)&&Gl(e,t)}Ac=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ci.current)wa=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return wa=!1,function(e,t,n){switch(t.tag){case 3:Ca(t),po();break;case 5:Xo(t);break;case 1:Ni(t.type)&&Li(t);break;case 4:Zo(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;_i(Ao,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(_i(es,1&es.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Ma(e,t,n):(_i(es,1&es.current),null!==(e=qa(e,t,n))?e.sibling:null);_i(es,1&es.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return za(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),_i(es,es.current),r)break;return null;case 22:case 23:return t.lanes=0,Sa(e,t,n)}return qa(e,t,n)}(e,t,n);wa=0!==(131072&e.flags)}else wa=!1,io&&0!==(1048576&t.flags)&&$i(t,Ki,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Va(e,t),e=t.pendingProps;var i=Pi(t,Ri.current);To(t,n),i=ms(null,t,r,e,i,n);var s=vs();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ni(r)?(s=!0,Li(t)):s=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Mo(t),i.updater=ia,t.stateNode=i,i._reactInternals=t,ca(t,r,e,n),t=Ra(null,t,r,!0,s,n)):(t.tag=0,io&&s&&eo(t),ba(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Va(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return Nl(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===R)return 11;if(e===P)return 14}return 2}(r),e=na(r,e),i){case 0:t=_a(null,t,r,e,n);break e;case 1:t=Ia(null,t,r,e,n);break e;case 11:t=Ea(null,t,r,e,n);break e;case 14:t=ka(null,t,r,na(r.type,e),n);break e}throw Error(o(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,_a(e,t,r,i=t.elementType===r?i:na(r,i),n);case 1:return r=t.type,i=t.pendingProps,Ia(e,t,r,i=t.elementType===r?i:na(r,i),n);case 3:e:{if(Ca(t),null===e)throw Error(o(387));r=t.pendingProps,i=(s=t.memoizedState).element,Fo(e,t),Vo(t,r,null,n);var a=t.memoizedState;if(r=a.element,s.isDehydrated){if(s={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Ta(e,t,r,n,i=la(Error(o(423)),t));break e}if(r!==i){t=Ta(e,t,r,n,i=la(Error(o(424)),t));break e}for(ro=li(t.stateNode.containerInfo.firstChild),no=t,io=!0,oo=null,n=ko(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(po(),r===i){t=qa(e,t,n);break e}ba(e,t,r,n)}t=t.child}return t;case 5:return Xo(t),null===e&&lo(t),r=t.type,i=t.pendingProps,s=null!==e?e.memoizedProps:null,a=i.children,ni(r,i)?a=null:null!==s&&ni(r,s)&&(t.flags|=32),xa(e,t),ba(e,t,a,n),t.child;case 6:return null===e&&lo(t),null;case 13:return Ma(e,t,n);case 4:return Zo(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Eo(t,null,r,n):ba(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,Ea(e,t,r,i=t.elementType===r?i:na(r,i),n);case 7:return ba(e,t,t.pendingProps,n),t.child;case 8:case 12:return ba(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,s=t.memoizedProps,a=i.value,_i(Ao,r._currentValue),r._currentValue=a,null!==s)if(ar(s.value,a)){if(s.children===i.children&&!Ci.current){t=qa(e,t,n);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var c=s.dependencies;if(null!==c){a=s.child;for(var l=c.firstContext;null!==l;){if(l.context===r){if(1===s.tag){(l=Uo(-1,n&-n)).tag=2;var u=s.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),Co(s.return,n,t),c.lanes|=n;break}l=l.next}}else if(10===s.tag)a=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(a=s.return))throw Error(o(341));a.lanes|=n,null!==(c=a.alternate)&&(c.lanes|=n),Co(a,n,t),a=s.sibling}else a=s.child;if(null!==a)a.return=s;else for(a=s;null!==a;){if(a===t){a=null;break}if(null!==(s=a.sibling)){s.return=a.return,a=s;break}a=a.return}s=a}ba(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,To(t,n),r=r(i=Po(i)),t.flags|=1,ba(e,t,r,n),t.child;case 14:return i=na(r=t.type,t.pendingProps),ka(e,t,r,i=na(r.type,i),n);case 15:return Aa(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:na(r,i),Va(e,t),t.tag=1,Ni(r)?(e=!0,Li(t)):e=!1,To(t,n),sa(t,r,i),ca(t,r,i,n),Ra(null,t,r,!0,e,n);case 19:return za(e,t,n);case 22:return Sa(e,t,n)}throw Error(o(156,t.tag))};var Wl="function"===typeof reportError?reportError:function(e){console.error(e)};function Ql(e){this._internalRoot=e}function Yl(e){this._internalRoot=e}function Zl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Xl(){}function $l(e,t,n,r,i){var o=n._reactRootContainer;if(o){var s=o;if("function"===typeof i){var a=i;i=function(){var e=ql(s);a.call(e)}}Vl(t,s,e,i)}else s=function(e,t,n,r,i){if(i){if("function"===typeof r){var o=r;r=function(){var e=ql(s);o.call(e)}}var s=zl(t,r,e,0,null,!1,0,"",Xl);return e._reactRootContainer=s,e[pi]=s.current,zr(8===e.nodeType?e.parentNode:e),ul(),s}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var a=r;r=function(){var e=ql(c);a.call(e)}}var c=jl(e,0,!1,null,0,!1,0,"",Xl);return e._reactRootContainer=c,e[pi]=c.current,zr(8===e.nodeType?e.parentNode:e),ul((function(){Vl(t,c,n,r)})),c}(n,t,e,i,r);return ql(s)}Yl.prototype.render=Ql.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(o(409));Vl(e,t,null,null)},Yl.prototype.unmount=Ql.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;ul((function(){Vl(null,e,null,null)})),t[pi]=null}},Yl.prototype.unstable_scheduleHydration=function(e){if(e){var t=St();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Bt.length&&0!==t&&t<Bt[n].priority;n++);Bt.splice(n,0,e),0===n&&Mt(e)}},Et=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(yt(t,1|n),rl(t,Je()),0===(6&Rc)&&(zc=Je()+500,zi()))}break;case 13:ul((function(){var t=Oo(e,1);if(null!==t){var n=el();nl(t,e,1,n)}})),Kl(e,1)}},kt=function(e){if(13===e.tag){var t=Oo(e,134217728);if(null!==t)nl(t,e,134217728,el());Kl(e,134217728)}},At=function(e){if(13===e.tag){var t=tl(e),n=Oo(e,t);if(null!==n)nl(n,e,t,el());Kl(e,t)}},St=function(){return wt},xt=function(e,t){var n=wt;try{return wt=e,t()}finally{wt=n}},ke=function(e,t,n){switch(t){case"input":if(X(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=Ei(r);if(!i)throw Error(o(90));W(r),X(r,i)}}}break;case"textarea":oe(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Re=ll,Ce=ul;var eu={usingClientEntryPoint:!1,Events:[wi,bi,Ei,_e,Ie,ll]},tu={findFiberByHostInstance:yi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ge(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ru.isDisabled&&ru.supportsFiber)try{it=ru.inject(nu),ot=ru}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Zl(t))throw Error(o(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:k,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Zl(e))throw Error(o(299));var n=!1,r="",i=Wl;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=jl(e,1,!1,null,0,n,0,r,i),e[pi]=t.current,zr(8===e.nodeType?e.parentNode:e),new Ql(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(o(188));throw e=Object.keys(e).join(","),Error(o(268,e))}return e=null===(e=Ge(t))?null:e.stateNode},t.flushSync=function(e){return ul(e)},t.hydrate=function(e,t,n){if(!Jl(t))throw Error(o(200));return $l(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Zl(e))throw Error(o(405));var r=null!=n&&n.hydratedSources||null,i=!1,s="",a=Wl;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(s=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),t=zl(t,null,e,1,null!=n?n:null,i,0,s,a),e[pi]=t.current,zr(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Yl(t)},t.render=function(e,t,n){if(!Jl(t))throw Error(o(200));return $l(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Jl(e))throw Error(o(40));return!!e._reactRootContainer&&(ul((function(){$l(null,null,e,!1,(function(){e._reactRootContainer=null,e[pi]=null}))})),!0)},t.unstable_batchedUpdates=ll,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Jl(n))throw Error(o(200));if(null==e||void 0===e._reactInternals)throw Error(o(38));return $l(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},4391:(e,t,n)=>{"use strict";var r=n(7950);t.H=r.createRoot,r.hydrateRoot},7950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(2730)},1153:(e,t,n)=>{"use strict";var r=n(5043),i=Symbol.for("react.element"),o=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,n){var r,o={},l=null,u=null;for(r in void 0!==n&&(l=""+n),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(u=t.ref),t)s.call(t,r)&&!c.hasOwnProperty(r)&&(o[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===o[r]&&(o[r]=t[r]);return{$$typeof:i,type:e,key:l,ref:u,props:o,_owner:a.current}}t.Fragment=o,t.jsx=l,t.jsxs=l},4202:(e,t)=>{"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),c=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,m={};function v(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}function y(){}function w(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var b=w.prototype=new y;b.constructor=w,g(b,v.prototype),b.isPureReactComponent=!0;var E=Array.isArray,k=Object.prototype.hasOwnProperty,A={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function x(e,t,r){var i,o={},s=null,a=null;if(null!=t)for(i in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(s=""+t.key),t)k.call(t,i)&&!S.hasOwnProperty(i)&&(o[i]=t[i]);var c=arguments.length-2;if(1===c)o.children=r;else if(1<c){for(var l=Array(c),u=0;u<c;u++)l[u]=arguments[u+2];o.children=l}if(e&&e.defaultProps)for(i in c=e.defaultProps)void 0===o[i]&&(o[i]=c[i]);return{$$typeof:n,type:e,key:s,ref:a,props:o,_owner:A.current}}function _(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var I=/\/+/g;function R(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function C(e,t,i,o,s){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var c=!1;if(null===e)c=!0;else switch(a){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case n:case r:c=!0}}if(c)return s=s(c=e),e=""===o?"."+R(c,0):o,E(s)?(i="",null!=e&&(i=e.replace(I,"$&/")+"/"),C(s,t,i,"",(function(e){return e}))):null!=s&&(_(s)&&(s=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,i+(!s.key||c&&c.key===s.key?"":(""+s.key).replace(I,"$&/")+"/")+e)),t.push(s)),1;if(c=0,o=""===o?".":o+":",E(e))for(var l=0;l<e.length;l++){var u=o+R(a=e[l],l);c+=C(a,t,i,u,s)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),l=0;!(a=e.next()).done;)c+=C(a=a.value,t,i,u=o+R(a,l++),s);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return c}function T(e,t,n){if(null==e)return e;var r=[],i=0;return C(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function P(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var N={current:null},B={transition:null},D={ReactCurrentDispatcher:N,ReactCurrentBatchConfig:B,ReactCurrentOwner:A};function O(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:T,forEach:function(e,t,n){T(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return T(e,(function(){t++})),t},toArray:function(e){return T(e,(function(e){return e}))||[]},only:function(e){if(!_(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=i,t.Profiler=s,t.PureComponent=w,t.StrictMode=o,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=D,t.act=O,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=g({},e.props),o=e.key,s=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,a=A.current),void 0!==t.key&&(o=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(l in t)k.call(t,l)&&!S.hasOwnProperty(l)&&(i[l]=void 0===t[l]&&void 0!==c?c[l]:t[l])}var l=arguments.length-2;if(1===l)i.children=r;else if(1<l){c=Array(l);for(var u=0;u<l;u++)c[u]=arguments[u+2];i.children=c}return{$$typeof:n,type:e.type,key:o,ref:s,props:i,_owner:a}},t.createContext=function(e){return(e={$$typeof:c,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=x,t.createFactory=function(e){var t=x.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:l,render:e}},t.isValidElement=_,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:P}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=B.transition;B.transition={};try{e()}finally{B.transition=t}},t.unstable_act=O,t.useCallback=function(e,t){return N.current.useCallback(e,t)},t.useContext=function(e){return N.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return N.current.useDeferredValue(e)},t.useEffect=function(e,t){return N.current.useEffect(e,t)},t.useId=function(){return N.current.useId()},t.useImperativeHandle=function(e,t,n){return N.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return N.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return N.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return N.current.useMemo(e,t)},t.useReducer=function(e,t,n){return N.current.useReducer(e,t,n)},t.useRef=function(e){return N.current.useRef(e)},t.useState=function(e){return N.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return N.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return N.current.useTransition()},t.version="18.3.1"},5043:(e,t,n)=>{"use strict";e.exports=n(4202)},579:(e,t,n)=>{"use strict";e.exports=n(1153)},1287:(e,t,n)=>{"use strict";var r=n(3688),i=/[\/\?<>\\:\*\|"]/g,o=/[\x00-\x1f\x80-\x9f]/g,s=/^\.+$/,a=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,c=/[\. ]+$/;function l(e,t){if("string"!==typeof e)throw new Error("Input must be string");var n=e.replace(i,t).replace(o,t).replace(s,t).replace(a,t).replace(c,t);return r(n,255)}e.exports=function(e,t){var n=t&&t.replacement||"",r=l(e,n);return""===n?r:l(r,"")}},7234:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<o(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,s=i>>>1;r<s;){var a=2*(r+1)-1,c=e[a],l=a+1,u=e[l];if(0>o(c,n))l<i&&0>o(u,c)?(e[r]=u,e[l]=n,r=l):(e[r]=c,e[a]=n,r=a);else{if(!(l<i&&0>o(u,n)))break e;e[r]=u,e[l]=n,r=l}}}return t}function o(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,c=a.now();t.unstable_now=function(){return a.now()-c}}var l=[],u=[],d=1,h=null,f=3,p=!1,g=!1,m=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,w="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=r(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,n(l,t)}t=r(u)}}function E(e){if(m=!1,b(e),!g)if(null!==r(l))g=!0,B(k);else{var t=r(u);null!==t&&D(E,t.startTime-e)}}function k(e,n){g=!1,m&&(m=!1,y(_),_=-1),p=!0;var o=f;try{for(b(n),h=r(l);null!==h&&(!(h.expirationTime>n)||e&&!C());){var s=h.callback;if("function"===typeof s){h.callback=null,f=h.priorityLevel;var a=s(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof a?h.callback=a:h===r(l)&&i(l),b(n)}else i(l);h=r(l)}if(null!==h)var c=!0;else{var d=r(u);null!==d&&D(E,d.startTime-n),c=!1}return c}finally{h=null,f=o,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var A,S=!1,x=null,_=-1,I=5,R=-1;function C(){return!(t.unstable_now()-R<I)}function T(){if(null!==x){var e=t.unstable_now();R=e;var n=!0;try{n=x(!0,e)}finally{n?A():(S=!1,x=null)}}else S=!1}if("function"===typeof w)A=function(){w(T)};else if("undefined"!==typeof MessageChannel){var P=new MessageChannel,N=P.port2;P.port1.onmessage=T,A=function(){N.postMessage(null)}}else A=function(){v(T,0)};function B(e){x=e,S||(S=!0,A())}function D(e,n){_=v((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){g||p||(g=!0,B(k))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,i,o){var s=t.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?s+o:s:o=s,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:d++,callback:i,priorityLevel:e,startTime:o,expirationTime:a=o+a,sortIndex:-1},o>s?(e.sortIndex=o,n(u,e),null===r(l)&&e===r(u)&&(m?(y(_),_=-1):m=!0,D(E,o-s))):(e.sortIndex=a,n(l,e),g||p||(g=!0,B(k))),e},t.unstable_shouldYield=C,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},8853:(e,t,n)=>{"use strict";e.exports=n(7234)},4132:function(e,t,n){!function(e,t){"use strict";if(!e.setImmediate){var n,r=1,i={},o=!1,s=e.document,a=Object.getPrototypeOf&&Object.getPrototypeOf(e);a=a&&a.setTimeout?a:e,"[object process]"==={}.toString.call(e.process)?n=function(e){process.nextTick((function(){l(e)}))}:function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?function(){var t="setImmediate$"+Math.random()+"$",r=function(n){n.source===e&&"string"===typeof n.data&&0===n.data.indexOf(t)&&l(+n.data.slice(t.length))};e.addEventListener?e.addEventListener("message",r,!1):e.attachEvent("onmessage",r),n=function(n){e.postMessage(t+n,"*")}}():e.MessageChannel?function(){var e=new MessageChannel;e.port1.onmessage=function(e){l(e.data)},n=function(t){e.port2.postMessage(t)}}():s&&"onreadystatechange"in s.createElement("script")?function(){var e=s.documentElement;n=function(t){var n=s.createElement("script");n.onreadystatechange=function(){l(t),n.onreadystatechange=null,e.removeChild(n),n=null},e.appendChild(n)}}():n=function(e){setTimeout(l,0,e)},a.setImmediate=function(e){"function"!==typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),o=0;o<t.length;o++)t[o]=arguments[o+1];var s={callback:e,args:t};return i[r]=s,n(r),r++},a.clearImmediate=c}function c(e){delete i[e]}function l(e){if(o)setTimeout(l,0,e);else{var n=i[e];if(n){o=!0;try{!function(e){var n=e.callback,r=e.args;switch(r.length){case 0:n();break;case 1:n(r[0]);break;case 2:n(r[0],r[1]);break;case 3:n(r[0],r[1],r[2]);break;default:n.apply(t,r)}}(n)}finally{c(e),o=!1}}}}}("undefined"===typeof self?"undefined"===typeof n.g?this:n.g:self)},3836:e=>{"use strict";function t(e,t){return e+n(t)}function n(e){let t=e;return t-=t>>1&1431655765,t=(858993459&t)+(t>>2&858993459),16843009*(t+(t>>4)&252645135)>>24}function r(e,t){return e[0]-t[0]}function i(e){return e[1]}e.exports=class{constructor(){this._bitArrays=[],this._data=[],this._length=0,this._changedLength=!1,this._changedData=!1}set(e,t){let n=this._internalPositionFor(e,!1);if(void 0===t)-1!==n&&(this._unsetInternalPos(n),this._unsetBit(e),this._changedLength=!0,this._changedData=!0);else{let r=!1;-1===n?(n=this._data.length,this._setBit(e),this._changedData=!0):r=!0,this._setInternalPos(n,e,t,r),this._changedLength=!0}}unset(e){this.set(e,void 0)}get(e){this._sortData();const t=this._internalPositionFor(e,!0);if(-1!==t)return this._data[t][1]}push(e){return this.set(this.length,e),this.length}get length(){if(this._sortData(),this._changedLength){const e=this._data[this._data.length-1];this._length=e?e[0]+1:0,this._changedLength=!1}return this._length}forEach(e){let t=0;for(;t<this.length;)e(this.get(t),t,this),t++}map(e){let t=0,n=new Array(this.length);for(;t<this.length;)n[t]=e(this.get(t),t,this),t++;return n}reduce(e,t){let n=0,r=t;for(;n<this.length;){r=e(r,this.get(n),n),n++}return r}find(e){let t,n,r=0;for(;r<this.length&&!t;)n=this.get(r),t=e(n),r++;return t?n:void 0}_internalPositionFor(e,r){const i=this._bytePosFor(e,r);if(i>=this._bitArrays.length)return-1;const o=this._bitArrays[i],s=e-7*i;if(!((o&1<<s)>0))return-1;return this._bitArrays.slice(0,i).reduce(t,0)+n(o&~(4294967295<<s+1))-1}_bytePosFor(e,t){const n=Math.floor(e/7),r=n+1;for(;!t&&this._bitArrays.length<r;)this._bitArrays.push(0);return n}_setBit(e){const t=this._bytePosFor(e,!1);this._bitArrays[t]|=1<<e-7*t}_unsetBit(e){const t=this._bytePosFor(e,!1);this._bitArrays[t]&=~(1<<e-7*t)}_setInternalPos(e,t,n,r){const i=this._data,o=[t,n];if(r)this._sortData(),i[e]=o;else{if(i.length)if(i[i.length-1][0]>=t)i.push(o);else if(i[0][0]<=t)i.unshift(o);else{const e=Math.round(i.length/2);this._data=i.slice(0,e).concat(o).concat(i.slice(e))}else this._data.push(o);this._changedData=!0,this._changedLength=!0}}_unsetInternalPos(e){this._data.splice(e,1)}_sortData(){this._changedData&&this._data.sort(r),this._changedData=!1}bitField(){const e=[];let t,n=8,r=0,i=0;const o=this._bitArrays.slice();for(;o.length||r;){0===r&&(t=o.shift(),r=7);const s=Math.min(r,n);i|=(t&~(255<<s))<<8-n,t>>>=s,r-=s,n-=s,n&&(r||o.length)||(e.push(i),i=0,n=8)}for(var s=e.length-1;s>0;s--){if(0!==e[s])break;e.pop()}return e}compactArray(){return this._sortData(),this._data.map(i)}}},3688:(e,t,n)=>{"use strict";var r=n(3748),i=n(6651);e.exports=r.bind(null,i)},3748:e=>{"use strict";function t(e){return e>=55296&&e<=56319}function n(e){return e>=56320&&e<=57343}e.exports=function(e,r,i){if("string"!==typeof r)throw new Error("Input must be string");for(var o,s,a=r.length,c=0,l=0;l<a;l+=1){if(o=r.charCodeAt(l),s=r[l],t(o)&&n(r.charCodeAt(l+1))&&(s+=r[l+=1]),(c+=e(s))===i)return r.slice(0,l+1);if(c>i)return r.slice(0,l-s.length+1)}return r}},6651:e=>{"use strict";function t(e){return e>=55296&&e<=56319}function n(e){return e>=56320&&e<=57343}e.exports=function(e){if("string"!==typeof e)throw new Error("Input must be string");for(var r=e.length,i=0,o=null,s=null,a=0;a<r;a++)n(o=e.charCodeAt(a))?null!=s&&t(s)?i+=1:i+=3:o<=127?i+=1:o>=128&&o<=2047?i+=2:o>=2048&&o<=65535&&(i+=3),s=o;return i}},6440:e=>{"use strict";var t=function(){};e.exports=t},6926:e=>{"use strict";var t=Object.prototype.hasOwnProperty,n="~";function r(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function o(e,t,r,o,s){if("function"!==typeof r)throw new TypeError("The listener must be a function");var a=new i(r,o||e,s),c=n?n+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function s(e,t){0===--e._eventsCount?e._events=new r:delete e._events[t]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),a.prototype.eventNames=function(){var e,r,i=[];if(0===this._eventsCount)return i;for(r in e=this._events)t.call(e,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},a.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,o=r.length,s=new Array(o);i<o;i++)s[i]=r[i].fn;return s},a.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},a.prototype.emit=function(e,t,r,i,o,s){var a=n?n+e:e;if(!this._events[a])return!1;var c,l,u=this._events[a],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,r),!0;case 4:return u.fn.call(u.context,t,r,i),!0;case 5:return u.fn.call(u.context,t,r,i,o),!0;case 6:return u.fn.call(u.context,t,r,i,o,s),!0}for(l=1,c=new Array(d-1);l<d;l++)c[l-1]=arguments[l];u.fn.apply(u.context,c)}else{var h,f=u.length;for(l=0;l<f;l++)switch(u[l].once&&this.removeListener(e,u[l].fn,void 0,!0),d){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,t);break;case 3:u[l].fn.call(u[l].context,t,r);break;case 4:u[l].fn.call(u[l].context,t,r,i);break;default:if(!c)for(h=1,c=new Array(d-1);h<d;h++)c[h-1]=arguments[h];u[l].fn.apply(u[l].context,c)}}return!0},a.prototype.on=function(e,t,n){return o(this,e,t,n,!1)},a.prototype.once=function(e,t,n){return o(this,e,t,n,!0)},a.prototype.removeListener=function(e,t,r,i){var o=n?n+e:e;if(!this._events[o])return this;if(!t)return s(this,o),this;var a=this._events[o];if(a.fn)a.fn!==t||i&&!a.once||r&&a.context!==r||s(this,o);else{for(var c=0,l=[],u=a.length;c<u;c++)(a[c].fn!==t||i&&!a[c].once||r&&a[c].context!==r)&&l.push(a[c]);l.length?this._events[o]=1===l.length?l[0]:l:s(this,o)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&s(this,t)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a},8139:(e,t)=>{var n;!function(){"use strict";var r={}.hasOwnProperty;function i(){for(var e="",t=0;t<arguments.length;t++){var n=arguments[t];n&&(e=s(e,o(n)))}return e}function o(e){if("string"===typeof e||"number"===typeof e)return e;if("object"!==typeof e)return"";if(Array.isArray(e))return i.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var n in e)r.call(e,n)&&e[n]&&(t=s(t,n));return t}function s(e,t){return t?e?e+" "+t:e+t:e}e.exports?(i.default=i,e.exports=i):void 0===(n=function(){return i}.apply(t,[]))||(e.exports=n)}()},7353:e=>{!function(){e.exports=m;var t=86400,n=3200,r=146097*n/400,i=t*r,o=1e3*i,s=864e13,a=4294967296,c=1e6,l="000000000",u=Math.trunc||function(e){var t=e-e%1;return 0==t&&(e<0||0===e&&1/e!=1/0)?-0:t},d=m.prototype,h=(m.fromDate=function(e){return new m(+e)},m.fromInt64BE=E(0,1,2,3,0,4),m.fromInt64LE=E(3,2,1,0,4,0),m.fromString=function(e){var t,n=new m;e=(e+="").replace(/^\s*[+\-]?\d+/,(function(e){var t=1970+((e=+e)-1970)%400;return n.year=e-t,t})).replace(/(?:Z|([+\-]\d{2}):?(\d{2}))$/,(function(e,n,r){return n<0&&(r*=-1),t=6e4*(60*+n+ +r),""})).replace(/\.\d+$/,(function(e){return n.nano=+(e+l).substr(1,9),""})).split(/\D+/);if(1<e.length?e[1]--:e[1]=0,n.time=t=Date.UTC.apply(Date,e)-(t||0),isNaN(t))throw new TypeError("Invalid Date");return v(n)},m.fromTimeT=function(e){return w(e,0)},d.year=0,d.time=0,d.nano=0,d.addNano=function(e){return this.nano+=+e||0,this},d.getNano=function(){var e=v(this);return(e.time%1e3*c+ +e.nano+1e9)%1e9},d.getTimeT=function(){var e=v(this),i=Math.floor(e.time/1e3);return(e=e.year)&&(i+=e*r*t/n),i},d.getYear=function(){return this.toDate().getUTCFullYear()+this.year},d.toDate=function(){return y(v(this).time)},d.toJSON=function(){return this.toString().replace(/0{1,6}Z$/,"Z")},d.toString=function(e){var t=this,n=t.toDate(),r={H:function(){return A(n.getUTCHours())},L:function(){return S(n.getUTCMilliseconds(),3)},M:function(){return A(n.getUTCMinutes())},N:function(){return S(t.getNano(),9)},S:function(){return A(n.getUTCSeconds())},Y:function(){var e=t.getYear();return 999999<e?"+"+e:9999<e?"+"+S(e,6):0<=e?S(e,4):-999999<=e?"-"+S(-e,6):e},a:function(){return p[n.getUTCDay()]},b:function(){return f[n.getUTCMonth()]},d:function(){return A(n.getUTCDate())},e:function(){return function(e){return(9<e?"":" ")+(0|e)}(n.getUTCDate())},m:function(){return A(n.getUTCMonth()+1)}};return function e(t){return t.replace(/%./g,(function(t){var n=t[1],i=g[n];n=r[n];return i?e(i):n?n():t}))}(e||h)},d.writeInt64BE=b(0,1,2,3,0,4),d.writeInt64LE=b(3,2,1,0,4,0),"%Y-%m-%dT%H:%M:%S.%NZ"),f=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],p=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],g={"%":"%",F:"%Y-%m-%d",n:"\n",R:"%H:%M",T:"%H:%M:%S",t:"\t",X:"%T",Z:"GMT",z:"+0000"};return m;function m(e,t,n){var r=this;if(!(r instanceof m))return new m(e,t,n);r.time=+e||0,r.nano=+t||0,r.year=+n||0,v(r)}function v(e){var t,r,i,a=e.year,l=e.time,d=e.nano,h=((d<0||c<=d)&&(d-=(r=Math.floor(d/c))*c,l+=r,r=1),a%n);return(l<-s||s<l||h)&&((t=u(l/o))&&(a+=t*n,l-=t*o),(i=y(l)).setUTCFullYear(h+i.getUTCFullYear()),i=(l=+i)+(t=u((a-=h)/n))*o,t&&-s<=i&&i<=s&&(a-=t*n,l=i),r=1),r&&(e.year=a,e.time=l,e.nano=d),e}function y(e){var t=new Date(0);return t.setTime(e),t}function w(e,t){e=+e||0;var r=u((t=(0|t)*a)/i)+u(e/i);return(e=u((t=t%i+e%i)/i))&&(r+=e,t-=e*i),new m(1e3*t,0,r*n)}function b(e,i,o,s,c,l){return function(e,i){var o=v(this);k(e=e||new Array(8),i|=0);var s=Math.floor(o.time/1e3),h=(o=o.year*(r*t/n),u(o/a)+u(s/a));o=o%a+s%a;return(s=Math.floor(o/a))&&(h+=s,o-=s*a),d(e,i+c,h),d(e,i+l,o),e};function d(t,n,r){t[n+e]=r>>24&255,t[n+i]=r>>16&255,t[n+o]=r>>8&255,t[n+s]=255&r}}function E(e,t,n,r,i,o){return function(e,t){k(e,t|=0);var n=s(e,t+i);return w(s(e,t+o),n)};function s(i,o){return 16777216*i[o+e]+(i[o+t]<<16|i[o+n]<<8|i[o+r])}}function k(e,t){if(null==(e=e&&e.length))throw new TypeError("Invalid Buffer");if(e<t+8)throw new RangeError("Out of range")}function A(e){return(9<e?"":"0")+(0|e)}function S(e,t){return(l+(0|e)).substr(-t)}}()},6260:(e,t,n)=>{"use strict";n.d(t,{K:()=>i});var r=n(8320);function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?(0,r.o)(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}},17:(e,t,n)=>{"use strict";n.r(t),n.d(t,{concat:()=>o});var r=n(6260),i=n(8320);function o(e,t){t||(t=e.reduce(((e,t)=>e+t.length),0));const n=(0,r.K)(t);let o=0;for(const r of e)n.set(r,o),o+=r.length;return(0,i.o)(n)}},223:(e,t,n)=>{"use strict";n.r(t),n.d(t,{fromString:()=>o});var r=n(9673),i=n(8320);function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8";const n=r.A[t];if(!n)throw new Error('Unsupported encoding "'.concat(t,'"'));return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.decoder.decode("".concat(n.prefix).concat(e)):(0,i.o)(globalThis.Buffer.from(e,"utf-8"))}},6232:(e,t,n)=>{"use strict";n.r(t),n.d(t,{toString:()=>i});var r=n(9673);function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8";const n=r.A[t];if(!n)throw new Error('Unsupported encoding "'.concat(t,'"'));return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}},8320:(e,t,n)=>{"use strict";function r(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}n.d(t,{o:()=>r})},9673:(e,t,n)=>{"use strict";n.d(t,{A:()=>qe});var r={};n.r(r),n.d(r,{identity:()=>R});var i={};n.r(i),n.d(i,{base2:()=>C});var o={};n.r(o),n.d(o,{base8:()=>T});var s={};n.r(s),n.d(s,{base10:()=>P});var a={};n.r(a),n.d(a,{base16:()=>N,base16upper:()=>B});var c={};n.r(c),n.d(c,{base32:()=>D,base32hex:()=>F,base32hexpad:()=>j,base32hexpadupper:()=>H,base32hexupper:()=>U,base32pad:()=>L,base32padupper:()=>M,base32upper:()=>O,base32z:()=>z});var l={};n.r(l),n.d(l,{base36:()=>V,base36upper:()=>q});var u={};n.r(u),n.d(u,{base58btc:()=>G,base58flickr:()=>K});var d={};n.r(d),n.d(d,{base64:()=>W,base64pad:()=>Q,base64url:()=>Y,base64urlpad:()=>Z});var h={};n.r(h),n.d(h,{base256emoji:()=>ee});var f={};n.r(f),n.d(f,{sha256:()=>xe,sha512:()=>_e});var p={};n.r(p),n.d(p,{identity:()=>Re});var g={};n.r(g),n.d(g,{code:()=>Te,decode:()=>Ne,encode:()=>Pe,name:()=>Ce});var m={};n.r(m),n.d(m,{code:()=>Le,decode:()=>Fe,encode:()=>Me,name:()=>Oe});var v=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==n[s])throw new TypeError(o+" is ambiguous");n[s]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var r=0,i=0;e[t]===c;)r++,t++;for(var o=(e.length-t)*l+1>>>0,s=new Uint8Array(o);e[t];){var u=n[e.charCodeAt(t)];if(255===u)return;for(var d=0,h=o-1;(0!==u||d<i)&&-1!==h;h--,d++)u+=a*s[h]>>>0,s[h]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=d,t++}if(" "!==e[t]){for(var f=o-i;f!==o&&0===s[f];)f++;for(var p=new Uint8Array(r+(o-f)),g=r;f!==o;)p[g++]=s[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,o=t.length;i!==o&&0===t[i];)i++,n++;for(var s=(o-i)*u+1>>>0,l=new Uint8Array(s);i!==o;){for(var d=t[i],h=0,f=s-1;(0!==d||h<r)&&-1!==f;f--,h++)d+=256*l[f]>>>0,l[f]=d%a>>>0,d=d/a>>>0;if(0!==d)throw new Error("Non-zero carry");r=h,i++}for(var p=s-r;p!==s&&0===l[p];)p++;for(var g=c.repeat(n);p<s;++p)g+=e.charAt(l[p]);return g},decodeUnsafe:d,decode:function(e){var n=d(e);if(n)return n;throw new Error("Non-".concat(t," character"))}}};const y=v,w=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class b{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return"".concat(this.prefix).concat(this.baseEncode(e));throw Error("Unknown type, must be binary type")}}class E{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error("Unable to decode multibase string ".concat(JSON.stringify(e),", ").concat(this.name," decoder only supports inputs prefixed with ").concat(this.prefix));return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return A(this,e)}}class k{constructor(e){this.decoders=e}or(e){return A(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError("Unable to decode multibase string ".concat(JSON.stringify(e),", only inputs prefixed with ").concat(Object.keys(this.decoders)," are supported"))}}const A=(e,t)=>new k({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class S{constructor(e,t,n,r){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=r,this.encoder=new b(e,t,n),this.decoder=new E(e,t,r)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const x=e=>{let{name:t,prefix:n,encode:r,decode:i}=e;return new S(t,n,r,i)},_=e=>{let{prefix:t,name:n,alphabet:r}=e;const{encode:i,decode:o}=y(r,n);return x({prefix:t,name:n,encode:i,decode:e=>w(o(e))})},I=e=>{let{name:t,prefix:n,bitsPerChar:r,alphabet:i}=e;return x({prefix:n,name:t,encode:e=>((e,t,n)=>{const r="="===t[t.length-1],i=(1<<n)-1;let o="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>n;)s-=n,o+=t[i&a>>s];if(s&&(o+=t[i&a<<n-s]),r)for(;o.length*n&7;)o+="=";return o})(e,i,r),decode:e=>((e,t,n,r)=>{const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*n/8|0);let a=0,c=0,l=0;for(let u=0;u<o;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError("Non-".concat(r," character"));c=c<<n|t,a+=n,a>=8&&(a-=8,s[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s})(e,i,r,t)})},R=x({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),C=I({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),T=I({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),P=_({prefix:"9",name:"base10",alphabet:"0123456789"}),N=I({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),B=I({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),D=I({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),O=I({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),L=I({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),M=I({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),F=I({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),U=I({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),j=I({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),H=I({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),z=I({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),V=_({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),q=_({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),G=_({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),K=_({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),W=I({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Q=I({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Y=I({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Z=I({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),J=Array.from("\ud83d\ude80\ud83e\ude90\u2604\ud83d\udef0\ud83c\udf0c\ud83c\udf11\ud83c\udf12\ud83c\udf13\ud83c\udf14\ud83c\udf15\ud83c\udf16\ud83c\udf17\ud83c\udf18\ud83c\udf0d\ud83c\udf0f\ud83c\udf0e\ud83d\udc09\u2600\ud83d\udcbb\ud83d\udda5\ud83d\udcbe\ud83d\udcbf\ud83d\ude02\u2764\ud83d\ude0d\ud83e\udd23\ud83d\ude0a\ud83d\ude4f\ud83d\udc95\ud83d\ude2d\ud83d\ude18\ud83d\udc4d\ud83d\ude05\ud83d\udc4f\ud83d\ude01\ud83d\udd25\ud83e\udd70\ud83d\udc94\ud83d\udc96\ud83d\udc99\ud83d\ude22\ud83e\udd14\ud83d\ude06\ud83d\ude44\ud83d\udcaa\ud83d\ude09\u263a\ud83d\udc4c\ud83e\udd17\ud83d\udc9c\ud83d\ude14\ud83d\ude0e\ud83d\ude07\ud83c\udf39\ud83e\udd26\ud83c\udf89\ud83d\udc9e\u270c\u2728\ud83e\udd37\ud83d\ude31\ud83d\ude0c\ud83c\udf38\ud83d\ude4c\ud83d\ude0b\ud83d\udc97\ud83d\udc9a\ud83d\ude0f\ud83d\udc9b\ud83d\ude42\ud83d\udc93\ud83e\udd29\ud83d\ude04\ud83d\ude00\ud83d\udda4\ud83d\ude03\ud83d\udcaf\ud83d\ude48\ud83d\udc47\ud83c\udfb6\ud83d\ude12\ud83e\udd2d\u2763\ud83d\ude1c\ud83d\udc8b\ud83d\udc40\ud83d\ude2a\ud83d\ude11\ud83d\udca5\ud83d\ude4b\ud83d\ude1e\ud83d\ude29\ud83d\ude21\ud83e\udd2a\ud83d\udc4a\ud83e\udd73\ud83d\ude25\ud83e\udd24\ud83d\udc49\ud83d\udc83\ud83d\ude33\u270b\ud83d\ude1a\ud83d\ude1d\ud83d\ude34\ud83c\udf1f\ud83d\ude2c\ud83d\ude43\ud83c\udf40\ud83c\udf37\ud83d\ude3b\ud83d\ude13\u2b50\u2705\ud83e\udd7a\ud83c\udf08\ud83d\ude08\ud83e\udd18\ud83d\udca6\u2714\ud83d\ude23\ud83c\udfc3\ud83d\udc90\u2639\ud83c\udf8a\ud83d\udc98\ud83d\ude20\u261d\ud83d\ude15\ud83c\udf3a\ud83c\udf82\ud83c\udf3b\ud83d\ude10\ud83d\udd95\ud83d\udc9d\ud83d\ude4a\ud83d\ude39\ud83d\udde3\ud83d\udcab\ud83d\udc80\ud83d\udc51\ud83c\udfb5\ud83e\udd1e\ud83d\ude1b\ud83d\udd34\ud83d\ude24\ud83c\udf3c\ud83d\ude2b\u26bd\ud83e\udd19\u2615\ud83c\udfc6\ud83e\udd2b\ud83d\udc48\ud83d\ude2e\ud83d\ude46\ud83c\udf7b\ud83c\udf43\ud83d\udc36\ud83d\udc81\ud83d\ude32\ud83c\udf3f\ud83e\udde1\ud83c\udf81\u26a1\ud83c\udf1e\ud83c\udf88\u274c\u270a\ud83d\udc4b\ud83d\ude30\ud83e\udd28\ud83d\ude36\ud83e\udd1d\ud83d\udeb6\ud83d\udcb0\ud83c\udf53\ud83d\udca2\ud83e\udd1f\ud83d\ude41\ud83d\udea8\ud83d\udca8\ud83e\udd2c\u2708\ud83c\udf80\ud83c\udf7a\ud83e\udd13\ud83d\ude19\ud83d\udc9f\ud83c\udf31\ud83d\ude16\ud83d\udc76\ud83e\udd74\u25b6\u27a1\u2753\ud83d\udc8e\ud83d\udcb8\u2b07\ud83d\ude28\ud83c\udf1a\ud83e\udd8b\ud83d\ude37\ud83d\udd7a\u26a0\ud83d\ude45\ud83d\ude1f\ud83d\ude35\ud83d\udc4e\ud83e\udd32\ud83e\udd20\ud83e\udd27\ud83d\udccc\ud83d\udd35\ud83d\udc85\ud83e\uddd0\ud83d\udc3e\ud83c\udf52\ud83d\ude17\ud83e\udd11\ud83c\udf0a\ud83e\udd2f\ud83d\udc37\u260e\ud83d\udca7\ud83d\ude2f\ud83d\udc86\ud83d\udc46\ud83c\udfa4\ud83d\ude47\ud83c\udf51\u2744\ud83c\udf34\ud83d\udca3\ud83d\udc38\ud83d\udc8c\ud83d\udccd\ud83e\udd40\ud83e\udd22\ud83d\udc45\ud83d\udca1\ud83d\udca9\ud83d\udc50\ud83d\udcf8\ud83d\udc7b\ud83e\udd10\ud83e\udd2e\ud83c\udfbc\ud83e\udd75\ud83d\udea9\ud83c\udf4e\ud83c\udf4a\ud83d\udc7c\ud83d\udc8d\ud83d\udce3\ud83e\udd42"),X=J.reduce(((e,t,n)=>(e[n]=t,e)),[]),$=J.reduce(((e,t,n)=>(e[t.codePointAt(0)]=n,e)),[]);const ee=x({prefix:"\ud83d\ude80",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=X[t]),"")},decode:function(e){const t=[];for(const n of e){const e=$[n.codePointAt(0)];if(void 0===e)throw new Error("Non-base256emoji character: ".concat(n));t.push(e)}return new Uint8Array(t)}});var te=function e(t,n,r){n=n||[];var i=r=r||0;for(;t>=ie;)n[r++]=255&t|ne,t/=128;for(;t&re;)n[r++]=255&t|ne,t>>>=7;return n[r]=0|t,e.bytes=r-i+1,n},ne=128,re=-128,ie=Math.pow(2,31);var oe=function e(t,n){var r,i=0,o=0,s=n=n||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");r=t[s++],i+=o<28?(r&ae)<<o:(r&ae)*Math.pow(2,o),o+=7}while(r>=se);return e.bytes=s-n,i},se=128,ae=127;var ce=Math.pow(2,7),le=Math.pow(2,14),ue=Math.pow(2,21),de=Math.pow(2,28),he=Math.pow(2,35),fe=Math.pow(2,42),pe=Math.pow(2,49),ge=Math.pow(2,56),me=Math.pow(2,63);const ve={encode:te,decode:oe,encodingLength:function(e){return e<ce?1:e<le?2:e<ue?3:e<de?4:e<he?5:e<fe?6:e<pe?7:e<ge?8:e<me?9:10}},ye=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ve.encode(e,t,n),t},we=e=>ve.encodingLength(e),be=(e,t)=>{const n=t.byteLength,r=we(e),i=r+we(n),o=new Uint8Array(i+n);return ye(e,o,0),ye(n,o,r),o.set(t,i),new Ee(e,n,t,o)};class Ee{constructor(e,t,n,r){this.code=e,this.size=t,this.digest=n,this.bytes=r}}const ke=e=>{let{name:t,code:n,encode:r}=e;return new Ae(t,n,r)};class Ae{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?be(this.code,t):t.then((e=>be(this.code,e)))}throw Error("Unknown type, must be binary type")}}const Se=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),xe=ke({name:"sha2-256",code:18,encode:Se("SHA-256")}),_e=ke({name:"sha2-512",code:19,encode:Se("SHA-512")}),Ie=w,Re={code:0,name:"identity",encode:Ie,digest:e=>be(0,Ie(e))},Ce="raw",Te=85,Pe=e=>w(e),Ne=e=>w(e),Be=new TextEncoder,De=new TextDecoder,Oe="json",Le=512,Me=e=>Be.encode(JSON.stringify(e)),Fe=e=>JSON.parse(De.decode(e));Symbol.toStringTag,Symbol.for("nodejs.util.inspect.custom");Symbol.for("@ipld/js-cid/CID");const Ue={...r,...i,...o,...s,...a,...c,...l,...u,...d,...h};var je=n(6260);function He(e,t,n,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:r}}}const ze=He("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),Ve=He("ascii","a",(e=>{let t="a";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}),(e=>{e=e.substring(1);const t=(0,je.K)(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t})),qe={utf8:ze,"utf-8":ze,hex:Ue.base16,latin1:Ve,ascii:Ve,binary:Ve,...Ue}},5903:e=>{"use strict";e.exports=JSON.parse('{"HV":[{"type":"constructor","inputs":[{"name":"_name","type":"string","internalType":"string"},{"name":"_symbol","type":"string","internalType":"string"}],"stateMutability":"nonpayable"},{"type":"function","name":"approve","inputs":[{"name":"_approved","type":"address","internalType":"address"},{"name":"_tokenId","type":"uint256","internalType":"uint256"}],"outputs":[],"stateMutability":"payable"},{"type":"function","name":"balanceOf","inputs":[{"name":"_owner","type":"address","internalType":"address"}],"outputs":[{"name":"","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"create","inputs":[{"name":"_uri","type":"string","internalType":"string"},{"name":"_tokenId","type":"uint256","internalType":"uint256"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"founder","inputs":[],"outputs":[{"name":"","type":"address","internalType":"address"}],"stateMutability":"view"},{"type":"function","name":"getApproved","inputs":[{"name":"_tokenId","type":"uint256","internalType":"uint256"}],"outputs":[{"name":"","type":"address","internalType":"address"}],"stateMutability":"view"},{"type":"function","name":"isApprovedForAll","inputs":[{"name":"_owner","type":"address","internalType":"address"},{"name":"_operator","type":"address","internalType":"address"}],"outputs":[{"name":"","type":"bool","internalType":"bool"}],"stateMutability":"view"},{"type":"function","name":"name","inputs":[],"outputs":[{"name":"","type":"string","internalType":"string"}],"stateMutability":"view"},{"type":"function","name":"ownerOf","inputs":[{"name":"_tokenId","type":"uint256","internalType":"uint256"}],"outputs":[{"name":"","type":"address","internalType":"address"}],"stateMutability":"view"},{"type":"function","name":"safeTransferFrom","inputs":[{"name":"_from","type":"address","internalType":"address"},{"name":"_to","type":"address","internalType":"address"},{"name":"_tokenId","type":"uint256","internalType":"uint256"}],"outputs":[],"stateMutability":"payable"},{"type":"function","name":"safeTransferFrom","inputs":[{"name":"_from","type":"address","internalType":"address"},{"name":"_to","type":"address","internalType":"address"},{"name":"_tokenId","type":"uint256","internalType":"uint256"},{"name":"data","type":"bytes","internalType":"bytes"}],"outputs":[],"stateMutability":"payable"},{"type":"function","name":"setApprovalForAll","inputs":[{"name":"_operator","type":"address","internalType":"address"},{"name":"_approved","type":"bool","internalType":"bool"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"supportsInterface","inputs":[{"name":"interfaceID","type":"bytes4","internalType":"bytes4"}],"outputs":[{"name":"","type":"bool","internalType":"bool"}],"stateMutability":"view"},{"type":"function","name":"symbol","inputs":[],"outputs":[{"name":"","type":"string","internalType":"string"}],"stateMutability":"view"},{"type":"function","name":"tokenByIndex","inputs":[{"name":"_index","type":"uint256","internalType":"uint256"}],"outputs":[{"name":"","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"tokenOfOwnerByIndex","inputs":[{"name":"_owner","type":"address","internalType":"address"},{"name":"_index","type":"uint256","internalType":"uint256"}],"outputs":[{"name":"","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"tokenURI","inputs":[{"name":"_tokenId","type":"uint256","internalType":"uint256"}],"outputs":[{"name":"","type":"string","internalType":"string"}],"stateMutability":"view"},{"type":"function","name":"totalSupply","inputs":[],"outputs":[{"name":"","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"transferFrom","inputs":[{"name":"_from","type":"address","internalType":"address"},{"name":"_to","type":"address","internalType":"address"},{"name":"_tokenId","type":"uint256","internalType":"uint256"}],"outputs":[],"stateMutability":"payable"},{"type":"event","name":"Approval","inputs":[{"name":"_owner","type":"address","indexed":true,"internalType":"address"},{"name":"_approved","type":"address","indexed":true,"internalType":"address"},{"name":"_tokenId","type":"uint256","indexed":true,"internalType":"uint256"}],"anonymous":false},{"type":"event","name":"ApprovalForAll","inputs":[{"name":"_owner","type":"address","indexed":true,"internalType":"address"},{"name":"_operator","type":"address","indexed":true,"internalType":"address"},{"name":"_approved","type":"bool","indexed":false,"internalType":"bool"}],"anonymous":false},{"type":"event","name":"Transfer","inputs":[{"name":"_from","type":"address","indexed":true,"internalType":"address"},{"name":"_to","type":"address","indexed":true,"internalType":"address"},{"name":"_tokenId","type":"uint256","indexed":true,"internalType":"uint256"}],"anonymous":false},{"type":"error","name":"ERC721IncorrectOwner","inputs":[{"name":"sender","type":"address","internalType":"address"},{"name":"tokenId","type":"uint256","internalType":"uint256"},{"name":"owner","type":"address","internalType":"address"}]},{"type":"error","name":"ERC721InvalidReceiver","inputs":[{"name":"receiver","type":"address","internalType":"address"}]},{"type":"error","name":"ERC721NonexistentToken","inputs":[{"name":"tokenId","type":"uint256","internalType":"uint256"}]}]}')}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";var e={};n.r(e),n.d(e,{base32:()=>ai,base32hex:()=>di,base32hexpad:()=>fi,base32hexpadupper:()=>pi,base32hexupper:()=>hi,base32pad:()=>li,base32padupper:()=>ui,base32upper:()=>ci,base32z:()=>gi});var t={};n.r(t),n.d(t,{base58btc:()=>mi,base58flickr:()=>vi});var r={};n.r(r),n.d(r,{code:()=>Eo,createLink:()=>wo,createNode:()=>yo,decode:()=>Ao,encode:()=>ko,name:()=>bo,prepare:()=>mo,validate:()=>vo});var i={};n.r(i),n.d(i,{base10:()=>es});var o={};n.r(o),n.d(o,{base16:()=>ts,base16upper:()=>ns});var s={};n.r(s),n.d(s,{base2:()=>rs});var a={};n.r(a),n.d(a,{base256emoji:()=>as});var c={};n.r(c),n.d(c,{base36:()=>cs,base36upper:()=>ls});var l={};n.r(l),n.d(l,{base64:()=>us,base64pad:()=>ds,base64url:()=>hs,base64urlpad:()=>fs});var u={};n.r(u),n.d(u,{base8:()=>ps});var d={};n.r(d),n.d(d,{identity:()=>gs});var h={};n.r(h),n.d(h,{code:()=>ws,decode:()=>Es,encode:()=>bs,name:()=>ys});var f={};n.r(f),n.d(f,{code:()=>As,decode:()=>xs,encode:()=>Ss,name:()=>ks});var p={};n.r(p),n.d(p,{identity:()=>Is});var g={};n.r(g),n.d(g,{sha256:()=>Ps,sha512:()=>Ns});var m={};n.r(m),n.d(m,{abortedError:()=>_v,closeFailedError:()=>bv,deleteFailedError:()=>Av,getFailedError:()=>kv,hasFailedError:()=>Sv,notFoundError:()=>xv,openFailedError:()=>wv,putFailedError:()=>Ev});var v={};n.r(v),n.d(v,{DO:()=>_w,OG:()=>Uw,My:()=>Rw,bytesToNumberBE:()=>Bw,lX:()=>Dw,Id:()=>Fw,fg:()=>zw,qj:()=>Mw,hexToBytes:()=>Nw,aY:()=>xw,lq:()=>Ow,z:()=>Lw,Q5:()=>qw});var y={};n.r(y),n.d(y,{Ed25519PrivateKey:()=>Yb,Ed25519PublicKey:()=>Qb,generateKeyPair:()=>Xb,generateKeyPairFromSeed:()=>$b,unmarshalEd25519PrivateKey:()=>Zb,unmarshalEd25519PublicKey:()=>Jb});var w={};n.r(w),n.d(w,{MAX_RSA_KEY_SIZE:()=>yA,RsaPrivateKey:()=>bA,RsaPublicKey:()=>wA,fromJwk:()=>AA,generateKeyPair:()=>SA,unmarshalRsaPrivateKey:()=>EA,unmarshalRsaPublicKey:()=>kA});var b={};n.r(b),n.d(b,{Secp256k1PrivateKey:()=>qA,Secp256k1PublicKey:()=>VA,generateKeyPair:()=>WA,unmarshalSecp256k1PrivateKey:()=>GA,unmarshalSecp256k1PublicKey:()=>KA});var E={};n.r(E),n.d(E,{OG:()=>KI,My:()=>OI,bytesToNumberBE:()=>jI,lX:()=>HI,Id:()=>GI,fg:()=>YI,qj:()=>qI,hexToBytes:()=>UI,aY:()=>BI,lq:()=>zI,z:()=>VI,Q5:()=>JI});var k={};n.r(k),n.d(k,{abiSchemaToJsonSchema:()=>Fj,codePointToInt:()=>zj,ensureIfUint8Array:()=>Zj,ethAbiToJsonSchema:()=>Uj,fetchArrayElement:()=>jj,hexToNumber:()=>Vj,hexToUint8Array:()=>Yj,numberToHex:()=>qj,padLeft:()=>Gj,parseBaseType:()=>Lj,transformJsonDataToAbiFormat:()=>Hj,uint8ArrayToHexString:()=>Kj});var A={};n.r(A),n.d(A,{isBatchRequest:()=>mV,isBatchResponse:()=>dV,isResponseRpcError:()=>iV,isResponseWithError:()=>sV,isResponseWithNotification:()=>aV,isResponseWithResult:()=>oV,isSubscriptionResult:()=>cV,isValidResponse:()=>uV,setRequestIdStart:()=>fV,toBatchPayload:()=>gV,toPayload:()=>pV,validateResponse:()=>lV});var S={};n.r(S),n.d(S,{ChunkResponseParser:()=>bV,Eip1193Provider:()=>kV,EventEmitter:()=>cz,SocketProvider:()=>xV,Web3DeferredPromise:()=>wV,asciiToHex:()=>YH,bytesToHex:()=>OH,bytesToUint8Array:()=>BH,checkAddressCheckSum:()=>dz,compareBlockNumbers:()=>wz,convert:()=>Dz,convertScalarValue:()=>Bz,encodePacked:()=>qz,ethUnitMap:()=>NH,format:()=>Oz,fromAscii:()=>ZH,fromDecimal:()=>jH,fromTwosComplement:()=>Cz,fromUtf8:()=>VH,fromWei:()=>nz,getStorageSlotNumForLongString:()=>Wz,hexToAscii:()=>JH,hexToBytes:()=>LH,hexToNumber:()=>MH,hexToNumberString:()=>HH,hexToString:()=>QH,hexToUtf8:()=>GH,isAddress:()=>hz,isBatchRequest:()=>mV,isBatchResponse:()=>dV,isBloom:()=>fz,isContractAddressInBloom:()=>mz,isContractInitOptions:()=>bz,isDataFormat:()=>Pz,isHex:()=>uz,isHexStrict:()=>lz,isInBloom:()=>pz,isNullish:()=>Ez,isPromise:()=>Jz,isResponseRpcError:()=>iV,isResponseWithError:()=>sV,isResponseWithNotification:()=>aV,isResponseWithResult:()=>oV,isSubscriptionResult:()=>cV,isTopic:()=>vz,isTopicInBloom:()=>yz,isUint8Array:()=>CH,isUserEthereumAddressInBloom:()=>gz,isValidResponse:()=>uV,jsonRpc:()=>A,keccak256:()=>Uz,keccak256Wrapper:()=>Uz,leftPad:()=>Iz,mergeDeep:()=>Az,numberToHex:()=>UH,padLeft:()=>Sz,padRight:()=>xz,pollTillDefined:()=>eV,pollTillDefinedAndReturnIntervalId:()=>$z,processSolidityEncodePackedArgs:()=>Vz,randomBytes:()=>Qz,randomHex:()=>Yz,rejectIfConditionAtInterval:()=>nV,rejectIfTimeout:()=>tV,rightPad:()=>_z,setRequestIdStart:()=>fV,sha3:()=>Mz,sha3Raw:()=>Fz,soliditySha3:()=>Gz,soliditySha3Raw:()=>Kz,stringToHex:()=>qH,toAscii:()=>XH,toBatchPayload:()=>gV,toBigInt:()=>tz,toBool:()=>oz,toChecksumAddress:()=>iz,toDecimal:()=>FH,toHex:()=>$H,toNumber:()=>ez,toPayload:()=>pV,toTwosComplement:()=>Rz,toUtf8:()=>KH,toWei:()=>rz,uint8ArrayConcat:()=>TH,uint8ArrayEquals:()=>PH,utf8ToBytes:()=>WH,utf8ToHex:()=>zH,uuidV4:()=>rV,validateResponse:()=>lV,waitWithTimeout:()=>Xz});var x={};n.r(x),n.d(x,{secp256k1:()=>Iq});var _=n(5043),I=n(4391),R=n(8139),C=n.n(R);const T=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return null!=e?String(e):t||null},P=_.createContext(null);function N(){return N=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},N.apply(this,arguments)}function B(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}n(2740);function D(e){return"default"+e.charAt(0).toUpperCase()+e.substr(1)}function O(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}function L(e,t){return Object.keys(t).reduce((function(n,r){var i,o=n,s=o[D(r)],a=o[r],c=B(o,[D(r),r].map(O)),l=t[r],u=function(e,t,n){var r=(0,_.useRef)(void 0!==e),i=(0,_.useState)(t),o=i[0],s=i[1],a=void 0!==e,c=r.current;return r.current=a,!a&&c&&o!==t&&s(t),[a?e:o,(0,_.useCallback)((function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];n&&n.apply(void 0,[e].concat(r)),s(e)}),[n])]}(a,s,e[l]),d=u[0],h=u[1];return N({},c,((i={})[r]=d,i[l]=h,i))}),e)}function M(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);null!==e&&void 0!==e&&this.setState(e)}function F(e){this.setState(function(t){var n=this.constructor.getDerivedStateFromProps(e,t);return null!==n&&void 0!==n?n:null}.bind(this))}function U(e,t){try{var n=this.props,r=this.state;this.props=e,this.state=t,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(n,r)}finally{this.props=n,this.state=r}}M.__suppressDeprecationWarning=!0,F.__suppressDeprecationWarning=!0,U.__suppressDeprecationWarning=!0;var j=n(579);const H=["xxl","xl","lg","md","sm","xs"],z="xs",V=_.createContext({prefixes:{},breakpoints:H,minBreakpoint:z}),{Consumer:q,Provider:G}=V;function K(e,t){const{prefixes:n}=(0,_.useContext)(V);return e||n[t]||t}function W(){const{breakpoints:e}=(0,_.useContext)(V);return e}function Q(){const{minBreakpoint:e}=(0,_.useContext)(V);return e}const Y=_.forwardRef(((e,t)=>{let{bsPrefix:n,className:r,as:i,...o}=e;n=K(n,"navbar-brand");const s=i||(o.href?"a":"span");return(0,j.jsx)(s,{...o,ref:t,className:C()(r,n)})}));Y.displayName="NavbarBrand";const Z=Y;function J(e){return e&&e.ownerDocument||document}function X(e,t){return function(e){var t=J(e);return t&&t.defaultView||window}(e).getComputedStyle(e,t)}var $=/([A-Z])/g;var ee=/^ms-/;function te(e){return function(e){return e.replace($,"-$1").toLowerCase()}(e).replace(ee,"-ms-")}var ne=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;const re=function(e,t){var n="",r="";if("string"===typeof t)return e.style.getPropertyValue(te(t))||X(e).getPropertyValue(te(t));Object.keys(t).forEach((function(i){var o=t[i];o||0===o?!function(e){return!(!e||!ne.test(e))}(i)?n+=te(i)+": "+o+";":r+=i+"("+o+") ":e.style.removeProperty(te(i))})),r&&(n+="transform: "+r+";"),e.style.cssText+=";"+n};function ie(e,t){return ie=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ie(e,t)}var oe=n(7950);const se=!1,ae=_.createContext(null);var ce="unmounted",le="exited",ue="entering",de="entered",he="exiting",fe=function(e){var t,n;function r(t,n){var r;r=e.call(this,t,n)||this;var i,o=n&&!n.isMounting?t.enter:t.appear;return r.appearStatus=null,t.in?o?(i=le,r.appearStatus=ue):i=de:i=t.unmountOnExit||t.mountOnEnter?ce:le,r.state={status:i},r.nextCallback=null,r}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,ie(t,n),r.getDerivedStateFromProps=function(e,t){return e.in&&t.status===ce?{status:le}:null};var i=r.prototype;return i.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},i.componentDidUpdate=function(e){var t=null;if(e!==this.props){var n=this.state.status;this.props.in?n!==ue&&n!==de&&(t=ue):n!==ue&&n!==de||(t=he)}this.updateStatus(!1,t)},i.componentWillUnmount=function(){this.cancelNextCallback()},i.getTimeouts=function(){var e,t,n,r=this.props.timeout;return e=t=n=r,null!=r&&"number"!==typeof r&&(e=r.exit,t=r.enter,n=void 0!==r.appear?r.appear:t),{exit:e,enter:t,appear:n}},i.updateStatus=function(e,t){if(void 0===e&&(e=!1),null!==t)if(this.cancelNextCallback(),t===ue){if(this.props.unmountOnExit||this.props.mountOnEnter){var n=this.props.nodeRef?this.props.nodeRef.current:oe.findDOMNode(this);n&&function(e){e.scrollTop}(n)}this.performEnter(e)}else this.performExit();else this.props.unmountOnExit&&this.state.status===le&&this.setState({status:ce})},i.performEnter=function(e){var t=this,n=this.props.enter,r=this.context?this.context.isMounting:e,i=this.props.nodeRef?[r]:[oe.findDOMNode(this),r],o=i[0],s=i[1],a=this.getTimeouts(),c=r?a.appear:a.enter;!e&&!n||se?this.safeSetState({status:de},(function(){t.props.onEntered(o)})):(this.props.onEnter(o,s),this.safeSetState({status:ue},(function(){t.props.onEntering(o,s),t.onTransitionEnd(c,(function(){t.safeSetState({status:de},(function(){t.props.onEntered(o,s)}))}))})))},i.performExit=function(){var e=this,t=this.props.exit,n=this.getTimeouts(),r=this.props.nodeRef?void 0:oe.findDOMNode(this);t&&!se?(this.props.onExit(r),this.safeSetState({status:he},(function(){e.props.onExiting(r),e.onTransitionEnd(n.exit,(function(){e.safeSetState({status:le},(function(){e.props.onExited(r)}))}))}))):this.safeSetState({status:le},(function(){e.props.onExited(r)}))},i.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},i.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},i.setNextCallback=function(e){var t=this,n=!0;return this.nextCallback=function(r){n&&(n=!1,t.nextCallback=null,e(r))},this.nextCallback.cancel=function(){n=!1},this.nextCallback},i.onTransitionEnd=function(e,t){this.setNextCallback(t);var n=this.props.nodeRef?this.props.nodeRef.current:oe.findDOMNode(this),r=null==e&&!this.props.addEndListener;if(n&&!r){if(this.props.addEndListener){var i=this.props.nodeRef?[this.nextCallback]:[n,this.nextCallback],o=i[0],s=i[1];this.props.addEndListener(o,s)}null!=e&&setTimeout(this.nextCallback,e)}else setTimeout(this.nextCallback,0)},i.render=function(){var e=this.state.status;if(e===ce)return null;var t=this.props,n=t.children,r=(t.in,t.mountOnEnter,t.unmountOnExit,t.appear,t.enter,t.exit,t.timeout,t.addEndListener,t.onEnter,t.onEntering,t.onEntered,t.onExit,t.onExiting,t.onExited,t.nodeRef,B(t,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]));return _.createElement(ae.Provider,{value:null},"function"===typeof n?n(e,r):_.cloneElement(_.Children.only(n),r))},r}(_.Component);function pe(){}fe.contextType=ae,fe.propTypes={},fe.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:pe,onEntering:pe,onEntered:pe,onExit:pe,onExiting:pe,onExited:pe},fe.UNMOUNTED=ce,fe.EXITED=le,fe.ENTERING=ue,fe.ENTERED=de,fe.EXITING=he;const ge=fe,me=!("undefined"===typeof window||!window.document||!window.document.createElement);var ve=!1,ye=!1;try{var we={get passive(){return ve=!0},get once(){return ye=ve=!0}};me&&(window.addEventListener("test",we,we),window.removeEventListener("test",we,!0))}catch(BJ){}const be=function(e,t,n,r){if(r&&"boolean"!==typeof r&&!ye){var i=r.once,o=r.capture,s=n;!ye&&i&&(s=n.__once||function e(r){this.removeEventListener(t,e,o),n.call(this,r)},n.__once=s),e.addEventListener(t,s,ve?r:o)}e.addEventListener(t,n,r)};const Ee=function(e,t,n,r){var i=r&&"boolean"!==typeof r?r.capture:r;e.removeEventListener(t,n,i),n.__once&&e.removeEventListener(t,n.__once,i)};const ke=function(e,t,n,r){return be(e,t,n,r),function(){Ee(e,t,n,r)}};function Ae(e,t,n){void 0===n&&(n=5);var r=!1,i=setTimeout((function(){r||function(e,t,n,r){if(void 0===n&&(n=!1),void 0===r&&(r=!0),e){var i=document.createEvent("HTMLEvents");i.initEvent(t,n,r),e.dispatchEvent(i)}}(e,"transitionend",!0)}),t+n),o=ke(e,"transitionend",(function(){r=!0}),{once:!0});return function(){clearTimeout(i),o()}}function Se(e,t,n,r){null==n&&(n=function(e){var t=re(e,"transitionDuration")||"",n=-1===t.indexOf("ms")?1e3:1;return parseFloat(t)*n}(e)||0);var i=Ae(e,n,r),o=ke(e,"transitionend",t);return function(){i(),o()}}function xe(e,t){const n=re(e,t)||"",r=-1===n.indexOf("ms")?1e3:1;return parseFloat(n)*r}function _e(e,t){const n=xe(e,"transitionDuration"),r=xe(e,"transitionDelay"),i=Se(e,(n=>{n.target===e&&(i(),t(n))}),n+r)}const Ie=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((e=>null!=e)).reduce(((e,t)=>{if("function"!==typeof t)throw new Error("Invalid Argument Type, must only provide functions, undefined, or null.");return null===e?t:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];e.apply(this,r),t.apply(this,r)}}),null)};function Re(e){e.offsetHeight}const Ce=e=>e&&"function"!==typeof e?t=>{e.current=t}:e;const Te=function(e,t){return(0,_.useMemo)((()=>function(e,t){const n=Ce(e),r=Ce(t);return e=>{n&&n(e),r&&r(e)}}(e,t)),[e,t])};const Pe=_.forwardRef(((e,t)=>{let{onEnter:n,onEntering:r,onEntered:i,onExit:o,onExiting:s,onExited:a,addEndListener:c,children:l,childRef:u,...d}=e;const h=(0,_.useRef)(null),f=Te(h,u),p=e=>{var t;f((t=e)&&"setState"in t?oe.findDOMNode(t):null!=t?t:null)},g=e=>t=>{e&&h.current&&e(h.current,t)},m=(0,_.useCallback)(g(n),[n]),v=(0,_.useCallback)(g(r),[r]),y=(0,_.useCallback)(g(i),[i]),w=(0,_.useCallback)(g(o),[o]),b=(0,_.useCallback)(g(s),[s]),E=(0,_.useCallback)(g(a),[a]),k=(0,_.useCallback)(g(c),[c]);return(0,j.jsx)(ge,{ref:t,...d,onEnter:m,onEntered:y,onEntering:v,onExit:w,onExited:E,onExiting:b,addEndListener:k,nodeRef:h,children:"function"===typeof l?(e,t)=>l(e,{...t,ref:p}):_.cloneElement(l,{ref:p})})})),Ne=Pe,Be={height:["marginTop","marginBottom"],width:["marginLeft","marginRight"]};function De(e,t){const n=t["offset".concat(e[0].toUpperCase()).concat(e.slice(1))],r=Be[e];return n+parseInt(re(t,r[0]),10)+parseInt(re(t,r[1]),10)}const Oe={[le]:"collapse",[he]:"collapsing",[ue]:"collapsing",[de]:"collapse show"},Le=_.forwardRef(((e,t)=>{let{onEnter:n,onEntering:r,onEntered:i,onExit:o,onExiting:s,className:a,children:c,dimension:l="height",in:u=!1,timeout:d=300,mountOnEnter:h=!1,unmountOnExit:f=!1,appear:p=!1,getDimensionValue:g=De,...m}=e;const v="function"===typeof l?l():l,y=(0,_.useMemo)((()=>Ie((e=>{e.style[v]="0"}),n)),[v,n]),w=(0,_.useMemo)((()=>Ie((e=>{const t="scroll".concat(v[0].toUpperCase()).concat(v.slice(1));e.style[v]="".concat(e[t],"px")}),r)),[v,r]),b=(0,_.useMemo)((()=>Ie((e=>{e.style[v]=null}),i)),[v,i]),E=(0,_.useMemo)((()=>Ie((e=>{e.style[v]="".concat(g(v,e),"px"),Re(e)}),o)),[o,g,v]),k=(0,_.useMemo)((()=>Ie((e=>{e.style[v]=null}),s)),[v,s]);return(0,j.jsx)(Ne,{ref:t,addEndListener:_e,...m,"aria-expanded":m.role?u:null,onEnter:y,onEntering:w,onEntered:b,onExit:E,onExiting:k,childRef:c.ref,in:u,timeout:d,mountOnEnter:h,unmountOnExit:f,appear:p,children:(e,t)=>_.cloneElement(c,{...t,className:C()(a,c.props.className,Oe[e],"width"===v&&"collapse-horizontal")})})})),Me=_.createContext(null);Me.displayName="NavbarContext";const Fe=Me,Ue=_.forwardRef(((e,t)=>{let{children:n,bsPrefix:r,...i}=e;r=K(r,"navbar-collapse");const o=(0,_.useContext)(Fe);return(0,j.jsx)(Le,{in:!(!o||!o.expanded),...i,children:(0,j.jsx)("div",{ref:t,className:r,children:n})})}));Ue.displayName="NavbarCollapse";const je=Ue;const He=function(e){const t=(0,_.useRef)(e);return(0,_.useEffect)((()=>{t.current=e}),[e]),t};function ze(e){const t=He(e);return(0,_.useCallback)((function(){return t.current&&t.current(...arguments)}),[t])}const Ve=_.forwardRef(((e,t)=>{let{bsPrefix:n,className:r,children:i,label:o="Toggle navigation",as:s="button",onClick:a,...c}=e;n=K(n,"navbar-toggler");const{onToggle:l,expanded:u}=(0,_.useContext)(Fe)||{},d=ze((e=>{a&&a(e),l&&l()}));return"button"===s&&(c.type="button"),(0,j.jsx)(s,{...c,ref:t,onClick:d,"aria-label":o,className:C()(r,n,!u&&"collapsed"),children:i||(0,j.jsx)("span",{className:"".concat(n,"-icon")})})}));Ve.displayName="NavbarToggle";const qe=Ve,Ge="undefined"!==typeof n.g&&n.g.navigator&&"ReactNative"===n.g.navigator.product,Ke="undefined"!==typeof document||Ge?_.useLayoutEffect:_.useEffect,We=new WeakMap,Qe=(e,t)=>{if(!e||!t)return;const n=We.get(t)||new Map;We.set(t,n);let r=n.get(e);return r||(r=t.matchMedia(e),r.refCount=0,n.set(r.media,r)),r};function Ye(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"undefined"===typeof window?void 0:window;const n=Qe(e,t),[r,i]=(0,_.useState)((()=>!!n&&n.matches));return Ke((()=>{let n=Qe(e,t);if(!n)return i(!1);let r=We.get(t);const o=()=>{i(n.matches)};return n.refCount++,n.addListener(o),o(),()=>{n.removeListener(o),n.refCount--,n.refCount<=0&&(null==r||r.delete(n.media)),n=void 0}}),[e]),r}const Ze=function(e){const t=Object.keys(e);function n(e,t){return e===t?t:e?"".concat(e," and ").concat(t):t}function r(n){const r=function(e){return t[Math.min(t.indexOf(e)+1,t.length-1)]}(n);let i=e[r];return i="number"===typeof i?"".concat(i-.2,"px"):"calc(".concat(i," - 0.2px)"),"(max-width: ".concat(i,")")}return function(t,i,o){let s;return"object"===typeof t?(s=t,o=i,i=!0):(i=i||!0,s={[t]:i}),Ye((0,_.useMemo)((()=>Object.entries(s).reduce(((t,i)=>{let[o,s]=i;return"up"!==s&&!0!==s||(t=n(t,function(t){let n=e[t];return"number"===typeof n&&(n="".concat(n,"px")),"(min-width: ".concat(n,")")}(o))),"down"!==s&&!0!==s||(t=n(t,r(o))),t}),"")),[JSON.stringify(s)]),o)}}({xs:0,sm:576,md:768,lg:992,xl:1200,xxl:1400}),Je=Ze;function Xe(e){void 0===e&&(e=J());try{var t=e.activeElement;return t&&t.nodeName?t:null}catch(BJ){return e.body}}function $e(e,t){return e.contains?e.contains(t):e.compareDocumentPosition?e===t||!!(16&e.compareDocumentPosition(t)):void 0}function et(e){const t=function(e){const t=(0,_.useRef)(e);return t.current=e,t}(e);(0,_.useEffect)((()=>()=>t.current()),[])}const tt="data-rr-ui-";function nt(e){return"".concat(tt).concat(e)}const rt=nt("modal-open");const it=class{constructor(){let{ownerDocument:e,handleContainerOverflow:t=!0,isRTL:n=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.handleContainerOverflow=t,this.isRTL=n,this.modals=[],this.ownerDocument=e}getScrollbarWidth(){return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;const t=e.defaultView;return Math.abs(t.innerWidth-e.documentElement.clientWidth)}(this.ownerDocument)}getElement(){return(this.ownerDocument||document).body}setModalAttributes(e){}removeModalAttributes(e){}setContainerStyle(e){const t={overflow:"hidden"},n=this.isRTL?"paddingLeft":"paddingRight",r=this.getElement();e.style={overflow:r.style.overflow,[n]:r.style[n]},e.scrollBarWidth&&(t[n]="".concat(parseInt(re(r,n)||"0",10)+e.scrollBarWidth,"px")),r.setAttribute(rt,""),re(r,t)}reset(){[...this.modals].forEach((e=>this.remove(e)))}removeContainerStyle(e){const t=this.getElement();t.removeAttribute(rt),Object.assign(t.style,e.style)}add(e){let t=this.modals.indexOf(e);return-1!==t?t:(t=this.modals.length,this.modals.push(e),this.setModalAttributes(e),0!==t||(this.state={scrollBarWidth:this.getScrollbarWidth(),style:{}},this.handleContainerOverflow&&this.setContainerStyle(this.state)),t)}remove(e){const t=this.modals.indexOf(e);-1!==t&&(this.modals.splice(t,1),!this.modals.length&&this.handleContainerOverflow&&this.removeContainerStyle(this.state),this.removeModalAttributes(e))}isTopModal(e){return!!this.modals.length&&this.modals[this.modals.length-1]===e}},ot=(0,_.createContext)(me?window:void 0);ot.Provider;function st(){return(0,_.useContext)(ot)}const at=(e,t)=>me?null==e?(t||J()).body:("function"===typeof e&&(e=e()),e&&"current"in e&&(e=e.current),e&&("nodeType"in e||e.getBoundingClientRect)?e:null):null;const ct=function(e){let{children:t,in:n,onExited:r,mountOnEnter:i,unmountOnExit:o}=e;const s=(0,_.useRef)(null),a=(0,_.useRef)(n),c=ze(r);(0,_.useEffect)((()=>{n?a.current=!0:c(s.current)}),[n,c]);const l=Te(s,t.ref),u=(0,_.cloneElement)(t,{ref:l});return n?u:o||!a.current&&i?null:u},lt=["onEnter","onEntering","onEntered","onExit","onExiting","onExited","addEndListener","children"];function ut(e){let{onEnter:t,onEntering:n,onEntered:r,onExit:i,onExiting:o,onExited:s,addEndListener:a,children:c}=e,l=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,lt);const u=(0,_.useRef)(null),d=Te(u,"function"===typeof c?null:c.ref),h=e=>t=>{e&&u.current&&e(u.current,t)},f=(0,_.useCallback)(h(t),[t]),p=(0,_.useCallback)(h(n),[n]),g=(0,_.useCallback)(h(r),[r]),m=(0,_.useCallback)(h(i),[i]),v=(0,_.useCallback)(h(o),[o]),y=(0,_.useCallback)(h(s),[s]),w=(0,_.useCallback)(h(a),[a]);return Object.assign({},l,{nodeRef:u},t&&{onEnter:f},n&&{onEntering:p},r&&{onEntered:g},i&&{onExit:m},o&&{onExiting:v},s&&{onExited:y},a&&{addEndListener:w},{children:"function"===typeof c?(e,t)=>c(e,Object.assign({},t,{ref:d})):(0,_.cloneElement)(c,{ref:d})})}const dt=["component"];const ht=_.forwardRef(((e,t)=>{let{component:n}=e,r=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,dt);const i=ut(r);return(0,j.jsx)(n,Object.assign({ref:t},i))})),ft=ht;function pt(e){let{children:t,in:n,onExited:r,onEntered:i,transition:o}=e;const[s,a]=(0,_.useState)(!n);n&&s&&a(!1);const c=function(e){let{in:t,onTransition:n}=e;const r=(0,_.useRef)(null),i=(0,_.useRef)(!0),o=ze(n);return Ke((()=>{if(!r.current)return;let e=!1;return o({in:t,element:r.current,initial:i.current,isStale:()=>e}),()=>{e=!0}}),[t,o]),Ke((()=>(i.current=!1,()=>{i.current=!0})),[]),r}({in:!!n,onTransition:e=>{Promise.resolve(o(e)).then((()=>{e.isStale()||(e.in?null==i||i(e.element,e.initial):(a(!0),null==r||r(e.element)))}),(t=>{throw e.in||a(!0),t}))}}),l=Te(c,t.ref);return s&&!n?null:(0,_.cloneElement)(t,{ref:l})}function gt(e,t,n){return e?(0,j.jsx)(ft,Object.assign({},n,{component:e})):t?(0,j.jsx)(pt,Object.assign({},n,{transition:t})):(0,j.jsx)(ct,Object.assign({},n))}const mt=["show","role","className","style","children","backdrop","keyboard","onBackdropClick","onEscapeKeyDown","transition","runTransition","backdropTransition","runBackdropTransition","autoFocus","enforceFocus","restoreFocus","restoreFocusOptions","renderDialog","renderBackdrop","manager","container","onShow","onHide","onExit","onExited","onExiting","onEnter","onEntering","onEntered"];let vt;function yt(e){const t=st(),n=e||function(e){return vt||(vt=new it({ownerDocument:null==e?void 0:e.document})),vt}(t),r=(0,_.useRef)({dialog:null,backdrop:null});return Object.assign(r.current,{add:()=>n.add(r.current),remove:()=>n.remove(r.current),isTopModal:()=>n.isTopModal(r.current),setDialogRef:(0,_.useCallback)((e=>{r.current.dialog=e}),[]),setBackdropRef:(0,_.useCallback)((e=>{r.current.backdrop=e}),[])})}const wt=(0,_.forwardRef)(((e,t)=>{let{show:n=!1,role:r="dialog",className:i,style:o,children:s,backdrop:a=!0,keyboard:c=!0,onBackdropClick:l,onEscapeKeyDown:u,transition:d,runTransition:h,backdropTransition:f,runBackdropTransition:p,autoFocus:g=!0,enforceFocus:m=!0,restoreFocus:v=!0,restoreFocusOptions:y,renderDialog:w,renderBackdrop:b=(e=>(0,j.jsx)("div",Object.assign({},e))),manager:E,container:k,onShow:A,onHide:S=(()=>{}),onExit:x,onExited:I,onExiting:R,onEnter:C,onEntering:T,onEntered:P}=e,N=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,mt);const B=st(),D=function(e,t){const n=st(),[r,i]=(0,_.useState)((()=>at(e,null==n?void 0:n.document)));if(!r){const t=at(e);t&&i(t)}return(0,_.useEffect)((()=>{t&&r&&t(r)}),[t,r]),(0,_.useEffect)((()=>{const t=at(e);t!==r&&i(t)}),[e,r]),r}(k),O=yt(E),L=function(){const e=(0,_.useRef)(!0),t=(0,_.useRef)((()=>e.current));return(0,_.useEffect)((()=>(e.current=!0,()=>{e.current=!1})),[]),t.current}(),M=function(e){const t=(0,_.useRef)(null);return(0,_.useEffect)((()=>{t.current=e})),t.current}(n),[F,U]=(0,_.useState)(!n),H=(0,_.useRef)(null);(0,_.useImperativeHandle)(t,(()=>O),[O]),me&&!M&&n&&(H.current=Xe(null==B?void 0:B.document)),n&&F&&U(!1);const z=ze((()=>{if(O.add(),Q.current=ke(document,"keydown",K),W.current=ke(document,"focus",(()=>setTimeout(q)),!0),A&&A(),g){var e,t;const n=Xe(null!=(e=null==(t=O.dialog)?void 0:t.ownerDocument)?e:null==B?void 0:B.document);O.dialog&&n&&!$e(O.dialog,n)&&(H.current=n,O.dialog.focus())}})),V=ze((()=>{var e;(O.remove(),null==Q.current||Q.current(),null==W.current||W.current(),v)&&(null==(e=H.current)||null==e.focus||e.focus(y),H.current=null)}));(0,_.useEffect)((()=>{n&&D&&z()}),[n,D,z]),(0,_.useEffect)((()=>{F&&V()}),[F,V]),et((()=>{V()}));const q=ze((()=>{if(!m||!L()||!O.isTopModal())return;const e=Xe(null==B?void 0:B.document);O.dialog&&e&&!$e(O.dialog,e)&&O.dialog.focus()})),G=ze((e=>{e.target===e.currentTarget&&(null==l||l(e),!0===a&&S())})),K=ze((e=>{c&&function(e){return"Escape"===e.code||27===e.keyCode}(e)&&O.isTopModal()&&(null==u||u(e),e.defaultPrevented||S())})),W=(0,_.useRef)(),Q=(0,_.useRef)();if(!D)return null;const Y=Object.assign({role:r,ref:O.setDialogRef,"aria-modal":"dialog"===r||void 0},N,{style:o,className:i,tabIndex:-1});let Z=w?w(Y):(0,j.jsx)("div",Object.assign({},Y,{children:_.cloneElement(s,{role:"document"})}));Z=gt(d,h,{unmountOnExit:!0,mountOnEnter:!0,appear:!0,in:!!n,onExit:x,onExiting:R,onExited:function(){U(!0),null==I||I(...arguments)},onEnter:C,onEntering:T,onEntered:P,children:Z});let J=null;return a&&(J=b({ref:O.setBackdropRef,onClick:G}),J=gt(f,p,{in:!!n,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:J})),(0,j.jsx)(j.Fragment,{children:oe.createPortal((0,j.jsxs)(j.Fragment,{children:[J,Z]}),D)})}));wt.displayName="Modal";const bt=Object.assign(wt,{Manager:it}),Et={[ue]:"show",[de]:"show"},kt=_.forwardRef(((e,t)=>{let{className:n,children:r,transitionClasses:i={},onEnter:o,...s}=e;const a={in:!1,timeout:300,mountOnEnter:!1,unmountOnExit:!1,appear:!1,...s},c=(0,_.useCallback)(((e,t)=>{Re(e),null==o||o(e,t)}),[o]);return(0,j.jsx)(Ne,{ref:t,addEndListener:_e,...a,onEnter:c,childRef:r.ref,children:(e,t)=>_.cloneElement(r,{...t,className:C()("fade",n,r.props.className,Et[e],i[e])})})}));kt.displayName="Fade";const At=kt,St=_.forwardRef(((e,t)=>{let{className:n,bsPrefix:r,as:i="div",...o}=e;return r=K(r,"offcanvas-body"),(0,j.jsx)(i,{ref:t,className:C()(n,r),...o})}));St.displayName="OffcanvasBody";const xt=St,_t={[ue]:"show",[de]:"show"},It=_.forwardRef(((e,t)=>{let{bsPrefix:n,className:r,children:i,in:o=!1,mountOnEnter:s=!1,unmountOnExit:a=!1,appear:c=!1,...l}=e;return n=K(n,"offcanvas"),(0,j.jsx)(Ne,{ref:t,addEndListener:_e,in:o,mountOnEnter:s,unmountOnExit:a,appear:c,...l,childRef:i.ref,children:(e,t)=>_.cloneElement(i,{...t,className:C()(r,i.props.className,(e===ue||e===he)&&"".concat(n,"-toggling"),_t[e])})})}));It.displayName="OffcanvasToggling";const Rt=It,Ct=_.createContext({onHide(){}});var Tt=n(5173),Pt=n.n(Tt);const Nt={"aria-label":Pt().string,onClick:Pt().func,variant:Pt().oneOf(["white"])},Bt=_.forwardRef(((e,t)=>{let{className:n,variant:r,"aria-label":i="Close",...o}=e;return(0,j.jsx)("button",{ref:t,type:"button",className:C()("btn-close",r&&"btn-close-".concat(r),n),"aria-label":i,...o})}));Bt.displayName="CloseButton",Bt.propTypes=Nt;const Dt=Bt,Ot=_.forwardRef(((e,t)=>{let{closeLabel:n="Close",closeVariant:r,closeButton:i=!1,onHide:o,children:s,...a}=e;const c=(0,_.useContext)(Ct),l=ze((()=>{null==c||c.onHide(),null==o||o()}));return(0,j.jsxs)("div",{ref:t,...a,children:[s,i&&(0,j.jsx)(Dt,{"aria-label":n,variant:r,onClick:l})]})})),Lt=Ot,Mt=_.forwardRef(((e,t)=>{let{bsPrefix:n,className:r,closeLabel:i="Close",closeButton:o=!1,...s}=e;return n=K(n,"offcanvas-header"),(0,j.jsx)(Lt,{ref:t,...s,className:C()(r,n),closeLabel:i,closeButton:o})}));Mt.displayName="OffcanvasHeader";const Ft=Mt,Ut=e=>_.forwardRef(((t,n)=>(0,j.jsx)("div",{...t,ref:n,className:C()(t.className,e)}))),jt=Ut("h5"),Ht=_.forwardRef(((e,t)=>{let{className:n,bsPrefix:r,as:i=jt,...o}=e;return r=K(r,"offcanvas-title"),(0,j.jsx)(i,{ref:t,className:C()(n,r),...o})}));Ht.displayName="OffcanvasTitle";const zt=Ht;var Vt=Function.prototype.bind.call(Function.prototype.call,[].slice);function qt(e,t){return Vt(e.querySelectorAll(t))}function Gt(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}const Kt=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Wt=".sticky-top",Qt=".navbar-toggler";class Yt extends it{adjustAndStore(e,t,n){const r=t.style[e];t.dataset[e]=r,re(t,{[e]:"".concat(parseFloat(re(t,e))+n,"px")})}restore(e,t){const n=t.dataset[e];void 0!==n&&(delete t.dataset[e],re(t,{[e]:n}))}setContainerStyle(e){super.setContainerStyle(e);const t=this.getElement();var n,r;if(r="modal-open",(n=t).classList?n.classList.add(r):function(e,t){return e.classList?!!t&&e.classList.contains(t):-1!==(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")}(n,r)||("string"===typeof n.className?n.className=n.className+" "+r:n.setAttribute("class",(n.className&&n.className.baseVal||"")+" "+r)),!e.scrollBarWidth)return;const i=this.isRTL?"paddingLeft":"paddingRight",o=this.isRTL?"marginLeft":"marginRight";qt(t,Kt).forEach((t=>this.adjustAndStore(i,t,e.scrollBarWidth))),qt(t,Wt).forEach((t=>this.adjustAndStore(o,t,-e.scrollBarWidth))),qt(t,Qt).forEach((t=>this.adjustAndStore(o,t,e.scrollBarWidth)))}removeContainerStyle(e){super.removeContainerStyle(e);const t=this.getElement();var n,r;r="modal-open",(n=t).classList?n.classList.remove(r):"string"===typeof n.className?n.className=Gt(n.className,r):n.setAttribute("class",Gt(n.className&&n.className.baseVal||"",r));const i=this.isRTL?"paddingLeft":"paddingRight",o=this.isRTL?"marginLeft":"marginRight";qt(t,Kt).forEach((e=>this.restore(i,e))),qt(t,Wt).forEach((e=>this.restore(o,e))),qt(t,Qt).forEach((e=>this.restore(o,e)))}}let Zt;const Jt=Yt;function Xt(e){return(0,j.jsx)(Rt,{...e})}function $t(e){return(0,j.jsx)(At,{...e})}const en=_.forwardRef(((e,t)=>{let{bsPrefix:n,className:r,children:i,"aria-labelledby":o,placement:s="start",responsive:a,show:c=!1,backdrop:l=!0,keyboard:u=!0,scroll:d=!1,onEscapeKeyDown:h,onShow:f,onHide:p,container:g,autoFocus:m=!0,enforceFocus:v=!0,restoreFocus:y=!0,restoreFocusOptions:w,onEntered:b,onExit:E,onExiting:k,onEnter:A,onEntering:S,onExited:x,backdropClassName:I,manager:R,renderStaticNode:T=!1,...P}=e;const N=(0,_.useRef)();n=K(n,"offcanvas");const{onToggle:B}=(0,_.useContext)(Fe)||{},[D,O]=(0,_.useState)(!1),L=Je(a||"xs","up");(0,_.useEffect)((()=>{O(a?c&&!L:c)}),[c,a,L]);const M=ze((()=>{null==B||B(),null==p||p()})),F=(0,_.useMemo)((()=>({onHide:M})),[M]);const U=(0,_.useCallback)((e=>(0,j.jsx)("div",{...e,className:C()("".concat(n,"-backdrop"),I)})),[I,n]),H=e=>(0,j.jsx)("div",{...e,...P,className:C()(r,a?"".concat(n,"-").concat(a):n,"".concat(n,"-").concat(s)),"aria-labelledby":o,children:i});return(0,j.jsxs)(j.Fragment,{children:[!D&&(a||T)&&H({}),(0,j.jsx)(Ct.Provider,{value:F,children:(0,j.jsx)(bt,{show:D,ref:t,backdrop:l,container:g,keyboard:u,autoFocus:m,enforceFocus:v&&!d,restoreFocus:y,restoreFocusOptions:w,onEscapeKeyDown:h,onShow:f,onHide:M,onEnter:function(e){e&&(e.style.visibility="visible");for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];null==A||A(e,...n)},onEntering:S,onEntered:b,onExit:E,onExiting:k,onExited:function(e){e&&(e.style.visibility="");for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];null==x||x(...n)},manager:R||(d?(N.current||(N.current=new Jt({handleContainerOverflow:!1})),N.current):function(e){return Zt||(Zt=new Yt(e)),Zt}()),transition:Xt,backdropTransition:$t,renderBackdrop:U,renderDialog:H})})]})}));en.displayName="Offcanvas";const tn=Object.assign(en,{Body:xt,Header:Ft,Title:zt}),nn=_.forwardRef(((e,t)=>{const n=(0,_.useContext)(Fe);return(0,j.jsx)(tn,{ref:t,show:!(null==n||!n.expanded),...e,renderStaticNode:!0})}));nn.displayName="NavbarOffcanvas";const rn=nn,on=_.forwardRef(((e,t)=>{let{className:n,bsPrefix:r,as:i="span",...o}=e;return r=K(r,"navbar-text"),(0,j.jsx)(i,{ref:t,className:C()(n,r),...o})}));on.displayName="NavbarText";const sn=on,an=_.forwardRef(((e,t)=>{const{bsPrefix:n,expand:r=!0,variant:i="light",bg:o,fixed:s,sticky:a,className:c,as:l="nav",expanded:u,onToggle:d,onSelect:h,collapseOnSelect:f=!1,...p}=L(e,{expanded:"onToggle"}),g=K(n,"navbar"),m=(0,_.useCallback)((function(){null==h||h(...arguments),f&&u&&(null==d||d(!1))}),[h,f,u,d]);void 0===p.role&&"nav"!==l&&(p.role="navigation");let v="".concat(g,"-expand");"string"===typeof r&&(v="".concat(v,"-").concat(r));const y=(0,_.useMemo)((()=>({onToggle:()=>null==d?void 0:d(!u),bsPrefix:g,expanded:!!u,expand:r})),[g,u,r,d]);return(0,j.jsx)(Fe.Provider,{value:y,children:(0,j.jsx)(P.Provider,{value:m,children:(0,j.jsx)(l,{ref:t,...p,className:C()(c,g,r&&v,i&&"".concat(g,"-").concat(i),o&&"bg-".concat(o),a&&"sticky-".concat(a),s&&"fixed-".concat(s))})})})}));an.displayName="Navbar";const cn=Object.assign(an,{Brand:Z,Collapse:je,Offcanvas:rn,Text:sn,Toggle:qe}),ln=_.forwardRef(((e,t)=>{let{bsPrefix:n,fluid:r=!1,as:i="div",className:o,...s}=e;const a=K(n,"container"),c="string"===typeof r?"-".concat(r):"-fluid";return(0,j.jsx)(i,{ref:t,...s,className:C()(o,r?"".concat(a).concat(c):a)})}));ln.displayName="Container";const un=ln;n(9197);const dn=_.createContext(null);dn.displayName="NavContext";const hn=dn,fn=_.createContext(null),pn=["as","disabled"];function gn(e){let{tagName:t,disabled:n,href:r,target:i,rel:o,role:s,onClick:a,tabIndex:c=0,type:l}=e;t||(t=null!=r||null!=i||null!=o?"a":"button");const u={tagName:t};if("button"===t)return[{type:l||"button",disabled:n},u];const d=e=>{(n||"a"===t&&function(e){return!e||"#"===e.trim()}(r))&&e.preventDefault(),n?e.stopPropagation():null==a||a(e)};return"a"===t&&(r||(r="#"),n&&(r=void 0)),[{role:null!=s?s:"button",disabled:void 0,tabIndex:n?void 0:c,href:r,target:"a"===t?i:void 0,"aria-disabled":n||void 0,rel:"a"===t?o:void 0,onClick:d,onKeyDown:e=>{" "===e.key&&(e.preventDefault(),d(e))}},u]}const mn=_.forwardRef(((e,t)=>{let{as:n,disabled:r}=e,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,pn);const[o,{tagName:s}]=gn(Object.assign({tagName:n,disabled:r},i));return(0,j.jsx)(s,Object.assign({},i,o,{ref:t}))}));mn.displayName="Button";const vn=mn,yn=["as","active","eventKey"];function wn(e){let{key:t,onClick:n,active:r,id:i,role:o,disabled:s}=e;const a=(0,_.useContext)(P),c=(0,_.useContext)(hn),l=(0,_.useContext)(fn);let u=r;const d={role:o};if(c){o||"tablist"!==c.role||(d.role="tab");const e=c.getControllerId(null!=t?t:null),n=c.getControlledId(null!=t?t:null);d[nt("event-key")]=t,d.id=e||i,u=null==r&&null!=t?c.activeKey===t:r,!u&&(null!=l&&l.unmountOnExit||null!=l&&l.mountOnEnter)||(d["aria-controls"]=n)}return"tab"===d.role&&(d["aria-selected"]=u,u||(d.tabIndex=-1),s&&(d.tabIndex=-1,d["aria-disabled"]=!0)),d.onClick=ze((e=>{s||(null==n||n(e),null!=t&&a&&!e.isPropagationStopped()&&a(t,e))})),[d,{isActive:u}]}const bn=_.forwardRef(((e,t)=>{let{as:n=vn,active:r,eventKey:i}=e,o=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,yn);const[s,a]=wn(Object.assign({key:T(i,o.href),active:r},o));return s[nt("active")]=a.isActive,(0,j.jsx)(n,Object.assign({},o,s,{ref:t}))}));bn.displayName="NavItem";const En=bn,kn=["as","onSelect","activeKey","role","onKeyDown"];const An=()=>{},Sn=nt("event-key"),xn=_.forwardRef(((e,t)=>{let{as:n="div",onSelect:r,activeKey:i,role:o,onKeyDown:s}=e,a=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,kn);const c=function(){const[,e]=(0,_.useReducer)((e=>!e),!1);return e}(),l=(0,_.useRef)(!1),u=(0,_.useContext)(P),d=(0,_.useContext)(fn);let h,f;d&&(o=o||"tablist",i=d.activeKey,h=d.getControlledId,f=d.getControllerId);const p=(0,_.useRef)(null),g=e=>{const t=p.current;if(!t)return null;const n=qt(t,"[".concat(Sn,"]:not([aria-disabled=true])")),r=t.querySelector("[aria-selected=true]");if(!r||r!==document.activeElement)return null;const i=n.indexOf(r);if(-1===i)return null;let o=i+e;return o>=n.length&&(o=0),o<0&&(o=n.length-1),n[o]},m=(e,t)=>{null!=e&&(null==r||r(e,t),null==u||u(e,t))};(0,_.useEffect)((()=>{if(p.current&&l.current){const e=p.current.querySelector("[".concat(Sn,"][aria-selected=true]"));null==e||e.focus()}l.current=!1}));const v=Te(t,p);return(0,j.jsx)(P.Provider,{value:m,children:(0,j.jsx)(hn.Provider,{value:{role:o,activeKey:T(i),getControlledId:h||An,getControllerId:f||An},children:(0,j.jsx)(n,Object.assign({},a,{onKeyDown:e=>{if(null==s||s(e),!d)return;let t;switch(e.key){case"ArrowLeft":case"ArrowUp":t=g(-1);break;case"ArrowRight":case"ArrowDown":t=g(1);break;default:return}var n;t&&(e.preventDefault(),m(t.dataset[(n="EventKey","".concat("rrUi").concat(n))]||null,e),l.current=!0,c())},ref:v,role:o}))})})}));xn.displayName="Nav";const _n=Object.assign(xn,{Item:En}),In=_.createContext(null);In.displayName="CardHeaderContext";const Rn=In,Cn=_.forwardRef(((e,t)=>{let{className:n,bsPrefix:r,as:i="div",...o}=e;return r=K(r,"nav-item"),(0,j.jsx)(i,{ref:t,className:C()(n,r),...o})}));Cn.displayName="NavItem";const Tn=Cn;new WeakMap;const Pn=["onKeyDown"];const Nn=_.forwardRef(((e,t)=>{let{onKeyDown:n}=e,r=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,Pn);const[i]=gn(Object.assign({tagName:"a"},r)),o=ze((e=>{i.onKeyDown(e),null==n||n(e)}));return(s=r.href)&&"#"!==s.trim()&&"button"!==r.role?(0,j.jsx)("a",Object.assign({ref:t},r,{onKeyDown:n})):(0,j.jsx)("a",Object.assign({ref:t},r,i,{onKeyDown:o}));var s}));Nn.displayName="Anchor";const Bn=Nn,Dn=_.forwardRef(((e,t)=>{let{bsPrefix:n,className:r,as:i=Bn,active:o,eventKey:s,disabled:a=!1,...c}=e;n=K(n,"nav-link");const[l,u]=wn({key:T(s,c.href),active:o,disabled:a,...c});return(0,j.jsx)(i,{...c,...l,ref:t,disabled:a,className:C()(r,n,a&&"disabled",u.isActive&&"active")})}));Dn.displayName="NavLink";const On=Dn,Ln=_.forwardRef(((e,t)=>{const{as:n="div",bsPrefix:r,variant:i,fill:o=!1,justify:s=!1,navbar:a,navbarScroll:c,className:l,activeKey:u,...d}=L(e,{activeKey:"onSelect"}),h=K(r,"nav");let f,p,g=!1;const m=(0,_.useContext)(Fe),v=(0,_.useContext)(Rn);return m?(f=m.bsPrefix,g=null==a||a):v&&({cardHeaderBsPrefix:p}=v),(0,j.jsx)(_n,{as:n,ref:t,activeKey:u,className:C()(l,{[h]:!g,["".concat(f,"-nav")]:g,["".concat(f,"-nav-scroll")]:g&&c,["".concat(p,"-").concat(i)]:!!p,["".concat(h,"-").concat(i)]:!!i,["".concat(h,"-fill")]:o,["".concat(h,"-justified")]:s}),...d})}));Ln.displayName="Nav";const Mn=Object.assign(Ln,{Item:Tn,Link:On}),Fn=Ut("h4");Fn.displayName="DivStyledAsH4";const Un=_.forwardRef(((e,t)=>{let{className:n,bsPrefix:r,as:i=Fn,...o}=e;return r=K(r,"alert-heading"),(0,j.jsx)(i,{ref:t,className:C()(n,r),...o})}));Un.displayName="AlertHeading";const jn=Un,Hn=_.forwardRef(((e,t)=>{let{className:n,bsPrefix:r,as:i=Bn,...o}=e;return r=K(r,"alert-link"),(0,j.jsx)(i,{ref:t,className:C()(n,r),...o})}));Hn.displayName="AlertLink";const zn=Hn,Vn=_.forwardRef(((e,t)=>{const{bsPrefix:n,show:r=!0,closeLabel:i="Close alert",closeVariant:o,className:s,children:a,variant:c="primary",onClose:l,dismissible:u,transition:d=At,...h}=L(e,{show:"onClose"}),f=K(n,"alert"),p=ze((e=>{l&&l(!1,e)})),g=!0===d?At:d,m=(0,j.jsxs)("div",{role:"alert",...g?void 0:h,ref:t,className:C()(s,f,c&&"".concat(f,"-").concat(c),u&&"".concat(f,"-dismissible")),children:[u&&(0,j.jsx)(Dt,{onClick:p,"aria-label":i,variant:o}),a]});return g?(0,j.jsx)(g,{unmountOnExit:!0,...h,ref:void 0,in:r,children:m}):r?m:null}));Vn.displayName="Alert";const qn=Object.assign(Vn,{Link:zn,Heading:jn}),Gn=_.forwardRef(((e,t)=>{let{as:n,bsPrefix:r,variant:i="primary",size:o,active:s=!1,disabled:a=!1,className:c,...l}=e;const u=K(r,"btn"),[d,{tagName:h}]=gn({tagName:n,disabled:a,...l}),f=h;return(0,j.jsx)(f,{...d,...l,ref:t,disabled:a,className:C()(c,u,s&&"active",i&&"".concat(u,"-").concat(i),o&&"".concat(u,"-").concat(o),l.href&&a&&"disabled")})}));Gn.displayName="Button";const Kn=Gn,Wn={type:Pt().string,tooltip:Pt().bool,as:Pt().elementType},Qn=_.forwardRef(((e,t)=>{let{as:n="div",className:r,type:i="valid",tooltip:o=!1,...s}=e;return(0,j.jsx)(n,{...s,ref:t,className:C()(r,"".concat(i,"-").concat(o?"tooltip":"feedback"))})}));Qn.displayName="Feedback",Qn.propTypes=Wn;const Yn=Qn,Zn=_.createContext({}),Jn=_.forwardRef(((e,t)=>{let{id:n,bsPrefix:r,className:i,type:o="checkbox",isValid:s=!1,isInvalid:a=!1,as:c="input",...l}=e;const{controlId:u}=(0,_.useContext)(Zn);return r=K(r,"form-check-input"),(0,j.jsx)(c,{...l,ref:t,type:o,id:n||u,className:C()(i,r,s&&"is-valid",a&&"is-invalid")})}));Jn.displayName="FormCheckInput";const Xn=Jn,$n=_.forwardRef(((e,t)=>{let{bsPrefix:n,className:r,htmlFor:i,...o}=e;const{controlId:s}=(0,_.useContext)(Zn);return n=K(n,"form-check-label"),(0,j.jsx)("label",{...o,ref:t,htmlFor:i||s,className:C()(r,n)})}));$n.displayName="FormCheckLabel";const er=$n;const tr=_.forwardRef(((e,t)=>{let{id:n,bsPrefix:r,bsSwitchPrefix:i,inline:o=!1,reverse:s=!1,disabled:a=!1,isValid:c=!1,isInvalid:l=!1,feedbackTooltip:u=!1,feedback:d,feedbackType:h,className:f,style:p,title:g="",type:m="checkbox",label:v,children:y,as:w="input",...b}=e;r=K(r,"form-check"),i=K(i,"form-switch");const{controlId:E}=(0,_.useContext)(Zn),k=(0,_.useMemo)((()=>({controlId:n||E})),[E,n]),A=!y&&null!=v&&!1!==v||function(e,t){return _.Children.toArray(e).some((e=>_.isValidElement(e)&&e.type===t))}(y,er),S=(0,j.jsx)(Xn,{...b,type:"switch"===m?"checkbox":m,ref:t,isValid:c,isInvalid:l,disabled:a,as:w});return(0,j.jsx)(Zn.Provider,{value:k,children:(0,j.jsx)("div",{style:p,className:C()(f,A&&r,o&&"".concat(r,"-inline"),s&&"".concat(r,"-reverse"),"switch"===m&&i),children:y||(0,j.jsxs)(j.Fragment,{children:[S,A&&(0,j.jsx)(er,{title:g,children:v}),d&&(0,j.jsx)(Yn,{type:h,tooltip:u,children:d})]})})})}));tr.displayName="FormCheck";const nr=Object.assign(tr,{Input:Xn,Label:er});n(6440);const rr=_.forwardRef(((e,t)=>{let{bsPrefix:n,type:r,size:i,htmlSize:o,id:s,className:a,isValid:c=!1,isInvalid:l=!1,plaintext:u,readOnly:d,as:h="input",...f}=e;const{controlId:p}=(0,_.useContext)(Zn);return n=K(n,"form-control"),(0,j.jsx)(h,{...f,type:r,size:o,ref:t,readOnly:d,id:s||p,className:C()(a,u?"".concat(n,"-plaintext"):n,i&&"".concat(n,"-").concat(i),"color"===r&&"".concat(n,"-color"),c&&"is-valid",l&&"is-invalid")})}));rr.displayName="FormControl";const ir=Object.assign(rr,{Feedback:Yn}),or=_.forwardRef(((e,t)=>{let{className:n,bsPrefix:r,as:i="div",...o}=e;return r=K(r,"form-floating"),(0,j.jsx)(i,{ref:t,className:C()(n,r),...o})}));or.displayName="FormFloating";const sr=or,ar=_.forwardRef(((e,t)=>{let{controlId:n,as:r="div",...i}=e;const o=(0,_.useMemo)((()=>({controlId:n})),[n]);return(0,j.jsx)(Zn.Provider,{value:o,children:(0,j.jsx)(r,{...i,ref:t})})}));ar.displayName="FormGroup";const cr=ar;const lr=_.forwardRef(((e,t)=>{const[{className:n,...r},{as:i="div",bsPrefix:o,spans:s}]=function(e){let{as:t,bsPrefix:n,className:r,...i}=e;n=K(n,"col");const o=W(),s=Q(),a=[],c=[];return o.forEach((e=>{const t=i[e];let r,o,l;delete i[e],"object"===typeof t&&null!=t?({span:r,offset:o,order:l}=t):r=t;const u=e!==s?"-".concat(e):"";r&&a.push(!0===r?"".concat(n).concat(u):"".concat(n).concat(u,"-").concat(r)),null!=l&&c.push("order".concat(u,"-").concat(l)),null!=o&&c.push("offset".concat(u,"-").concat(o))})),[{...i,className:C()(r,...a,...c)},{as:t,bsPrefix:n,spans:a}]}(e);return(0,j.jsx)(i,{...r,ref:t,className:C()(n,!s.length&&o)})}));lr.displayName="Col";const ur=lr,dr=_.forwardRef(((e,t)=>{let{as:n="label",bsPrefix:r,column:i=!1,visuallyHidden:o=!1,className:s,htmlFor:a,...c}=e;const{controlId:l}=(0,_.useContext)(Zn);r=K(r,"form-label");let u="col-form-label";"string"===typeof i&&(u="".concat(u," ").concat(u,"-").concat(i));const d=C()(s,r,o&&"visually-hidden",i&&u);return a=a||l,i?(0,j.jsx)(ur,{ref:t,as:"label",className:d,htmlFor:a,...c}):(0,j.jsx)(n,{ref:t,className:d,htmlFor:a,...c})}));dr.displayName="FormLabel";const hr=dr,fr=_.forwardRef(((e,t)=>{let{bsPrefix:n,className:r,id:i,...o}=e;const{controlId:s}=(0,_.useContext)(Zn);return n=K(n,"form-range"),(0,j.jsx)("input",{...o,type:"range",ref:t,className:C()(r,n),id:i||s})}));fr.displayName="FormRange";const pr=fr,gr=_.forwardRef(((e,t)=>{let{bsPrefix:n,size:r,htmlSize:i,className:o,isValid:s=!1,isInvalid:a=!1,id:c,...l}=e;const{controlId:u}=(0,_.useContext)(Zn);return n=K(n,"form-select"),(0,j.jsx)("select",{...l,size:i,ref:t,className:C()(o,n,r&&"".concat(n,"-").concat(r),s&&"is-valid",a&&"is-invalid"),id:c||u})}));gr.displayName="FormSelect";const mr=gr,vr=_.forwardRef(((e,t)=>{let{bsPrefix:n,className:r,as:i="small",muted:o,...s}=e;return n=K(n,"form-text"),(0,j.jsx)(i,{...s,ref:t,className:C()(r,n,o&&"text-muted")})}));vr.displayName="FormText";const yr=vr,wr=_.forwardRef(((e,t)=>(0,j.jsx)(nr,{...e,ref:t,type:"switch"})));wr.displayName="Switch";const br=Object.assign(wr,{Input:nr.Input,Label:nr.Label}),Er=_.forwardRef(((e,t)=>{let{bsPrefix:n,className:r,children:i,controlId:o,label:s,...a}=e;return n=K(n,"form-floating"),(0,j.jsxs)(cr,{ref:t,className:C()(r,n),controlId:o,...a,children:[i,(0,j.jsx)("label",{htmlFor:o,children:s})]})}));Er.displayName="FloatingLabel";const kr=Er,Ar={_ref:Pt().any,validated:Pt().bool,as:Pt().elementType},Sr=_.forwardRef(((e,t)=>{let{className:n,validated:r,as:i="form",...o}=e;return(0,j.jsx)(i,{...o,ref:t,className:C()(n,r&&"was-validated")})}));Sr.displayName="Form",Sr.propTypes=Ar;const xr=Object.assign(Sr,{Group:cr,Control:ir,Floating:sr,Check:nr,Switch:br,Label:hr,Text:yr,Range:pr,Select:mr,FloatingLabel:kr}),_r=_.createContext(null);_r.displayName="InputGroupContext";const Ir=_r,Rr=_.forwardRef(((e,t)=>{let{className:n,bsPrefix:r,as:i="span",...o}=e;return r=K(r,"input-group-text"),(0,j.jsx)(i,{ref:t,className:C()(n,r),...o})}));Rr.displayName="InputGroupText";const Cr=Rr,Tr=_.forwardRef(((e,t)=>{let{bsPrefix:n,size:r,hasValidation:i,className:o,as:s="div",...a}=e;n=K(n,"input-group");const c=(0,_.useMemo)((()=>({})),[]);return(0,j.jsx)(Ir.Provider,{value:c,children:(0,j.jsx)(s,{ref:t,...a,className:C()(o,n,r&&"".concat(n,"-").concat(r),i&&"has-validation")})})}));Tr.displayName="InputGroup";const Pr=Object.assign(Tr,{Text:Cr,Radio:e=>(0,j.jsx)(Cr,{children:(0,j.jsx)(Xn,{type:"radio",...e})}),Checkbox:e=>(0,j.jsx)(Cr,{children:(0,j.jsx)(Xn,{type:"checkbox",...e})})});function Nr(e){return Nr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nr(e)}function Br(e){var t=function(e,t){if("object"!=Nr(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Nr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Nr(t)?t:t+""}function Dr(e,t,n){return(t=Br(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Or=n(4823);const Lr=function(e){if(null!=e[Symbol.asyncIterator])return(async()=>{for await(const t of e)return t})();for(const t of e)return t};const Mr=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t=Number(t),null!=e[Symbol.asyncIterator]?async function*(){let n=[];if(t<1&&(t=1),t!==Math.round(t))throw new Error("Batch size must be an integer");for await(const r of e)for(n.push(r);n.length>=t;)yield n.slice(0,t),n=n.slice(t);for(;n.length>0;)yield n.slice(0,t),n=n.slice(t)}():function*(){let n=[];if(t<1&&(t=1),t!==Math.round(t))throw new Error("Batch size must be an integer");for(const r of e)for(n.push(r);n.length>=t;)yield n.slice(0,t),n=n.slice(t);for(;n.length>0;)yield n.slice(0,t),n=n.slice(t)}()};function Fr(e){try{let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return async function*(){for await(const n of Mr(e,t)){const e=n.map((async e=>e().then((e=>({ok:!0,value:e})),(e=>({ok:!1,err:e})))));for(let t=0;t<e.length;t++){const n=await e[t];if(!n.ok)throw n.err;yield n.value}}}()}catch(BJ){return Promise.reject(BJ)}}function Ur(){return new Uint8Array(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)}function jr(){return new Uint8Array(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)}function Hr(e,t){null==t&&(t=e.reduce(((e,t)=>e+t.length),0));const n=jr(t);let r=0;for(const i of e)n.set(i,r),r+=i.length;return n}function zr(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0}const Vr=Symbol.for("@achingbrain/uint8arraylist");function qr(e,t){if(null==t||t<0)throw new RangeError("index is out of bounds");let n=0;for(const r of e){const e=n+r.byteLength;if(t<e)return{buf:r,index:t-n};n=e}throw new RangeError("index is out of bounds")}function Gr(e){return Boolean(null===e||void 0===e?void 0:e[Vr])}class Kr{constructor(){Dr(this,"bufs",void 0),Dr(this,"length",void 0),Dr(this,Vr,!0),this.bufs=[],this.length=0;for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.length>0&&this.appendAll(t)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.appendAll(t)}appendAll(e){let t=0;for(const n of e)if(n instanceof Uint8Array)t+=n.byteLength,this.bufs.push(n);else{if(!Gr(n))throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");t+=n.byteLength,this.bufs.push(...n.bufs)}this.length+=t}prepend(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.prependAll(t)}prependAll(e){let t=0;for(const n of e.reverse())if(n instanceof Uint8Array)t+=n.byteLength,this.bufs.unshift(n);else{if(!Gr(n))throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");t+=n.byteLength,this.bufs.unshift(...n.bufs)}this.length+=t}get(e){const t=qr(this.bufs,e);return t.buf[t.index]}set(e,t){const n=qr(this.bufs,e);n.buf[n.index]=t}write(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(e instanceof Uint8Array)for(let n=0;n<e.length;n++)this.set(t+n,e[n]);else{if(!Gr(e))throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList");for(let n=0;n<e.length;n++)this.set(t+n,e.get(n))}}consume(e){if(e=Math.trunc(e),!(Number.isNaN(e)||e<=0)){if(e===this.byteLength)return this.bufs=[],void(this.length=0);for(;this.bufs.length>0;){if(!(e>=this.bufs[0].byteLength)){this.bufs[0]=this.bufs[0].subarray(e),this.length-=e;break}e-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift()}}}slice(e,t){const{bufs:n,length:r}=this._subList(e,t);return Hr(n,r)}subarray(e,t){const{bufs:n,length:r}=this._subList(e,t);return 1===n.length?n[0]:Hr(n,r)}sublist(e,t){const{bufs:n,length:r}=this._subList(e,t),i=new Kr;return i.length=r,i.bufs=[...n],i}_subList(e,t){var n,r;if(e=null!==(n=e)&&void 0!==n?n:0,t=null!==(r=t)&&void 0!==r?r:this.length,e<0&&(e=this.length+e),t<0&&(t=this.length+t),e<0||t>this.length)throw new RangeError("index is out of bounds");if(e===t)return{bufs:[],length:0};if(0===e&&t===this.length)return{bufs:this.bufs,length:this.length};const i=[];let o=0;for(let s=0;s<this.bufs.length;s++){const n=this.bufs[s],r=o,a=r+n.byteLength;if(o=a,e>=a)continue;const c=e>=r&&e<a,l=t>r&&t<=a;if(c&&l){if(e===r&&t===a){i.push(n);break}const o=e-r;i.push(n.subarray(o,o+(t-e)));break}if(c){if(0===e){i.push(n);continue}i.push(n.subarray(e-r))}else{if(l){if(t===a){i.push(n);break}i.push(n.subarray(0,t-r));break}i.push(n)}}return{bufs:i,length:t-e}}indexOf(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!Gr(e)&&!(e instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');const r=e instanceof Uint8Array?e:e.subarray();if(n=Number(null!==(t=n)&&void 0!==t?t:0),isNaN(n)&&(n=0),n<0&&(n=this.length+n),n<0&&(n=0),0===e.length)return n>this.length?this.length:n;const i=r.byteLength;if(0===i)throw new TypeError("search must be at least 1 byte long");const o=new Int32Array(256);for(let u=0;u<256;u++)o[u]=-1;for(let u=0;u<i;u++)o[r[u]]=u;const s=o,a=this.byteLength-r.byteLength,c=r.byteLength-1;let l;for(let u=n;u<=a;u+=l){l=0;for(let e=c;e>=0;e--){const t=this.get(u+e);if(r[e]!==t){l=Math.max(1,e-s[t]);break}}if(0===l)return u}return-1}getInt8(e){const t=this.subarray(e,e+1);return new DataView(t.buffer,t.byteOffset,t.byteLength).getInt8(0)}setInt8(e,t){const n=jr(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,t),this.write(n,e)}getInt16(e,t){const n=this.subarray(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,t)}setInt16(e,t,n){const r=Ur(2);new DataView(r.buffer,r.byteOffset,r.byteLength).setInt16(0,t,n),this.write(r,e)}getInt32(e,t){const n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,t)}setInt32(e,t,n){const r=Ur(4);new DataView(r.buffer,r.byteOffset,r.byteLength).setInt32(0,t,n),this.write(r,e)}getBigInt64(e,t){const n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,t)}setBigInt64(e,t,n){const r=Ur(8);new DataView(r.buffer,r.byteOffset,r.byteLength).setBigInt64(0,t,n),this.write(r,e)}getUint8(e){const t=this.subarray(e,e+1);return new DataView(t.buffer,t.byteOffset,t.byteLength).getUint8(0)}setUint8(e,t){const n=jr(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,t),this.write(n,e)}getUint16(e,t){const n=this.subarray(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,t)}setUint16(e,t,n){const r=Ur(2);new DataView(r.buffer,r.byteOffset,r.byteLength).setUint16(0,t,n),this.write(r,e)}getUint32(e,t){const n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,t)}setUint32(e,t,n){const r=Ur(4);new DataView(r.buffer,r.byteOffset,r.byteLength).setUint32(0,t,n),this.write(r,e)}getBigUint64(e,t){const n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,t)}setBigUint64(e,t,n){const r=Ur(8);new DataView(r.buffer,r.byteOffset,r.byteLength).setBigUint64(0,t,n),this.write(r,e)}getFloat32(e,t){const n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,t)}setFloat32(e,t,n){const r=Ur(4);new DataView(r.buffer,r.byteOffset,r.byteLength).setFloat32(0,t,n),this.write(r,e)}getFloat64(e,t){const n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,t)}setFloat64(e,t,n){const r=Ur(8);new DataView(r.buffer,r.byteOffset,r.byteLength).setFloat64(0,t,n),this.write(r,e)}equals(e){if(null==e)return!1;if(!(e instanceof Kr))return!1;if(e.bufs.length!==this.bufs.length)return!1;for(let t=0;t<this.bufs.length;t++)if(!zr(this.bufs[t],e.bufs[t]))return!1;return!0}static fromUint8Arrays(e,t){const n=new Kr;return n.bufs=e,null==t&&(t=e.reduce(((e,t)=>e+t.byteLength),0)),n.length=t,n}}const Wr=function(){var e;const t=null!==(e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).chunkSize)&&void 0!==e?e:262144;return async function*(e){let n=new Kr,r=0,i=!1;for await(const o of e)for(n.append(o),r+=o.length;r>=t;)if(yield n.slice(0,t),i=!0,t===n.length)n=new Kr,r=0;else{const e=new Kr;e.append(n.sublist(t)),n=e,r-=t}(!i||r>0)&&(yield n.subarray(0,r))}},Qr=new Uint8Array(0);function Yr(e){const t=e.match(/../g);return null!=t?new Uint8Array(t.map((e=>parseInt(e,16)))):Qr}function Zr(e){if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}var Jr=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==n[s])throw new TypeError(o+" is ambiguous");n[s]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var r=0,i=0;e[t]===c;)r++,t++;for(var o=(e.length-t)*l+1>>>0,s=new Uint8Array(o);e[t];){var u=n[e.charCodeAt(t)];if(255===u)return;for(var d=0,h=o-1;(0!==u||d<i)&&-1!==h;h--,d++)u+=a*s[h]>>>0,s[h]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=d,t++}if(" "!==e[t]){for(var f=o-i;f!==o&&0===s[f];)f++;for(var p=new Uint8Array(r+(o-f)),g=r;f!==o;)p[g++]=s[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,o=t.length;i!==o&&0===t[i];)i++,n++;for(var s=(o-i)*u+1>>>0,l=new Uint8Array(s);i!==o;){for(var d=t[i],h=0,f=s-1;(0!==d||h<r)&&-1!==f;f--,h++)d+=256*l[f]>>>0,l[f]=d%a>>>0,d=d/a>>>0;if(0!==d)throw new Error("Non-zero carry");r=h,i++}for(var p=s-r;p!==s&&0===l[p];)p++;for(var g=c.repeat(n);p<s;++p)g+=e.charAt(l[p]);return g},decodeUnsafe:d,decode:function(e){var n=d(e);if(n)return n;throw new Error("Non-".concat(t," character"))}}};const Xr=Jr;class $r{constructor(e,t,n){Dr(this,"name",void 0),Dr(this,"prefix",void 0),Dr(this,"baseEncode",void 0),this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return"".concat(this.prefix).concat(this.baseEncode(e));throw Error("Unknown type, must be binary type")}}class ei{constructor(e,t,n){if(Dr(this,"name",void 0),Dr(this,"prefix",void 0),Dr(this,"baseDecode",void 0),Dr(this,"prefixCodePoint",void 0),this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error("Unable to decode multibase string ".concat(JSON.stringify(e),", ").concat(this.name," decoder only supports inputs prefixed with ").concat(this.prefix));return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return ni(this,e)}}class ti{constructor(e){Dr(this,"decoders",void 0),this.decoders=e}or(e){return ni(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(null!=n)return n.decode(e);throw RangeError("Unable to decode multibase string ".concat(JSON.stringify(e),", only inputs prefixed with ").concat(Object.keys(this.decoders)," are supported"))}}function ni(e,t){var n,r;return new ti({...null!==(n=e.decoders)&&void 0!==n?n:{[e.prefix]:e},...null!==(r=t.decoders)&&void 0!==r?r:{[t.prefix]:t}})}class ri{constructor(e,t,n,r){Dr(this,"name",void 0),Dr(this,"prefix",void 0),Dr(this,"baseEncode",void 0),Dr(this,"baseDecode",void 0),Dr(this,"encoder",void 0),Dr(this,"decoder",void 0),this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=r,this.encoder=new $r(e,t,n),this.decoder=new ei(e,t,r)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}function ii(e){let{name:t,prefix:n,encode:r,decode:i}=e;return new ri(t,n,r,i)}function oi(e){let{name:t,prefix:n,alphabet:r}=e;const{encode:i,decode:o}=Xr(r,t);return ii({prefix:n,name:t,encode:i,decode:e=>Zr(o(e))})}function si(e){let{name:t,prefix:n,bitsPerChar:r,alphabet:i}=e;return ii({prefix:n,name:t,encode:e=>function(e,t,n){const r="="===t[t.length-1],i=(1<<n)-1;let o="",s=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],s+=8;s>n;)s-=n,o+=t[i&a>>s];if(0!==s&&(o+=t[i&a<<n-s]),r)for(;0!==(o.length*n&7);)o+="=";return o}(e,i,r),decode:e=>function(e,t,n,r){const i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let o=e.length;for(;"="===e[o-1];)--o;const s=new Uint8Array(o*n/8|0);let a=0,c=0,l=0;for(let u=0;u<o;++u){const t=i[e[u]];if(void 0===t)throw new SyntaxError("Non-".concat(r," character"));c=c<<n|t,a+=n,a>=8&&(a-=8,s[l++]=255&c>>a)}if(a>=n||0!==(255&c<<8-a))throw new SyntaxError("Unexpected end of data");return s}(e,i,r,t)})}const ai=si({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),ci=si({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),li=si({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),ui=si({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),di=si({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),hi=si({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),fi=si({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),pi=si({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),gi=si({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),mi=oi({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),vi=oi({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var yi=function e(t,n,r){n=n||[];var i=r=r||0;for(;t>=Ei;)n[r++]=255&t|wi,t/=128;for(;t&bi;)n[r++]=255&t|wi,t>>>=7;return n[r]=0|t,e.bytes=r-i+1,n},wi=128,bi=-128,Ei=Math.pow(2,31);var ki=function e(t,n){var r,i=0,o=0,s=n=n||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");r=t[s++],i+=o<28?(r&Si)<<o:(r&Si)*Math.pow(2,o),o+=7}while(r>=Ai);return e.bytes=s-n,i},Ai=128,Si=127;var xi=Math.pow(2,7),_i=Math.pow(2,14),Ii=Math.pow(2,21),Ri=Math.pow(2,28),Ci=Math.pow(2,35),Ti=Math.pow(2,42),Pi=Math.pow(2,49),Ni=Math.pow(2,56),Bi=Math.pow(2,63);const Di={encode:yi,decode:ki,encodingLength:function(e){return e<xi?1:e<_i?2:e<Ii?3:e<Ri?4:e<Ci?5:e<Ti?6:e<Pi?7:e<Ni?8:e<Bi?9:10}};function Oi(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return[Di.decode(e,t),Di.decode.bytes]}function Li(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Di.encode(e,t,n),t}function Mi(e){return Di.encodingLength(e)}function Fi(e,t){const n=t.byteLength,r=Mi(e),i=r+Mi(n),o=new Uint8Array(i+n);return Li(e,o,0),Li(n,o,r),o.set(t,i),new ji(e,n,t,o)}function Ui(e){const t=Zr(e),[n,r]=Oi(t),[i,o]=Oi(t.subarray(r)),s=t.subarray(r+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new ji(n,i,s,t)}class ji{constructor(e,t,n,r){Dr(this,"code",void 0),Dr(this,"size",void 0),Dr(this,"digest",void 0),Dr(this,"bytes",void 0),this.code=e,this.size=t,this.digest=n,this.bytes=r}}function Hi(e,t){const{bytes:n,version:r}=e;return 0===r?function(e,t,n){const{prefix:r}=n;if(r!==mi.prefix)throw Error("Cannot string encode V0 in ".concat(n.name," encoding"));const i=t.get(r);if(null==i){const i=n.encode(e).slice(1);return t.set(r,i),i}return i}(n,Vi(e),null!==t&&void 0!==t?t:mi.encoder):function(e,t,n){const{prefix:r}=n,i=t.get(r);if(null==i){const i=n.encode(e);return t.set(r,i),i}return i}(n,Vi(e),null!==t&&void 0!==t?t:ai.encoder)}const zi=new WeakMap;function Vi(e){const t=zi.get(e);if(null==t){const t=new Map;return zi.set(e,t),t}return t}class qi{constructor(e,t,n,r){Dr(this,"code",void 0),Dr(this,"version",void 0),Dr(this,"multihash",void 0),Dr(this,"bytes",void 0),Dr(this,"/",void 0),Dr(this,Symbol.toStringTag,"CID"),this.code=t,this.version=e,this.multihash=n,this.bytes=r,this["/"]=r}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==Gi)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==Ki)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return qi.createV0(t)}default:throw Error("Can not convert CID version ".concat(this.version," to version 0. This is a bug please report"))}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=Fi(e,t);return qi.createV1(this.code,n)}case 1:return this;default:throw Error("Can not convert CID version ".concat(this.version," to version 1. This is a bug please report"))}}equals(e){return qi.equals(this,e)}static equals(e,t){const n=t;return null!=n&&e.code===n.code&&e.version===n.version&&function(e,t){if(e===t)return!0;{const n=t;return e.code===n.code&&e.size===n.size&&n.bytes instanceof Uint8Array&&function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0}(e.bytes,n.bytes)}}(e.multihash,n.multihash)}toString(e){return Hi(this,e)}toJSON(){return{"/":Hi(this)}}link(){return this}[Symbol.for("nodejs.util.inspect.custom")](){return"CID(".concat(this.toString(),")")}static asCID(e){if(null==e)return null;const t=e;if(t instanceof qi)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:n,multihash:r,bytes:i}=t;return new qi(e,n,r,null!==i&&void 0!==i?i:Wi(e,n,r.bytes))}if(!0===t[Qi]){const{version:e,multihash:n,code:r}=t,i=Ui(n);return qi.create(e,r,i)}return null}static create(e,t,n){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==Gi)throw new Error("Version 0 CID must use dag-pb (code: ".concat(Gi,") block encoding"));return new qi(e,t,n,n.bytes);case 1:{const r=Wi(e,t,n.bytes);return new qi(e,t,n,r)}default:throw new Error("Invalid version")}}static createV0(e){return qi.create(0,Gi,e)}static createV1(e,t){return qi.create(1,e,t)}static decode(e){const[t,n]=qi.decodeFirst(e);if(0!==n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=qi.inspectBytes(e),n=t.size-t.multihashSize,r=Zr(e.subarray(n,n+t.multihashSize));if(r.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=r.subarray(t.multihashSize-t.digestSize),o=new ji(t.multihashCode,t.digestSize,i,r);return[0===t.version?qi.createV0(o):qi.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[n,r]=Oi(e.subarray(t));return t+=r,n};let r=n(),i=Gi;if(18===r?(r=0,t=0):i=n(),0!==r&&1!==r)throw new RangeError("Invalid CID version ".concat(r));const o=t,s=n(),a=n(),c=t+a;return{version:r,codec:i,multihashCode:s,digestSize:a,multihashSize:c-o,size:c}}static parse(e,t){const[n,r]=function(e,t){switch(e[0]){case"Q":{const n=null!==t&&void 0!==t?t:mi;return[mi.prefix,n.decode("".concat(mi.prefix).concat(e))]}case mi.prefix:{const n=null!==t&&void 0!==t?t:mi;return[mi.prefix,n.decode(e)]}case ai.prefix:{const n=null!==t&&void 0!==t?t:ai;return[ai.prefix,n.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}(e,t),i=qi.decode(r);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return Vi(i).set(n,e),i}}const Gi=112,Ki=18;function Wi(e,t,n){const r=Mi(e),i=r+Mi(t),o=new Uint8Array(i+n.byteLength);return Li(e,o,0),Li(t,o,r),o.set(n,i),o}const Qi=Symbol.for("@ipld/js-cid/CID"),Yi=new TextDecoder;function Zi(e,t){let n=0;for(let r=0;;r+=7){if(r>=64)throw new Error("protobuf: varint overflow");if(t>=e.length)throw new Error("protobuf: unexpected end of data");const i=e[t++];if(n+=r<28?(127&i)<<r:(127&i)*2**r,i<128)break}return[n,t]}function Ji(e,t){let n;[n,t]=Zi(e,t);const r=t+n;if(n<0||r<0)throw new Error("protobuf: invalid length");if(r>e.length)throw new Error("protobuf: unexpected end of data");return[e.subarray(t,r),r]}function Xi(e,t){let n;return[n,t]=Zi(e,t),[7&n,n>>3,t]}function $i(e){const t={},n=e.length;let r=0;for(;r<n;){let n,i;if([n,i,r]=Xi(e,r),1===i){if(t.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(2!==n)throw new Error("protobuf: (PBLink) wrong wireType (".concat(n,") for Hash"));if(void 0!==t.Name)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(void 0!==t.Tsize)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[t.Hash,r]=Ji(e,r)}else if(2===i){if(void 0!==t.Name)throw new Error("protobuf: (PBLink) duplicate Name section");if(2!==n)throw new Error("protobuf: (PBLink) wrong wireType (".concat(n,") for Name"));if(void 0!==t.Tsize)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let i;[i,r]=Ji(e,r),t.Name=Yi.decode(i)}else{if(3!==i)throw new Error("protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ".concat(i));if(void 0!==t.Tsize)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(0!==n)throw new Error("protobuf: (PBLink) wrong wireType (".concat(n,") for Tsize"));[t.Tsize,r]=Zi(e,r)}}if(r>n)throw new Error("protobuf: (PBLink) unexpected end of data");return t}const eo=new TextEncoder,to=2**32,no=2**31;function ro(e,t){let n=t.length;if("number"===typeof e.Tsize){if(e.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(e.Tsize))throw new Error("Tsize too large for encoding");n=so(t,n,e.Tsize)-1,t[n]=24}if("string"===typeof e.Name){const r=eo.encode(e.Name);n-=r.length,t.set(r,n),n=so(t,n,r.length)-1,t[n]=18}return e.Hash&&(n-=e.Hash.length,t.set(e.Hash,n),n=so(t,n,e.Hash.length)-1,t[n]=10),t.length-n}function io(e){const t=function(e){let t=0;if(e.Data){const n=e.Data.length;t+=1+n+ao(n)}if(e.Links)for(const n of e.Links){const e=oo(n);t+=1+e+ao(e)}return t}(e),n=new Uint8Array(t);let r=t;if(e.Data&&(r-=e.Data.length,n.set(e.Data,r),r=so(n,r,e.Data.length)-1,n[r]=10),e.Links)for(let i=e.Links.length-1;i>=0;i--){const t=ro(e.Links[i],n.subarray(0,r));r-=t,r=so(n,r,t)-1,n[r]=18}return n}function oo(e){let t=0;if(e.Hash){const n=e.Hash.length;t+=1+n+ao(n)}if("string"===typeof e.Name){const n=eo.encode(e.Name).length;t+=1+n+ao(n)}return"number"===typeof e.Tsize&&(t+=1+ao(e.Tsize)),t}function so(e,t,n){const r=t-=ao(n);for(;n>=no;)e[t++]=127&n|128,n/=128;for(;n>=128;)e[t++]=127&n|128,n>>>=7;return e[t]=n,r}function ao(e){return e%2===0&&e++,Math.floor((function(e){let t=0;e>=to&&(e=Math.floor(e/to),t=32);e>=65536&&(e>>>=16,t+=16);e>=256&&(e>>>=8,t+=8);return t+co[e]}(e)+6)/7)}const co=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],lo=["Data","Links"],uo=["Hash","Name","Tsize"],ho=new TextEncoder;function fo(e,t){if(e===t)return 0;const n=e.Name?ho.encode(e.Name):[],r=t.Name?ho.encode(t.Name):[];let i=n.length,o=r.length;for(let s=0,a=Math.min(i,o);s<a;++s)if(n[s]!==r[s]){i=n[s],o=r[s];break}return i<o?-1:o<i?1:0}function po(e,t){return!Object.keys(e).some((e=>!t.includes(e)))}function go(e){if("object"===typeof e.asCID){const t=qi.asCID(e);if(!t)throw new TypeError("Invalid DAG-PB form");return{Hash:t}}if("object"!==typeof e||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");const t={};if(e.Hash){let n=qi.asCID(e.Hash);try{n||("string"===typeof e.Hash?n=qi.parse(e.Hash):e.Hash instanceof Uint8Array&&(n=qi.decode(e.Hash)))}catch(BJ){throw new TypeError("Invalid DAG-PB form: ".concat(BJ.message))}n&&(t.Hash=n)}if(!t.Hash)throw new TypeError("Invalid DAG-PB form");return"string"===typeof e.Name&&(t.Name=e.Name),"number"===typeof e.Tsize&&(t.Tsize=e.Tsize),t}function mo(e){if((e instanceof Uint8Array||"string"===typeof e)&&(e={Data:e}),"object"!==typeof e||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");const t={};if(void 0!==e.Data)if("string"===typeof e.Data)t.Data=ho.encode(e.Data);else{if(!(e.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form");t.Data=e.Data}if(void 0!==e.Links){if(!Array.isArray(e.Links))throw new TypeError("Invalid DAG-PB form");t.Links=e.Links.map(go),t.Links.sort(fo)}else t.Links=[];return t}function vo(e){if(!e||"object"!==typeof e||Array.isArray(e)||e instanceof Uint8Array||e["/"]&&e["/"]===e.bytes)throw new TypeError("Invalid DAG-PB form");if(!po(e,lo))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(void 0!==e.Data&&!(e.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be bytes)");if(!Array.isArray(e.Links))throw new TypeError("Invalid DAG-PB form (Links must be a list)");for(let t=0;t<e.Links.length;t++){const n=e.Links[t];if(!n||"object"!==typeof n||Array.isArray(n)||n instanceof Uint8Array||n["/"]&&n["/"]===n.bytes)throw new TypeError("Invalid DAG-PB form (bad link)");if(!po(n,uo))throw new TypeError("Invalid DAG-PB form (extraneous properties on link)");if(void 0===n.Hash)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(null==n.Hash||!n.Hash["/"]||n.Hash["/"]!==n.Hash.bytes)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(void 0!==n.Name&&"string"!==typeof n.Name)throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(void 0!==n.Tsize){if("number"!==typeof n.Tsize||n.Tsize%1!==0)throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(n.Tsize<0)throw new TypeError("Invalid DAG-PB form (link Tsize cannot be negative)")}if(t>0&&-1===fo(n,e.Links[t-1]))throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}function yo(e){return mo({Data:e,Links:arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]})}function wo(e,t,n){return go({Hash:n,Name:e,Tsize:t})}const bo="dag-pb",Eo=112;function ko(e){vo(e);const t={};return e.Links&&(t.Links=e.Links.map((e=>{const t={};return e.Hash&&(t.Hash=e.Hash.bytes),void 0!==e.Name&&(t.Name=e.Name),void 0!==e.Tsize&&(t.Tsize=e.Tsize),t}))),e.Data&&(t.Data=e.Data),io(t)}function Ao(e){const t=function(e){const t=e.length;let n,r,i=0,o=!1;for(;i<t;){let t,s;if([t,s,i]=Xi(e,i),2!==t)throw new Error("protobuf: (PBNode) invalid wireType, expected 2, got ".concat(t));if(1===s){if(r)throw new Error("protobuf: (PBNode) duplicate Data section");[r,i]=Ji(e,i),n&&(o=!0)}else{if(2!==s)throw new Error("protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ".concat(s));{if(o)throw new Error("protobuf: (PBNode) duplicate Links section");let t;n||(n=[]),[t,i]=Ji(e,i),n.push($i(t))}}}if(i>t)throw new Error("protobuf: (PBNode) unexpected end of data");const s={};return r&&(s.Data=r),s.Links=n||[],s}(function(e){return e instanceof ArrayBuffer?new Uint8Array(e,0,e.byteLength):e}(e)),n={};return t.Data&&(n.Data=t.Data),t.Links&&(n.Links=t.Links.map((e=>{const t={};try{t.Hash=qi.decode(e.Hash)}catch(BJ){}if(!t.Hash)throw new Error("Invalid Hash field found in link, expected CID");return void 0!==e.Name&&(t.Name=e.Name),void 0!==e.Tsize&&(t.Tsize=e.Tsize),t}))),n}const So=Math.pow(2,7),xo=Math.pow(2,14),_o=Math.pow(2,21),Io=Math.pow(2,28),Ro=Math.pow(2,35),Co=Math.pow(2,42),To=Math.pow(2,49),Po=128,No=127;function Bo(e){if(e<So)return 1;if(e<xo)return 2;if(e<_o)return 3;if(e<Io)return 4;if(e<Ro)return 5;if(e<Co)return 6;if(e<To)return 7;if(null!=Number.MAX_SAFE_INTEGER&&e>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return 8}function Do(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;switch(Bo(e)){case 8:t[n++]=255&e|Po,e/=128;case 7:t[n++]=255&e|Po,e/=128;case 6:t[n++]=255&e|Po,e/=128;case 5:t[n++]=255&e|Po,e/=128;case 4:t[n++]=255&e|Po,e>>>=7;case 3:t[n++]=255&e|Po,e>>>=7;case 2:t[n++]=255&e|Po,e>>>=7;case 1:t[n++]=255&e,e>>>=7;break;default:throw new Error("unreachable")}return t}function Oo(e,t){let n=e[t],r=0;if(r+=n&No,n<Po)return r;if(n=e[t+1],r+=(n&No)<<7,n<Po)return r;if(n=e[t+2],r+=(n&No)<<14,n<Po)return r;if(n=e[t+3],r+=(n&No)<<21,n<Po)return r;if(n=e[t+4],r+=(n&No)*Io,n<Po)return r;if(n=e[t+5],r+=(n&No)*Ro,n<Po)return r;if(n=e[t+6],r+=(n&No)*Co,n<Po)return r;if(n=e[t+7],r+=(n&No)*To,n<Po)return r;throw new RangeError("Could not decode varint")}function Lo(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return null==t&&(t=jr(Bo(e))),t instanceof Uint8Array?Do(e,t,n):function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;switch(Bo(e)){case 8:t.set(n++,255&e|Po),e/=128;case 7:t.set(n++,255&e|Po),e/=128;case 6:t.set(n++,255&e|Po),e/=128;case 5:t.set(n++,255&e|Po),e/=128;case 4:t.set(n++,255&e|Po),e>>>=7;case 3:t.set(n++,255&e|Po),e>>>=7;case 2:t.set(n++,255&e|Po),e>>>=7;case 1:t.set(n++,255&e),e>>>=7;break;default:throw new Error("unreachable")}return t}(e,t,n)}function Mo(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e instanceof Uint8Array?Oo(e,t):function(e,t){let n=e.get(t),r=0;if(r+=n&No,n<Po)return r;if(n=e.get(t+1),r+=(n&No)<<7,n<Po)return r;if(n=e.get(t+2),r+=(n&No)<<14,n<Po)return r;if(n=e.get(t+3),r+=(n&No)<<21,n<Po)return r;if(n=e.get(t+4),r+=(n&No)*Io,n<Po)return r;if(n=e.get(t+5),r+=(n&No)*Ro,n<Po)return r;if(n=e.get(t+6),r+=(n&No)*Co,n<Po)return r;if(n=e.get(t+7),r+=(n&No)*To,n<Po)return r;throw new RangeError("Could not decode varint")}(e,t)}const Fo=new Float32Array([-0]),Uo=new Uint8Array(Fo.buffer);function jo(e,t,n){Fo[0]=e,t[n]=Uo[0],t[n+1]=Uo[1],t[n+2]=Uo[2],t[n+3]=Uo[3]}const Ho=new Float64Array([-0]),zo=new Uint8Array(Ho.buffer);function Vo(e,t,n){Ho[0]=e,t[n]=zo[0],t[n+1]=zo[1],t[n+2]=zo[2],t[n+3]=zo[3],t[n+4]=zo[4],t[n+5]=zo[5],t[n+6]=zo[6],t[n+7]=zo[7]}const qo=BigInt(Number.MAX_SAFE_INTEGER),Go=BigInt(Number.MIN_SAFE_INTEGER);class Ko{constructor(e,t){Dr(this,"lo",void 0),Dr(this,"hi",void 0),this.lo=0|e,this.hi=0|t}toNumber(){if(!(arguments.length>0&&void 0!==arguments[0]&&arguments[0])&&this.hi>>>31>0){const e=1+~this.lo>>>0;let t=~this.hi>>>0;return 0===e&&(t=t+1>>>0),-(e+4294967296*t)}return this.lo+4294967296*this.hi}toBigInt(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31!==0){const e=1+~this.lo>>>0;let t=~this.hi>>>0;return 0===e&&(t=t+1>>>0),-(BigInt(e)+(BigInt(t)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toString(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.toBigInt(e).toString()}zzEncode(){const e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this}zzDecode(){const e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this}length(){const e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10}static fromBigInt(e){if(0n===e)return Wo;if(e<qo&&e>Go)return this.fromNumber(Number(e));const t=e<0n;t&&(e=-e);let n=e>>32n,r=e-(n<<32n);return t&&(n=0n|~n,r=0n|~r,++r>Qo&&(r=0n,++n>Qo&&(n=0n))),new Ko(Number(r),Number(n))}static fromNumber(e){if(0===e)return Wo;const t=e<0;t&&(e=-e);let n=e>>>0,r=(e-n)/4294967296>>>0;return t&&(r=~r>>>0,n=~n>>>0,++n>4294967295&&(n=0,++r>4294967295&&(r=0))),new Ko(n,r)}static from(e){return"number"===typeof e?Ko.fromNumber(e):"bigint"===typeof e?Ko.fromBigInt(e):"string"===typeof e?Ko.fromBigInt(BigInt(e)):null!=e.low||null!=e.high?new Ko(e.low>>>0,e.high>>>0):Wo}}const Wo=new Ko(0,0);Wo.toBigInt=function(){return 0n},Wo.zzEncode=Wo.zzDecode=function(){return this},Wo.length=function(){return 1};const Qo=4294967296n;function Yo(e,t,n){const r=n;let i,o;for(let s=0;s<e.length;++s)i=e.charCodeAt(s),i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&56320===(64512&(o=e.charCodeAt(s+1)))?(i=65536+((1023&i)<<10)+(1023&o),++s,t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128);return n-r}function Zo(e,t){return RangeError("index out of range: ".concat(e.pos," + ").concat(null!==t&&void 0!==t?t:1," > ").concat(e.len))}function Jo(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}class Xo{constructor(e){Dr(this,"buf",void 0),Dr(this,"pos",void 0),Dr(this,"len",void 0),Dr(this,"_slice",Uint8Array.prototype.subarray),this.buf=e,this.pos=0,this.len=e.length}uint32(){let e=4294967295;if(e=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return e;if((this.pos+=5)>this.len)throw this.pos=this.len,Zo(this,10);return e}int32(){return 0|this.uint32()}sint32(){const e=this.uint32();return e>>>1^-(1&e)}bool(){return 0!==this.uint32()}fixed32(){if(this.pos+4>this.len)throw Zo(this,4);return Jo(this.buf,this.pos+=4)}sfixed32(){if(this.pos+4>this.len)throw Zo(this,4);return 0|Jo(this.buf,this.pos+=4)}float(){if(this.pos+4>this.len)throw Zo(this,4);const e=function(e,t){return Uo[0]=e[t],Uo[1]=e[t+1],Uo[2]=e[t+2],Uo[3]=e[t+3],Fo[0]}(this.buf,this.pos);return this.pos+=4,e}double(){if(this.pos+8>this.len)throw Zo(this,4);const e=function(e,t){return zo[0]=e[t],zo[1]=e[t+1],zo[2]=e[t+2],zo[3]=e[t+3],zo[4]=e[t+4],zo[5]=e[t+5],zo[6]=e[t+6],zo[7]=e[t+7],Ho[0]}(this.buf,this.pos);return this.pos+=8,e}bytes(){const e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw Zo(this,e);return this.pos+=e,t===n?new Uint8Array(0):this.buf.subarray(t,n)}string(){const e=this.bytes();return function(e,t,n){if(n-t<1)return"";let r;const i=[];let o,s=0;for(;t<n;){var a;o=e[t++],o<128?i[s++]=o:o>191&&o<224?i[s++]=(31&o)<<6|63&e[t++]:o>239&&o<365?(o=((7&o)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,i[s++]=55296+(o>>10),i[s++]=56320+(1023&o)):i[s++]=(15&o)<<12|(63&e[t++])<<6|63&e[t++],s>8191&&((null!==(a=r)&&void 0!==a?a:r=[]).push(String.fromCharCode.apply(String,i)),s=0)}return null!=r?(s>0&&r.push(String.fromCharCode.apply(String,i.slice(0,s))),r.join("")):String.fromCharCode.apply(String,i.slice(0,s))}(e,0,e.length)}skip(e){if("number"===typeof e){if(this.pos+e>this.len)throw Zo(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw Zo(this)}while(0!==(128&this.buf[this.pos++]));return this}skipType(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!==(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type ".concat(e," at offset ").concat(this.pos))}return this}readLongVarint(){const e=new Ko(0,0);let t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw Zo(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw Zo(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}readFixed64(){if(this.pos+8>this.len)throw Zo(this,8);const e=Jo(this.buf,this.pos+=4),t=Jo(this.buf,this.pos+=4);return new Ko(e,t)}int64(){return this.readLongVarint().toBigInt()}int64Number(){return this.readLongVarint().toNumber()}int64String(){return this.readLongVarint().toString()}uint64(){return this.readLongVarint().toBigInt(!0)}uint64Number(){const e=Oo(this.buf,this.pos);return this.pos+=Bo(e),e}uint64String(){return this.readLongVarint().toString(!0)}sint64(){return this.readLongVarint().zzDecode().toBigInt()}sint64Number(){return this.readLongVarint().zzDecode().toNumber()}sint64String(){return this.readLongVarint().zzDecode().toString()}fixed64(){return this.readFixed64().toBigInt()}fixed64Number(){return this.readFixed64().toNumber()}fixed64String(){return this.readFixed64().toString()}sfixed64(){return this.readFixed64().toBigInt()}sfixed64Number(){return this.readFixed64().toNumber()}sfixed64String(){return this.readFixed64().toString()}}function $o(e,t,n){const r=function(e){return new Xo(e instanceof Uint8Array?e:e.subarray())}(e);return t.decode(r,void 0,n)}const es=oi({prefix:"9",name:"base10",alphabet:"0123456789"}),ts=si({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),ns=si({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),rs=si({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),is=Array.from("\ud83d\ude80\ud83e\ude90\u2604\ud83d\udef0\ud83c\udf0c\ud83c\udf11\ud83c\udf12\ud83c\udf13\ud83c\udf14\ud83c\udf15\ud83c\udf16\ud83c\udf17\ud83c\udf18\ud83c\udf0d\ud83c\udf0f\ud83c\udf0e\ud83d\udc09\u2600\ud83d\udcbb\ud83d\udda5\ud83d\udcbe\ud83d\udcbf\ud83d\ude02\u2764\ud83d\ude0d\ud83e\udd23\ud83d\ude0a\ud83d\ude4f\ud83d\udc95\ud83d\ude2d\ud83d\ude18\ud83d\udc4d\ud83d\ude05\ud83d\udc4f\ud83d\ude01\ud83d\udd25\ud83e\udd70\ud83d\udc94\ud83d\udc96\ud83d\udc99\ud83d\ude22\ud83e\udd14\ud83d\ude06\ud83d\ude44\ud83d\udcaa\ud83d\ude09\u263a\ud83d\udc4c\ud83e\udd17\ud83d\udc9c\ud83d\ude14\ud83d\ude0e\ud83d\ude07\ud83c\udf39\ud83e\udd26\ud83c\udf89\ud83d\udc9e\u270c\u2728\ud83e\udd37\ud83d\ude31\ud83d\ude0c\ud83c\udf38\ud83d\ude4c\ud83d\ude0b\ud83d\udc97\ud83d\udc9a\ud83d\ude0f\ud83d\udc9b\ud83d\ude42\ud83d\udc93\ud83e\udd29\ud83d\ude04\ud83d\ude00\ud83d\udda4\ud83d\ude03\ud83d\udcaf\ud83d\ude48\ud83d\udc47\ud83c\udfb6\ud83d\ude12\ud83e\udd2d\u2763\ud83d\ude1c\ud83d\udc8b\ud83d\udc40\ud83d\ude2a\ud83d\ude11\ud83d\udca5\ud83d\ude4b\ud83d\ude1e\ud83d\ude29\ud83d\ude21\ud83e\udd2a\ud83d\udc4a\ud83e\udd73\ud83d\ude25\ud83e\udd24\ud83d\udc49\ud83d\udc83\ud83d\ude33\u270b\ud83d\ude1a\ud83d\ude1d\ud83d\ude34\ud83c\udf1f\ud83d\ude2c\ud83d\ude43\ud83c\udf40\ud83c\udf37\ud83d\ude3b\ud83d\ude13\u2b50\u2705\ud83e\udd7a\ud83c\udf08\ud83d\ude08\ud83e\udd18\ud83d\udca6\u2714\ud83d\ude23\ud83c\udfc3\ud83d\udc90\u2639\ud83c\udf8a\ud83d\udc98\ud83d\ude20\u261d\ud83d\ude15\ud83c\udf3a\ud83c\udf82\ud83c\udf3b\ud83d\ude10\ud83d\udd95\ud83d\udc9d\ud83d\ude4a\ud83d\ude39\ud83d\udde3\ud83d\udcab\ud83d\udc80\ud83d\udc51\ud83c\udfb5\ud83e\udd1e\ud83d\ude1b\ud83d\udd34\ud83d\ude24\ud83c\udf3c\ud83d\ude2b\u26bd\ud83e\udd19\u2615\ud83c\udfc6\ud83e\udd2b\ud83d\udc48\ud83d\ude2e\ud83d\ude46\ud83c\udf7b\ud83c\udf43\ud83d\udc36\ud83d\udc81\ud83d\ude32\ud83c\udf3f\ud83e\udde1\ud83c\udf81\u26a1\ud83c\udf1e\ud83c\udf88\u274c\u270a\ud83d\udc4b\ud83d\ude30\ud83e\udd28\ud83d\ude36\ud83e\udd1d\ud83d\udeb6\ud83d\udcb0\ud83c\udf53\ud83d\udca2\ud83e\udd1f\ud83d\ude41\ud83d\udea8\ud83d\udca8\ud83e\udd2c\u2708\ud83c\udf80\ud83c\udf7a\ud83e\udd13\ud83d\ude19\ud83d\udc9f\ud83c\udf31\ud83d\ude16\ud83d\udc76\ud83e\udd74\u25b6\u27a1\u2753\ud83d\udc8e\ud83d\udcb8\u2b07\ud83d\ude28\ud83c\udf1a\ud83e\udd8b\ud83d\ude37\ud83d\udd7a\u26a0\ud83d\ude45\ud83d\ude1f\ud83d\ude35\ud83d\udc4e\ud83e\udd32\ud83e\udd20\ud83e\udd27\ud83d\udccc\ud83d\udd35\ud83d\udc85\ud83e\uddd0\ud83d\udc3e\ud83c\udf52\ud83d\ude17\ud83e\udd11\ud83c\udf0a\ud83e\udd2f\ud83d\udc37\u260e\ud83d\udca7\ud83d\ude2f\ud83d\udc86\ud83d\udc46\ud83c\udfa4\ud83d\ude47\ud83c\udf51\u2744\ud83c\udf34\ud83d\udca3\ud83d\udc38\ud83d\udc8c\ud83d\udccd\ud83e\udd40\ud83e\udd22\ud83d\udc45\ud83d\udca1\ud83d\udca9\ud83d\udc50\ud83d\udcf8\ud83d\udc7b\ud83e\udd10\ud83e\udd2e\ud83c\udfbc\ud83e\udd75\ud83d\udea9\ud83c\udf4e\ud83c\udf4a\ud83d\udc7c\ud83d\udc8d\ud83d\udce3\ud83e\udd42"),os=is.reduce(((e,t,n)=>(e[n]=t,e)),[]),ss=is.reduce(((e,t,n)=>(e[t.codePointAt(0)]=n,e)),[]);const as=ii({prefix:"\ud83d\ude80",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=os[t]),"")},decode:function(e){const t=[];for(const n of e){const e=ss[n.codePointAt(0)];if(void 0===e)throw new Error("Non-base256emoji character: ".concat(n));t.push(e)}return new Uint8Array(t)}}),cs=oi({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),ls=oi({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),us=si({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),ds=si({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),hs=si({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),fs=si({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),ps=si({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),gs=ii({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>function(e){return(new TextEncoder).encode(e)}(e)}),ms=new TextEncoder,vs=new TextDecoder,ys="json",ws=512;function bs(e){return ms.encode(JSON.stringify(e))}function Es(e){return JSON.parse(vs.decode(e))}const ks="raw",As=85;function Ss(e){return Zr(e)}function xs(e){return Zr(e)}const _s=Zr;const Is={code:0,name:"identity",encode:_s,digest:function(e){return Fi(0,_s(e))}};function Rs(e){let{name:t,code:n,encode:r}=e;return new Cs(t,n,r)}class Cs{constructor(e,t,n){Dr(this,"name",void 0),Dr(this,"code",void 0),Dr(this,"encode",void 0),this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Fi(this.code,t):t.then((e=>Fi(this.code,e)))}throw Error("Unknown type, must be binary type")}}function Ts(e){return async t=>new Uint8Array(await crypto.subtle.digest(e,t))}const Ps=Rs({name:"sha2-256",code:18,encode:Ts("SHA-256")}),Ns=Rs({name:"sha2-512",code:19,encode:Ts("SHA-512")}),Bs={...d,...s,...u,...i,...o,...e,...c,...t,...l,...a};function Ds(e,t,n,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:r}}}const Os=Ds("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),Ls=Ds("ascii","a",(e=>{let t="a";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}),(e=>{const t=jr((e=e.substring(1)).length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t})),Ms={utf8:Os,"utf-8":Os,hex:Bs.base16,latin1:Ls,ascii:Ls,binary:Ls,...Bs};function Fs(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8";const n=Ms[t];if(null==n)throw new Error('Unsupported encoding "'.concat(t,'"'));return n.decoder.decode("".concat(n.prefix).concat(e))}class Us{constructor(e,t,n){Dr(this,"fn",void 0),Dr(this,"len",void 0),Dr(this,"next",void 0),Dr(this,"val",void 0),this.fn=e,this.len=t,this.next=void 0,this.val=n}}function js(){}class Hs{constructor(e){Dr(this,"head",void 0),Dr(this,"tail",void 0),Dr(this,"len",void 0),Dr(this,"next",void 0),this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}}const zs=function(e){const t=null!==e&&void 0!==e?e:8192,n=t>>>1;let r,i=t;return function(e){if(e<1||e>n)return jr(e);i+e>t&&(r=jr(t),i=0);const o=r.subarray(i,i+=e);return 0!==(7&i)&&(i=1+(7|i)),o}}();class Vs{constructor(){Dr(this,"len",void 0),Dr(this,"head",void 0),Dr(this,"tail",void 0),Dr(this,"states",void 0),this.len=0,this.head=new Us(js,0,0),this.tail=this.head,this.states=null}_push(e,t,n){return this.tail=this.tail.next=new Us(e,t,n),this.len+=t,this}uint32(e){return this.len+=(this.tail=this.tail.next=new Ks((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this}int32(e){return e<0?this._push(Ws,10,Ko.fromNumber(e)):this.uint32(e)}sint32(e){return this.uint32((e<<1^e>>31)>>>0)}uint64(e){const t=Ko.fromBigInt(e);return this._push(Ws,t.length(),t)}uint64Number(e){return this._push(Do,Bo(e),e)}uint64String(e){return this.uint64(BigInt(e))}int64(e){return this.uint64(e)}int64Number(e){return this.uint64Number(e)}int64String(e){return this.uint64String(e)}sint64(e){const t=Ko.fromBigInt(e).zzEncode();return this._push(Ws,t.length(),t)}sint64Number(e){const t=Ko.fromNumber(e).zzEncode();return this._push(Ws,t.length(),t)}sint64String(e){return this.sint64(BigInt(e))}bool(e){return this._push(qs,1,e?1:0)}fixed32(e){return this._push(Qs,4,e>>>0)}sfixed32(e){return this.fixed32(e)}fixed64(e){const t=Ko.fromBigInt(e);return this._push(Qs,4,t.lo)._push(Qs,4,t.hi)}fixed64Number(e){const t=Ko.fromNumber(e);return this._push(Qs,4,t.lo)._push(Qs,4,t.hi)}fixed64String(e){return this.fixed64(BigInt(e))}sfixed64(e){return this.fixed64(e)}sfixed64Number(e){return this.fixed64Number(e)}sfixed64String(e){return this.fixed64String(e)}float(e){return this._push(jo,4,e)}double(e){return this._push(Vo,8,e)}bytes(e){const t=e.length>>>0;return 0===t?this._push(qs,1,0):this.uint32(t)._push(Ys,t,e)}string(e){const t=function(e){let t=0,n=0;for(let r=0;r<e.length;++r)n=e.charCodeAt(r),n<128?t+=1:n<2048?t+=2:55296===(64512&n)&&56320===(64512&e.charCodeAt(r+1))?(++r,t+=4):t+=3;return t}(e);return 0!==t?this.uint32(t)._push(Yo,t,e):this._push(qs,1,0)}fork(){return this.states=new Hs(this),this.head=this.tail=new Us(js,0,0),this.len=0,this}reset(){return null!=this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Us(js,0,0),this.len=0),this}ldelim(){const e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),0!==n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this}finish(){let e=this.head.next;const t=(n=this.len,null!=globalThis.Buffer?jr(n):zs(n));var n;let r=0;for(;null!=e;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t}}function qs(e,t,n){t[n]=255&e}function Gs(e,t,n){for(;e>127;)t[n++]=127&e|128,e>>>=7;t[n]=e}class Ks extends Us{constructor(e,t){super(Gs,e,t),Dr(this,"next",void 0),this.next=void 0}}function Ws(e,t,n){for(;0!==e.hi;)t[n++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[n++]=127&e.lo|128,e.lo=e.lo>>>7;t[n++]=e.lo}function Qs(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}function Ys(e,t,n){t.set(e,n)}function Zs(e,t,n){t.set(e,n)}function Js(e,t,n){e.length<40?Yo(e,t,n):null!=t.utf8Write?t.utf8Write(e,n):t.set(Fs(e),n)}function Xs(e,t){const n=new Vs;return t.encode(e,n,{lengthDelimited:!1}),n.finish()}var $s,ea,ta,na;function ra(e,t,n,r){return{name:e,type:t,encode:n,decode:r}}function ia(e){function t(t){if(null==e[t.toString()])throw new Error("Invalid enum value");return e[t]}return ra("enum",$s.VARINT,(function(e,n){const r=t(e);n.int32(r)}),(function(e){return t(e.int32())}))}function oa(e,t){return ra("message",$s.LENGTH_DELIMITED,e,t)}null!=globalThis.Buffer&&(Vs.prototype.bytes=function(e){const t=e.length>>>0;return this.uint32(t),t>0&&this._push(Zs,t,e),this},Vs.prototype.string=function(e){const t=globalThis.Buffer.byteLength(e);return this.uint32(t),t>0&&this._push(Js,t,e),this}),function(e){e[e.VARINT=0]="VARINT",e[e.BIT64=1]="BIT64",e[e.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",e[e.START_GROUP=3]="START_GROUP",e[e.END_GROUP=4]="END_GROUP",e[e.BIT32=5]="BIT32"}($s||($s={}));class sa extends Error{constructor(e,t,n){super(e,n),Dr(this,"code",void 0),this.code=t}}!function(e){let t,n,r;!function(e){e.Raw="Raw",e.Directory="Directory",e.File="File",e.Metadata="Metadata",e.Symlink="Symlink",e.HAMTShard="HAMTShard"}(t=e.DataType||(e.DataType={})),function(e){e[e.Raw=0]="Raw",e[e.Directory=1]="Directory",e[e.File=2]="File",e[e.Metadata=3]="Metadata",e[e.Symlink=4]="Symlink",e[e.HAMTShard=5]="HAMTShard"}(n||(n={})),function(e){e.codec=()=>ia(n)}(t=e.DataType||(e.DataType={})),e.codec=()=>(null==r&&(r=oa((function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==r.lengthDelimited&&n.fork(),null!=t.Type&&(n.uint32(8),e.DataType.codec().encode(t.Type,n)),null!=t.Data&&(n.uint32(18),n.bytes(t.Data)),null!=t.filesize&&(n.uint32(24),n.uint64(t.filesize)),null!=t.blocksizes)for(const e of t.blocksizes)n.uint32(32),n.uint64(e);null!=t.hashType&&(n.uint32(40),n.uint64(t.hashType)),null!=t.fanout&&(n.uint32(48),n.uint64(t.fanout)),null!=t.mode&&(n.uint32(56),n.uint32(t.mode)),null!=t.mtime&&(n.uint32(66),ta.codec().encode(t.mtime,n)),!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={blocksizes:[]},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.Type=e.DataType.codec().decode(t);break;case 2:r.Data=t.bytes();break;case 3:r.filesize=t.uint64();break;case 4:r.blocksizes.push(t.uint64());break;case 5:r.hashType=t.uint64();break;case 6:r.fanout=t.uint64();break;case 7:r.mode=t.uint32();break;case 8:r.mtime=ta.codec().decode(t,t.uint32());break;default:t.skipType(7&n)}}return r}))),r),e.encode=t=>Xs(t,e.codec()),e.decode=t=>$o(t,e.codec())}(ea||(ea={})),function(e){let t;e.codec=()=>(null==t&&(t=oa((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.Seconds&&(t.uint32(8),t.int64(e.Seconds)),null!=e.FractionalNanoseconds&&(t.uint32(21),t.fixed32(e.FractionalNanoseconds)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.Seconds=e.int64();break;case 2:n.FractionalNanoseconds=e.fixed32();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>Xs(t,e.codec()),e.decode=t=>$o(t,e.codec())}(ta||(ta={})),function(e){let t;e.codec=()=>(null==t&&(t=oa((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.MimeType&&(t.uint32(10),t.string(e.MimeType)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();if(t>>>3===1)n.MimeType=e.string();else e.skipType(7&t)}return n}))),t),e.encode=t=>Xs(t,e.codec()),e.decode=t=>$o(t,e.codec())}(na||(na={}));const aa={Raw:"raw",Directory:"directory",File:"file",Metadata:"metadata",Symlink:"symlink",HAMTShard:"hamt-sharded-directory"},ca=["directory","hamt-sharded-directory"],la=parseInt("0644",8),ua=parseInt("0755",8);class da{static unmarshal(e){var t,n;const r=ea.decode(e),i=new da({type:aa[null!=r.Type?r.Type.toString():"File"],data:r.Data,blockSizes:r.blocksizes,mode:r.mode,mtime:null!=r.mtime?{secs:null!==(t=r.mtime.Seconds)&&void 0!==t?t:0n,nsecs:r.mtime.FractionalNanoseconds}:void 0,fanout:r.fanout});return i._originalMode=null!==(n=r.mode)&&void 0!==n?n:0,i}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{type:"file"};Dr(this,"type",void 0),Dr(this,"data",void 0),Dr(this,"blockSizes",void 0),Dr(this,"hashType",void 0),Dr(this,"fanout",void 0),Dr(this,"mtime",void 0),Dr(this,"_mode",void 0),Dr(this,"_originalMode",void 0);const{type:t,data:n,blockSizes:r,hashType:i,fanout:o,mtime:s,mode:a}=e;if(null!=t&&!Object.values(aa).includes(t))throw Or(new Error("Type: "+t+" is not valid"),"ERR_INVALID_TYPE");this.type=null!==t&&void 0!==t?t:"file",this.data=n,this.hashType=i,this.fanout=o,this.blockSizes=null!==r&&void 0!==r?r:[],this._originalMode=0,this.mode=a,this.mtime=s}set mode(e){this._mode=null==e?this.isDirectory()?ua:la:4095&e}get mode(){return this._mode}isDirectory(){return ca.includes(this.type)}addBlockSize(e){this.blockSizes.push(e)}removeBlockSize(e){this.blockSizes.splice(e,1)}fileSize(){if(this.isDirectory())return 0n;let e=0n;return this.blockSizes.forEach((t=>{e+=t})),null!=this.data&&(e+=BigInt(this.data.length)),e}marshal(){let e;switch(this.type){case"raw":e=ea.DataType.Raw;break;case"directory":e=ea.DataType.Directory;break;case"file":e=ea.DataType.File;break;case"metadata":e=ea.DataType.Metadata;break;case"symlink":e=ea.DataType.Symlink;break;case"hamt-sharded-directory":e=ea.DataType.HAMTShard;break;default:throw Or(new Error("Type: ".concat(e," is not valid")),"ERR_INVALID_TYPE")}let t,n=this.data;var r;(null!=this.data&&0!==this.data.length||(n=void 0),null!=this.mode)&&(t=4294963200&this._originalMode|(null!==(r=this.mode)&&void 0!==r?r:0),t!==la||this.isDirectory()||(t=void 0),t===ua&&this.isDirectory()&&(t=void 0));let i;return null!=this.mtime&&(i={Seconds:this.mtime.secs,FractionalNanoseconds:this.mtime.nsecs}),ea.encode({Type:e,Data:n,filesize:this.isDirectory()?void 0:this.fileSize(),blocksizes:this.blockSizes,hashType:this.hashType,fanout:this.fanout,mode:t,mtime:i})}}class ha extends Event{constructor(e,t){super(e),this.detail=t}}const fa=async(e,t,n)=>{null==n.codec&&(n.codec=r);const i=await Ps.digest(e),o=qi.create(n.cidVersion,n.codec.code,i);return await t.put(o,e,n),o};function pa(e){return async function*(t,n){let i=0n;for await(let o of t.content)yield async()=>{var s;let a;const c={codec:r,cidVersion:e.cidVersion,onProgress:e.onProgress};e.rawLeaves?(c.codec=f,c.cidVersion=1):(a=new da({type:e.leafType,data:o}),o=ko({Data:a.marshal(),Links:[]}));const l=await fa(o,n,c);return i+=BigInt(o.byteLength),null===(s=e.onProgress)||void 0===s||s.call(e,new ha("unixfs:importer:progress:file:write",{bytesWritten:i,cid:l,path:t.path})),{cid:l,unixfs:a,size:BigInt(o.length),block:o}}}}const ga=async(e,t,n)=>{const r=new da({type:"directory",mtime:e.mtime,mode:e.mode}),i=ko(mo({Data:r.marshal()}));return{cid:await fa(i,t,n),path:e.path,unixfs:r,size:BigInt(i.length),originalPath:e.originalPath,block:i}};function ma(e){return!0===e.single}const va=async(e,t,n)=>n.layout(async function*(e,t,n){let r,i=-1;for await(const o of Fr(n.bufferImporter(e,t),n.blockWriteConcurrency))i++,0!==i?(1===i&&null!=r&&(yield{...r,block:void 0,single:void 0},r=void 0),yield{...o,block:void 0}):r={...o,single:!0};null!=r&&(yield r)}(e,t,n),((e,t,n)=>async function(r){var i;if(1===r.length&&ma(r[0])&&n.reduceSingleLeafToSelf){var o;const i=r[0];let s=i.block;return!ma(i)||void 0===e.mtime&&void 0===e.mode||(i.unixfs=new da({type:"file",mtime:e.mtime,mode:e.mode,data:i.block}),s={Data:i.unixfs.marshal(),Links:[]},i.block=ko(mo(s)),i.cid=await fa(i.block,t,{...n,cidVersion:n.cidVersion}),i.size=BigInt(i.block.length)),null===(o=n.onProgress)||void 0===o||o.call(n,new ha("unixfs:importer:progress:file:layout",{cid:i.cid,path:i.originalPath})),{cid:i.cid,path:e.path,unixfs:i.unixfs,size:i.size,originalPath:i.originalPath}}const s=new da({type:"file",mtime:e.mtime,mode:e.mode}),a=r.filter((e=>{var t;return e.cid.code===As&&e.size>0||null!=e.unixfs&&null==e.unixfs.data&&e.unixfs.fileSize()>0n||Boolean(null===(t=e.unixfs)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.length)})).map((e=>{return e.cid.code===As?(s.addBlockSize(e.size),{Name:"",Tsize:Number(e.size),Hash:e.cid}):(null==e.unixfs||null==e.unixfs.data?s.addBlockSize(null!==(t=null===(n=e.unixfs)||void 0===n?void 0:n.fileSize())&&void 0!==t?t:0n):s.addBlockSize(BigInt(e.unixfs.data.length)),{Name:"",Tsize:Number(e.size),Hash:e.cid});var t,n})),c={Data:s.marshal(),Links:a},l=ko(mo(c)),u=await fa(l,t,n);return null===(i=n.onProgress)||void 0===i||i.call(n,new ha("unixfs:importer:progress:file:layout",{cid:u,path:e.originalPath})),{cid:u,path:e.path,unixfs:s,size:BigInt(l.length+c.Links.reduce(((e,t)=>{var n;return e+(null!==(n=t.Tsize)&&void 0!==n?n:0)}),0)),originalPath:e.originalPath,block:l}})(e,t,n));function ya(e){try{if(e instanceof Uint8Array)return async function*(){yield e}();if(t=e,Symbol.iterator in t)return async function*(){yield*e}();if(function(e){return Symbol.asyncIterator in e}(e))return e}catch{throw Or(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}var t;throw Or(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}function wa(e){return null!=e.content}const ba=()=>async function*(e){for await(const t of e){if(void 0===t.length)throw Or(new Error("Content was invalid"),"ERR_INVALID_CONTENT");if("string"===typeof t||t instanceof String)yield Fs(t.toString());else if(Array.isArray(t))yield Uint8Array.from(t);else{if(!(t instanceof Uint8Array))throw Or(new Error("Content was invalid"),"ERR_INVALID_CONTENT");yield t}}},Ea=174;function ka(e){var t;const n=null!==(t=null===e||void 0===e?void 0:e.maxChildrenPerNode)&&void 0!==t?t:Ea;return async function e(t,r){const i=[];for await(const o of Mr(t,n))i.push(await r(o));return i.length>1?e(i,r):i[0]}}class Aa{constructor(e,t){Dr(this,"options",void 0),Dr(this,"root",void 0),Dr(this,"dir",void 0),Dr(this,"path",void 0),Dr(this,"dirty",void 0),Dr(this,"flat",void 0),Dr(this,"parent",void 0),Dr(this,"parentKey",void 0),Dr(this,"unixfs",void 0),Dr(this,"mode",void 0),Dr(this,"mtime",void 0),Dr(this,"cid",void 0),Dr(this,"size",void 0),Dr(this,"nodeSize",void 0),this.options=null!==t&&void 0!==t?t:{},this.root=e.root,this.dir=e.dir,this.path=e.path,this.dirty=e.dirty,this.flat=e.flat,this.parent=e.parent,this.parentKey=e.parentKey,this.unixfs=e.unixfs,this.mode=e.mode,this.mtime=e.mtime}}const Sa=qi.parse("QmUNLLsPACCz1vLxQVkXqqLX5R1X345qqfHbsf67hvA3Nn"),xa=qi.parse("zdj7WbTaiJT1fgatdet9Ei9iDB5hdCxkbVyhyh8YTUnXMiwYi");class _a extends Aa{constructor(e,t){super(e,t),Dr(this,"_children",void 0),this._children=new Map}async put(e,t){this.cid=void 0,this.size=void 0,this.nodeSize=void 0,this._children.set(e,t)}async get(e){return Promise.resolve(this._children.get(e))}childCount(){return this._children.size}directChildrenCount(){return this.childCount()}onlyChild(){return this._children.values().next().value}async*eachChildSeries(){for(const[e,t]of this._children.entries())yield{key:e,child:t}}estimateNodeSize(){if(void 0!==this.nodeSize)return this.nodeSize;this.nodeSize=0;for(const[e,t]of this._children.entries())null!=t.size&&null!=t.cid&&(this.nodeSize+=e.length+(1===this.options.cidVersion?xa.bytes.byteLength:Sa.bytes.byteLength));return this.nodeSize}async*flush(e){const t=[];for(const[a,c]of this._children.entries()){let n=c;if(c instanceof Aa)for await(const t of c.flush(e))n=t,yield t;null!=n.size&&null!=n.cid&&t.push({Name:a,Tsize:Number(n.size),Hash:n.cid})}const n=new da({type:"directory",mtime:this.mtime,mode:this.mode}),r={Data:n.marshal(),Links:t},i=ko(mo(r)),o=await fa(i,e,this.options),s=i.length+r.Links.reduce(((e,t)=>e+(null==t.Tsize?0:t.Tsize)),0);this.cid=o,this.size=s,yield{cid:o,unixfs:n,path:this.path,size:BigInt(s)}}}var Ia=n(2962);Rs({name:"murmur3-32",code:35,encode:e=>function(e){const t=new Array(4);for(let n=0;n<4;n++)t[n]=255&e,e>>=8;return new Uint8Array(t)}(Ia.x86.hash32(e))});const Ra=Rs({name:"murmur3-128",code:34,encode:e=>Yr(Ia.x64.hash128(e))});Rs({name:"murmur3-x64-64",code:34,encode:e=>Yr(Ia.x64.hash128(e)).subarray(0,8)});var Ca=n(3836);class Ta{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Dr(this,"_options",void 0),Dr(this,"_popCount",void 0),Dr(this,"_parent",void 0),Dr(this,"_posAtParent",void 0),Dr(this,"_children",void 0),Dr(this,"key",void 0),this._options=e,this._popCount=0,this._parent=t,this._posAtParent=n,this._children=new Ca,this.key=null}async put(e,t){const n=await this._findNewBucketAndPos(e);n.bucket._putAt(n,e,t)}async get(e){const t=await this._findChild(e);if(null!=t)return t.value}async del(e){const t=await this._findPlace(e),n=t.bucket._at(t.pos);null!=n&&n.key===e&&t.bucket._delAt(t.pos)}leafCount(){return this._children.compactArray().reduce(((e,t)=>t instanceof Ta?e+t.leafCount():e+1),0)}childrenCount(){return this._children.length}onlyChild(){return this._children.get(0)}*eachLeafSeries(){const e=this._children.compactArray();for(const t of e)t instanceof Ta?yield*t.eachLeafSeries():yield t}serialize(e,t){return t(this._children.reduce(((n,r,i)=>(null!=r&&(r instanceof Ta?n.push(r.serialize(e,t)):n.push(e(r,i))),n)),[]))}async asyncTransform(e,t){return Da(this,e,t)}toJSON(){return this.serialize(Na,Ba)}prettyPrint(){return JSON.stringify(this.toJSON(),null,"  ")}tableSize(){return Math.pow(2,this._options.bits)}async _findChild(e){const t=await this._findPlace(e),n=t.bucket._at(t.pos);if(!(n instanceof Ta))return null!=n&&n.key===e?n:void 0}async _findPlace(e){const t=this._options.hash("string"===typeof e?Fs(e):e),n=await t.take(this._options.bits),r=this._children.get(n);return r instanceof Ta?r._findPlace(t):{bucket:this,pos:n,hash:t,existingChild:r}}async _findNewBucketAndPos(e){const t=await this._findPlace(e);if(null!=t.existingChild&&t.existingChild.key!==e){const e=new Ta(this._options,t.bucket,t.pos);t.bucket._putObjectAt(t.pos,e);const n=await e._findPlace(t.existingChild.hash);return n.bucket._putAt(n,t.existingChild.key,t.existingChild.value),e._findNewBucketAndPos(t.hash)}return t}_putAt(e,t,n){this._putObjectAt(e.pos,{key:t,value:n,hash:e.hash})}_putObjectAt(e,t){null==this._children.get(e)&&this._popCount++,this._children.set(e,t)}_delAt(e){if(-1===e)throw new Error("Invalid position");null!=this._children.get(e)&&this._popCount--,this._children.unset(e),this._level()}_level(){if(null!=this._parent&&this._popCount<=1)if(1===this._popCount){const e=this._children.find(Pa);if(null!=e&&!(e instanceof Ta)){const t=e.hash;t.untake(this._options.bits);const n={pos:this._posAtParent,hash:t,bucket:this._parent};this._parent._putAt(n,e.key,e.value)}}else this._parent._delAt(this._posAtParent)}_at(e){return this._children.get(e)}}function Pa(e){return Boolean(e)}function Na(e,t){return e.key}function Ba(e){return e}async function Da(e,t,n){const r=[];for(const i of e._children.compactArray())if(i instanceof Ta)await Da(i,t,n);else{const n=await t(i);r.push({bitField:e._children.bitField(),children:n})}return n(r)}const Oa=[255,254,252,248,240,224,192,128],La=[1,3,7,15,31,63,127,255];class Ma{constructor(e){Dr(this,"_value",void 0),Dr(this,"_currentBytePos",void 0),Dr(this,"_currentBitPos",void 0),this._value=e,this._currentBytePos=e.length-1,this._currentBitPos=7}availableBits(){return this._currentBitPos+1+8*this._currentBytePos}totalBits(){return 8*this._value.length}take(e){let t=e,n=0;for(;t>0&&this._haveBits();){const e=this._value[this._currentBytePos],r=this._currentBitPos+1,i=Math.min(r,t);n=(n<<i)+Fa(e,r-i,i),t-=i,this._currentBitPos-=i,this._currentBitPos<0&&(this._currentBitPos=7,this._currentBytePos--)}return n}untake(e){for(this._currentBitPos+=e;this._currentBitPos>7;)this._currentBitPos-=8,this._currentBytePos+=1}_haveBits(){return this._currentBytePos>=0}}function Fa(e,t,n){const r=function(e,t){return Oa[e]&La[Math.min(t+e-1,7)]}(t,n);return(e&r)>>>t}function Ua(e){return function(t){return t instanceof ja?t:new ja(t,e)}}class ja{constructor(e,t){if(Dr(this,"_value",void 0),Dr(this,"_hashFn",void 0),Dr(this,"_depth",void 0),Dr(this,"_availableBits",void 0),Dr(this,"_currentBufferIndex",void 0),Dr(this,"_buffers",void 0),!(e instanceof Uint8Array))throw new Error("can only hash Uint8Arrays");this._value=e,this._hashFn=t,this._depth=-1,this._availableBits=0,this._currentBufferIndex=0,this._buffers=[]}async take(e){let t=e;for(;this._availableBits<t;)await this._produceMoreBits();let n=0;for(;t>0;){const e=this._buffers[this._currentBufferIndex],r=Math.min(e.availableBits(),t);n=(n<<r)+e.take(r),t-=r,this._availableBits-=r,0===e.availableBits()&&this._currentBufferIndex++}return n}untake(e){let t=e;for(;t>0;){const e=this._buffers[this._currentBufferIndex],n=Math.min(e.totalBits()-e.availableBits(),t);e.untake(n),t-=n,this._availableBits+=n,this._currentBufferIndex>0&&e.totalBits()===e.availableBits()&&(this._depth--,this._currentBufferIndex--)}}async _produceMoreBits(){this._depth++;const e=this._depth>0?Hr([this._value,Uint8Array.from([this._depth])]):this._value,t=await this._hashFn(e),n=new Ma(t);this._buffers.push(n),this._availableBits+=n.availableBits()}}function Ha(e){var t;if(null==e||null==e.hashFn)throw new Error("please define an options.hashFn");const n={bits:null!==(t=e.bits)&&void 0!==t?t:8,hash:Ua(e.hashFn)};return new Ta(n)}async function za(e){return(await Ra.encode(e)).slice(0,8).reverse()}const Va=BigInt(34);const qa=class extends Aa{constructor(e,t){var n;super(e,t),Dr(this,"_bucket",void 0),this._bucket=Ha({hashFn:za,bits:null!==(n=t.shardFanoutBits)&&void 0!==n?n:8})}async put(e,t){this.cid=void 0,this.size=void 0,this.nodeSize=void 0,await this._bucket.put(e,t)}async get(e){return this._bucket.get(e)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(const{key:e,value:t}of this._bucket.eachLeafSeries())yield{key:e,child:t}}estimateNodeSize(){return void 0!==this.nodeSize||(this.nodeSize=Ka(this._bucket,this,this.options)),this.nodeSize}async*flush(e){for await(const t of Ga(this._bucket,e,this,this.options))yield{...t,path:this.path}}};async function*Ga(e,t,n,r){const i=e._children,o=(e.tableSize()-1).toString(16).length,s=[];let a=0n;for(let f=0;f<i.length;f++){const e=i.get(f);if(null==e)continue;const n=f.toString(16).toUpperCase().padStart(o,"0");if(e instanceof Ta){let i;for await(const n of Ga(e,t,null,r))i=n;if(null==i)throw new Error("Could not flush sharded directory, no subshard found");s.push({Name:n,Tsize:Number(i.size),Hash:i.cid}),a+=i.size}else if("function"===typeof e.value.flush){const r=e.value;let i;for await(const e of r.flush(t))i=e,yield i;if(null==i)throw new Error("Did not flush dir");const o=n+e.key;s.push({Name:o,Tsize:Number(i.size),Hash:i.cid}),a+=i.size}else{const t=e.value;if(null==t.cid)continue;const r=n+e.key,i=t.size;s.push({Name:r,Tsize:Number(i),Hash:t.cid}),a+=BigInt(null!==i&&void 0!==i?i:0)}}const c=Uint8Array.from(i.bitField().reverse()),l=new da({type:"hamt-sharded-directory",data:c,fanout:BigInt(e.tableSize()),hashType:Va,mtime:null===n||void 0===n?void 0:n.mtime,mode:null===n||void 0===n?void 0:n.mode}),u=ko(mo({Data:l.marshal(),Links:s})),d=await fa(u,t,r),h=BigInt(u.byteLength)+a;yield{cid:d,unixfs:l,size:h}}function Ka(e,t,n){const r=e._children,i=(e.tableSize()-1).toString(16).length,o=[];for(let a=0;a<r.length;a++){const e=r.get(a);if(null==e)continue;const t=a.toString(16).toUpperCase().padStart(i,"0");if(e instanceof Ta){const r=Ka(e,null,n);o.push({Name:t,Tsize:Number(r),Hash:0===n.cidVersion?Sa:xa})}else if("function"===typeof e.value.flush){const r=e.value.nodeSize();o.push({Name:t+e.key,Tsize:Number(r),Hash:0===n.cidVersion?Sa:xa})}else{const n=e.value;if(null==n.cid)continue;const r=t+e.key,i=n.size;o.push({Name:r,Tsize:Number(i),Hash:n.cid})}}const s=Uint8Array.from(r.bitField().reverse());return ko(mo({Data:new da({type:"hamt-sharded-directory",data:s,fanout:BigInt(e.tableSize()),hashType:Va,mtime:null===t||void 0===t?void 0:t.mtime,mode:null===t||void 0===t?void 0:t.mode}).marshal(),Links:o})).length}async function Wa(e,t,n,r){let i=t;t instanceof _a&&t.estimateNodeSize()>n&&(i=await async function(e,t){const n=new qa({root:e.root,dir:!0,parent:e.parent,parentKey:e.parentKey,path:e.path,dirty:e.dirty,flat:!1,mtime:e.mtime,mode:e.mode},t);for await(const{key:r,child:i}of e.eachChildSeries())await n.put(r,i);return n}(t,r));const o=i.parent;if(null!=o){if(i!==t){if(null!=e&&(e.parent=i),null==i.parentKey)throw new Error("No parent key found");await o.put(i.parentKey,i)}return Wa(i,o,n,r)}return i}const Qa=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").split(/(?<!\\)\//).filter(Boolean)};async function Ya(e,t,n){var r;const i=Qa(null!==(r=e.path)&&void 0!==r?r:""),o=i.length-1;let s=t,a="";for(let u=0;u<i.length;u++){const r=i[u];a+="".concat(""!==a?"/":"").concat(r);const d=u===o;if(s.dirty=!0,s.cid=void 0,s.size=void 0,d)await s.put(r,e),t=await Wa(null,s,n.shardSplitThresholdBytes,n);else{let e=await s.get(r);var c,l;if(null==e||!(e instanceof Aa))e=new _a({root:!1,dir:!0,parent:s,parentKey:r,path:a,dirty:!0,flat:!0,mtime:null===(c=e)||void 0===c||null===(c=c.unixfs)||void 0===c?void 0:c.mtime,mode:null===(l=e)||void 0===l||null===(l=l.unixfs)||void 0===l?void 0:l.mode},n);await s.put(r,e),s=e}}return t}async function*Za(e,t){var n;e instanceof Aa?yield*e.flush(t):!0===(null===(n=e.unixfs)||void 0===n?void 0:n.isDirectory())&&(yield e)}function Ja(e,t){try{let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return async function*(r,i,o,s,a,c,l,u,d,h,f,p,g,m,v){let y;y=Symbol.asyncIterator in e||Symbol.iterator in e?e:[e];const w=null!==(r=n.wrapWithDirectory)&&void 0!==r&&r,b=null!==(i=n.shardSplitThresholdBytes)&&void 0!==i?i:262144,E=null!==(o=n.shardFanoutBits)&&void 0!==o?o:8,k=null!==(s=n.cidVersion)&&void 0!==s?s:1,A=null===(a=n.rawLeaves)||void 0===a||a,S=null!==(c=n.leafType)&&void 0!==c?c:"file",x=null!==(l=n.fileImportConcurrency)&&void 0!==l?l:50,_=null!==(u=n.blockWriteConcurrency)&&void 0!==u?u:10,I=null===(d=n.reduceSingleLeafToSelf)||void 0===d||d,R=null!==(h=n.chunker)&&void 0!==h?h:Wr(),C=null!==(f=n.chunkValidator)&&void 0!==f?f:ba(),T=null!==(p=n.dagBuilder)&&void 0!==p?p:function(e){return async function*(t,n){for await(const r of t){let t;if(null!=r.path&&(t=r.path,r.path=r.path.split("/").filter((e=>null!=e&&"."!==e)).join("/")),wa(r)){const i={path:r.path,mtime:r.mtime,mode:r.mode,content:async function*(){let t=0n;for await(const i of e.chunker(e.chunkValidator(ya(r.content)))){var n;const o=BigInt(i.byteLength);t+=o,null===(n=e.onProgress)||void 0===n||n.call(e,new ha("unixfs:importer:progress:file:read",{bytesRead:t,chunkSize:o,path:r.path})),yield i}}(),originalPath:t};yield async()=>va(i,n,e)}else{if(null==r.path)throw new Error("Import candidate must have content or path or both");{const i={path:r.path,mtime:r.mtime,mode:r.mode,originalPath:t};yield async()=>ga(i,n,e)}}}}}({chunker:R,chunkValidator:C,wrapWithDirectory:w,layout:null!==(g=n.layout)&&void 0!==g?g:ka(),bufferImporter:null!==(m=n.bufferImporter)&&void 0!==m?m:pa({cidVersion:k,rawLeaves:A,leafType:S,onProgress:n.onProgress}),blockWriteConcurrency:_,reduceSingleLeafToSelf:I,cidVersion:k,onProgress:n.onProgress}),P=null!==(v=n.treeBuilder)&&void 0!==v?v:function(e){return async function*(t,n){let r,i=new _a({root:!0,dir:!0,path:"",dirty:!0,flat:!0},e),o=!1;for await(const a of t){var s;if(null==a)continue;const t="".concat(null!==(s=a.originalPath)&&void 0!==s?s:"").split("/")[0];null!=t&&""!==t&&(null==r?(r=t,o=!0):r!==t&&(o=!1)),i=await Ya(a,i,e),null!=a.unixfs&&a.unixfs.isDirectory()||(yield a)}if(e.wrapWithDirectory||o&&i.childCount()>1)yield*Za(i,n);else for await(const e of i.eachChildSeries())null!=e&&(yield*Za(e.child,n))}}({wrapWithDirectory:w,shardSplitThresholdBytes:b,shardFanoutBits:E,cidVersion:k,onProgress:n.onProgress});for await(const e of P(Fr(T(y,t),x),t))yield{cid:e.cid,path:e.path,unixfs:e.unixfs,size:e.size}}()}catch(BJ){return Promise.reject(BJ)}}async function Xa(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=await Lr(Ja([e],t,n));if(null==r)throw Or(new Error("Nothing imported"),"ERR_INVALID_PARAMS");return r}const $a={cidVersion:1,rawLeaves:!0,layout:ka({maxChildrenPerNode:1024}),chunker:Wr({chunkSize:1048576})};async function ec(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{cid:r}=await async function(e,t){return Xa({content:e},t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})}(e,t,{...$a,...n});return r}async function tc(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{cid:r}=await async function(e,t){return Xa({content:e},t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})}(e,t,{...$a,...n});return r}async function nc(e,t){var n;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{cid:i}=await async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=await Lr(Ja([e],t,n));if(null==r)throw Or(new Error("Nothing imported"),"ERR_INVALID_PARAMS");return r}({...e,path:null!==(n=e.path)&&void 0!==n?n:"-"},t,{...$a,...r});return i}const rc=function(e){if(null!=e[Symbol.asyncIterator])return(async()=>{let t;for await(const n of e)t=n;return t})();let t;for(const n of e)t=n;return t},ic=["string","number","bigint","symbol"],oc=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function sc(e){if(null===e)return"null";if(void 0===e)return"undefined";if(!0===e||!1===e)return"boolean";const t=typeof e;if(ic.includes(t))return t;if("function"===t)return"Function";if(Array.isArray(e))return"Array";if(function(e){return e&&e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer.call(null,e)}(e))return"Buffer";const n=function(e){const t=Object.prototype.toString.call(e).slice(8,-1);if(oc.includes(t))return t;return}(e);return n||"Object"}class ac{constructor(e,t,n){this.major=e,this.majorEncoded=e<<5,this.name=t,this.terminal=n}toString(){return"Type[".concat(this.major,"].").concat(this.name)}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}}ac.uint=new ac(0,"uint",!0),ac.negint=new ac(1,"negint",!0),ac.bytes=new ac(2,"bytes",!0),ac.string=new ac(3,"string",!0),ac.array=new ac(4,"array",!1),ac.map=new ac(5,"map",!1),ac.tag=new ac(6,"tag",!1),ac.float=new ac(7,"float",!0),ac.false=new ac(7,"false",!0),ac.true=new ac(7,"true",!0),ac.null=new ac(7,"null",!0),ac.undefined=new ac(7,"undefined",!0),ac.break=new ac(7,"break",!0);class cc{constructor(e,t,n){this.type=e,this.value=t,this.encodedLength=n,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return"Token[".concat(this.type,"].").concat(this.value)}}const lc=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&"function"===typeof globalThis.Buffer.isBuffer,uc=new TextDecoder,dc=new TextEncoder;function hc(e){return lc&&globalThis.Buffer.isBuffer(e)}function fc(e){return e instanceof Uint8Array?hc(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e:Uint8Array.from(e)}const pc=lc?(e,t,n)=>n-t>64?globalThis.Buffer.from(e.subarray(t,n)).toString("utf8"):Ec(e,t,n):(e,t,n)=>n-t>64?uc.decode(e.subarray(t,n)):Ec(e,t,n),gc=lc?e=>e.length>64?globalThis.Buffer.from(e):bc(e):e=>e.length>64?dc.encode(e):bc(e),mc=e=>Uint8Array.from(e),vc=lc?(e,t,n)=>hc(e)?new Uint8Array(e.subarray(t,n)):e.slice(t,n):(e,t,n)=>e.slice(t,n),yc=lc?(e,t)=>(e=e.map((e=>e instanceof Uint8Array?e:globalThis.Buffer.from(e))),fc(globalThis.Buffer.concat(e,t))):(e,t)=>{const n=new Uint8Array(t);let r=0;for(let i of e)r+i.length>n.length&&(i=i.subarray(0,n.length-r)),n.set(i,r),r+=i.length;return n},wc=lc?e=>globalThis.Buffer.allocUnsafe(e):e=>new Uint8Array(e);function bc(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t}function Ec(e,t,n){const r=[];for(;t<n;){const i=e[t];let o=null,s=i>239?4:i>223?3:i>191?2:1;if(t+s<=n){let n,r,a,c;switch(s){case 1:i<128&&(o=i);break;case 2:n=e[t+1],128===(192&n)&&(c=(31&i)<<6|63&n,c>127&&(o=c));break;case 3:n=e[t+1],r=e[t+2],128===(192&n)&&128===(192&r)&&(c=(15&i)<<12|(63&n)<<6|63&r,c>2047&&(c<55296||c>57343)&&(o=c));break;case 4:n=e[t+1],r=e[t+2],a=e[t+3],128===(192&n)&&128===(192&r)&&128===(192&a)&&(c=(15&i)<<18|(63&n)<<12|(63&r)<<6|63&a,c>65535&&c<1114112&&(o=c))}}null===o?(o=65533,s=1):o>65535&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|1023&o),r.push(o),t+=s}return Ac(r)}const kc=4096;function Ac(e){const t=e.length;if(t<=kc)return String.fromCharCode.apply(String,e);let n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=kc));return n}class Sc{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:256;this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),null!==this._initReuseChunk&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let t=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){const n=t.length-(this.maxCursor-this.cursor)-1;t.set(e,n)}else{if(t){const e=t.length-(this.maxCursor-this.cursor)-1;e<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,e),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(t=wc(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,null===this._initReuseChunk&&(this._initReuseChunk=t),t.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(){let e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(1===this.chunks.length){const n=this.chunks[0];t&&this.cursor>n.length/2?(e=this.cursor===n.length?n:n.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):e=vc(n,0,this.cursor)}else e=yc(this.chunks,this.cursor);return t&&this.reset(),e}}const xc="CBOR decode error:",_c="CBOR encode error:",Ic=[];function Rc(e,t,n){if(e.length-t<n)throw new Error("".concat(xc," not enough data for type"))}Ic[23]=1,Ic[24]=2,Ic[25]=3,Ic[26]=5,Ic[27]=9;const Cc=[24,256,65536,4294967296,BigInt("18446744073709551616")];function Tc(e,t,n){Rc(e,t,1);const r=e[t];if(!0===n.strict&&r<Cc[0])throw new Error("".concat(xc," integer encoded in more bytes than necessary (strict decode)"));return r}function Pc(e,t,n){Rc(e,t,2);const r=e[t]<<8|e[t+1];if(!0===n.strict&&r<Cc[1])throw new Error("".concat(xc," integer encoded in more bytes than necessary (strict decode)"));return r}function Nc(e,t,n){Rc(e,t,4);const r=16777216*e[t]+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];if(!0===n.strict&&r<Cc[2])throw new Error("".concat(xc," integer encoded in more bytes than necessary (strict decode)"));return r}function Bc(e,t,n){Rc(e,t,8);const r=16777216*e[t]+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3],i=16777216*e[t+4]+(e[t+5]<<16)+(e[t+6]<<8)+e[t+7],o=(BigInt(r)<<BigInt(32))+BigInt(i);if(!0===n.strict&&o<Cc[3])throw new Error("".concat(xc," integer encoded in more bytes than necessary (strict decode)"));if(o<=Number.MAX_SAFE_INTEGER)return Number(o);if(!0===n.allowBigInt)return o;throw new Error("".concat(xc," integers outside of the safe integer range are not supported"))}function Dc(e,t){return Oc(e,0,t.value)}function Oc(e,t,n){if(n<Cc[0]){const r=Number(n);e.push([t|r])}else if(n<Cc[1]){const r=Number(n);e.push([24|t,r])}else if(n<Cc[2]){const r=Number(n);e.push([25|t,r>>>8,255&r])}else if(n<Cc[3]){const r=Number(n);e.push([26|t,r>>>24&255,r>>>16&255,r>>>8&255,255&r])}else{const r=BigInt(n);if(!(r<Cc[4]))throw new Error("".concat(xc," encountered BigInt larger than allowable range"));{const n=[27|t,0,0,0,0,0,0,0];let i=Number(r&BigInt(4294967295)),o=Number(r>>BigInt(32)&BigInt(4294967295));n[8]=255&i,i>>=8,n[7]=255&i,i>>=8,n[6]=255&i,i>>=8,n[5]=255&i,n[4]=255&o,o>>=8,n[3]=255&o,o>>=8,n[2]=255&o,o>>=8,n[1]=255&o,e.push(n)}}}Dc.encodedSize=function(e){return Oc.encodedSize(e.value)},Oc.encodedSize=function(e){return e<Cc[0]?1:e<Cc[1]?2:e<Cc[2]?3:e<Cc[3]?5:9},Dc.compareTokens=function(e,t){return e.value<t.value?-1:e.value>t.value?1:0};const Lc=BigInt(-1),Mc=BigInt(1);function Fc(e,t){const n=t.value,r="bigint"===typeof n?n*Lc-Mc:-1*n-1;Oc(e,t.type.majorEncoded,r)}function Uc(e,t,n,r){Rc(e,t,n+r);const i=vc(e,t+n,t+n+r);return new cc(ac.bytes,i,n+r)}function jc(e,t,n,r){return Uc(e,t,1,n)}function Hc(e){return void 0===e.encodedBytes&&(e.encodedBytes=e.type===ac.string?gc(e.value):e.value),e.encodedBytes}function zc(e,t){const n=Hc(t);Oc(e,t.type.majorEncoded,n.length),e.push(n)}function Vc(e,t,n,r,i){const o=n+r;Rc(e,t,o);const s=new cc(ac.string,pc(e,t+n,t+o),o);return!0===i.retainStringBytes&&(s.byteValue=vc(e,t+n,t+o)),s}function qc(e,t,n,r){return Vc(e,t,1,n,r)}Fc.encodedSize=function(e){const t=e.value,n="bigint"===typeof t?t*Lc-Mc:-1*t-1;return n<Cc[0]?1:n<Cc[1]?2:n<Cc[2]?3:n<Cc[3]?5:9},Fc.compareTokens=function(e,t){return e.value<t.value?1:e.value>t.value?-1:0},zc.encodedSize=function(e){const t=Hc(e);return Oc.encodedSize(t.length)+t.length},zc.compareTokens=function(e,t){return n=Hc(e),r=Hc(t),n.length<r.length?-1:n.length>r.length?1:function(e,t){if(hc(e)&&hc(t))return e.compare(t);for(let n=0;n<e.length;n++)if(e[n]!==t[n])return e[n]<t[n]?-1:1;return 0}(n,r);var n,r};const Gc=zc;function Kc(e,t,n,r){return new cc(ac.array,r,n)}function Wc(e,t,n,r){return Kc(0,0,1,n)}function Qc(e,t){Oc(e,ac.array.majorEncoded,t.value)}function Yc(e,t,n,r){return new cc(ac.map,r,n)}function Zc(e,t,n,r){return Yc(0,0,1,n)}function Jc(e,t){Oc(e,ac.map.majorEncoded,t.value)}function Xc(e,t,n,r){return new cc(ac.tag,n,1)}function $c(e,t){Oc(e,ac.tag.majorEncoded,t.value)}Qc.compareTokens=Dc.compareTokens,Qc.encodedSize=function(e){return Oc.encodedSize(e.value)},Jc.compareTokens=Dc.compareTokens,Jc.encodedSize=function(e){return Oc.encodedSize(e.value)},$c.compareTokens=Dc.compareTokens,$c.encodedSize=function(e){return Oc.encodedSize(e.value)};const el=20,tl=21,nl=22,rl=23;function il(e,t,n){if(n){if(!1===n.allowNaN&&Number.isNaN(e))throw new Error("".concat(xc," NaN values are not supported"));if(!1===n.allowInfinity&&(e===1/0||e===-1/0))throw new Error("".concat(xc," Infinity values are not supported"))}return new cc(ac.float,e,t)}function ol(e,t,n){const r=t.value;if(!1===r)e.push([ac.float.majorEncoded|el]);else if(!0===r)e.push([ac.float.majorEncoded|tl]);else if(null===r)e.push([ac.float.majorEncoded|nl]);else if(void 0===r)e.push([ac.float.majorEncoded|rl]);else{let t,o=!1;n&&!0===n.float64||(ll(r),t=ul(cl,1),r===t||Number.isNaN(r)?(cl[0]=249,e.push(cl.slice(0,3)),o=!0):(dl(r),t=hl(cl,1),r===t&&(cl[0]=250,e.push(cl.slice(0,5)),o=!0))),o||(i=r,al.setFloat64(0,i,!1),t=fl(cl,1),cl[0]=251,e.push(cl.slice(0,9)))}var i}ol.encodedSize=function(e,t){const n=e.value;if(!1===n||!0===n||null===n||void 0===n)return 1;if(!t||!0!==t.float64){ll(n);let e=ul(cl,1);if(n===e||Number.isNaN(n))return 3;if(dl(n),e=hl(cl,1),n===e)return 5}return 9};const sl=new ArrayBuffer(9),al=new DataView(sl,1),cl=new Uint8Array(sl,0);function ll(e){if(e===1/0)al.setUint16(0,31744,!1);else if(e===-1/0)al.setUint16(0,64512,!1);else if(Number.isNaN(e))al.setUint16(0,32256,!1);else{al.setFloat32(0,e);const t=al.getUint32(0),n=(2139095040&t)>>23,r=8388607&t;if(255===n)al.setUint16(0,31744,!1);else if(0===n)al.setUint16(0,(2147483648&e)>>16|r>>13,!1);else{const e=n-127;e<-24?al.setUint16(0,0):e<-14?al.setUint16(0,(2147483648&t)>>16|1<<24+e,!1):al.setUint16(0,(2147483648&t)>>16|e+15<<10|r>>13,!1)}}}function ul(e,t){if(e.length-t<2)throw new Error("".concat(xc," not enough data for float16"));const n=(e[t]<<8)+e[t+1];if(31744===n)return 1/0;if(64512===n)return-1/0;if(32256===n)return NaN;const r=n>>10&31,i=1023&n;let o;return o=0===r?i*2**-24:31!==r?(i+1024)*2**(r-25):0===i?1/0:NaN,32768&n?-o:o}function dl(e){al.setFloat32(0,e,!1)}function hl(e,t){if(e.length-t<4)throw new Error("".concat(xc," not enough data for float32"));const n=(e.byteOffset||0)+t;return new DataView(e.buffer,n,4).getFloat32(0,!1)}function fl(e,t){if(e.length-t<8)throw new Error("".concat(xc," not enough data for float64"));const n=(e.byteOffset||0)+t;return new DataView(e.buffer,n,8).getFloat64(0,!1)}function pl(e,t,n){throw new Error("".concat(xc," encountered invalid minor (").concat(n,") for major ").concat(e[t]>>>5))}function gl(e){return()=>{throw new Error("".concat(xc," ").concat(e))}}ol.compareTokens=Dc.compareTokens;const ml=[];for(let n=0;n<=23;n++)ml[n]=pl;ml[24]=function(e,t,n,r){return new cc(ac.uint,Tc(e,t+1,r),2)},ml[25]=function(e,t,n,r){return new cc(ac.uint,Pc(e,t+1,r),3)},ml[26]=function(e,t,n,r){return new cc(ac.uint,Nc(e,t+1,r),5)},ml[27]=function(e,t,n,r){return new cc(ac.uint,Bc(e,t+1,r),9)},ml[28]=pl,ml[29]=pl,ml[30]=pl,ml[31]=pl;for(let n=32;n<=55;n++)ml[n]=pl;ml[56]=function(e,t,n,r){return new cc(ac.negint,-1-Tc(e,t+1,r),2)},ml[57]=function(e,t,n,r){return new cc(ac.negint,-1-Pc(e,t+1,r),3)},ml[58]=function(e,t,n,r){return new cc(ac.negint,-1-Nc(e,t+1,r),5)},ml[59]=function(e,t,n,r){const i=Bc(e,t+1,r);if("bigint"!==typeof i){const e=-1-i;if(e>=Number.MIN_SAFE_INTEGER)return new cc(ac.negint,e,9)}if(!0!==r.allowBigInt)throw new Error("".concat(xc," integers outside of the safe integer range are not supported"));return new cc(ac.negint,Lc-BigInt(i),9)},ml[60]=pl,ml[61]=pl,ml[62]=pl,ml[63]=pl;for(let n=64;n<=87;n++)ml[n]=jc;ml[88]=function(e,t,n,r){return Uc(e,t,2,Tc(e,t+1,r))},ml[89]=function(e,t,n,r){return Uc(e,t,3,Pc(e,t+1,r))},ml[90]=function(e,t,n,r){return Uc(e,t,5,Nc(e,t+1,r))},ml[91]=function(e,t,n,r){const i=Bc(e,t+1,r);if("bigint"===typeof i)throw new Error("".concat(xc," 64-bit integer bytes lengths not supported"));return Uc(e,t,9,i)},ml[92]=pl,ml[93]=pl,ml[94]=pl,ml[95]=gl("indefinite length bytes/strings are not supported");for(let n=96;n<=119;n++)ml[n]=qc;ml[120]=function(e,t,n,r){return Vc(e,t,2,Tc(e,t+1,r),r)},ml[121]=function(e,t,n,r){return Vc(e,t,3,Pc(e,t+1,r),r)},ml[122]=function(e,t,n,r){return Vc(e,t,5,Nc(e,t+1,r),r)},ml[123]=function(e,t,n,r){const i=Bc(e,t+1,r);if("bigint"===typeof i)throw new Error("".concat(xc," 64-bit integer string lengths not supported"));return Vc(e,t,9,i,r)},ml[124]=pl,ml[125]=pl,ml[126]=pl,ml[127]=gl("indefinite length bytes/strings are not supported");for(let n=128;n<=151;n++)ml[n]=Wc;ml[152]=function(e,t,n,r){return Kc(0,0,2,Tc(e,t+1,r))},ml[153]=function(e,t,n,r){return Kc(0,0,3,Pc(e,t+1,r))},ml[154]=function(e,t,n,r){return Kc(0,0,5,Nc(e,t+1,r))},ml[155]=function(e,t,n,r){const i=Bc(e,t+1,r);if("bigint"===typeof i)throw new Error("".concat(xc," 64-bit integer array lengths not supported"));return Kc(0,0,9,i)},ml[156]=pl,ml[157]=pl,ml[158]=pl,ml[159]=function(e,t,n,r){if(!1===r.allowIndefinite)throw new Error("".concat(xc," indefinite length items not allowed"));return Kc(0,0,1,1/0)};for(let n=160;n<=183;n++)ml[n]=Zc;ml[184]=function(e,t,n,r){return Yc(0,0,2,Tc(e,t+1,r))},ml[185]=function(e,t,n,r){return Yc(0,0,3,Pc(e,t+1,r))},ml[186]=function(e,t,n,r){return Yc(0,0,5,Nc(e,t+1,r))},ml[187]=function(e,t,n,r){const i=Bc(e,t+1,r);if("bigint"===typeof i)throw new Error("".concat(xc," 64-bit integer map lengths not supported"));return Yc(0,0,9,i)},ml[188]=pl,ml[189]=pl,ml[190]=pl,ml[191]=function(e,t,n,r){if(!1===r.allowIndefinite)throw new Error("".concat(xc," indefinite length items not allowed"));return Yc(0,0,1,1/0)};for(let n=192;n<=215;n++)ml[n]=Xc;ml[216]=function(e,t,n,r){return new cc(ac.tag,Tc(e,t+1,r),2)},ml[217]=function(e,t,n,r){return new cc(ac.tag,Pc(e,t+1,r),3)},ml[218]=function(e,t,n,r){return new cc(ac.tag,Nc(e,t+1,r),5)},ml[219]=function(e,t,n,r){return new cc(ac.tag,Bc(e,t+1,r),9)},ml[220]=pl,ml[221]=pl,ml[222]=pl,ml[223]=pl;for(let n=224;n<=243;n++)ml[n]=gl("simple values are not supported");ml[244]=pl,ml[245]=pl,ml[246]=pl,ml[247]=function(e,t,n,r){if(!1===r.allowUndefined)throw new Error("".concat(xc," undefined values are not supported"));return!0===r.coerceUndefinedToNull?new cc(ac.null,null,1):new cc(ac.undefined,void 0,1)},ml[248]=gl("simple values are not supported"),ml[249]=function(e,t,n,r){return il(ul(e,t+1),3,r)},ml[250]=function(e,t,n,r){return il(hl(e,t+1),5,r)},ml[251]=function(e,t,n,r){return il(fl(e,t+1),9,r)},ml[252]=pl,ml[253]=pl,ml[254]=pl,ml[255]=function(e,t,n,r){if(!1===r.allowIndefinite)throw new Error("".concat(xc," indefinite length items not allowed"));return new cc(ac.break,void 0,1)};const vl=[];for(let n=0;n<24;n++)vl[n]=new cc(ac.uint,n,1);for(let n=-1;n>=-24;n--)vl[31-n]=new cc(ac.negint,n,1);vl[64]=new cc(ac.bytes,new Uint8Array(0),1),vl[96]=new cc(ac.string,"",1),vl[128]=new cc(ac.array,0,1),vl[160]=new cc(ac.map,0,1),vl[244]=new cc(ac.false,!1,1),vl[245]=new cc(ac.true,!0,1),vl[246]=new cc(ac.null,null,1);const yl={float64:!1,mapSorter:function(e,t){const n=Array.isArray(e[0])?e[0][0]:e[0],r=Array.isArray(t[0])?t[0][0]:t[0];if(n.type!==r.type)return n.type.compare(r.type);const i=n.type.major,o=wl[i].compareTokens(n,r);0===o&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone");return o},quickEncodeToken:function(e){switch(e.type){case ac.false:return mc([244]);case ac.true:return mc([245]);case ac.null:return mc([246]);case ac.bytes:return e.value.length?void 0:mc([64]);case ac.string:return""===e.value?mc([96]):void 0;case ac.array:return 0===e.value?mc([128]):void 0;case ac.map:return 0===e.value?mc([160]):void 0;case ac.uint:return e.value<24?mc([Number(e.value)]):void 0;case ac.negint:if(e.value>=-24)return mc([31-Number(e.value)])}}};const wl=function(){const e=[];return e[ac.uint.major]=Dc,e[ac.negint.major]=Fc,e[ac.bytes.major]=zc,e[ac.string.major]=Gc,e[ac.array.major]=Qc,e[ac.map.major]=Jc,e[ac.tag.major]=$c,e[ac.float.major]=ol,e}(),bl=new Sc;class El{constructor(e,t){this.obj=e,this.parent=t}includes(e){let t=this;do{if(t.obj===e)return!0}while(t=t.parent);return!1}static createCheck(e,t){if(e&&e.includes(t))throw new Error("".concat(_c," object contains circular references"));return new El(t,e)}}const kl={null:new cc(ac.null,null),undefined:new cc(ac.undefined,void 0),true:new cc(ac.true,!0),false:new cc(ac.false,!1),emptyArray:new cc(ac.array,0),emptyMap:new cc(ac.map,0)},Al={number:(e,t,n,r)=>Number.isInteger(e)&&Number.isSafeInteger(e)?new cc(e>=0?ac.uint:ac.negint,e):new cc(ac.float,e),bigint:(e,t,n,r)=>e>=BigInt(0)?new cc(ac.uint,e):new cc(ac.negint,e),Uint8Array:(e,t,n,r)=>new cc(ac.bytes,e),string:(e,t,n,r)=>new cc(ac.string,e),boolean:(e,t,n,r)=>e?kl.true:kl.false,null:(e,t,n,r)=>kl.null,undefined:(e,t,n,r)=>kl.undefined,ArrayBuffer:(e,t,n,r)=>new cc(ac.bytes,new Uint8Array(e)),DataView:(e,t,n,r)=>new cc(ac.bytes,new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),Array(e,t,n,r){if(!e.length)return!0===n.addBreakTokens?[kl.emptyArray,new cc(ac.break)]:kl.emptyArray;r=El.createCheck(r,e);const i=[];let o=0;for(const s of e)i[o++]=Sl(s,n,r);return n.addBreakTokens?[new cc(ac.array,e.length),i,new cc(ac.break)]:[new cc(ac.array,e.length),i]},Object(e,t,n,r){const i="Object"!==t,o=i?e.keys():Object.keys(e),s=i?e.size:o.length;if(!s)return!0===n.addBreakTokens?[kl.emptyMap,new cc(ac.break)]:kl.emptyMap;r=El.createCheck(r,e);const a=[];let c=0;for(const l of o)a[c++]=[Sl(l,n,r),Sl(i?e.get(l):e[l],n,r)];return function(e,t){t.mapSorter&&e.sort(t.mapSorter)}(a,n),n.addBreakTokens?[new cc(ac.map,s),a,new cc(ac.break)]:[new cc(ac.map,s),a]}};Al.Map=Al.Object,Al.Buffer=Al.Uint8Array;for(const n of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))Al["".concat(n,"Array")]=Al.DataView;function Sl(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const r=sc(e),i=t&&t.typeEncoders&&t.typeEncoders[r]||Al[r];if("function"===typeof i){const o=i(e,r,t,n);if(null!=o)return o}const o=Al[r];if(!o)throw new Error("".concat(_c," unsupported type: ").concat(r));return o(e,r,t,n)}function xl(e,t,n,r){if(Array.isArray(t))for(const i of t)xl(e,i,n,r);else n[t.type.major](e,t,r)}function _l(e,t,n){const r=Sl(e,n);if(!Array.isArray(r)&&n.quickEncodeToken){const e=n.quickEncodeToken(r);if(e)return e;const i=t[r.type.major];if(i.encodedSize){const e=i.encodedSize(r,n),t=new Sc(e);if(i(t,r,n),1!==t.chunks.length)throw new Error("Unexpected error: pre-calculated length for ".concat(r," was wrong"));return fc(t.chunks[0])}}return bl.reset(),xl(bl,r,t,n),bl.toBytes(!0)}function Il(e,t){return t=Object.assign({},yl,t),_l(e,wl,t)}const Rl={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class Cl{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._pos=0,this.data=e,this.options=t}pos(){return this._pos}done(){return this._pos>=this.data.length}next(){const e=this.data[this._pos];let t=vl[e];if(void 0===t){const n=ml[e];if(!n)throw new Error("".concat(xc," no decoder for major type ").concat(e>>>5," (byte 0x").concat(e.toString(16).padStart(2,"0"),")"));const r=31&e;t=n(this.data,this._pos,r,this.options)}return this._pos+=t.encodedLength,t}}const Tl=Symbol.for("DONE"),Pl=Symbol.for("BREAK");function Nl(e,t){if(e.done())return Tl;const n=e.next();if(n.type===ac.break)return Pl;if(n.type.terminal)return n.value;if(n.type===ac.array)return function(e,t,n){const r=[];for(let i=0;i<e.value;i++){const o=Nl(t,n);if(o===Pl){if(e.value===1/0)break;throw new Error("".concat(xc," got unexpected break to lengthed array"))}if(o===Tl)throw new Error("".concat(xc," found array but not enough entries (got ").concat(i,", expected ").concat(e.value,")"));r[i]=o}return r}(n,e,t);if(n.type===ac.map)return function(e,t,n){const r=!0===n.useMaps,i=r?void 0:{},o=r?new Map:void 0;for(let s=0;s<e.value;s++){const a=Nl(t,n);if(a===Pl){if(e.value===1/0)break;throw new Error("".concat(xc," got unexpected break to lengthed map"))}if(a===Tl)throw new Error("".concat(xc," found map but not enough entries (got ").concat(s," [no key], expected ").concat(e.value,")"));if(!0!==r&&"string"!==typeof a)throw new Error("".concat(xc," non-string keys not supported (got ").concat(typeof a,")"));if(!0===n.rejectDuplicateMapKeys&&(r&&o.has(a)||!r&&a in i))throw new Error("".concat(xc,' found repeat map key "').concat(a,'"'));const c=Nl(t,n);if(c===Tl)throw new Error("".concat(xc," found map but not enough entries (got ").concat(s," [no value], expected ").concat(e.value,")"));r?o.set(a,c):i[a]=c}return r?o:i}(n,e,t);if(n.type===ac.tag){if(t.tags&&"function"===typeof t.tags[n.value]){const r=Nl(e,t);return t.tags[n.value](r)}throw new Error("".concat(xc," tag not supported (").concat(n.value,")"))}throw new Error("unsupported")}function Bl(e,t){const[n,r]=function(e,t){if(!(e instanceof Uint8Array))throw new Error("".concat(xc," data to decode must be a Uint8Array"));const n=(t=Object.assign({},Rl,t)).tokenizer||new Cl(e,t),r=Nl(n,t);if(r===Tl)throw new Error("".concat(xc," did not find any content to decode"));if(r===Pl)throw new Error("".concat(xc," got unexpected break"));return[r,e.subarray(n.pos())]}(e,t);if(r.length>0)throw new Error("".concat(xc," too many terminals, data makes no sense"));return n}const Dl={float64:!0,typeEncoders:{Object:function(e){if(e.asCID!==e&&e["/"]!==e.bytes)return null;const t=qi.asCID(e);if(!t)return null;const n=new Uint8Array(t.bytes.byteLength+1);return n.set(t.bytes,1),[new cc(ac.tag,42),new cc(ac.bytes,n)]},undefined:function(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")},number:function(e){if(Number.isNaN(e))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(e===1/0||e===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}}};const Ol={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};Ol.tags[42]=function(e){if(0!==e[0])throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return qi.decode(e.subarray(1))};Ol.tags.slice();const Ll=113,Ml=e=>Bl(function(e){return e instanceof ArrayBuffer?new Uint8Array(e,0,e.byteLength):e}(e),Ol);ac.uint.major,ac.negint.major,ac.bytes.major,ac.string.major,ac.array.major,ac.map.major,ac.tag.major,ac.float.major;class Fl{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._pos=0,this.data=e,this.options=t,this.modeStack=["value"],this.lastToken=""}pos(){return this._pos}done(){return this._pos>=this.data.length}ch(){return this.data[this._pos]}currentMode(){return this.modeStack[this.modeStack.length-1]}skipWhitespace(){let e=this.ch();for(;32===e||9===e||13===e||10===e;)e=this.data[++this._pos]}expect(e){if(this.data.length-this._pos<e.length)throw new Error("".concat(xc," unexpected end of input at position ").concat(this._pos));for(let t=0;t<e.length;t++)if(this.data[this._pos++]!==e[t])throw new Error("".concat(xc," unexpected token at position ").concat(this._pos,", expected to find '").concat(String.fromCharCode(...e),"'"))}parseNumber(){const e=this._pos;let t=!1,n=!1;const r=e=>{for(;!this.done();){const t=this.ch();if(!e.includes(t))break;this._pos++}};if(45===this.ch()&&(t=!0,this._pos++),48===this.ch()){if(this._pos++,46!==this.ch())return new cc(ac.uint,0,this._pos-e);this._pos++,n=!0}if(r([48,49,50,51,52,53,54,55,56,57]),t&&this._pos===e+1)throw new Error("".concat(xc," unexpected token at position ").concat(this._pos));if(!this.done()&&46===this.ch()){if(n)throw new Error("".concat(xc," unexpected token at position ").concat(this._pos));n=!0,this._pos++,r([48,49,50,51,52,53,54,55,56,57])}this.done()||101!==this.ch()&&69!==this.ch()||(n=!0,this._pos++,this.done()||43!==this.ch()&&45!==this.ch()||this._pos++,r([48,49,50,51,52,53,54,55,56,57]));const i=String.fromCharCode.apply(null,this.data.subarray(e,this._pos)),o=parseFloat(i);return n?new cc(ac.float,o,this._pos-e):!0!==this.options.allowBigInt||Number.isSafeInteger(o)?new cc(o>=0?ac.uint:ac.negint,o,this._pos-e):new cc(o>=0?ac.uint:ac.negint,BigInt(i),this._pos-e)}parseString(){if(34!==this.ch())throw new Error("".concat(xc," unexpected character at position ").concat(this._pos,"; this shouldn't happen"));this._pos++;for(let i=this._pos,o=0;i<this.data.length&&o<65536;i++,o++){const e=this.data[i];if(92===e||e<32||e>=128)break;if(34===e){const e=String.fromCharCode.apply(null,this.data.subarray(this._pos,i));return this._pos=i+1,new cc(ac.string,e,o)}}const e=this._pos,t=[],n=()=>{if(this._pos+4>=this.data.length)throw new Error("".concat(xc," unexpected end of unicode escape sequence at position ").concat(this._pos));let e=0;for(let t=0;t<4;t++){let t=this.ch();if(t>=48&&t<=57)t-=48;else if(t>=97&&t<=102)t=t-97+10;else{if(!(t>=65&&t<=70))throw new Error("".concat(xc," unexpected unicode escape character at position ").concat(this._pos));t=t-65+10}e=16*e+t,this._pos++}return e},r=()=>{const e=this.ch();let n,r,i,o,s=null,a=e>239?4:e>223?3:e>191?2:1;if(this._pos+a>this.data.length)throw new Error("".concat(xc," unexpected unicode sequence at position ").concat(this._pos));switch(a){case 1:e<128&&(s=e);break;case 2:n=this.data[this._pos+1],128===(192&n)&&(o=(31&e)<<6|63&n,o>127&&(s=o));break;case 3:n=this.data[this._pos+1],r=this.data[this._pos+2],128===(192&n)&&128===(192&r)&&(o=(15&e)<<12|(63&n)<<6|63&r,o>2047&&(o<55296||o>57343)&&(s=o));break;case 4:n=this.data[this._pos+1],r=this.data[this._pos+2],i=this.data[this._pos+3],128===(192&n)&&128===(192&r)&&128===(192&i)&&(o=(15&e)<<18|(63&n)<<12|(63&r)<<6|63&i,o>65535&&o<1114112&&(s=o))}null===s?(s=65533,a=1):s>65535&&(s-=65536,t.push(s>>>10&1023|55296),s=56320|1023&s),t.push(s),this._pos+=a};for(;!this.done();){const i=this.ch();let o;switch(i){case 92:if(this._pos++,this.done())throw new Error("".concat(xc," unexpected string termination at position ").concat(this._pos));switch(o=this.ch(),this._pos++,o){case 34:case 39:case 92:case 47:t.push(o);break;case 98:t.push(8);break;case 116:t.push(9);break;case 110:t.push(10);break;case 102:t.push(12);break;case 114:t.push(13);break;case 117:t.push(n());break;default:throw new Error("".concat(xc," unexpected string escape character at position ").concat(this._pos))}break;case 34:return this._pos++,new cc(ac.string,Ac(t),this._pos-e);default:if(i<32)throw new Error("".concat(xc," invalid control character at position ").concat(this._pos));i<128?(t.push(i),this._pos++):r()}}throw new Error("".concat(xc," unexpected end of string at position ").concat(this._pos))}parseValue(){switch(this.ch()){case 123:return this.modeStack.push("obj-start"),this._pos++,new cc(ac.map,1/0,1);case 91:return this.modeStack.push("array-start"),this._pos++,new cc(ac.array,1/0,1);case 34:return this.parseString();case 110:return this.expect([110,117,108,108]),new cc(ac.null,null,4);case 102:return this.expect([102,97,108,115,101]),new cc(ac.false,!1,5);case 116:return this.expect([116,114,117,101]),new cc(ac.true,!0,4);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.parseNumber();default:throw new Error("".concat(xc," unexpected character at position ").concat(this._pos))}}next(){switch(this.skipWhitespace(),this.currentMode()){case"value":return this.modeStack.pop(),this.parseValue();case"array-value":if(this.modeStack.pop(),93===this.ch())return this._pos++,this.skipWhitespace(),new cc(ac.break,void 0,1);if(44!==this.ch())throw new Error("".concat(xc," unexpected character at position ").concat(this._pos,", was expecting array delimiter but found '").concat(String.fromCharCode(this.ch()),"'"));return this._pos++,this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue();case"array-start":return this.modeStack.pop(),93===this.ch()?(this._pos++,this.skipWhitespace(),new cc(ac.break,void 0,1)):(this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue());case"obj-key":if(125===this.ch())return this.modeStack.pop(),this._pos++,this.skipWhitespace(),new cc(ac.break,void 0,1);if(44!==this.ch())throw new Error("".concat(xc," unexpected character at position ").concat(this._pos,", was expecting object delimiter but found '").concat(String.fromCharCode(this.ch()),"'"));this._pos++,this.skipWhitespace();case"obj-start":{if(this.modeStack.pop(),125===this.ch())return this._pos++,this.skipWhitespace(),new cc(ac.break,void 0,1);const e=this.parseString();if(this.skipWhitespace(),58!==this.ch())throw new Error("".concat(xc," unexpected character at position ").concat(this._pos,", was expecting key/value delimiter ':' but found '").concat(String.fromCharCode(this.ch()),"'"));return this._pos++,this.modeStack.push("obj-value"),e}case"obj-value":return this.modeStack.pop(),this.modeStack.push("obj-key"),this.skipWhitespace(),this.parseValue();default:throw new Error("".concat(xc," unexpected parse state at position ").concat(this._pos,"; this shouldn't happen"))}}}function Ul(e,t){return Bl(e,t=Object.assign({tokenizer:new Fl(e,t)},t))}class jl extends Fl{constructor(e,t){super(e,t),this.tokenBuffer=[]}done(){return 0===this.tokenBuffer.length&&super.done()}_next(){return this.tokenBuffer.length>0?this.tokenBuffer.pop():super.next()}next(){const e=this._next();if(e.type===ac.map){const e=this._next();if(e.type===ac.string&&"/"===e.value){const e=this._next();if(e.type===ac.string){if(this._next().type!==ac.break)throw new Error("Invalid encoded CID form");return this.tokenBuffer.push(e),new cc(ac.tag,42,0)}if(e.type===ac.map){const e=this._next();if(e.type===ac.string&&"bytes"===e.value){const e=this._next();if(e.type===ac.string){for(let e=0;e<2;e++){if(this._next().type!==ac.break)throw new Error("Invalid encoded Bytes form")}const t=us.decode("m".concat(e.value));return new cc(ac.bytes,t,e.value.length)}this.tokenBuffer.push(e)}this.tokenBuffer.push(e)}this.tokenBuffer.push(e)}this.tokenBuffer.push(e)}return e}}const Hl={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};Hl.tags[42]=qi.parse;const zl=297,Vl=e=>{const t=function(e){return e instanceof ArrayBuffer?new Uint8Array(e,0,e.byteLength):e}(e);return Ul(t,Object.assign(Hl,{tokenizer:new jl(t,Hl)}))};new TextDecoder,new TextEncoder;function ql(e,t,n,r,i,o,s){let a=e,c=i;for(;o.length>0;){const l=o[0];if(!(l in a))throw Or(new Error("No property named ".concat(l," found in node ").concat(n)),"ERR_NO_PROP");{o.shift(),c="".concat(c,"/").concat(l);const u=qi.asCID(a[l]);if(null!=u)return{entry:{type:"object",name:r,path:i,cid:n,node:t,depth:s,size:BigInt(t.length),content:async function*(){yield e}},next:{cid:u,name:l,path:c,toResolve:o}};a=a[l]}}return{entry:{type:"object",name:r,path:i,cid:n,node:t,depth:s,size:BigInt(t.length),content:async function*(){yield e}}}}const Gl=async(e,t,n,r,i,o,s,a)=>{const c=await s.get(e,a);return ql(Ml(c),c,e,t,n,r,o)},Kl=async(e,t,n,r,i,o,s,a)=>{const c=await s.get(e,a);return ql(Vl(c),c,e,t,n,r,o)};const Wl=function(e,t,n,r){const i=BigInt(e.length),o=BigInt(t+i);return n>=o||r<t?new Uint8Array(0):(r>=t&&r<o&&(e=e.subarray(0,Number(r-t))),n>=t&&n<o&&(e=e.subarray(Number(n-t))),e)},Ql=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;const r=BigInt(e),i=BigInt(null!==t&&void 0!==t?t:0);let o=BigInt(n);if(o!==r&&(o=i+o),o>r&&(o=r),i<0n)throw Or(new Error("Offset must be greater than or equal to 0"),"ERR_INVALID_PARAMS");if(i>r)throw Or(new Error("Offset must be less than the file size"),"ERR_INVALID_PARAMS");if(o<0n)throw Or(new Error("Length must be greater than or equal to 0"),"ERR_INVALID_PARAMS");if(o>r)throw Or(new Error("Length must be less than the file size"),"ERR_INVALID_PARAMS");return{start:i,end:o}},Yl=async(e,t,n,r,i,o,s,a)=>{if(r.length>0)throw Or(new Error("No link named ".concat(n," found in raw node ").concat(e)),"ERR_NOT_FOUND");const c=Ui(e.multihash.bytes);return{entry:{type:"identity",name:t,path:n,cid:e,content:(l=c.digest,function(){try{let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return async function*(t){const{start:n,end:r}=Ql(l.length,e.offset,e.length),i=Wl(l,0n,n,r);null===(t=e.onProgress)||void 0===t||t.call(e,new ha("unixfs:exporter:progress:identity",{bytesRead:BigInt(i.byteLength),totalBytes:r-n,fileSize:BigInt(l.byteLength)})),yield i}()}catch(BJ){return Promise.reject(BJ)}}),depth:o,size:BigInt(c.digest.length),node:c.digest}};var l},Zl=async(e,t,n,r,i,o,s,a)=>{const c=await s.get(e,a);return ql(Es(c),c,e,t,n,r,o)},Jl=async(e,t,n,r,i,o,s,a)=>{if(r.length>0)throw Or(new Error("No link named ".concat(n," found in raw node ").concat(e)),"ERR_NOT_FOUND");const c=await s.get(e,a);return{entry:{type:"raw",name:t,path:n,cid:e,content:(l=c,function(){try{let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return async function*(t){const{start:n,end:r}=Ql(l.length,e.offset,e.length),i=Wl(l,0n,n,r);null===(t=e.onProgress)||void 0===t||t.call(e,new ha("unixfs:exporter:progress:raw",{bytesRead:BigInt(i.byteLength),totalBytes:r-n,fileSize:BigInt(l.byteLength)})),yield i}()}catch(BJ){return Promise.reject(BJ)}}),depth:o,size:BigInt(c.length),node:c}};var l},Xl=async function(e){return(await Ra.encode(e)).slice(0,8).reverse()},$l=(e,t)=>e.toString(16).toUpperCase().padStart(t,"0").substring(0,t),eu=async(e,t,n,r,i)=>{if(null==r){if(null==e.Data)throw Or(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");let t;try{t=da.unmarshal(e.Data)}catch(u){throw Or(u,"ERR_NOT_UNIXFS")}if("hamt-sharded-directory"!==t.type)throw Or(new Error("not a HAMT"),"ERR_NOT_UNIXFS");if(null==t.fanout)throw Or(new Error("missing fanout"),"ERR_NOT_UNIXFS");const n=Ha({hashFn:Xl,bits:Math.log2(Number(t.fanout))});r={rootBucket:n,hamtDepth:1,lastBucket:n}}const o=(r.lastBucket.tableSize()-1).toString(16).length;await(async(e,t,n)=>{const r=(t.tableSize()-1).toString(16).length;await Promise.all(e.map((async e=>{if(null==e.Name)throw new Error("Unexpected Link without a Name");if(e.Name.length!==r)await n.put(e.Name.substring(2),!0);else{const r=parseInt(e.Name,16);t._putObjectAt(r,new Ta({hash:n._options.hash,bits:n._options.bits},t,r))}})))})(e.Links,r.lastBucket,r.rootBucket);const s=await r.rootBucket._findNewBucketAndPos(t);let a=$l(s.pos,o);const c=(e=>{let t=e.bucket;const n=[];for(;null!=t._parent;)n.push(t),t=t._parent;return n.push(t),n.reverse()})(s);c.length>r.hamtDepth&&(r.lastBucket=c[r.hamtDepth],a=$l(r.lastBucket._posAtParent,o));const l=e.Links.find((e=>{if(null==e.Name)return!1;const n=e.Name.substring(0,o),r=e.Name.substring(o);return n===a&&(""===r||r===t)}));if(null==l)return;if(null!=l.Name&&l.Name.substring(o)===t)return l.Hash;r.hamtDepth++;return e=Ao(await n.get(l.Hash,i)),eu(e,t,n,r,i)},tu=eu;const nu=function(e){const[t,n]=null!=e[Symbol.asyncIterator]?[e[Symbol.asyncIterator](),Symbol.asyncIterator]:[e[Symbol.iterator](),Symbol.iterator],r=[];return{peek:()=>t.next(),push:e=>{r.push(e)},next:()=>r.length>0?{done:!1,value:r.shift()}:t.next(),[n](){return this}}};const ru=function(e,t){let n=0;if(null!=e[Symbol.asyncIterator])return async function*(){for await(const r of e)await t(r,n++)&&(yield r)}();const r=nu(e),{value:i,done:o}=r.next();if(!0===o)return function*(){}();const s=t(i,n++);if("function"===typeof s.then)return async function*(){await s&&(yield i);for await(const e of r)await t(e,n++)&&(yield e)}();const a=t;return function*(){!0===s&&(yield i);for(const e of r)a(e,n++)&&(yield e)}()};const iu=function(e,t){let n=0;if(null!=e[Symbol.asyncIterator])return async function*(){for await(const r of e)yield t(r,n++)}();const r=nu(e),{value:i,done:o}=r.next();if(!0===o)return function*(){}();const s=t(i,n++);if("function"===typeof s.then)return async function*(){yield await s;for await(const e of r)yield t(e,n++)}();const a=t;return function*(){yield s;for(const e of r)yield a(e,n++)}()};function ou(){const e={};return e.promise=new Promise(((t,n)=>{e.resolve=t,e.reject=n})),e}var su;const au=null!==(su=globalThis.CustomEvent)&&void 0!==su?su:Event;function cu(e){try{let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(n){let r=null!==(n=t.concurrency)&&void 0!==n?n:1/0;r<1&&(r=1/0);const i=null!=t.ordered&&t.ordered,o=new EventTarget,s=[];let a,c=ou(),l=ou(),u=!1,d=!1;function h(){var e;return i?null===(e=s[0])||void 0===e?void 0:e.done:Boolean(s.find((e=>e.done)))}function*f(){for(;s.length>0&&s[0].done;){const e=s[0];if(s.shift(),!e.ok)throw d=!0,c.resolve(),e.err;yield e.value,c.resolve()}}function*p(){for(;h();)for(let e=0;e<s.length;e++)if(s[e].done){const t=s[e];if(s.splice(e,1),e--,!t.ok)throw d=!0,c.resolve(),t.err;yield t.value,c.resolve()}}for(o.addEventListener("task-complete",(()=>{l.resolve()})),Promise.resolve().then((async()=>{try{for await(const t of e){if(s.length===r&&(c=ou(),await c.promise),d)break;const e={done:!1};s.push(e),t().then((t=>{e.done=!0,e.ok=!0,e.value=t,o.dispatchEvent(new au("task-complete"))}),(t=>{e.done=!0,e.err=t,o.dispatchEvent(new au("task-complete"))}))}u=!0,o.dispatchEvent(new au("task-complete"))}catch(t){a=t,o.dispatchEvent(new au("task-complete"))}}));;){if(h()||(l=ou(),await l.promise),null!=a)throw a;if(i?yield*f():yield*p(),u&&0===s.length)break}}()}catch(BJ){return Promise.reject(BJ)}}class lu{constructor(e){if(Dr(this,"buffer",void 0),Dr(this,"mask",void 0),Dr(this,"top",void 0),Dr(this,"btm",void 0),Dr(this,"next",void 0),!(e>0)||0!==(e-1&e))throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){const e=this.buffer[this.btm];if(void 0!==e)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return void 0===this.buffer[this.btm]}}class uu{constructor(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Dr(this,"size",void 0),Dr(this,"hwm",void 0),Dr(this,"head",void 0),Dr(this,"tail",void 0),this.hwm=null!==(e=t.splitLimit)&&void 0!==e?e:16,this.head=new lu(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return null!=(null===e||void 0===e?void 0:e.byteLength)?e.byteLength:1}push(e){if(null!=(null===e||void 0===e?void 0:e.value)&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){const t=this.head;this.head=t.next=new lu(2*this.head.buffer.length),this.head.push(e)}}shift(){var e;let t=this.tail.shift();if(void 0===t&&null!=this.tail.next){const e=this.tail.next;this.tail.next=null,this.tail=e,t=this.tail.shift()}return null!=(null===(e=t)||void 0===e?void 0:e.value)&&(this.size-=this.calculateSize(t.value)),t}isEmpty(){return this.head.isEmpty()}}class du extends Error{constructor(e,t){super(null!==e&&void 0!==e?e:"The operation was aborted"),Dr(this,"type",void 0),Dr(this,"code",void 0),this.type="aborted",this.code=null!==t&&void 0!==t?t:"ABORT_ERR"}}function hu(){return fu((e=>{const t=e.shift();if(null==t)return{done:!0};if(null!=t.error)throw t.error;return{done:!0===t.done,value:t.value}}),arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function fu(e,t){var n;let r,i,o,s=(t=null!==(n=t)&&void 0!==n?n:{}).onEnd,a=new uu,c=ou();const l=e=>null!=i?i(e):(a.push(e),r),u=e=>{var n;if(o)return r;if(!0!==(null===(n=t)||void 0===n?void 0:n.objectMode)&&null==(null===e||void 0===e?void 0:e.byteLength))throw new Error("objectMode was not true but tried to push non-Uint8Array value");return l({done:!1,value:e})},d=e=>o?r:(o=!0,null!=e?(e=>(a=new uu,null!=i?i({error:e}):(a.push({error:e}),r)))(e):l({done:!0}));if(r={[Symbol.asyncIterator](){return this},next:async()=>{try{return a.isEmpty()?o?{done:!0}:await new Promise(((t,n)=>{i=o=>{i=null,a.push(o);try{t(e(a))}catch(s){n(s)}return r}})):e(a)}finally{a.isEmpty()&&queueMicrotask((()=>{c.resolve(),c=ou()}))}},return:()=>(a=new uu,d(),{done:!0}),throw:e=>(d(e),{done:!0}),push:u,end:d,get readableLength(){return a.size},onEmpty:async e=>{const t=null===e||void 0===e?void 0:e.signal;if(null===t||void 0===t||t.throwIfAborted(),a.isEmpty())return;let n,r;null!=t&&(n=new Promise(((e,n)=>{r=()=>{n(new du)},t.addEventListener("abort",r)})));try{await Promise.race([c.promise,n])}finally{null!=r&&null!=t&&(null===t||void 0===t||t.removeEventListener("abort",r))}}},null==s)return r;const h=r;return r={[Symbol.asyncIterator](){return this},next:()=>h.next(),throw:e=>(h.throw(e),null!=s&&(s(e),s=void 0),{done:!0}),return:()=>(h.return(),null!=s&&(s(),s=void 0),{done:!0}),push:u,end:e=>(h.end(e),null!=s&&(s(e),s=void 0),r),get readableLength(){return h.readableLength},onEmpty:e=>h.onEmpty(e)},r}const pu=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=[];for(const i of t)null==i[Symbol.asyncIterator]&&r.push(i);return r.length===t.length?function*(){for(const e of r)yield*e}():async function*(){const e=hu({objectMode:!0});Promise.resolve().then((async()=>{try{await Promise.all(t.map((async t=>{for await(const n of t)e.push(n)}))),e.end()}catch(n){e.end(n)}})),yield*e}()};function gu(e){if(null==e)throw new Error("Empty pipeline");if(wu(e)){const t=e;e=()=>t.source}else if(yu(e)||vu(e)){const t=e;e=()=>t}for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=[e,...n];if(i.length>1&&wu(i[i.length-1])&&(i[i.length-1]=i[i.length-1].sink),i.length>2)for(let o=1;o<i.length-1;o++)wu(i[o])&&(i[o]=bu(i[o]));return mu(...i)}const mu=function(){let e;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(;n.length>0;)e=n.shift()(e);return e},vu=e=>null!=(null===e||void 0===e?void 0:e[Symbol.asyncIterator]),yu=e=>null!=(null===e||void 0===e?void 0:e[Symbol.iterator]),wu=e=>null!=e&&(null!=e.sink&&null!=e.source),bu=e=>t=>{const n=e.sink(t);if(null!=(null===n||void 0===n?void 0:n.then)){const t=hu({objectMode:!0});let r;n.then((()=>{t.end()}),(e=>{t.end(e)}));const i=e.source;if(vu(i))r=async function*(){yield*i,t.end()};else{if(!yu(i))throw new Error("Unknown duplex source type - must be Iterable or AsyncIterable");r=function*(){yield*i,t.end()}}return pu(t,r())}return e.source},Eu=(e,t,n,r,i,o,s)=>function(){try{let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return async function*(a,c,l){const u=null!==(a=n.offset)&&void 0!==a?a:0,d=null!==(c=n.length)&&void 0!==c?c:t.Links.length,h=t.Links.slice(u,d);null===(l=n.onProgress)||void 0===l||l.call(n,new ha("unixfs:exporter:walk:directory",{cid:e})),yield*gu(h,(e=>iu(e,(e=>async()=>{var t;const a=null!==(t=e.Name)&&void 0!==t?t:"",c="".concat(r,"/").concat(a);return(await i(e.Hash,a,c,[],o+1,s,n)).entry}))),(e=>cu(e,{ordered:!0,concurrency:n.blockReadConcurrency})),(e=>ru(e,(e=>null!=e))))}()}catch(BJ){return Promise.reject(BJ)}};function ku(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Au(e,t){ku(e,t),t.add(e)}function Su(e,t,n){ku(e,t),t.set(e,n)}function xu(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}function _u(e,t,n){return n(xu(e,t))}function Iu(e,t){return e.get(xu(e,t))}function Ru(e,t,n){return e.set(xu(e,t),n),n}var Cu=n(7465);class Tu extends Error{constructor(e){super(e),this.name="TimeoutError"}}class Pu extends Error{constructor(e){super(),this.name="AbortError",this.message=e}}const Nu=e=>void 0===globalThis.DOMException?new Pu(e):new DOMException(e),Bu=e=>{const t=void 0===e.reason?Nu("This operation was aborted."):e.reason;return t instanceof Error?t:Nu(t)};function Du(e,t){const{milliseconds:n,fallback:r,message:i,customTimers:o={setTimeout:setTimeout,clearTimeout:clearTimeout}}=t;let s;const a=new Promise(((a,c)=>{if("number"!==typeof n||1!==Math.sign(n))throw new TypeError("Expected `milliseconds` to be a positive number, got `".concat(n,"`"));if(t.signal){const{signal:e}=t;e.aborted&&c(Bu(e)),e.addEventListener("abort",(()=>{c(Bu(e))}))}if(n===Number.POSITIVE_INFINITY)return void e.then(a,c);const l=new Tu;s=o.setTimeout.call(void 0,(()=>{if(r)try{a(r())}catch(t){c(t)}else"function"===typeof e.cancel&&e.cancel(),!1===i?a():i instanceof Error?c(i):(l.message=null!==i&&void 0!==i?i:"Promise timed out after ".concat(n," milliseconds"),c(l))}),n),(async()=>{try{a(await e)}catch(t){c(t)}})()})),c=a.finally((()=>{c.clear()}));return c.clear=()=>{o.clearTimeout.call(void 0,s),s=void 0},c}var Ou=new WeakMap;class Lu{constructor(){Su(this,Ou,[])}enqueue(e,t){const n={priority:(t={priority:0,...t}).priority,run:e};if(this.size&&Iu(Ou,this)[this.size-1].priority>=t.priority)return void Iu(Ou,this).push(n);const r=function(e,t,n){let r=0,i=e.length;for(;i>0;){const o=Math.trunc(i/2);let s=r+o;n(e[s],t)<=0?(r=++s,i-=o+1):i=o}return r}(Iu(Ou,this),n,((e,t)=>t.priority-e.priority));Iu(Ou,this).splice(r,0,n)}dequeue(){const e=Iu(Ou,this).shift();return null===e||void 0===e?void 0:e.run}filter(e){return Iu(Ou,this).filter((t=>t.priority===e.priority)).map((e=>e.run))}get size(){return Iu(Ou,this).length}}var Mu=new WeakMap,Fu=new WeakMap,Uu=new WeakMap,ju=new WeakMap,Hu=new WeakMap,zu=new WeakMap,Vu=new WeakMap,qu=new WeakMap,Gu=new WeakMap,Ku=new WeakMap,Wu=new WeakMap,Qu=new WeakMap,Yu=new WeakMap,Zu=new WeakMap,Ju=new WeakSet;class Xu extends Cu{constructor(e){var t,n,r,i;if(super(),Au(this,Ju),Su(this,Mu,void 0),Su(this,Fu,void 0),Su(this,Uu,0),Su(this,ju,void 0),Su(this,Hu,void 0),Su(this,zu,0),Su(this,Vu,void 0),Su(this,qu,void 0),Su(this,Gu,void 0),Su(this,Ku,void 0),Su(this,Wu,0),Su(this,Qu,void 0),Su(this,Yu,void 0),Su(this,Zu,void 0),Dr(this,"timeout",void 0),!("number"===typeof(e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:Lu,...e}).intervalCap&&e.intervalCap>=1))throw new TypeError("Expected `intervalCap` to be a number from 1 and up, got `".concat(null!==(t=null===(n=e.intervalCap)||void 0===n?void 0:n.toString())&&void 0!==t?t:"","` (").concat(typeof e.intervalCap,")"));if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError("Expected `interval` to be a finite number >= 0, got `".concat(null!==(r=null===(i=e.interval)||void 0===i?void 0:i.toString())&&void 0!==r?r:"","` (").concat(typeof e.interval,")"));Ru(Mu,this,e.carryoverConcurrencyCount),Ru(Fu,this,e.intervalCap===Number.POSITIVE_INFINITY||0===e.interval),Ru(ju,this,e.intervalCap),Ru(Hu,this,e.interval),Ru(Gu,this,new e.queueClass),Ru(Ku,this,e.queueClass),this.concurrency=e.concurrency,this.timeout=e.timeout,Ru(Zu,this,!0===e.throwOnTimeout),Ru(Yu,this,!1===e.autoStart)}get concurrency(){return Iu(Qu,this)}set concurrency(e){if(!("number"===typeof e&&e>=1))throw new TypeError("Expected `concurrency` to be a number from 1 and up, got `".concat(e,"` (").concat(typeof e,")"));Ru(Qu,this,e),xu(Ju,this,ad).call(this)}async add(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t={timeout:this.timeout,throwOnTimeout:Iu(Zu,this),...t},new Promise(((n,r)=>{Iu(Gu,this).enqueue((async()=>{var i,o;Ru(Wu,this,(i=Iu(Wu,this),i++,i)),Ru(Uu,this,(o=Iu(Uu,this),o++,o));try{var s;null===(s=t.signal)||void 0===s||s.throwIfAborted();let r=e({signal:t.signal});t.timeout&&(r=Du(Promise.resolve(r),{milliseconds:t.timeout})),t.signal&&(r=Promise.race([r,xu(Ju,this,cd).call(this,t.signal)]));const i=await r;n(i),this.emit("completed",i)}catch(a){if(a instanceof Tu&&!t.throwOnTimeout)return void n();r(a),this.emit("error",a)}finally{xu(Ju,this,td).call(this)}}),t),this.emit("add"),xu(Ju,this,id).call(this)}))}async addAll(e,t){return Promise.all(e.map((async e=>this.add(e,t))))}start(){return Iu(Yu,this)?(Ru(Yu,this,!1),xu(Ju,this,ad).call(this),this):this}pause(){Ru(Yu,this,!0)}clear(){Ru(Gu,this,new(Iu(Ku,this)))}async onEmpty(){0!==Iu(Gu,this).size&&await xu(Ju,this,ld).call(this,"empty")}async onSizeLessThan(e){Iu(Gu,this).size<e||await xu(Ju,this,ld).call(this,"next",(()=>Iu(Gu,this).size<e))}async onIdle(){0===Iu(Wu,this)&&0===Iu(Gu,this).size||await xu(Ju,this,ld).call(this,"idle")}get size(){return Iu(Gu,this).size}sizeBy(e){return Iu(Gu,this).filter(e).length}get pending(){return Iu(Wu,this)}get isPaused(){return Iu(Yu,this)}}function $u(e){return Iu(Fu,e)||Iu(Uu,e)<Iu(ju,e)}function ed(e){return Iu(Wu,e)<Iu(Qu,e)}function td(){var e;Ru(Wu,this,(e=Iu(Wu,this),e--,e)),xu(Ju,this,id).call(this),this.emit("next")}function nd(){xu(Ju,this,sd).call(this),xu(Ju,this,od).call(this),Ru(qu,this,void 0)}function rd(e){const t=Date.now();if(void 0===Iu(Vu,e)){const n=Iu(zu,e)-t;if(!(n<0))return void 0===Iu(qu,e)&&Ru(qu,e,setTimeout((()=>{xu(Ju,e,nd).call(e)}),n)),!0;Ru(Uu,e,Iu(Mu,e)?Iu(Wu,e):0)}return!1}function id(){if(0===Iu(Gu,this).size)return Iu(Vu,this)&&clearInterval(Iu(Vu,this)),Ru(Vu,this,void 0),this.emit("empty"),0===Iu(Wu,this)&&this.emit("idle"),!1;if(!Iu(Yu,this)){const e=!_u(Ju,this,rd);if(_u(Ju,this,$u)&&_u(Ju,this,ed)){const t=Iu(Gu,this).dequeue();return!!t&&(this.emit("active"),t(),e&&xu(Ju,this,od).call(this),!0)}}return!1}function od(){Iu(Fu,this)||void 0!==Iu(Vu,this)||(Ru(Vu,this,setInterval((()=>{xu(Ju,this,sd).call(this)}),Iu(Hu,this))),Ru(zu,this,Date.now()+Iu(Hu,this)))}function sd(){0===Iu(Uu,this)&&0===Iu(Wu,this)&&Iu(Vu,this)&&(clearInterval(Iu(Vu,this)),Ru(Vu,this,void 0)),Ru(Uu,this,Iu(Mu,this)?Iu(Wu,this):0),xu(Ju,this,ad).call(this)}function ad(){for(;xu(Ju,this,id).call(this););}async function cd(e){return new Promise(((t,n)=>{e.addEventListener("abort",(()=>{n(e.reason)}),{once:!0})}))}async function ld(e,t){return new Promise((n=>{const r=()=>{t&&!t()||(this.off(e,r),n())};this.on(e,r)}))}async function ud(e,t,n,r,i,o,s){if(t instanceof Uint8Array){const e=Wl(t,r,i,o);return void n.push(e)}if(null==t.Data)throw Or(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");let a;try{a=da.unmarshal(t.Data)}catch(l){throw Or(l,"ERR_NOT_UNIXFS")}if(null!=a.data){const e=a.data,t=Wl(e,r,i,o);n.push(t),r+=BigInt(t.byteLength)}const c=[];if(t.Links.length!==a.blockSizes.length)throw Or(new Error("Inconsistent block sizes and dag links"),"ERR_NOT_UNIXFS");for(let u=0;u<t.Links.length;u++){const e=t.Links[u],n=r,s=n+a.blockSizes[u];if((i>=n&&i<s||o>=n&&o<=s||i<n&&o>s)&&c.push({link:e,blockStart:r}),(r=s)>o)break}await gu(c,(t=>iu(t,(t=>async()=>{const n=await e.get(t.link.Hash,s);return{...t,block:n}}))),(e=>cu(e,{ordered:!0,concurrency:s.blockReadConcurrency})),(async t=>{for await(const{link:r,block:a,blockStart:c}of t){let t;switch(r.Hash.code){case Eo:t=Ao(a);break;case As:t=a;break;default:return void n.end(Or(new Error("Unsupported codec: ".concat(r.Hash.code)),"ERR_NOT_UNIXFS"))}const l=new Xu({concurrency:1});l.on("error",(e=>{n.end(e)})),l.add((async()=>{var a;null===(a=s.onProgress)||void 0===a||a.call(s,new ha("unixfs:exporter:walk:file",{cid:r.Hash})),await ud(e,t,n,c,i,o,s)})),await l.onIdle()}})),r>=o&&n.end()}const dd=(e,t,n,r,i,o,s)=>function(){try{let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return async function*(i){const o=n.fileSize();if(void 0===o)throw new Error("File was a directory");const{start:a,end:c}=Ql(o,r.offset,r.length);if(0n===c)return;let l=0n;const u=c-a,d=hu();null===(i=r.onProgress)||void 0===i||i.call(r,new ha("unixfs:exporter:walk:file",{cid:e})),ud(s,t,d,0n,a,c,r).catch((e=>{d.end(e)}));for await(const e of d){var h;if(null!=e){if(l+=BigInt(e.byteLength),l>u)throw d.end(),Or(new Error("Read too many bytes - the file size reported by the UnixFS data in the root node may be incorrect"),"ERR_OVER_READ");l===u&&d.end(),null===(h=r.onProgress)||void 0===h||h.call(r,new ha("unixfs:exporter:progress:unixfs:file",{bytesRead:l,totalBytes:u,fileSize:o})),yield e}}if(l<u)throw Or(new Error("Traversed entire DAG but did not read enough bytes"),"ERR_UNDER_READ")}()}catch(BJ){return Promise.reject(BJ)}};async function*hd(e,t,n,r,i,o){const s=e.Links;if(null==e.Data)throw Or(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");let a;try{a=da.unmarshal(e.Data)}catch(u){throw Or(u,"ERR_NOT_UNIXFS")}if(null==a.fanout)throw Or(new Error("missing fanout"),"ERR_NOT_UNIXFS");const c=(a.fanout-1n).toString(16).length,l=gu(s,(s=>iu(s,(s=>async()=>{const a=null!=s.Name?s.Name.substring(c):null;if(null!=a&&""!==a){const e=await n(s.Hash,a,"".concat(t,"/").concat(a),[],r+1,i,o);return{entries:null==e.entry?[]:[e.entry]}}{var l;const a=await i.get(s.Hash,o);return e=Ao(a),null===(l=o.onProgress)||void 0===l||l.call(o,new ha("unixfs:exporter:walk:hamt-sharded-directory",{cid:s.Hash})),{entries:hd(e,t,n,r,i,o)}}}))),(e=>cu(e,{ordered:!0,concurrency:o.blockReadConcurrency})));for await(const{entries:d}of l)yield*d}const fd=(e,t,n,r,i,o,s)=>function(){var n;let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return null===(n=a.onProgress)||void 0===n||n.call(a,new ha("unixfs:exporter:walk:hamt-sharded-directory",{cid:e})),hd(t,r,i,o,s,a)},pd={raw:dd,file:dd,directory:Eu,"hamt-sharded-directory":fd,metadata:(e,t,n,r,i,o,s)=>()=>[],symlink:(e,t,n,r,i,o,s)=>()=>[]},gd=async(e,t,n,r,i,o,s,a)=>{const c=Ao(await s.get(e,a));let l,u;if(null==t&&(t=e.toString()),null==c.Data)throw Or(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");try{l=da.unmarshal(c.Data)}catch(f){throw Or(f,"ERR_NOT_UNIXFS")}if(null==n&&(n=t),r.length>0){var d;let e;if(e="hamt-sharded-directory"===(null===(d=l)||void 0===d?void 0:d.type)?await tu(c,r[0],s):((e,t)=>{const n=e.Links.find((e=>e.Name===t));return null===n||void 0===n?void 0:n.Hash})(c,r[0]),null==e)throw Or(new Error("file does not exist"),"ERR_NOT_FOUND");const t=r.shift();u={cid:e,toResolve:r,name:null!==t&&void 0!==t?t:"",path:"".concat(n,"/").concat(t)}}const h=pd[l.type](e,c,l,n,i,o,s);if(null==h)throw Or(new Error("could not find content exporter"),"ERR_NOT_FOUND");return l.isDirectory()?{entry:{type:"directory",name:t,path:n,cid:e,content:h,unixfs:l,depth:o,node:c,size:l.fileSize()},next:u}:{entry:{type:"file",name:t,path:n,cid:e,content:h,unixfs:l,depth:o,node:c,size:l.fileSize()},next:u}},md={[Eo]:gd,[As]:Jl,[Ll]:Gl,[zl]:Kl,[Is.code]:Yl,[ws]:Zl},vd=async(e,t,n,r,i,o,s)=>{const a=md[e.code];if(null==a)throw Or(new Error("No resolver for code ".concat(e.code)),"ERR_NO_RESOLVER");return a(e,t,n,r,vd,i,o,s)},yd=vd,wd=e=>{if(e instanceof Uint8Array)return{cid:qi.decode(e),toResolve:[]};const t=qi.asCID(e);if(null!=t)return{cid:t,toResolve:[]};if("string"===typeof e){0===e.indexOf("/ipfs/")&&(e=e.substring(6));const t=function(){var e;return(null!==(e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").trim().match(/([^\\^/]|\\\/)+/g))&&void 0!==e?e:[]).filter(Boolean)}(e);return{cid:qi.parse(t[0]),toResolve:t.slice(1)}}throw Or(new Error("Unknown path type ".concat(e)),"ERR_BAD_PATH")};function bd(e,t){try{let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return async function*(){let{cid:r,toResolve:i}=wd(e),o=r.toString(),s=o;const a=i.length;for(;;){const c=await yd(r,o,s,i,a,t,n);if(null==c.entry&&null==c.next)throw Or(new Error("Could not resolve ".concat(e)),"ERR_NOT_FOUND");if(null!=c.entry&&(yield c.entry),null==c.next)return;i=c.next.toResolve,r=c.next.cid,o=c.next.name,s=c.next.path}}()}catch(BJ){return Promise.reject(BJ)}}async function Ed(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=await rc(bd(e,t,n));if(null==r)throw Or(new Error("Could not resolve ".concat(e)),"ERR_NOT_FOUND");return r}function kd(e,t){try{let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return async function*(){const r=await Ed(e,t,n);if(null!=r&&(yield r,"directory"===r.type))for await(const e of async function*e(t,n){for await(const r of t.content(n))yield r,r instanceof Uint8Array||"directory"===r.type&&(yield*e(r,n))}(r,n))yield e}()}catch(BJ){return Promise.reject(BJ)}}const Ad=n(8355);class Sd extends Error{constructor(e,t,n){super(e),Dr(this,"name",void 0),Dr(this,"code",void 0),this.name=t,this.code=n}}class xd extends Sd{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"not a Unixfs node","NotUnixFSError","ERR_NOT_UNIXFS")}}class _d extends Sd{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"invalid PBNode","InvalidPBNodeError","ERR_INVALID_PBNODE")}}class Id extends Sd{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"unknown error","InvalidPBNodeError","ERR_UNKNOWN_ERROR")}}class Rd extends Sd{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"path already exists","AlreadyExistsError","ERR_ALREADY_EXISTS")}}class Cd extends Sd{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"path does not exist","DoesNotExistError","ERR_DOES_NOT_EXIST")}}class Td extends Sd{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"no content","NoContentError","ERR_NO_CONTENT")}}class Pd extends Sd{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"not a file","NotAFileError","ERR_NOT_A_FILE")}}class Nd extends Sd{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"not a directory","NotADirectoryError","ERR_NOT_A_DIRECTORY")}}class Bd extends Sd{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"invalid parameters","InvalidParametersError","ERR_INVALID_PARAMETERS")}}var Dd=n(6522);function Od(){return{forComponent:e=>Ld(e)}}function Ld(e){let t=function(e){const t=()=>{};return t.enabled=!1,t.color="",t.diff=0,t.log=()=>{},t.namespace=e,t.destroy=()=>!0,t.extend=()=>t,t}("".concat(e,":trace"));return Dd.enabled("".concat(e,":trace"))&&null!=Dd.names.map((e=>e.toString())).find((e=>e.includes(":trace")))&&(t=Dd("".concat(e,":trace"))),Object.assign(Dd(e),{error:Dd("".concat(e,":error")),trace:t})}Dd.formatters.b=e=>null==e?"undefined":mi.baseEncode(e),Dd.formatters.t=e=>null==e?"undefined":ai.baseEncode(e),Dd.formatters.m=e=>null==e?"undefined":us.baseEncode(e),Dd.formatters.p=e=>null==e?"undefined":e.toString(),Dd.formatters.c=e=>null==e?"undefined":e.toString(),Dd.formatters.k=e=>null==e?"undefined":e.toString(),Dd.formatters.a=e=>null==e?"undefined":e.toString();const Md=function(e){if(null!=e[Symbol.asyncIterator])return(async()=>{const t=[];for await(const n of e)t.push(n);return t})();const t=[];for(const n of e)t.push(n);return t};function Fd(e){return function(t){return t instanceof Ud?t:new Ud(t,e)}}class Ud{constructor(e,t){if(Dr(this,"_value",void 0),Dr(this,"_hashFn",void 0),Dr(this,"_depth",void 0),Dr(this,"_availableBits",void 0),Dr(this,"_currentBufferIndex",void 0),Dr(this,"_buffers",void 0),!(e instanceof Uint8Array))throw new Error("can only hash Uint8Arrays");this._value=e,this._hashFn=t,this._depth=-1,this._availableBits=0,this._currentBufferIndex=0,this._buffers=[]}async take(e){let t=e;for(;this._availableBits<t;)await this._produceMoreBits();let n=0;for(;t>0;){const e=this._buffers[this._currentBufferIndex],r=Math.min(e.availableBits(),t);n=(n<<r)+e.take(r),t-=r,this._availableBits-=r,0===e.availableBits()&&this._currentBufferIndex++}return n}untake(e){let t=e;for(;t>0;){const e=this._buffers[this._currentBufferIndex],n=Math.min(e.totalBits()-e.availableBits(),t);e.untake(n),t-=n,this._availableBits+=n,this._currentBufferIndex>0&&e.totalBits()===e.availableBits()&&(this._depth--,this._currentBufferIndex--)}}async _produceMoreBits(){this._depth++;const e=this._depth>0?Hr([this._value,Uint8Array.from([this._depth])]):this._value,t=await this._hashFn(e),n=new zd(t);this._buffers.push(n),this._availableBits+=n.availableBits()}}const jd=[255,254,252,248,240,224,192,128],Hd=[1,3,7,15,31,63,127,255];class zd{constructor(e){Dr(this,"_value",void 0),Dr(this,"_currentBytePos",void 0),Dr(this,"_currentBitPos",void 0),this._value=e,this._currentBytePos=e.length-1,this._currentBitPos=7}availableBits(){return this._currentBitPos+1+8*this._currentBytePos}totalBits(){return 8*this._value.length}take(e){let t=e,n=0;for(;t>0&&this._haveBits();){const e=this._value[this._currentBytePos],r=this._currentBitPos+1,i=Math.min(r,t);n=(n<<i)+Vd(e,r-i,i),t-=i,this._currentBitPos-=i,this._currentBitPos<0&&(this._currentBitPos=7,this._currentBytePos--)}return n}untake(e){for(this._currentBitPos+=e;this._currentBitPos>7;)this._currentBitPos-=8,this._currentBytePos+=1}_haveBits(){return this._currentBytePos>=0}}function Vd(e,t,n){const r=function(e,t){return jd[e]&Hd[Math.min(t+e-1,7)]}(t,n);return(e&r)>>>t}const qd=BigInt(Ra.code);async function Gd(e){return(await Ra.encode(e)).subarray(0,8).reverse()}const Kd=async(e,t,n)=>{null==n.codec&&(n.codec=r);const i=await Ps.digest(e),o=qi.create(n.cidVersion,n.codec.code,i);return await t.put(o,e,{...n,signal:n.signal}),o};class Wd{constructor(e,t){Dr(this,"options",void 0),Dr(this,"root",void 0),Dr(this,"dir",void 0),Dr(this,"path",void 0),Dr(this,"dirty",void 0),Dr(this,"flat",void 0),Dr(this,"parent",void 0),Dr(this,"parentKey",void 0),Dr(this,"unixfs",void 0),Dr(this,"mode",void 0),Dr(this,"mtime",void 0),Dr(this,"cid",void 0),Dr(this,"size",void 0),Dr(this,"nodeSize",void 0),this.options=null!==t&&void 0!==t?t:{},this.root=e.root,this.dir=e.dir,this.path=e.path,this.dirty=e.dirty,this.flat=e.flat,this.parent=e.parent,this.parentKey=e.parentKey,this.unixfs=e.unixfs,this.mode=e.mode,this.mtime=e.mtime}}class Qd extends Wd{constructor(e,t){super(e,t),Dr(this,"_bucket",void 0),this._bucket=Ha({hashFn:Gd,bits:8})}async put(e,t){this.cid=void 0,this.size=void 0,this.nodeSize=void 0,await this._bucket.put(e,t)}async get(e){return this._bucket.get(e)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(const{key:e,value:t}of this._bucket.eachLeafSeries())yield{key:e,child:t}}estimateNodeSize(){return void 0!==this.nodeSize||(this.nodeSize=Zd(this._bucket,this,this.options)),this.nodeSize}async*flush(e){for await(const t of Yd(this._bucket,e,this,this.options))yield{...t,path:this.path}}}async function*Yd(e,t,n,r){const i=e._children,o=[];let s=0n;for(let h=0;h<i.length;h++){const e=i.get(h);if(null==e)continue;const n=h.toString(16).toUpperCase().padStart(2,"0");if(e instanceof Ta){let i;for await(const n of Yd(e,t,null,r))i=n;if(null==i)throw new Error("Could not flush sharded directory, no subshard found");o.push({Name:n,Tsize:Number(i.size),Hash:i.cid}),s+=i.size}else if("function"===typeof e.value.flush){const r=e.value;let i;for await(const e of r.flush(t))i=e,yield i;if(null==i)throw new Error("Did not flush dir");const a=n+e.key;o.push({Name:a,Tsize:Number(i.size),Hash:i.cid}),s+=i.size}else{const t=e.value;if(null==t.cid)continue;const r=n+e.key,i=t.size;o.push({Name:r,Tsize:Number(i),Hash:t.cid}),s+=BigInt(null!==i&&void 0!==i?i:0)}}const a=Uint8Array.from(i.bitField().reverse()),c=new da({type:"hamt-sharded-directory",data:a,fanout:BigInt(e.tableSize()),hashType:qd,mtime:null===n||void 0===n?void 0:n.mtime,mode:null===n||void 0===n?void 0:n.mode}),l=ko(mo({Data:c.marshal(),Links:o})),u=await Kd(l,t,r),d=BigInt(l.byteLength)+s;yield{cid:u,unixfs:c,size:d}}function Zd(e,t,n){const r=e._children,i=[];for(let s=0;s<r.length;s++){const e=r.get(s);if(null==e)continue;const t=s.toString(16).toUpperCase().padStart(2,"0");if(e instanceof Ta){const r=Zd(e,null,n);i.push({Name:t,Tsize:Number(r),Hash:0===n.cidVersion?Jd:Xd})}else if("function"===typeof e.value.flush){const r=e.value.nodeSize();i.push({Name:t+e.key,Tsize:Number(r),Hash:0===n.cidVersion?Jd:Xd})}else{const n=e.value;if(null==n.cid)continue;const r=t+e.key,o=n.size;i.push({Name:r,Tsize:Number(o),Hash:n.cid})}}const o=Uint8Array.from(r.bitField().reverse());return ko(mo({Data:new da({type:"hamt-sharded-directory",data:o,fanout:BigInt(e.tableSize()),hashType:qd,mtime:null===t||void 0===t?void 0:t.mtime,mode:null===t||void 0===t?void 0:t.mode}).marshal(),Links:i})).length}const Jd=qi.parse("QmUNLLsPACCz1vLxQVkXqqLX5R1X345qqfHbsf67hvA3Nn"),Xd=qi.parse("zdj7WbTaiJT1fgatdet9Ei9iDB5hdCxkbVyhyh8YTUnXMiwYi"),$d=Ld("helia:unixfs:commands:utils:hamt-utils"),eh=e=>e.toString(16).toUpperCase().padStart(2,"0").substring(0,2),th=async(e,t,n)=>{var r;const i=da.unmarshal(null!==(r=e[0].node.Data)&&void 0!==r?r:new Uint8Array(0)),o=BigInt(Math.pow(2,8));let s,a;e.reverse();for(let c=0;c<e.length;c++){const r=c===e.length-1,l=e[c],u=Uint8Array.from(l.children.bitField().reverse()),d=new da({type:"hamt-sharded-directory",data:u,fanout:o,hashType:qd});r&&(d.mtime=i.mtime,d.mode=i.mode),a={Data:d.marshal(),Links:l.node.Links};const h=ko(mo(a));if(s=await Kd(h,t,n),!r){const t=e[c+1];if(null==t)throw new Error("Was not operating on shard root but also had no parent?");$d("updating link in parent sub-shard with prefix %s",t.prefix),t.node.Links=t.node.Links.filter((e=>e.Name!==t.prefix)),t.node.Links.push({Name:t.prefix,Hash:s,Tsize:l.node.Links.reduce(((e,t)=>{var n;return e+(null!==(n=t.Tsize)&&void 0!==n?n:0)}),h.byteLength)})}}if(null==s||null==a)throw new Error("Noting persisted");return{cid:s,node:a}},nh=async(e,t,n,r)=>{const i=Fd(Gd)(Fs(t)),o=[];for(;;){var s;const c=Ao(await n.get(e,r)),l=new Ca,u=await i.take(8),d=eh(u);let h;o.push({prefix:d,children:l,node:c});for(const e of c.Links){var a;const t=null!==(a=e.Name)&&void 0!==a?a:"";if(t.length<2)throw new Error("Invalid HAMT - link name was too short");const n=parseInt(t.substring(0,2),16);l.set(n,!0),t.startsWith(d)&&(h=e)}if(null==h){$d("no link found with prefix %s for %s",d,t);break}const f=null!==(s=h.Name)&&void 0!==s?s:"";if(f.length<2)throw new Error("Invalid HAMT - link name was too short");if(2!==f.length)break;e=h.Hash,$d("descend into sub-shard with prefix %s",f)}return{path:o,hash:i}};async function rh(e,t,n,r){if(null==e.Data)throw new Error("DagPB node had no data");const i=da.unmarshal(e.Data);let o;if("directory"===i.type)o=function(e){let t=0;for(const r of e.Links){var n;t+=(null!==(n=r.Name)&&void 0!==n?n:"").length,t+=1===r.Hash.version?Xd.bytes.byteLength:Jd.bytes.byteLength}return t}(e);else{if("hamt-sharded-directory"!==i.type)throw new Error("Can only estimate the size of directories or shards");o=await ih(e,0,n,t,r)}return o>n}async function ih(e,t,n,r,i){if(t>n)return n;if(null==e.Data)return t;if(!da.unmarshal(e.Data).isDirectory())return t;for(const s of e.Links){var o;let e=null!==(o=s.Name)&&void 0!==o?o:"";if(e=e.substring(2),t+=e.length,t+=s.Hash.bytes.byteLength,s.Hash.code===Eo){const e=Ao(await r.get(s.Hash,i));t+=await ih(e,t,n,r,i)}}return t}const oh=Ld("helia:unixfs:components:utils:add-link");async function sh(e,t,n,r){if(null==e.node.Data)throw new Bd("Invalid parent passed to addLink");if("hamt-sharded-directory"===da.unmarshal(e.node.Data).type)return oh("adding link to sharded directory"),lh(e,t,n,r);oh("adding ".concat(t.Name," (").concat(t.Hash,") to regular directory"));const i=await ch(e,t,n,r);if(await rh(i.node,n,r.shardSplitThresholdBytes,r)){oh("converting directory to sharded directory");const e=await ah(i,n);i.cid=e.cid,i.node=Ao(await n.get(e.cid,r))}return i}const ah=async(e,t)=>{if(null==e.node.Data)throw new Bd("Invalid parent passed to convertToShardedDirectory");const n=da.unmarshal(e.node.Data),r=await(async(e,t,n)=>{const r=new Qd({root:!0,dir:!0,parent:void 0,parentKey:void 0,path:"",dirty:!0,flat:!1,mtime:n.mtime,mode:n.mode},n);for(let o=0;o<t.length;o++)await r._bucket.put(t[o].name,{size:t[o].size,cid:t[o].cid});const i=await rc(r.flush(e));if(null==i)throw new Error("Flushing shard yielded no result");return i})(t,e.node.Links.map((e=>{var t,n;return{name:null!==(t=e.Name)&&void 0!==t?t:"",size:BigInt(null!==(n=e.Tsize)&&void 0!==n?n:0),cid:e.Hash}})),{mode:n.mode,mtime:n.mtime,cidVersion:e.cid.version});return oh("converted directory to sharded directory ".concat(r.cid)),r},ch=async(e,t,n,r)=>{const i=e.node.Links.filter((e=>{const n=e.Name===t.Name;if(n&&!r.allowOverwriting)throw new Rd;return!n}));if(i.push(t),null==e.node.Data)throw new _d("Parent node with no data passed to addToDirectory");const o=da.unmarshal(e.node.Data);let s;if(null!=o.mtime){const e=Date.now(),t=Math.floor(e/1e3);o.mtime={secs:BigInt(t),nsecs:1e3*(e-1e3*t)},s=o.marshal()}else s=e.node.Data;e.node=mo({Data:s,Links:i});const a=ko(e.node),c=await Ps.digest(a),l=qi.create(e.cid.version,Eo,c);return await n.put(l,a),{node:e.node,cid:l}},lh=async(e,t,n,r)=>{const{path:i,hash:o}=await nh(e.cid,t.Name,n,r),s=i[i.length-1];if(null==s)throw new Error("Invalid HAMT, could not generate path");const a=s.prefix,c=parseInt(a,16);oh("next prefix for %s is %s",t.Name,a);const l="".concat(a).concat(t.Name),u=s.node.Links.find((e=>{var t;return(null!==(t=e.Name)&&void 0!==t?t:"").startsWith(a)}));var d;if(null!=u)if(oh("link %s was present in shard",l),u.Name===l){if(!r.allowOverwriting)throw new Rd;oh("overwriting %s in subshard",t.Name),s.node.Links=s.node.Links.filter((e=>e.Name!==l)),s.node.Links.push({Name:l,Hash:t.Hash,Tsize:t.Tsize})}else{if(2===(null===(d=u.Name)||void 0===d?void 0:d.length))throw new Error("Existing link was subshard?!");{var h;oh("prefix %s already exists, creating new subshard",a);const e=s.node.Links.findIndex((e=>{var t;return null===(t=e.Name)||void 0===t?void 0:t.startsWith(a)})),n=s.node.Links.splice(e,1)[0],r=(null!==(h=n.Name)&&void 0!==h?h:"").substring(2),c=Fd(Gd)(Fs(r));for(let t=0;t<i.length;t++)await c.take(8);for(;;){const e=await c.take(8),s=eh(e);n.Name="".concat(s).concat(r);const l=await o.take(8),u=eh(l);if(s===u){const e=new Ca;e.set(l,!0),i.push({prefix:u,children:e,node:{Links:[]}});continue}const d=new Ca;d.set(l,!0),d.set(e,!0),i.push({prefix:a,children:d,node:{Links:[n,{Name:"".concat(u).concat(t.Name),Hash:t.Hash,Tsize:t.Tsize}]}});break}}}else oh("link %s was not present in sub-shard",l),t.Name=l,s.node.Links.push(t),s.children.set(c,!0),oh("adding %s to existing sub-shard",l);return th(i,n,r)};async function uh(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=await Ed(e,t,n);if("directory"!==r.type)throw new Nd("".concat(e.toString()," was not a UnixFS directory"));return{cid:e,node:r.node}}async function dh(e,t,n,r){const i=await Ed(e,n,r);if("directory"!==i.type&&"file"!==i.type&&"raw"!==i.type)throw new xd("".concat(e.toString()," was not a UnixFS node"));return{Name:t,Tsize:i.node instanceof Uint8Array?i.node.byteLength:hh(i.node),Hash:e}}function hh(e){const t=e.Links.reduce(((e,t)=>{var n;return e+(null!==(n=t.Tsize)&&void 0!==n?n:0)}),0);return ko(e).byteLength+t}const fh=Ld("helia:unixfs:components:utils:resolve");async function ph(e,t,n,r){if(null==t||""===t)return{cid:e};const i="/ipfs/".concat(e).concat(null==t?"":"/".concat(t)),o=await Md(bd(i,n,r));if(0===o.length)throw new Cd("Could not find path in directory");return fh("resolved %s to %c",t,e),{cid:o[o.length-1].cid,path:t,segments:o}}async function gh(e,t,n,r){if(null==t.segments||0===t.segments.length)return e;let i=t.segments.pop();if(null==i)throw new Error("Insufficient segments");i.cid=e,t.segments.reverse();for(const o of t.segments){const[t,s]=await Promise.all([uh(o.cid,n,r),dh(i.cid,i.name,n,r)]);e=(await sh(t,s,n,{...r,allowOverwriting:!0,cidVersion:e.version})).cid,o.cid=e,i=o}return e}const mh=Ad.bind({ignoreUndefined:!0}),vh={};const yh=262144,wh=Ad.bind({ignoreUndefined:!0}),bh=Ld("helia:unixfs:chmod"),Eh={recursive:!1,shardSplitThresholdBytes:yh};const kh=Ad.bind({ignoreUndefined:!0}),Ah=Ld("helia:unixfs:cp"),Sh={force:!1,shardSplitThresholdBytes:yh};const xh=Ad.bind({ignoreUndefined:!0}),_h={};const Ih=Ad.bind({ignoreUndefined:!0}),Rh=Ld("helia:unixfs:mkdir"),Ch={cidVersion:1,force:!1,shardSplitThresholdBytes:yh};const Th=Ld("helia:unixfs:utils:remove-link");const Ph=async(e,t,n,r)=>{e.node.Links=e.node.Links.filter((e=>e.Name!==t));const i=ko(e.node),o=await Kd(i,n,{...r,cidVersion:e.cid.version});return Th("Updated regular directory ".concat(o)),{node:e.node,cid:o}},Nh=async(e,t,n,r)=>{const{path:i}=await nh(e.cid,t,n,r),o=i[i.length-1];if(null==o)throw new Error("Invalid HAMT, could not generate path");const s=o.node.Links.filter((e=>{var n;return(null!==(n=e.Name)&&void 0!==n?n:"").substring(2)===t})).map((e=>e.Name)).pop();if(null==s)throw new Error("File not found");const a=s.substring(0,2),c=parseInt(a,16);if(o.node.Links=o.node.Links.filter((e=>e.Name!==s)),o.children.unset(c),1===o.node.Links.length)for(;;){var l;if(1===i.length)break;const e=i[i.length-1];if(null==e||e.node.Links.length>1)break;i.pop();const t=i[i.length-1];if(null==t)break;const n=e.node.Links[0];t.node.Links=t.node.Links.filter((e=>{var n;return!(null!==(n=e.Name)&&void 0!==n?n:"").startsWith(t.prefix)})),t.node.Links.push({Hash:n.Hash,Name:"".concat(t.prefix).concat((null!==(l=n.Name)&&void 0!==l?l:"").substring(2)),Tsize:n.Tsize})}return th(i,n,r)},Bh=async(e,t,n)=>{if(null==e.node.Data)throw new Bd("Invalid parent passed to convertToFlatDirectory");const i={Links:[]},o=await Ed(e.cid,t);if("directory"!==o.type)throw new Error("Unexpected node type");for await(const r of o.content()){let e=0;e=r.node instanceof Uint8Array?r.node.byteLength:ko(r.node).length,i.Links.push({Hash:r.cid,Name:r.name,Tsize:e})}const s=da.unmarshal(e.node.Data);i.Data=new da({type:"directory",mode:s.mode,mtime:s.mtime}).marshal();const a=ko(mo(i));return{cid:await Kd(a,t,{codec:r,cidVersion:e.cid.version,signal:n.signal}),node:i}},Dh=Ad.bind({ignoreUndefined:!0}),Oh=Ld("helia:unixfs:rm"),Lh={shardSplitThresholdBytes:yh};async function Mh(e,t,n){const r=Dh(Lh,arguments.length>3&&void 0!==arguments[3]?arguments[3]:{});if(t.includes("/"))throw new Bd("Name must not have slashes");const i=await uh(e,n,r);Oh("Removing %s from %c",t,e);const o=await async function(e,t,n,r){if(null==e.node.Data)throw new _d("Parent node had no data");if("hamt-sharded-directory"===da.unmarshal(e.node.Data).type){Th("removing ".concat(t," from sharded directory"));const i=await Nh(e,t,n,r);return await rh(i.node,n,r.shardSplitThresholdBytes,r)?i:(Th("converting shard to flat directory %c",e.cid),Bh(i,n,r))}return Th("removing link ".concat(t," regular directory")),Ph(e,t,n,r)}(i,t,n,{...r,cidVersion:e.version});return o.cid}const Fh=Ad.bind({ignoreUndefined:!0}),Uh=Ld("helia:unixfs:stat"),jh={};async function Hh(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=Fh(jh,n),i=await ph(e,n.path,t,r);Uh("stat %c",i.cid);const o=await Ed(i.cid,t,r);if("file"!==o.type&&"directory"!==o.type&&"raw"!==o.type)throw new xd;let s,a,c=0n,l=0n,u=0n,d=0n,h=0;const f=o.type;let p;if("raw"===o.type&&(c=BigInt(o.node.byteLength),l=BigInt(o.node.byteLength),u=BigInt(o.node.byteLength),d=BigInt(o.node.byteLength),h=1),"directory"===o.type&&(c=0n,l=BigInt(o.unixfs.marshal().byteLength),u=0n,d=l,h=1,s=o.unixfs.mode,a=o.unixfs.mtime,p=o.unixfs),"file"===o.type){var g,m;const e=await zh(i.cid,t,r);c=o.unixfs.fileSize(),l=BigInt((null!==(g=null===(m=o.node.Data)||void 0===m?void 0:m.byteLength)&&void 0!==g?g:0)+o.node.Links.reduce(((e,t)=>{var n;return e+(null!==(n=t.Tsize)&&void 0!==n?n:0)}),0)),u=BigInt(e.localFileSize),d=BigInt(e.localDagSize),h=e.blocks,s=o.unixfs.mode,a=o.unixfs.mtime,p=o.unixfs}return{cid:i.cid,mode:s,mtime:a,fileSize:c,dagSize:l,localFileSize:u,localDagSize:d,blocks:h,type:f,unixfs:p}}async function zh(e,t,n){const r={localFileSize:0,localDagSize:0,blocks:0};if(await t.has(e,n)){const o=await t.get(e,n);if(r.blocks++,r.localDagSize+=o.byteLength,e.code===As)r.localFileSize+=o.byteLength;else{if(e.code!==Eo)throw new Id("".concat(e.toString()," was neither DAG_PB nor RAW"));{const s=Ao(o);if(s.Links.length>0)for(const e of s.Links){const i=await zh(e.Hash,t,n);r.localFileSize+=i.localFileSize,r.localDagSize+=i.localDagSize,r.blocks+=i.blocks}else{var i;if(null==s.Data)throw new _d("PBNode ".concat(e.toString()," had no data"));const t=da.unmarshal(s.Data);if(null==t.data)throw new _d("UnixFS node ".concat(e.toString()," had no data"));r.localFileSize+=null!==(i=t.data.byteLength)&&void 0!==i?i:0}}}}return r}const Vh=Ad.bind({ignoreUndefined:!0}),qh=Ld("helia:unixfs:touch"),Gh={recursive:!1,shardSplitThresholdBytes:yh};class Kh{constructor(e){Dr(this,"components",void 0),this.components=e}addAll(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){yield*function(e,t){try{let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return async function*(){yield*Ja(e,t,{...$a,...n})}()}catch(BJ){return Promise.reject(BJ)}}(e,t.components.blockstore,n)}()}catch(BJ){return Promise.reject(BJ)}}async addBytes(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ec(e,this.components.blockstore,t)}async addByteStream(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return tc(e,this.components.blockstore,t)}async addFile(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{cid:r}=await Xa(e,t,{...$a,...n});return r}(e,this.components.blockstore,t)}async addDirectory(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return nc(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},this.components.blockstore,e)}cat(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){yield*function(e,t){try{let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return async function*(){const r=mh(vh,n),i=await ph(e,r.path,t,r),o=await Ed(i.cid,t,r);if("file"!==o.type&&"raw"!==o.type)throw new Pd;if(null==o.content)throw new Td;yield*o.content(r)}()}catch(BJ){return Promise.reject(BJ)}}(e,t.components.blockstore,n)}()}catch(BJ){return Promise.reject(BJ)}}async chmod(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return async function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i=wh(Eh,r),o=await ph(e,i.path,n,r);if(bh("chmod %c %d",o.cid,t),i.recursive){const s=await gu((async function*(){for await(const e of kd(o.cid,n,r)){let n,r=[];if("raw"===e.type)n=new da({type:"file",data:e.node});else{if("file"!==e.type&&"directory"!==e.type)throw new xd;n=e.unixfs,r=e.node.Links}n.mode=t;const i={Data:n.marshal(),Links:r};yield{path:e.path,content:i}}}),(t=>Ja(t,n,{...i,dagBuilder:async function*(t,n){for await(const r of t)yield async function(){const t=r.content,o=ko(t),s=await Kd(o,n,{...i,cidVersion:e.version});if(null==t.Data)throw new _d("".concat(s," had no data"));const a=da.unmarshal(t.Data);return{cid:s,size:BigInt(o.length),path:r.path,unixfs:a}}}})),(async e=>rc(e)));if(null==s)throw new Id("Could not chmod ".concat(o.cid.toString()));return gh(s.cid,o,n,i)}const s=await n.get(o.cid,r);let a,c=[];if(o.cid.code===As)a=new da({type:"file",data:s});else{const e=Ao(s);if(null==e.Data)throw new _d("".concat(o.cid.toString()," had no data"));c=e.Links,a=da.unmarshal(e.Data)}a.mode=t;const l=ko({Data:a.marshal(),Links:c}),u=await Ps.digest(l),d=qi.create(o.cid.version,Eo,u);return await n.put(d,l),gh(d,o,n,i)}(e,t,this.components.blockstore,n)}async cp(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return async function(e,t,n,r){const i=kh(Sh,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{});if(n.includes("/"))throw new Bd("Name must not have slashes");const[o,s]=await Promise.all([uh(t,r,i),dh(e,n,r,i)]);return Ah('Adding %c as "%s" to %c',e,n,t),(await sh(o,s,r,{allowOverwriting:i.force,cidVersion:t.version,...i})).cid}(e,t,n,this.components.blockstore,r)}ls(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){yield*function(e,t){try{let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return async function*(){const r=xh(_h,n),i=await ph(e,r.path,t,r),o=await Ed(i.cid,t);if("file"!==o.type&&"raw"!==o.type){if(null==o.content)throw new Td;if("directory"!==o.type)throw new Nd;yield*o.content({offset:n.offset,length:n.length})}else yield o}()}catch(BJ){return Promise.reject(BJ)}}(e,t.components.blockstore,n)}()}catch(BJ){return Promise.reject(BJ)}}async mkdir(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return async function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i=Ih(Ch,r);if(t.includes("/"))throw new Bd("Path must not have slashes");if("directory"!==(await Ed(e,n,r)).type)throw new Nd("".concat(e.toString()," was not a UnixFS directory"));Rh("creating %s",t);const o=ko({Data:new da({type:"directory",mode:i.mode,mtime:i.mtime}).marshal(),Links:[]}),s=await Ps.digest(o),a=qi.create(i.cidVersion,Eo,s);await n.put(a,o);const[c,l]=await Promise.all([uh(e,n,i),dh(a,t,n,i)]);return Rh("adding empty dir called %s to %c",t,e),(await sh(c,l,n,{...i,allowOverwriting:i.force})).cid}(e,t,this.components.blockstore,n)}async rm(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Mh(e,t,this.components.blockstore,n)}async stat(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Hh(e,this.components.blockstore,t)}async touch(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function(e,t){var n;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=Vh(Gh,r),o=await ph(e,i.path,t,i),s=null!==(n=i.mtime)&&void 0!==n?n:{secs:BigInt(Math.round(Date.now()/1e3)),nsecs:0};if(qh("touch %c %o",o.cid,s),i.recursive){const n=await gu((async function*(){for await(const e of kd(o.cid,t)){let t,n;if("raw"===e.type)t=new da({data:e.node}),n=[];else{if("file"!==e.type&&"directory"!==e.type)throw new xd;t=e.unixfs,n=e.node.Links}t.mtime=s;const r={Data:t.marshal(),Links:n};yield{path:e.path,content:r}}}),(n=>Ja(n,t,{...i,dagBuilder:async function*(t,n){for await(const r of t)yield async function(){const t=r.content,o=ko(t),s=await Kd(o,n,{...i,cidVersion:e.version});if(null==t.Data)throw new _d("".concat(s," had no data"));const a=da.unmarshal(t.Data);return{cid:s,size:BigInt(o.length),path:r.path,unixfs:a}}}})),(async e=>rc(e)));if(null==n)throw new Id("Could not chmod ".concat(o.cid.toString()));return gh(n.cid,o,t,i)}const a=await t.get(o.cid,r);let c,l=[];if(o.cid.code===As)c=new da({data:a});else{const e=Ao(a);if(l=e.Links,null==e.Data)throw new _d("".concat(o.cid.toString()," had no data"));c=da.unmarshal(e.Data)}c.mtime=s;const u=ko({Data:c.marshal(),Links:l}),d=await Ps.digest(u),h=qi.create(o.cid.version,Eo,d);return await t.put(h,u),gh(h,o,t,i)}(e,this.components.blockstore,t)}}const Wh=function(e){try{for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r]}catch{}};function Qh(e){const t=new globalThis.AbortController;function n(){t.abort();for(const t of e)null!=(null===t||void 0===t?void 0:t.removeEventListener)&&t.removeEventListener("abort",n)}for(const i of e){if(!0===(null===i||void 0===i?void 0:i.aborted)){n();break}null!=(null===i||void 0===i?void 0:i.addEventListener)&&i.addEventListener("abort",n)}const r=t.signal;return r.clear=function(){for(const t of e)null!=(null===t||void 0===t?void 0:t.removeEventListener)&&t.removeEventListener("abort",n)},r}var Yh,Zh=new WeakMap;class Jh extends EventTarget{constructor(){super(),Su(this,Zh,new Map),Wh(1/0,this)}listenerCount(e){const t=Iu(Zh,this).get(e);return null==t?0:t.length}addEventListener(e,t,n){var r;super.addEventListener(e,t,n);let i=Iu(Zh,this).get(e);null==i&&(i=[],Iu(Zh,this).set(e,i)),i.push({callback:t,once:null!==(r=!0!==n&&!1!==n&&(null===n||void 0===n?void 0:n.once))&&void 0!==r&&r})}removeEventListener(e,t,n){super.removeEventListener(e.toString(),null!==t&&void 0!==t?t:null,n);let r=Iu(Zh,this).get(e);null!=r&&(r=r.filter((e=>{let{callback:n}=e;return n!==t})),Iu(Zh,this).set(e,r))}dispatchEvent(e){const t=super.dispatchEvent(e);let n=Iu(Zh,this).get(e.type);return null==n||(n=n.filter((e=>{let{once:t}=e;return!t})),Iu(Zh,this).set(e.type,n)),t}safeDispatchEvent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.dispatchEvent(new $h(e,t))}}class Xh extends Event{constructor(e,t){super(e,t),Dr(this,"detail",void 0),this.detail=null===t||void 0===t?void 0:t.detail}}const $h=null!==(Yh=globalThis.CustomEvent)&&void 0!==Yh?Yh:Xh;class ef extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"The operation was aborted"),Dr(this,"code",void 0),Dr(this,"type",void 0),this.name="AbortError",this.code=ef.code,this.type=ef.type}}Dr(ef,"code","ABORT_ERR"),Dr(ef,"type","aborted");class tf extends Error{constructor(e,t,n){var r;super(e),Dr(this,"code",void 0),Dr(this,"props",void 0),this.code=t,this.name=null!==(r=null===n||void 0===n?void 0:n.name)&&void 0!==r?r:"CodeError",this.props=null!==n&&void 0!==n?n:{}}}class nf extends AggregateError{constructor(e,t,n,r){var i;super(e,t),Dr(this,"code",void 0),Dr(this,"props",void 0),this.code=n,this.name=null!==(i=null===r||void 0===r?void 0:r.name)&&void 0!==i?i:"AggregateCodeError",this.props=null!==r&&void 0!==r?r:{}}}class rf extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected Peer"),Dr(this,"code",void 0),this.name="UnexpectedPeerError",this.code=rf.code}}Dr(rf,"code","ERR_UNEXPECTED_PEER");class of extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid crypto exchange"),Dr(this,"code",void 0),this.name="InvalidCryptoExchangeError",this.code=of.code}}Dr(of,"code","ERR_INVALID_CRYPTO_EXCHANGE");class sf extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid crypto transmission"),Dr(this,"code",void 0),this.name="InvalidCryptoTransmissionError",this.code=sf.code}}Dr(sf,"code","ERR_INVALID_CRYPTO_TRANSMISSION");const af="ERR_TIMEOUT",cf="ERR_INVALID_MESSAGE";class lf extends Error{constructor(e,t){super(null!==e&&void 0!==e?e:"The operation was aborted"),Dr(this,"type",void 0),Dr(this,"code",void 0),this.type="aborted",this.name="AbortError",this.code=null!==t&&void 0!==t?t:"ABORT_ERR"}}async function uf(e,t,n,r){const i=new lf(null===r||void 0===r?void 0:r.errorMessage,null===r||void 0===r?void 0:r.errorCode);return!0===(null===n||void 0===n?void 0:n.aborted)?Promise.reject(i):new Promise(((o,s)=>{function a(){null===n||void 0===n||n.removeEventListener("abort",u),e.removeEventListener(t,c),null!=(null===r||void 0===r?void 0:r.errorEvent)&&e.removeEventListener(r.errorEvent,l)}const c=e=>{try{var t;if(!1===(null===r||void 0===r||null===(t=r.filter)||void 0===t?void 0:t.call(r,e)))return}catch(n){return a(),void s(n)}a(),o(e)},l=e=>{a(),s(e.detail)},u=()=>{a(),s(i)};null===n||void 0===n||n.addEventListener("abort",u),e.addEventListener(t,c),null!=(null===r||void 0===r?void 0:r.errorEvent)&&e.addEventListener(r.errorEvent,l)}))}class df extends Error{constructor(e,t){super(null!==e&&void 0!==e?e:"The operation was aborted"),Dr(this,"type",void 0),Dr(this,"code",void 0),this.type="aborted",this.name="AbortError",this.code=null!==t&&void 0!==t?t:"ABORT_ERR"}}async function hf(e,t,n){if(null==t)return e;if(t.aborted)return Promise.reject(new df(null===n||void 0===n?void 0:n.errorMessage,null===n||void 0===n?void 0:n.errorCode));let r;const i=new df(null===n||void 0===n?void 0:n.errorMessage,null===n||void 0===n?void 0:n.errorCode);try{return await Promise.race([e,new Promise(((e,n)=>{r=()=>{n(i)},t.addEventListener("abort",r)}))])}finally{null!=r&&t.removeEventListener("abort",r)}}class ff{constructor(e,t){var n;Dr(this,"deferred",void 0),Dr(this,"signal",void 0),Dr(this,"where",void 0),this.signal=t,this.deferred=ou(),this.where=e,this.onAbort=this.onAbort.bind(this),null===(n=this.signal)||void 0===n||n.addEventListener("abort",this.onAbort)}onAbort(){var e,t;this.deferred.reject(null!==(e=null===(t=this.signal)||void 0===t?void 0:t.reason)&&void 0!==e?e:new ef)}cleanup(){var e;null===(e=this.signal)||void 0===e||e.removeEventListener("abort",this.onAbort)}}class pf{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Dr(this,"id",void 0),Dr(this,"fn",void 0),Dr(this,"options",void 0),Dr(this,"priority",void 0),Dr(this,"recipients",void 0),Dr(this,"status",void 0),Dr(this,"timeline",void 0),Dr(this,"controller",void 0),this.id="".concat(parseInt(String(1e9*Math.random()),10).toString()).concat(Date.now()),this.status="queued",this.fn=e,this.priority=n,this.options=t,this.recipients=[],this.timeline={created:Date.now()},this.controller=new AbortController,Wh(1/0,this.controller.signal),this.onAbort=this.onAbort.bind(this)}abort(e){this.controller.abort(e)}onAbort(){this.recipients.reduce(((e,t)=>{var n;return e&&!0===(null===(n=t.signal)||void 0===n?void 0:n.aborted)}),!0)&&(this.controller.abort(new ef),this.cleanup())}async join(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=new ff(new Error("where").stack,t.signal);return this.recipients.push(n),null===(e=t.signal)||void 0===e||e.addEventListener("abort",this.onAbort),n.deferred.promise}async run(){this.status="running",this.timeline.started=Date.now();try{var e;this.controller.signal.throwIfAborted();const t=await hf(this.fn({...null!==(e=this.options)&&void 0!==e?e:{},signal:this.controller.signal}),this.controller.signal);this.recipients.forEach((e=>{e.deferred.resolve(t)})),this.status="complete"}catch(t){this.recipients.forEach((e=>{e.deferred.reject(t)})),this.status="errored"}finally{this.timeline.finished=Date.now(),this.cleanup()}}cleanup(){this.recipients.forEach((e=>{var t;e.cleanup(),null===(t=e.signal)||void 0===t||t.removeEventListener("abort",this.onAbort)}))}}class gf extends Jh{constructor(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var n;(super(),Dr(this,"concurrency",void 0),Dr(this,"queue",void 0),Dr(this,"pending",void 0),this.concurrency=null!==(e=t.concurrency)&&void 0!==e?e:Number.POSITIVE_INFINITY,this.pending=0,null!=t.metricName)&&(null===(n=t.metrics)||void 0===n||n.registerMetricGroup(t.metricName,{calculate:()=>({size:this.queue.length,running:this.pending,queued:this.queue.length-this.pending})}));this.queue=[]}tryToStartAnother(){if(0===this.size)return queueMicrotask((()=>{this.safeDispatchEvent("empty")})),0===this.running&&queueMicrotask((()=>{this.safeDispatchEvent("idle")})),!1;if(this.pending<this.concurrency){let e;for(const t of this.queue)if("queued"===t.status){e=t;break}return null!=e&&(this.safeDispatchEvent("active"),this.pending++,e.run().finally((()=>{for(let t=0;t<this.queue.length;t++)if(this.queue[t]===e){this.queue.splice(t,1);break}this.pending--,this.tryToStartAnother(),this.safeDispatchEvent("next")})),!0)}return!1}enqueue(e){var t;if((null===(t=this.queue[this.size-1])||void 0===t?void 0:t.priority)>=e.priority)return void this.queue.push(e);const n=function(e,t,n){let r=0,i=e.length;for(;i>0;){const o=Math.trunc(i/2);let s=r+o;n(e[s],t)<=0?(r=++s,i-=o+1):i=o}return r}(this.queue,e,((e,t)=>t.priority-e.priority));this.queue.splice(n,0,e)}async add(e,t){var n;null===t||void 0===t||null===(n=t.signal)||void 0===n||n.throwIfAborted();const r=new pf(e,t,null===t||void 0===t?void 0:t.priority),i=r.join(t).then((e=>(this.safeDispatchEvent("completed",{detail:e}),this.safeDispatchEvent("success",{detail:{job:r,result:e}}),e))).catch((e=>{if("queued"===r.status)for(let t=0;t<this.queue.length;t++)if(this.queue[t]===r){this.queue.splice(t,1);break}throw this.safeDispatchEvent("error",{detail:e}),this.safeDispatchEvent("failure",{detail:{job:r,error:e}}),e}));return this.enqueue(r),this.safeDispatchEvent("add"),this.tryToStartAnother(),i}clear(){this.queue.splice(0,this.queue.length)}abort(){this.queue.forEach((e=>{e.abort(new ef)})),this.clear()}async onEmpty(e){0!==this.size&&await uf(this,"empty",null===e||void 0===e?void 0:e.signal)}async onSizeLessThan(e,t){this.size<e||await uf(this,"next",null===t||void 0===t?void 0:t.signal,{filter:()=>this.size<e})}async onIdle(e){0===this.pending&&0===this.size||await uf(this,"idle",null===e||void 0===e?void 0:e.signal)}get size(){return this.queue.length}get queued(){return this.queue.length-this.pending}get running(){return this.pending}async*toGenerator(e){var t,n;null===e||void 0===e||null===(t=e.signal)||void 0===t||t.throwIfAborted();const r=hu({objectMode:!0}),i=e=>{null!=e?this.abort():this.clear(),r.end(e)},o=e=>{null!=e.detail&&r.push(e.detail)},s=e=>{i(e.detail)},a=()=>{i()},c=()=>{i(new tf("Queue aborted","ERR_QUEUE_ABORTED"))};this.addEventListener("completed",o),this.addEventListener("error",s),this.addEventListener("idle",a),null===e||void 0===e||null===(n=e.signal)||void 0===n||n.addEventListener("abort",c);try{yield*r}finally{var l;this.removeEventListener("completed",o),this.removeEventListener("error",s),this.removeEventListener("idle",a),null===e||void 0===e||null===(l=e.signal)||void 0===l||l.removeEventListener("abort",c),i()}}}class mf extends gf{has(e){return null!=this.find(e)}find(e){return this.queue.find((t=>e.equals(t.options.peerId)))}}const vf=function(e){if(null!=e[Symbol.asyncIterator])return(async()=>{for await(const t of e);})();for(const t of e);};function yf(e){return null!=e[Symbol.asyncIterator]}const wf=e=>{const t=Bo(e),n=jr(t);return Lo(e,n),wf.bytes=t,n};function bf(e,t){var n,r;const i=null!==(r=(t=null!==(n=t)&&void 0!==n?n:{}).lengthEncoder)&&void 0!==r?r:wf;function*o(e){const t=i(e.byteLength);t instanceof Uint8Array?yield t:yield*t,e instanceof Uint8Array?yield e:yield*e}return yf(e)?async function*(){for await(const t of e)yield*o(t)}():function*(){for(const t of e)yield*o(t)}()}wf.bytes=0,bf.single=(e,t)=>{var n,r;const i=null!==(r=(t=null!==(n=t)&&void 0!==n?n:{}).lengthEncoder)&&void 0!==r?r:wf;return new Kr(i(e.byteLength),e)};var Ef;!function(e){e[e.LENGTH=0]="LENGTH",e[e.DATA=1]="DATA"}(Ef||(Ef={}));const kf=e=>{const t=Mo(e);return kf.bytes=Bo(t),t};function Af(e,t){var n,r,i;const o=new Kr;let s=Ef.LENGTH,a=-1;const c=null!==(n=null===t||void 0===t?void 0:t.lengthDecoder)&&void 0!==n?n:kf,l=null!==(r=null===t||void 0===t?void 0:t.maxLengthLength)&&void 0!==r?r:8,u=null!==(i=null===t||void 0===t?void 0:t.maxDataLength)&&void 0!==i?i:4194304;function*d(){for(;o.byteLength>0;){if(s===Ef.LENGTH)try{if(a=c(o),a<0)throw Or(new Error("invalid message length"),"ERR_INVALID_MSG_LENGTH");if(a>u)throw Or(new Error("message length too long"),"ERR_MSG_DATA_TOO_LONG");const e=c.bytes;o.consume(e),null!=(null===t||void 0===t?void 0:t.onLength)&&t.onLength(a),s=Ef.DATA}catch(e){if(e instanceof RangeError){if(o.byteLength>l)throw Or(new Error("message length length too long"),"ERR_MSG_LENGTH_TOO_LONG");break}throw e}if(s===Ef.DATA){if(o.byteLength<a)break;const e=o.sublist(0,a);o.consume(a),null!=(null===t||void 0===t?void 0:t.onData)&&t.onData(e),yield e,s=Ef.LENGTH}}}return yf(e)?async function*(){for await(const t of e)o.append(t),yield*d();if(o.byteLength>0)throw Or(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}():function*(){for(const t of e)o.append(t),yield*d();if(o.byteLength>0)throw Or(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}()}kf.bytes=0,Af.fromReader=(e,t)=>{let n=1;return Af(async function*(){for(;;)try{const{done:t,value:r}=await e.next(n);if(!0===t)return;null!=r&&(yield r)}catch(t){if("ERR_UNDER_READ"===t.code)return{done:!0,value:null};throw t}finally{n=1}}(),{...null!==t&&void 0!==t?t:{},onLength:e=>{n=e}})};const Sf=function(e,t){return null!=e[Symbol.asyncIterator]?async function*(){let n=0;if(!(t<1))for await(const r of e)if(yield r,n++,n===t)return}():function*(){let n=0;if(!(t<1))for(const r of e)if(yield r,n++,n===t)return}()},xf="/ipfs/bitswap/1.2.0",_f=4194304,If=_f;var Rf,Cf,Tf,Pf,Nf,Bf,Df,Of,Lf;!function(e){e.WantBlock="WantBlock",e.WantHave="WantHave"}(Rf||(Rf={})),function(e){e[e.WantBlock=0]="WantBlock",e[e.WantHave=1]="WantHave"}(Cf||(Cf={})),function(e){e.codec=()=>ia(Cf)}(Rf||(Rf={})),function(e){let t;e.codec=()=>(null==t&&(t=oa((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.cid&&e.cid.byteLength>0&&(t.uint32(10),t.bytes(e.cid)),null!=e.priority&&0!==e.priority&&(t.uint32(16),t.int32(e.priority)),null!=e.cancel&&(t.uint32(24),t.bool(e.cancel)),null!=e.wantType&&(t.uint32(32),Rf.codec().encode(e.wantType,t)),null!=e.sendDontHave&&(t.uint32(40),t.bool(e.sendDontHave)),!1!==n.lengthDelimited&&t.ldelim()}),(function(e,t){const n={cid:Ur(0),priority:0},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.cid=e.bytes();break;case 2:n.priority=e.int32();break;case 3:n.cancel=e.bool();break;case 4:n.wantType=Rf.codec().decode(e);break;case 5:n.sendDontHave=e.bool();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>Xs(t,e.codec()),e.decode=(t,n)=>$o(t,e.codec(),n)}(Tf||(Tf={})),function(e){let t;e.codec=()=>(null==t&&(t=oa((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==n.lengthDelimited&&t.fork(),null!=e.entries)for(const r of e.entries)t.uint32(10),Tf.codec().encode(r,t);null!=e.full&&(t.uint32(16),t.bool(e.full)),!1!==n.lengthDelimited&&t.ldelim()}),(function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r={entries:[]},i=null==t?e.len:e.pos+t;for(;e.pos<i;){const t=e.uint32();switch(t>>>3){case 1:var o,s;if(null!=(null===(o=n.limits)||void 0===o?void 0:o.entries)&&r.entries.length===n.limits.entries)throw new sa('decode error - map field "entries" had too many elements',"ERR_MAX_LENGTH");r.entries.push(Tf.codec().decode(e,e.uint32(),{limits:null===(s=n.limits)||void 0===s?void 0:s.entries$}));break;case 2:r.full=e.bool();break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>Xs(t,e.codec()),e.decode=(t,n)=>$o(t,e.codec(),n)}(Pf||(Pf={})),function(e){let t;e.codec=()=>(null==t&&(t=oa((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.prefix&&e.prefix.byteLength>0&&(t.uint32(10),t.bytes(e.prefix)),null!=e.data&&e.data.byteLength>0&&(t.uint32(18),t.bytes(e.data)),!1!==n.lengthDelimited&&t.ldelim()}),(function(e,t){const n={prefix:Ur(0),data:Ur(0)},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.prefix=e.bytes();break;case 2:n.data=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>Xs(t,e.codec()),e.decode=(t,n)=>$o(t,e.codec(),n)}(Nf||(Nf={})),function(e){e.HaveBlock="HaveBlock",e.DontHaveBlock="DontHaveBlock"}(Bf||(Bf={})),function(e){e[e.HaveBlock=0]="HaveBlock",e[e.DontHaveBlock=1]="DontHaveBlock"}(Df||(Df={})),function(e){e.codec=()=>ia(Df)}(Bf||(Bf={})),function(e){let t;e.codec=()=>(null==t&&(t=oa((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.cid&&e.cid.byteLength>0&&(t.uint32(10),t.bytes(e.cid)),null!=e.type&&0!==Df[e.type]&&(t.uint32(16),Bf.codec().encode(e.type,t)),!1!==n.lengthDelimited&&t.ldelim()}),(function(e,t){const n={cid:Ur(0),type:Bf.HaveBlock},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.cid=e.bytes();break;case 2:n.type=Bf.codec().decode(e);break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>Xs(t,e.codec()),e.decode=(t,n)=>$o(t,e.codec(),n)}(Of||(Of={})),function(e){let t;e.codec=()=>(null==t&&(t=oa((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==n.lengthDelimited&&t.fork(),null!=e.wantlist&&(t.uint32(10),Pf.codec().encode(e.wantlist,t)),null!=e.blocks)for(const r of e.blocks)t.uint32(26),Nf.codec().encode(r,t);if(null!=e.blockPresences)for(const r of e.blockPresences)t.uint32(34),Of.codec().encode(r,t);null!=e.pendingBytes&&0!==e.pendingBytes&&(t.uint32(40),t.int32(e.pendingBytes)),!1!==n.lengthDelimited&&t.ldelim()}),(function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r={blocks:[],blockPresences:[],pendingBytes:0},i=null==t?e.len:e.pos+t;for(;e.pos<i;){const t=e.uint32();switch(t>>>3){case 1:var o;r.wantlist=Pf.codec().decode(e,e.uint32(),{limits:null===(o=n.limits)||void 0===o?void 0:o.wantlist});break;case 3:var s,a;if(null!=(null===(s=n.limits)||void 0===s?void 0:s.blocks)&&r.blocks.length===n.limits.blocks)throw new sa('decode error - map field "blocks" had too many elements',"ERR_MAX_LENGTH");r.blocks.push(Nf.codec().decode(e,e.uint32(),{limits:null===(a=n.limits)||void 0===a?void 0:a.blocks$}));break;case 4:var c,l;if(null!=(null===(c=n.limits)||void 0===c?void 0:c.blockPresences)&&r.blockPresences.length===n.limits.blockPresences)throw new sa('decode error - map field "blockPresences" had too many elements',"ERR_MAX_LENGTH");r.blockPresences.push(Of.codec().decode(e,e.uint32(),{limits:null===(l=n.limits)||void 0===l?void 0:l.blockPresences$}));break;case 5:r.pendingBytes=e.int32();break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>Xs(t,e.codec()),e.decode=(t,n)=>$o(t,e.codec(),n)}(Lf||(Lf={}));const Mf=4193664;function Ff(e,t,n,r,i,o){let s=0,a=!1;for(let c=n;c<e.length;c++){const n=e[c],l=o(n);if(l>Mf)throw new tf("Cannot send block as after encoding it is over the max message size","ERR_BLOCK_TOO_LARGE");const u=i+l;if(u>r){a=!0;break}t.push(n),s++,i=u}return{hasMore:a,added:s,newSize:i}}function Uf(e){return zf(3,Nf.encode(e))}function jf(e){return zf(4,Of.encode(e))}function Hf(e){return zf(1,Tf.encode(e))}function zf(e,t){return Bo(e)+Bo(t.byteLength)+t.byteLength}class Vf extends Jh{constructor(e){var t,n,r,i,o,s,a,c,l,u,d;let h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),Dr(this,"log",void 0),Dr(this,"libp2p",void 0),Dr(this,"routing",void 0),Dr(this,"protocols",void 0),Dr(this,"running",void 0),Dr(this,"maxInboundStreams",void 0),Dr(this,"maxOutboundStreams",void 0),Dr(this,"messageReceiveTimeout",void 0),Dr(this,"registrarIds",void 0),Dr(this,"metrics",void 0),Dr(this,"sendQueue",void 0),Dr(this,"runOnTransientConnections",void 0),Dr(this,"maxOutgoingMessageSize",void 0),Dr(this,"maxIncomingMessageSize",void 0),this.log=e.logger.forComponent("helia:bitswap:network"),this.libp2p=e.libp2p,this.routing=e.routing,this.protocols=null!==(t=h.protocols)&&void 0!==t?t:[xf],this.registrarIds=[],this.running=!1,this._onStream=this._onStream.bind(this),this.maxInboundStreams=null!==(n=h.maxInboundStreams)&&void 0!==n?n:1024,this.maxOutboundStreams=null!==(r=h.maxOutboundStreams)&&void 0!==r?r:1024,this.messageReceiveTimeout=null!==(i=h.messageReceiveTimeout)&&void 0!==i?i:5e3,this.runOnTransientConnections=null!==(o=h.runOnTransientConnections)&&void 0!==o&&o,this.maxIncomingMessageSize=null!==(s=h.maxIncomingMessageSize)&&void 0!==s?s:_f,this.maxOutgoingMessageSize=null!==(a=null!==(c=h.maxOutgoingMessageSize)&&void 0!==c?c:h.maxIncomingMessageSize)&&void 0!==a?a:If,this.metrics={blocksSent:null===(l=e.metrics)||void 0===l?void 0:l.registerCounter("helia_bitswap_sent_blocks_total"),dataSent:null===(u=e.metrics)||void 0===u?void 0:u.registerCounter("helia_bitswap_sent_data_bytes_total")},this.sendQueue=new mf({concurrency:null!==(d=h.messageSendConcurrency)&&void 0!==d?d:50,metrics:e.metrics,metricName:"helia_bitswap_message_send_queue"}),this.sendQueue.addEventListener("error",(e=>{this.log.error("error sending wantlist to peer",e.detail)}))}async start(){if(this.running)return;this.running=!0,await this.libp2p.handle(this.protocols,this._onStream,{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams,runOnTransientConnection:this.runOnTransientConnections});const e={onConnect:e=>{this.safeDispatchEvent("peer:connected",{detail:e})},onDisconnect:e=>{this.safeDispatchEvent("peer:disconnected",{detail:e})}};this.registrarIds=[];for(const t of this.protocols)this.registrarIds.push(await this.libp2p.register(t,e));this.libp2p.getConnections().forEach((e=>{this.safeDispatchEvent("peer:connected",{detail:e.remotePeer})}))}async stop(){if(this.running=!1,await this.libp2p.unhandle(this.protocols),null!=this.registrarIds){for(const e of this.registrarIds)this.libp2p.unregister(e);this.registrarIds=[]}}_onStream(e){if(!this.running)return;const{stream:t,connection:n}=e;Promise.resolve().then((async()=>{this.log("incoming new bitswap %s stream from %p",t.protocol,n.remotePeer);const e=()=>{"open"===t.status?t.abort(new tf("Incoming Bitswap stream timed out after ".concat(this.messageReceiveTimeout,"ms"),"ERR_TIMEOUT")):this.log("stream aborted with status %s",t.status)};let r=AbortSignal.timeout(this.messageReceiveTimeout);Wh(1/0,r),r.addEventListener("abort",e),await t.closeWrite(),await gu(t,(e=>Af(e,{maxDataLength:this.maxIncomingMessageSize})),(async i=>{for await(const s of i)try{const i=Lf.decode(s);this.log("incoming new bitswap %s message from %p on stream",t.protocol,n.remotePeer,t.id),this.safeDispatchEvent("bitswap:message",{detail:{peer:n.remotePeer,message:i}}),r.removeEventListener("abort",e),r=AbortSignal.timeout(this.messageReceiveTimeout),Wh(1/0,r),r.addEventListener("abort",e)}catch(o){this.log.error("error reading incoming bitswap message from %p on stream",n.remotePeer,t.id,o),t.abort(o);break}}))})).catch((e=>{this.log.error("error handling incoming stream from %p",n.remotePeer,e),t.abort(e)}))}async*findProviders(e,t){var n;null===t||void 0===t||null===(n=t.onProgress)||void 0===n||n.call(t,new ha("bitswap:network:find-providers",e));for await(const r of this.routing.findProviders(e,t)){await this.libp2p.isDialable(r.multiaddrs,{runOnTransientConnection:this.runOnTransientConnections})&&(yield r)}}async findAndConnect(e,t){var n;await vf(iu(Sf(this.findProviders(e,t),null!==(n=null===t||void 0===t?void 0:t.maxProviders)&&void 0!==n?n:3),(async e=>this.connectTo(e.id,t)))).catch((e=>{this.log.error(e)}))}async sendMessage(e,t,n){if(!this.running)throw new Error("network isn't running");const r=this.sendQueue.queue.find((t=>e.equals(t.options.peerId)&&"queued"===t.status));if(null!=r)return r.options.message=function(e,t){for(const[o,s]of t.wantlist.entries()){const t=e.wantlist.get(o);var n,r,i;null!=t&&(t.priority>s.priority&&(s.priority=t.priority),s.cancel=null!==(n=s.cancel)&&void 0!==n?n:t.cancel,s.wantType=null!==(r=s.wantType)&&void 0!==r?r:t.wantType,s.sendDontHave=null!==(i=s.sendDontHave)&&void 0!==i?i:t.sendDontHave),e.wantlist.set(o,s)}for(const[o,s]of t.blockPresences.entries())e.blockPresences.set(o,s);for(const[o,s]of t.blocks.entries())e.blocks.set(o,s);return t.full&&!e.full&&(e.full=!0),e}(r.options.message,t),void await r.join({signal:null===n||void 0===n?void 0:n.signal});await this.sendQueue.add((async t=>{var n;const r=null===t||void 0===t?void 0:t.message;if(null==r)throw new tf("No message to send","ERR_NO_MESSAGE");this.log("sendMessage to %p",e),null===t||void 0===t||null===(n=t.onProgress)||void 0===n||n.call(t,new ha("bitswap:network:send-wantlist",e));const i=await this.libp2p.dialProtocol(e,xf,t);await i.closeRead();try{await gu(function*(e,t){const n=[...e.wantlist.values()],r=[...e.blockPresences.values()],i=[...e.blocks.values()];let o=0,s=0,a=0,c=!1;for(;;){var l;const u={wantlist:{full:null!==(l=e.full)&&void 0!==l&&l,entries:[]},blockPresences:[],blocks:[],pendingBytes:0};let d=Lf.encode(u).byteLength,{added:h,hasMore:f,newSize:p}=Ff(i,u.blocks,a,t,d,Uf);a+=h,d=p;const g=f;({added:h,hasMore:f,newSize:p}=Ff(r,u.blockPresences,s,t,d,jf)),s+=h,d=p;const m=f;if(({added:h,hasMore:f,newSize:p}=Ff(n,u.wantlist.entries,o,t,d,Hf)),o+=h,d=p,c=!g&&!m&&!f,c||(u.wantlist.full=!1),yield Lf.encode(u),c)break}}(r,this.maxOutgoingMessageSize),(e=>bf(e)),i),await i.close(t)}catch(s){var o;null===t||void 0===t||null===(o=t.onProgress)||void 0===o||o.call(t,new ha("bitswap:network:send-wantlist:error",{peer:e,error:s})),this.log.error("error sending message to %p",e,s),i.abort(s)}this._updateSentStats(r.blocks)}),{peerId:e,signal:null===n||void 0===n?void 0:n.signal,message:t})}async connectTo(e,t){var n;if(!this.running)throw new tf("Network isn't running","ERR_NOT_STARTED");null===t||void 0===t||null===(n=t.onProgress)||void 0===n||n.call(t,new ha("bitswap:network:dial",e));const[r]=await Promise.all([this.libp2p.dial(e,t),uf(this.libp2p,"peer:identify",null===t||void 0===t?void 0:t.signal,{filter:t=>{if(!t.detail.peerId.equals(e))return!1;if(t.detail.protocols.includes(xf))return!0;throw new tf("".concat(e," did not support ").concat(xf),"ERR_BITSWAP_UNSUPPORTED_BY_PEER")}})]);return r}_updateSentStats(e){var t,n;let r=0;for(const i of e.values())r+=i.data.byteLength;null===(t=this.metrics.dataSent)||void 0===t||t.increment(r),null===(n=this.metrics.blocksSent)||void 0===n||n.increment(e.size)}}const qf=Symbol.for("@libp2p/peer-id");function Gf(e){return null!=e&&Boolean(e[qf])}const Kf=Symbol.for("nodejs.util.inspect.custom"),Wf=Object.values(Bs).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)),Bs.identity.decoder),Qf=114,Yf=36,Zf=37;class Jf{constructor(e){Dr(this,"type",void 0),Dr(this,"multihash",void 0),Dr(this,"privateKey",void 0),Dr(this,"publicKey",void 0),Dr(this,"string",void 0),Dr(this,qf,!0),this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return"PeerId(".concat(this.toString(),")")}toString(){return null==this.string&&(this.string=mi.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return qi.createV1(Qf,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){var t;if(null==e)return!1;if(e instanceof Uint8Array)return zr(this.multihash.bytes,e);if("string"===typeof e)return tp(e).equals(this);if(null!=(null===e||void 0===e||null===(t=e.multihash)||void 0===t?void 0:t.bytes))return zr(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[Kf](){return"PeerId(".concat(this.toString(),")")}}class Xf extends Jf{constructor(e){super({...e,type:"RSA"}),Dr(this,"type","RSA"),Dr(this,"publicKey",void 0),this.publicKey=e.publicKey}}class $f extends Jf{constructor(e){super({...e,type:"Ed25519"}),Dr(this,"type","Ed25519"),Dr(this,"publicKey",void 0),this.publicKey=e.multihash.digest}}class ep extends Jf{constructor(e){super({...e,type:"secp256k1"}),Dr(this,"type","secp256k1"),Dr(this,"publicKey",void 0),this.publicKey=e.multihash.digest}}function tp(e,t){var n;if(t=null!==(n=t)&&void 0!==n?n:Wf,"1"===e.charAt(0)||"Q"===e.charAt(0)){const t=Ui(mi.decode("z".concat(e)));return e.startsWith("12D")?new $f({multihash:t}):e.startsWith("16U")?new ep({multihash:t}):new Xf({multihash:t})}return np(Wf.decode(e))}function np(e){try{const t=Ui(e);if(t.code===Is.code){if(t.digest.length===Yf)return new $f({multihash:t});if(t.digest.length===Zf)return new ep({multihash:t})}if(t.code===Ps.code)return new Xf({multihash:t})}catch{return function(e){if(null==e||null==e.multihash||null==e.version||1===e.version&&e.code!==Qf)throw new Error("Supplied PeerID CID is invalid");const t=e.multihash;if(t.code===Ps.code)return new Xf({multihash:e.multihash});if(t.code===Is.code){if(t.digest.length===Yf)return new $f({multihash:e.multihash});if(t.digest.length===Zf)return new ep({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}(qi.decode(e))}throw new Error("Supplied PeerID CID is invalid")}async function rp(e,t){return e.length===Yf?new $f({multihash:Fi(Is.code,e),privateKey:t}):e.length===Zf?new ep({multihash:Fi(Is.code,e),privateKey:t}):new Xf({multihash:await Ps.digest(e),publicKey:e,privateKey:t})}function ip(e,t){const n={[Symbol.iterator]:()=>n,next:()=>{const n=e.next(),r=n.value;if(!0===n.done||null==r){return{done:!0,value:void 0}}return{done:!1,value:t(r)}}};return n}class op{constructor(e){if(Dr(this,"map",void 0),this.map=new Map,null!=e)for(const[t,n]of e.entries())this.map.set(t.toString(),n)}[Symbol.iterator](){return this.entries()}clear(){this.map.clear()}delete(e){return this.map.delete(e.toString())}entries(){return ip(this.map.entries(),(e=>[tp(e[0]),e[1]]))}forEach(e){this.map.forEach(((t,n)=>{e(t,tp(n),this)}))}get(e){return this.map.get(e.toString())}has(e){return this.map.has(e.toString())}set(e,t){this.map.set(e.toString(),t)}keys(){return ip(this.map.keys(),(e=>tp(e)))}values(){return this.map.values()}get size(){return this.map.size}}class sp extends op{constructor(e){super(),Dr(this,"metric",void 0);const{name:t,metrics:n}=e;this.metric=n.registerMetric(t),this.updateComponentMetric()}set(e,t){return super.set(e,t),this.updateComponentMetric(),this}delete(e){const t=super.delete(e);return this.updateComponentMetric(),t}clear(){super.clear(),this.updateComponentMetric()}updateComponentMetric(){this.metric.update(this.size)}}function ap(e){const{name:t,metrics:n}=e;let r;return r=null!=n?new sp({name:t,metrics:n}):new op,r}function cp(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8";const n=Ms[t];if(null==n)throw new Error('Unsupported encoding "'.concat(t,'"'));return n.encoder.encode(e).substring(1)}class lp{constructor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Dr(this,"full",void 0),Dr(this,"pendingBytes",void 0),Dr(this,"wantlist",void 0),Dr(this,"blocks",void 0),Dr(this,"blockPresences",void 0),this.full=e,this.wantlist=new Map,this.blocks=new Map,this.blockPresences=new Map,this.pendingBytes=0}addWantlistEntry(e,t){const n=us.encode(e.multihash.bytes);this.wantlist.set(n,t)}addBlockPresence(e,t){const n=us.encode(e.multihash.bytes);this.blockPresences.set(n,t)}addBlock(e,t){const n=us.encode(e.multihash.bytes);this.blocks.set(n,t)}}const up=function(e){let t=new Uint8Array(e.reduce(((e,t)=>e+Bo(t)),0)),n=0;for(const r of e)t=Lo(r,t,n),n+=Bo(r);return t};function dp(e){return up([e.version,e.code,e.multihash.code,e.multihash.digest.byteLength])}class hp{constructor(e,t){var n;Dr(this,"peerId",void 0),Dr(this,"blockstore",void 0),Dr(this,"network",void 0),Dr(this,"wants",void 0),Dr(this,"exchangeCount",void 0),Dr(this,"bytesSent",void 0),Dr(this,"bytesReceived",void 0),Dr(this,"lastExchange",void 0),Dr(this,"maxSizeReplaceHasWithBlock",void 0),Dr(this,"log",void 0),this.peerId=e.peerId,this.blockstore=e.blockstore,this.network=e.network,this.wants=new Map,this.log=e.logger.forComponent("helia:bitswap:ledger:".concat(e.peerId)),this.exchangeCount=0,this.bytesSent=0,this.bytesReceived=0,this.maxSizeReplaceHasWithBlock=null!==(n=t.maxSizeReplaceHasWithBlock)&&void 0!==n?n:1024}sentBytes(e){this.exchangeCount++,this.lastExchange=(new Date).getTime(),this.bytesSent+=e}receivedBytes(e){this.exchangeCount++,this.lastExchange=(new Date).getTime(),this.bytesReceived+=e}debtRatio(){return this.bytesSent/(this.bytesReceived+1)}async sendBlocksToPeer(e){const t=new lp,n=new Set;for(const[i,o]of this.wants.entries())try{const r=await this.blockstore.get(o.cid,e);o.wantType===Rf.WantHave?r.byteLength<this.maxSizeReplaceHasWithBlock?(this.log("sending have and block for %c",o.cid),n.add(i),t.addBlock(o.cid,{data:r,prefix:dp(o.cid)})):(this.log("sending have for %c",o.cid),t.addBlockPresence(o.cid,{cid:o.cid.bytes,type:Bf.HaveBlock})):(this.log("sending block for %c",o.cid),n.add(i),t.addBlock(o.cid,{data:r,prefix:dp(o.cid)}))}catch(r){if("ERR_NOT_FOUND"!==r.code)throw r;if(this.log("do not have block for %c",o.cid),!o.sendDontHave)continue;if(!0===o.sentDontHave)continue;o.sentDontHave=!0,t.addBlockPresence(o.cid,{cid:o.cid.bytes,type:Bf.DontHaveBlock})}if(t.blocks.size>0||t.blockPresences.size>0){this.log("sending message"),await this.network.sendMessage(this.peerId,t,e),this.log("sent message"),this.sentBytes([...t.blocks.values()].reduce(((e,t)=>e+t.data.byteLength),0));for(const e of n)this.wants.delete(e)}}}class fp{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Dr(this,"blockstore",void 0),Dr(this,"network",void 0),Dr(this,"ledgerMap",void 0),Dr(this,"maxSizeReplaceHasWithBlock",void 0),Dr(this,"log",void 0),Dr(this,"logger",void 0),this.blockstore=e.blockstore,this.network=e.network,this.maxSizeReplaceHasWithBlock=t.maxSizeReplaceHasWithBlock,this.log=e.logger.forComponent("helia:bitswap:peer-want-lists"),this.logger=e.logger,this.ledgerMap=ap({name:"helia_bitswap_ledger_map",metrics:e.metrics}),this.network.addEventListener("bitswap:message",(e=>{this.receiveMessage(e.detail.peer,e.detail.message).catch((t=>{this.log.error("error receiving bitswap message from %p",e.detail.peer,t)}))})),this.network.addEventListener("peer:disconnected",(e=>{this.peerDisconnected(e.detail)}))}ledgerForPeer(e){const t=this.ledgerMap.get(e);if(null!=t)return{peer:t.peerId,value:t.debtRatio(),sent:t.bytesSent,received:t.bytesReceived,exchanged:t.exchangeCount}}wantListForPeer(e){const t=this.ledgerMap.get(e);if(null!=t)return[...t.wants.values()]}peers(){return Array.from(this.ledgerMap.values()).map((e=>e.peerId))}async receiveMessage(e,t){var n,r;let i=this.ledgerMap.get(e);if(null==i&&(i=new hp({peerId:e,blockstore:this.blockstore,network:this.network,logger:this.logger},{maxSizeReplaceHasWithBlock:this.maxSizeReplaceHasWithBlock}),this.ledgerMap.set(e,i)),i.receivedBytes(null!==(n=null===(r=t.blocks)||void 0===r?void 0:r.reduce(((e,t)=>e+t.data.byteLength),0))&&void 0!==n?n:0),null!=t.wantlist){!0===t.wantlist.full&&i.wants.clear();for(const n of t.wantlist.entries){const t=qi.decode(n.cid),r=cp(t.multihash.bytes,"base64");var o,s;if(!0===n.cancel)this.log("peer %p cancelled want of block for %c",e,t),i.wants.delete(r);else n.wantType===Rf.WantHave?this.log("peer %p wanted block presence for %c",e,t):this.log("peer %p wanted block for %c",e,t),i.wants.set(r,{cid:t,priority:n.priority,wantType:null!==(o=n.wantType)&&void 0!==o?o:Rf.WantBlock,sendDontHave:null!==(s=n.sendDontHave)&&void 0!==s&&s})}}this.log("send blocks to peer"),await i.sendBlocksToPeer()}async receivedBlock(e,t){const n=cp(e.multihash.bytes,"base64"),r=[];for(const i of this.ledgerMap.values())i.wants.has(n)&&r.push(i);await Promise.all(r.map((async e=>e.sendBlocksToPeer(t))))}peerDisconnected(e){this.ledgerMap.delete(e)}}const pp="object"===typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;function gp(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, not ".concat(e))}function mp(e){if(!((t=e)instanceof Uint8Array||null!=t&&"object"===typeof t&&"Uint8Array"===t.constructor.name))throw new Error("Uint8Array expected");for(var t,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(r.length>0&&!r.includes(e.length))throw new Error("Uint8Array expected of length ".concat(r,", not of length=").concat(e.length))}function vp(e){if("function"!==typeof e||"function"!==typeof e.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");gp(e.outputLen),gp(e.blockLen)}function yp(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function wp(e,t){mp(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least ".concat(n))}const bp=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),Ep=(e,t)=>e<<32-t|e>>>t,kp=(e,t)=>e<<t|e>>>32-t>>>0;new Uint8Array(new Uint32Array([287454020]).buffer)[0];const Ap=async()=>{};async function Sp(e,t,n){let r=Date.now();for(let i=0;i<e;i++){n(i);const e=Date.now()-r;e>=0&&e<t||(await Ap(),r+=e)}}function xp(e){if("string"!==typeof e)throw new Error("utf8ToBytes expected string, got ".concat(typeof e));return new Uint8Array((new TextEncoder).encode(e))}function _p(e){return"string"===typeof e&&(e=xp(e)),mp(e),e}function Ip(){let e=0;for(let n=0;n<arguments.length;n++){const t=n<0||arguments.length<=n?void 0:arguments[n];mp(t),e+=t.length}const t=new Uint8Array(e);for(let n=0,r=0;n<arguments.length;n++){const e=n<0||arguments.length<=n?void 0:arguments[n];t.set(e,r),r+=e.length}return t}class Rp{clone(){return this._cloneInto()}}const Cp={}.toString;function Tp(e){const t=t=>e().update(_p(t)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function Pp(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;if(pp&&"function"===typeof pp.getRandomValues)return pp.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}function Np(e){if(isNaN(e)||e<=0)throw new tf("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return Pp(e)}const Bp=Math.LN2*Math.LN2;class Dp{static create(e){const t=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.005;const n=Math.round(-1*e*Math.log(t)/Bp),r=Math.round(n/e*Math.LN2);return{bits:n,hashes:r}}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.005);return new Dp(t)}constructor(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var n;(Dr(this,"seeds",void 0),Dr(this,"bits",void 0),Dr(this,"buffer",void 0),null!=t.seeds)?this.seeds=t.seeds:this.seeds=function(e){let t,n;const r=[];for(let i=0;i<e;i++)for(t=new Kr(Np(4)),r[i]=t.getUint32(0,!0),n=0;n<i;n++)if(r[i]===r[n]){i--;break}return r}(null!==(n=t.hashes)&&void 0!==n?n:8);this.bits=null!==(e=t.bits)&&void 0!==e?e:1024,this.buffer=Ur(Math.ceil(this.bits/8))}add(e){"string"===typeof e&&(e=Fs(e));for(let t=0;t<this.seeds.length;t++){const n=Ia.x86.hash32(e,this.seeds[t])%this.bits;this.setbit(n)}}has(e){"string"===typeof e&&(e=Fs(e));for(let t=0;t<this.seeds.length;t++){const n=Ia.x86.hash32(e,this.seeds[t])%this.bits;if(!this.getbit(n))return!1}return!0}clear(){this.buffer.fill(0)}setbit(e){let t=0,n=e;for(;n>7;)t++,n-=8;let r=this.buffer[t];r|=1<<n,this.buffer[t]=r}getbit(e){let t=0,n=e;for(;n>7;)t++,n-=8;return 0!==(this.buffer[t]&1<<n)}}class Op extends Jh{constructor(e,t){var n,r;super(),Dr(this,"intialPeerSearchComplete",void 0),Dr(this,"requests",void 0),Dr(this,"name",void 0),Dr(this,"log",void 0),Dr(this,"logger",void 0),Dr(this,"minProviders",void 0),Dr(this,"maxProviders",void 0),Dr(this,"providers",void 0),Dr(this,"evictionFilter",void 0),Wh(1/0,this),this.name=t.name,this.logger=e.logger,this.log=e.logger.forComponent(this.name),this.requests=new Map,this.minProviders=null!==(n=t.minProviders)&&void 0!==n?n:1,this.maxProviders=null!==(r=t.maxProviders)&&void 0!==r?r:5,this.providers=[],this.evictionFilter=Dp.create(this.maxProviders)}async retrieve(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=us.encode(e.multihash.bytes),r=this.requests.get(n);if(null!=r)return this.log("join existing request for %c",e),r;const i=ou();if(this.requests.set(n,i.promise),0===this.providers.length){let n=!1;null==this.intialPeerSearchComplete&&(n=!0,this.log=this.logger.forComponent("".concat(this.name,":").concat(e)),this.intialPeerSearchComplete=this.findProviders(e,this.minProviders,t)),await this.intialPeerSearchComplete,n&&this.log("found initial session peers for %c",e)}let o=!1;const s=new gf({concurrency:this.maxProviders});s.addEventListener("error",(()=>{})),s.addEventListener("failure",(e=>{this.log.error("error querying provider %o, evicting from session",e.detail.job.options.provider,e.detail.error),this.evict(e.detail.job.options.provider)})),s.addEventListener("success",(e=>{o=!0,i.resolve(e.detail.result)})),s.addEventListener("idle",(()=>{var r;o||!0===(null===(r=t.signal)||void 0===r?void 0:r.aborted)||Promise.resolve().then((async()=>{this.log("no session peers had block for for %c, finding new providers",e);for(let e=0;e<this.minProviders&&0!==this.providers.length;e++){const e=this.providers[Math.floor(Math.random()*this.providers.length)];this.evict(e)}await this.findProviders(e,this.minProviders,t),this.log("found new providers re-retrieving %c",e),this.requests.delete(n),i.resolve(await this.retrieve(e,t))})).catch((t=>{this.log.error("could not find new providers for %c",e,t),i.reject(t)}))}));const a=n=>{s.add((async()=>this.queryProvider(e,n.detail,t)),{provider:n.detail}).catch((n=>{var r;!0!==(null===(r=t.signal)||void 0===r?void 0:r.aborted)&&this.log.error("error retrieving session block for %c",e,n)}))};this.addEventListener("provider",a),Promise.all([...this.providers].map((async n=>s.add((async()=>this.queryProvider(e,n,t)),{provider:n})))).catch((n=>{var r;!0!==(null===(r=t.signal)||void 0===r?void 0:r.aborted)&&this.log.error("error retrieving session block for %c",e,n)}));try{return await i.promise}finally{this.removeEventListener("provider",a),s.clear(),this.requests.delete(n)}}evict(e){this.evictionFilter.add(this.toEvictionKey(e));const t=this.providers.findIndex((t=>this.equals(t,e)));-1!==t&&this.providers.splice(t,1)}isEvicted(e){return this.providers.some((t=>this.equals(t,e)))}hasProvider(e){return null!=this.providers.find((t=>this.equals(t,e)))||!!this.isEvicted(e)}async findProviders(e,t,n){const r=ou();let i=0;return Promise.resolve().then((async()=>{this.log("finding %d-%d new provider(s) for %c",t,this.maxProviders,e);for await(const s of this.findNewProviders(e,n)){var o;if(i===this.maxProviders||!0===(null===(o=n.signal)||void 0===o?void 0:o.aborted))break;if(!this.hasProvider(s)&&(this.log("found %d/%d new providers",i,this.maxProviders),this.providers.push(s),this.safeDispatchEvent("provider",{detail:s}),i++,i===t&&(this.log("session is ready"),r.resolve()),this.providers.length===this.maxProviders)){this.log("found max session peers",i);break}}if(this.log("found %d/%d new session peers",i,this.maxProviders),i<t)throw new tf("Found ".concat(i," of ").concat(t," ").concat(this.name," providers for ").concat(e),"ERR_INSUFFICIENT_PROVIDERS_FOUND")})).catch((t=>{var n;this.log.error("error searching routing for potential session peers for %c",e,null!==(n=t.errors)&&void 0!==n?n:t),r.reject(t)})),r.promise}}class Lp extends Op{constructor(e,t){super(e,{...t,name:"helia:bitswap:session"}),Dr(this,"wantList",void 0),Dr(this,"network",void 0),this.wantList=e.wantList,this.network=e.network}async queryProvider(e,t,n){this.log("sending WANT-BLOCK for %c to %p",e,t);const r=await this.wantList.wantSessionBlock(e,t,n);if(this.log("%p %s %c",t,r.has?"has":"does not have",e),r.has&&null!=r.block)return r.block;throw new Error("Provider did not have block")}findNewProviders(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){for await(const r of t.network.findProviders(e,n))yield r.id}()}catch(BJ){return Promise.reject(BJ)}}toEvictionKey(e){return e.toBytes()}equals(e,t){return e.equals(t)}}class Mp{constructor(e){var t,n,r,i;Dr(this,"blocksReceived",void 0),Dr(this,"duplicateBlocksReceived",void 0),Dr(this,"dataReceived",void 0),Dr(this,"duplicateDataReceived",void 0),this.blocksReceived=null===(t=e.metrics)||void 0===t?void 0:t.registerMetricGroup("helia_bitswap_received_blocks"),this.duplicateBlocksReceived=null===(n=e.metrics)||void 0===n?void 0:n.registerMetricGroup("helia_bitswap_duplicate_received_blocks"),this.dataReceived=null===(r=e.metrics)||void 0===r?void 0:r.registerMetricGroup("helia_bitswap_data_received_bytes"),this.duplicateDataReceived=null===(i=e.metrics)||void 0===i?void 0:i.registerMetricGroup("helia_bitswap_duplicate_data_received_bytes")}updateBlocksReceived(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1?arguments[1]:void 0;const r={global:t};null!=n&&(r[n.toString()]=t),null===(e=this.blocksReceived)||void 0===e||e.increment(r)}updateDuplicateBlocksReceived(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1?arguments[1]:void 0;const r={global:t};null!=n&&(r[n.toString()]=t),null===(e=this.duplicateBlocksReceived)||void 0===e||e.increment(r)}updateDataReceived(e,t){var n;const r={global:e};null!=t&&(r[t.toString()]=e),null===(n=this.dataReceived)||void 0===n||n.increment(r)}updateDuplicateDataReceived(e,t){var n;const r={global:e};null!=t&&(r[t.toString()]=e),null===(n=this.duplicateDataReceived)||void 0===n||n.increment(r)}}class Fp extends Map{constructor(e){super(),Dr(this,"metric",void 0);const{name:t,metrics:n}=e;this.metric=n.registerMetric(t),this.updateComponentMetric()}set(e,t){return super.set(e,t),this.updateComponentMetric(),this}delete(e){const t=super.delete(e);return this.updateComponentMetric(),t}clear(){super.clear(),this.updateComponentMetric()}updateComponentMetric(){this.metric.update(this.size)}}function Up(e){const{name:t,metrics:n}=e;let r;return r=null!=n?new Fp({name:t,metrics:n}):new Map,r}const jp=function(e){if(!(e instanceof Uint8Array))throw new Error("arg needs to be a Uint8Array");const t=[];for(;e.length>0;){const n=Mo(e);t.push(n),e=e.slice(Bo(n))}return t};class Hp extends Jh{constructor(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),Dr(this,"peers",void 0),Dr(this,"wants",void 0),Dr(this,"network",void 0),Dr(this,"log",void 0),Dr(this,"sendMessagesDelay",void 0),Dr(this,"sendMessagesTimeout",void 0),Dr(this,"hashLoader",void 0),Dr(this,"sendingMessages",void 0),Wh(1/0,this),this.peers=ap({name:"helia_bitswap_peers",metrics:e.metrics}),this.wants=Up({name:"helia_bitswap_wantlist",metrics:e.metrics}),this.network=e.network,this.sendMessagesDelay=null!==(t=n.sendMessagesDelay)&&void 0!==t?t:10,this.log=e.logger.forComponent("helia:bitswap:wantlist"),this.hashLoader=n.hashLoader,this.network.addEventListener("bitswap:message",(e=>{this.receiveMessage(e.detail.peer,e.detail.message).catch((t=>{this.log.error("error receiving bitswap message from %p",e.detail.peer,t)}))})),this.network.addEventListener("peer:connected",(e=>{this.peerConnected(e.detail).catch((t=>{this.log.error("error processing newly connected bitswap peer %p",e.detail,t)}))})),this.network.addEventListener("peer:disconnected",(e=>{this.peerDisconnected(e.detail)}))}async addEntry(e,t){const n=cp(e.multihash.bytes,"base64");let r=this.wants.get(n);var i,o;null==r&&(r={cid:e,priority:null!==(i=t.priority)&&void 0!==i?i:1,wantType:null!==(o=t.wantType)&&void 0!==o?o:Rf.WantBlock,cancel:!1,sendDontHave:!0},this.wants.set(n,r));r.wantType===Rf.WantHave&&t.wantType===Rf.WantBlock&&(r.wantType=Rf.WantBlock),await this.sendMessagesDebounced();try{if(t.wantType===Rf.WantBlock){return(await uf(this,"block",null===t||void 0===t?void 0:t.signal,{filter:t=>zr(e.multihash.digest,t.detail.cid.multihash.digest),errorMessage:"Want was aborted"})).detail}return(await uf(this,"presence",null===t||void 0===t?void 0:t.signal,{filter:t=>zr(e.multihash.digest,t.detail.cid.multihash.digest),errorMessage:"Want was aborted"})).detail}finally{var s;!0===(null===(s=t.signal)||void 0===s?void 0:s.aborted)&&(this.log("want for %c was aborted, cancelling want",e),r.cancel=!0,await this.sendMessagesDebounced())}}async sendMessagesDebounced(){var e;await(null===(e=this.sendingMessages)||void 0===e?void 0:e.promise),clearTimeout(this.sendMessagesTimeout),this.sendMessagesTimeout=setTimeout((()=>{this.sendMessages().catch((e=>{this.log("error sending messages to peers",e)}))}),this.sendMessagesDelay)}async sendMessages(){this.sendingMessages=ou(),await Promise.all([...this.peers.entries()].map((async e=>{let[t,n]=e;const r=new Set,i=new lp;for(const[s,a]of this.wants.entries()){n.has(s)||a.cancel||(r.add(s),i.addWantlistEntry(a.cid,{cid:a.cid.bytes,priority:a.priority,wantType:a.wantType,cancel:a.cancel,sendDontHave:a.sendDontHave}))}if(0!==i.wantlist.size)try{await this.network.sendMessage(t,i);for(const e of r)n.add(e)}catch(o){this.log.error("error sending full wantlist to new peer",o)}}))).catch((e=>{this.log.error("error sending messages",e)}));for(const[e,t]of this.wants)if(t.cancel){this.wants.delete(e);for(const t of this.peers.values())t.delete(e)}this.sendingMessages.resolve()}has(e){const t=cp(e.multihash.bytes,"base64");return this.wants.has(t)}async wantSessionPresence(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new lp;r.addWantlistEntry(e,{cid:e.bytes,sendDontHave:!0,wantType:Rf.WantHave,priority:1}),await this.network.sendMessage(t,r);return(await uf(this,"presence",n.signal,{filter:n=>t.equals(n.detail.sender)&&zr(e.multihash.digest,n.detail.cid.multihash.digest)})).detail}async wantBlock(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.addEntry(e,{...t,wantType:Rf.WantBlock})}async wantSessionBlock(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new lp;r.addWantlistEntry(e,{cid:e.bytes,sendDontHave:!0,wantType:Rf.WantBlock,priority:1}),await this.network.sendMessage(t,r);return(await uf(this,"presence",n.signal,{filter:n=>t.equals(n.detail.sender)&&zr(e.multihash.digest,n.detail.cid.multihash.digest)})).detail}async receivedBlock(e,t){const n=cp(e.multihash.bytes,"base64"),r=this.wants.get(n);null!=r&&(r.cancel=!0,await this.sendMessagesDebounced())}async receiveMessage(e,t){this.log("received message from %p with %d blocks",e,t.blocks.length);let n=!1;for(const i of t.blocks){var r;if(null==i.prefix||null==i.data)continue;const t=jp(i.prefix),o=t[0],s=t[1],a=t[2],c=a===Ps.code?Ps:await(null===(r=this.hashLoader)||void 0===r?void 0:r.getHasher(a));if(null==c){this.log.error("unknown hash algorithm",a);continue}let l=c.digest(i.data);null!=l.then&&(l=await l);const u=qi.create(0===o?0:1,s,l);this.log("received block from %p for %c",e,u),this.safeDispatchEvent("block",{detail:{sender:e,cid:u,block:i.data}}),this.safeDispatchEvent("presence",{detail:{sender:e,cid:u,has:!0,block:i.data}});const d=cp(u.multihash.bytes,"base64"),h=this.wants.get(d);null!=h&&(h.cancel=!0,n=!0)}for(const{cid:i,type:o}of t.blockPresences){const t=qi.decode(i);this.log("received %s from %p for %c",o,e,t),this.safeDispatchEvent("presence",{detail:{sender:e,cid:t,has:o===Bf.HaveBlock}})}n&&await this.sendMessagesDebounced()}async peerConnected(e){const t=new Set,n=new lp(!0);for(const[i,o]of this.wants.entries())o.cancel||(t.add(i),n.addWantlistEntry(o.cid,{cid:o.cid.bytes,priority:1,wantType:Rf.WantBlock,cancel:!1,sendDontHave:!1}));if(0!==n.wantlist.size)try{await this.network.sendMessage(e,n),this.peers.set(e,t)}catch(r){this.log.error("error sending full wantlist to new peer %p",e,r)}else this.peers.set(e,t)}peerDisconnected(e){this.peers.delete(e)}start(){}stop(){this.peers.clear(),clearTimeout(this.sendMessagesTimeout)}}class zp{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Dr(this,"log",void 0),Dr(this,"logger",void 0),Dr(this,"stats",void 0),Dr(this,"network",void 0),Dr(this,"blockstore",void 0),Dr(this,"peerWantLists",void 0),Dr(this,"wantList",void 0),this.logger=e.logger,this.log=e.logger.forComponent("helia:bitswap"),this.blockstore=e.blockstore,this.stats=new Mp(e),this.network=new Vf(e,t),this.peerWantLists=new fp({...e,network:this.network},t),this.wantList=new Hp({...e,network:this.network},t)}createSession(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){return new Lp(e,t)}({wantList:this.wantList,network:this.network,logger:this.logger},e)}async want(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=new AbortController,r=Qh([n.signal,t.signal]);Wh(1/0,n.signal,r),this.network.findAndConnect(e,{...t,signal:r}).catch((t=>{n.signal.aborted||this.log.error("error during finding and connect for cid %c",e,t)}));try{return(await this.wantList.wantBlock(e,{...t,signal:r})).block}finally{n.abort(),r.clear()}}async notify(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};await Promise.all([this.peerWantLists.receivedBlock(e,n),this.wantList.receivedBlock(e,n)])}getWantlist(){return[...this.wantList.wants.values()].filter((e=>!e.cancel)).map((e=>({cid:e.cid,priority:e.priority,wantType:e.wantType})))}getPeerWantlist(e){return this.peerWantLists.wantListForPeer(e)}async start(){this.wantList.start(),await this.network.start()}async stop(){this.wantList.stop(),await this.network.stop()}}class Vp{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Dr(this,"bitswap",void 0),Dr(this,"started",void 0);const{hashers:n}=e;this.bitswap=function(e){return new zp(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e,{hashLoader:{getHasher:async e=>{let t;if(t="string"===typeof e?Object.values(n).find((t=>t.name===e)):n[e],null!=t)return t;throw new Error('Could not load hasher for code/name "'.concat(e,'"'))}},...t}),this.started=!1}isStarted(){return this.started}async start(){await this.bitswap.start(),this.started=!0}async stop(){await this.bitswap.stop(),this.started=!1}async announce(e,t,n){await this.bitswap.notify(e,t,n)}async retrieve(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.bitswap.want(e,t)}createSession(e){const t=this.bitswap.createSession(e);return{announce:async(e,t,n)=>{await this.bitswap.notify(e,t,n)},retrieve:async(e,n)=>t.retrieve(e,n)}}}function qp(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>new Vp(t,e)}const Gp=45,Kp=15,Wp=new class{constructor(){Dr(this,"index",0),Dr(this,"input","")}new(e){return this.index=0,this.input=e,this}readAtomically(e){const t=this.index,n=e();return void 0===n&&(this.index=t),n}parseWith(e){const t=e();if(this.index===this.input.length)return t}peekChar(){if(!(this.index>=this.input.length))return this.input[this.index]}readChar(){if(!(this.index>=this.input.length))return this.input[this.index++]}readGivenChar(e){return this.readAtomically((()=>{const t=this.readChar();if(t===e)return t}))}readSeparator(e,t,n){return this.readAtomically((()=>{if(!(t>0&&void 0===this.readGivenChar(e)))return n()}))}readNumber(e,t,n,r){return this.readAtomically((()=>{let i=0,o=0;const s=this.peekChar();if(void 0===s)return;const a="0"===s,c=2**(8*r)-1;for(;;){const n=this.readAtomically((()=>{const t=this.readChar();if(void 0===t)return;const n=Number.parseInt(t,e);return Number.isNaN(n)?void 0:n}));if(void 0===n)break;if(i*=e,i+=n,i>c)return;if(o+=1,void 0!==t&&o>t)return}return 0===o||!n&&a&&o>1?void 0:i}))}readIPv4Addr(){return this.readAtomically((()=>{const e=new Uint8Array(4);for(let t=0;t<e.length;t++){const n=this.readSeparator(".",t,(()=>this.readNumber(10,3,!1,1)));if(void 0===n)return;e[t]=n}return e}))}readIPv6Addr(){const e=e=>{for(let t=0;t<e.length/2;t++){const n=2*t;if(t<e.length-3){const r=this.readSeparator(":",t,(()=>this.readIPv4Addr()));if(void 0!==r)return e[n]=r[0],e[n+1]=r[1],e[n+2]=r[2],e[n+3]=r[3],[n+4,!0]}const r=this.readSeparator(":",t,(()=>this.readNumber(16,4,!0,2)));if(void 0===r)return[n,!1];e[n]=r>>8,e[n+1]=255&r}return[e.length,!1]};return this.readAtomically((()=>{const t=new Uint8Array(16),[n,r]=e(t);if(16===n)return t;if(r)return;if(void 0===this.readGivenChar(":"))return;if(void 0===this.readGivenChar(":"))return;const i=new Uint8Array(14),o=16-(n+2),[s]=e(i.subarray(0,o));return t.set(i.subarray(0,s),16-s),t}))}readIPAddr(){var e;return null!==(e=this.readIPv4Addr())&&void 0!==e?e:this.readIPv6Addr()}};function Qp(e){return Boolean(function(e){if(!(e.length>Kp))return Wp.new(e).parseWith((()=>Wp.readIPv4Addr()))}(e))}function Yp(e){return Boolean(function(e){if(e.includes("%")&&(e=e.split("%")[0]),!(e.length>Gp))return Wp.new(e).parseWith((()=>Wp.readIPv6Addr()))}(e))}function Zp(e){return Boolean(function(e){if(e.includes("%")&&(e=e.split("%")[0]),!(e.length>Gp))return Wp.new(e).parseWith((()=>Wp.readIPAddr()))}(e))}var Jp=n(7364);const Xp=["0.0.0.0/8","10.0.0.0/8","100.64.0.0/10","127.0.0.0/8","169.254.0.0/16","172.16.0.0/12","192.0.0.0/24","192.0.0.0/29","192.0.0.8/32","192.0.0.9/32","192.0.0.10/32","192.0.0.170/32","192.0.0.171/32","192.0.2.0/24","192.31.196.0/24","192.52.193.0/24","192.88.99.0/24","192.168.0.0/16","192.175.48.0/24","198.18.0.0/15","198.51.100.0/24","203.0.113.0/24","240.0.0.0/4","255.255.255.255/32"].map((e=>new Jp.Netmask(e)));function $p(e){return Qp(e)?function(e){for(const t of Xp)if(t.contains(e))return!0;return!1}(e):Yp(e)?/^::$/.test(t=e)||/^::1$/.test(t)||/^::f{4}:([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(t)||/^::f{4}:0.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(t)||/^64:ff9b::([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(t)||/^100::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2001::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2001:2[0-9a-fA-F]:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2001:db8:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2002:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^f[c-d]([0-9a-fA-F]{2,2}):/i.test(t)||/^fe[8-9a-bA-B][0-9a-fA-F]:/i.test(t)||/^ff([0-9a-fA-F]{2,2}):/i.test(t):void 0;var t}parseInt("0xFFFF",16),new Uint8Array([0,0,0,0,0,0,0,0,0,0,255,255]);const eg=Qp,tg=Yp,ng=function(e){let t=0;if(e=e.toString().trim(),eg(e)){const n=new Uint8Array(t+4);return e.split(/\./g).forEach((e=>{n[t++]=255&parseInt(e,10)})),n}if(tg(e)){const n=e.split(":",8);let r;for(r=0;r<n.length;r++){let e;eg(n[r])&&(e=ng(n[r]),n[r]=cp(e.slice(0,2),"base16")),null!=e&&++r<8&&n.splice(r,0,cp(e.slice(2,4),"base16"))}if(""===n[0])for(;n.length<8;)n.unshift("0");else if(""===n[n.length-1])for(;n.length<8;)n.push("0");else if(n.length<8){for(r=0;r<n.length&&""!==n[r];r++);const e=[r,1];for(r=9-n.length;r>0;r--)e.push("0");n.splice.apply(n,e)}const i=new Uint8Array(t+16);for(r=0;r<n.length;r++){const e=parseInt(n[r],16);i[t++]=e>>8&255,i[t++]=255&e}return i}throw new Error("invalid ip address")},rg=function(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;n=~~n,r=null!==(t=r)&&void 0!==t?t:e.length-n;const i=new DataView(e.buffer);if(4===r){const t=[];for(let i=0;i<r;i++)t.push(e[n+i]);return t.join(".")}if(16===r){const e=[];for(let t=0;t<r;t+=2)e.push(i.getUint16(n+t).toString(16));return e.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""},ig=-1,og={},sg={};function ag(e){if("number"===typeof e){if(null!=sg[e])return sg[e];throw new Error("no protocol with code: ".concat(e))}if("string"===typeof e){if(null!=og[e])return og[e];throw new Error("no protocol with name: ".concat(e))}throw new Error("invalid protocol id type: ".concat(typeof e))}[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,ig,"ip6zone"],[43,8,"ipcidr"],[53,ig,"dns",!0],[54,ig,"dns4",!0],[55,ig,"dns6",!0],[56,ig,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,ig,"unix",!1,!0],[421,ig,"ipfs"],[421,ig,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,ig,"garlic64"],[448,0,"tls"],[449,ig,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,ig,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,ig,"memory"]].forEach((e=>{const t=function(e,t,n,r,i){return{code:e,size:t,name:n,resolvable:Boolean(r),path:Boolean(i)}}(...e);sg[t.code]=t,og[t.name]=t}));ag("ip4"),ag("ip6"),ag("ipcidr");function cg(e,t){switch(ag(e).code){case 4:case 41:return function(e){const t=rg(e,0,e.length);if(null==t)throw new Error("ipBuff is required");if(!Zp(t))throw new Error("invalid ip address");return t}(t);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return mg(t);case 6:case 273:case 33:case 132:return pg(t).toString();case 421:return function(e){const t=Mo(e),n=e.slice(Bo(t));if(n.length!==t)throw new Error("inconsistent lengths");return cp(n,"base58btc")}(t);case 444:case 445:return vg(t);case 466:return function(e){const t=Mo(e),n=e.slice(Bo(t));if(n.length!==t)throw new Error("inconsistent lengths");return"u"+cp(n,"base64url")}(t);default:return cp(t,"base16")}}function lg(e,t){switch(ag(e).code){case 4:case 41:return hg(t);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return gg(t);case 6:case 273:case 33:case 132:return fg(parseInt(t,10));case 421:return function(e){let t;t="Q"===e[0]||"1"===e[0]?Ui(mi.decode("z".concat(e))).bytes:qi.parse(e).multihash.bytes;const n=Uint8Array.from(Lo(t.length));return Hr([n,t],n.length+t.length)}(t);case 444:return function(e){const t=e.split(":");if(2!==t.length)throw new Error("failed to parse onion addr: [\"'".concat(t.join('", "'),"'\"]' does not contain a port number"));if(16!==t[0].length)throw new Error("failed to parse onion addr: ".concat(t[0]," not a Tor onion address."));const n=ai.decode("b"+t[0]),r=parseInt(t[1],10);if(r<1||r>65536)throw new Error("Port number is not in range(1, 65536)");const i=fg(r);return Hr([n,i],n.length+i.length)}(t);case 445:return function(e){const t=e.split(":");if(2!==t.length)throw new Error("failed to parse onion addr: [\"'".concat(t.join('", "'),"'\"]' does not contain a port number"));if(56!==t[0].length)throw new Error("failed to parse onion addr: ".concat(t[0]," not a Tor onion3 address."));const n=ai.decode("b".concat(t[0])),r=parseInt(t[1],10);if(r<1||r>65536)throw new Error("Port number is not in range(1, 65536)");const i=fg(r);return Hr([n,i],n.length+i.length)}(t);case 466:return function(e){const t=dg.decode(e),n=Uint8Array.from(Lo(t.length));return Hr([n,t],n.length+t.length)}(t);default:return Fs(t,"base16")}}const ug=Object.values(Bs).map((e=>e.decoder)),dg=function(){let e=ug[0].or(ug[1]);return ug.slice(2).forEach((t=>e=e.or(t))),e}();function hg(e){if(!Zp(e))throw new Error("invalid ip address");return ng(e)}function fg(e){const t=new ArrayBuffer(2);return new DataView(t).setUint16(0,e),new Uint8Array(t)}function pg(e){return new DataView(e.buffer).getUint16(e.byteOffset)}function gg(e){const t=Fs(e),n=Uint8Array.from(Lo(t.length));return Hr([n,t],n.length+t.length)}function mg(e){const t=Mo(e);if((e=e.slice(Bo(t))).length!==t)throw new Error("inconsistent lengths");return cp(e)}function vg(e){const t=e.slice(0,e.length-2),n=e.slice(e.length-2),r=cp(t,"base32"),i=pg(n);return"".concat(r,":").concat(i)}function yg(e){const t=[],n=[];let r=null,i=0;for(;i<e.length;){const o=Mo(e,i),s=Bo(o),a=ag(o),c=Eg(a,e.slice(i+s));if(0===c){t.push([o]),n.push([o]),i+=s;continue}const l=e.slice(i+s,i+s+c);if(i+=c+s,i>e.length)throw Ag("Invalid address Uint8Array: "+cp(e,"base16"));t.push([o,l]);const u=cg(o,l);if(n.push([o,u]),!0===a.path){r=u;break}}return{bytes:Uint8Array.from(e),string:wg(n),tuples:t,stringTuples:n,path:r}}function wg(e){const t=[];return e.map((e=>{const n=ag(e[0]);return t.push(n.name),e.length>1&&null!=e[1]&&t.push(e[1]),null})),kg(t.join("/"))}function bg(e){return Hr(e.map((e=>{const t=ag(e[0]);let n=Uint8Array.from(Lo(t.code));return e.length>1&&null!=e[1]&&(n=Hr([n,e[1]])),n})))}function Eg(e,t){if(e.size>0)return e.size/8;if(0===e.size)return 0;{const e=Mo(t instanceof Uint8Array?t:Uint8Array.from(t));return e+Bo(e)}}function kg(e){return"/"+e.trim().split("/").filter((e=>e)).join("/")}function Ag(e){return new Error("Error parsing address: "+e)}const Sg=Symbol.for("nodejs.util.inspect.custom"),xg=Symbol.for("@multiformats/js-multiaddr/multiaddr"),_g=[ag("dns").code,ag("dns4").code,ag("dns6").code,ag("dnsaddr").code];var Ig=new WeakMap,Rg=new WeakMap,Cg=new WeakMap,Tg=new WeakMap;class Pg{constructor(e){let t;if(Dr(this,"bytes",void 0),Su(this,Ig,void 0),Su(this,Rg,void 0),Su(this,Cg,void 0),Su(this,Tg,void 0),Dr(this,xg,!0),null==e&&(e=""),e instanceof Uint8Array)t=yg(e);else if("string"===typeof e){if(e.length>0&&"/"!==e.charAt(0))throw new Error('multiaddr "'.concat(e,'" must start with a "/"'));t=function(e){const t=[],n=[];let r=null;const i=(e=kg(e)).split("/").slice(1);if(1===i.length&&""===i[0])return{bytes:new Uint8Array,string:"/",tuples:[],stringTuples:[],path:null};for(let o=0;o<i.length;o++){const s=ag(i[o]);if(0===s.size){t.push([s.code]),n.push([s.code]);continue}if(o++,o>=i.length)throw Ag("invalid address: "+e);if(!0===s.path){r=kg(i.slice(o).join("/")),t.push([s.code,lg(s.code,r)]),n.push([s.code,r]);break}const a=lg(s.code,i[o]);t.push([s.code,a]),n.push([s.code,cg(s.code,a)])}return{string:wg(n),bytes:bg(t),tuples:t,stringTuples:n,path:r}}(e)}else{if(!Bg(e))throw new Error("addr must be a string, Buffer, or another Multiaddr");t=yg(e.bytes)}this.bytes=t.bytes,Ru(Ig,this,t.string),Ru(Rg,this,t.tuples),Ru(Cg,this,t.stringTuples),Ru(Tg,this,t.path)}toString(){return Iu(Ig,this)}toJSON(){return this.toString()}toOptions(){let e,t,n,r,i="";const o=ag("tcp"),s=ag("udp"),a=ag("ip4"),c=ag("ip6"),l=ag("dns6"),u=ag("ip6zone");for(const[d,h]of this.stringTuples())d===u.code&&(i="%".concat(null!==h&&void 0!==h?h:"")),_g.includes(d)&&(t=o.name,r=443,n="".concat(null!==h&&void 0!==h?h:"").concat(i),e=d===l.code?6:4),d!==o.code&&d!==s.code||(t=ag(d).name,r=parseInt(null!==h&&void 0!==h?h:"")),d!==a.code&&d!==c.code||(t=ag(d).name,n="".concat(null!==h&&void 0!==h?h:"").concat(i),e=d===c.code?6:4);if(null==e||null==t||null==n||null==r)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e,host:n,transport:t,port:r}}protos(){return Iu(Rg,this).map((e=>{let[t]=e;return Object.assign({},ag(t))}))}protoCodes(){return Iu(Rg,this).map((e=>{let[t]=e;return t}))}protoNames(){return Iu(Rg,this).map((e=>{let[t]=e;return ag(t).name}))}tuples(){return Iu(Rg,this)}stringTuples(){return Iu(Cg,this)}encapsulate(e){return e=new Pg(e),new Pg(this.toString()+e.toString())}decapsulate(e){const t=e.toString(),n=this.toString(),r=n.lastIndexOf(t);if(r<0)throw new Error("Address ".concat(this.toString()," does not contain subaddress: ").concat(e.toString()));return new Pg(n.slice(0,r))}decapsulateCode(e){const t=this.tuples();for(let n=t.length-1;n>=0;n--)if(t[n][0]===e)return new Pg(bg(t.slice(0,n)));return this}getPeerId(){try{let e=[];this.stringTuples().forEach((t=>{let[n,r]=t;n===og.p2p.code&&e.push([n,r]),n===og["p2p-circuit"].code&&(e=[])}));const t=e.pop();if(null!=(null===t||void 0===t?void 0:t[1])){const e=t[1];return"Q"===e[0]||"1"===e[0]?cp(mi.decode("z".concat(e)),"base58btc"):cp(qi.parse(e).multihash.bytes,"base58btc")}return null}catch(BJ){return null}}getPath(){return Iu(Tg,this)}equals(e){return zr(this.bytes,e.bytes)}async resolve(e){const t=this.protos().find((e=>e.resolvable));if(null==t)return[this];const n=Ng.get(t.name);if(null==n)throw new tf("no available resolver for ".concat(t.name),"ERR_NO_AVAILABLE_RESOLVER");return(await n(this,e)).map((e=>Dg(e)))}nodeAddress(){const e=this.toOptions();if("tcp"!==e.transport&&"udp"!==e.transport)throw new Error('multiaddr must have a valid format - no protocol with name: "'.concat(e.transport,'". Must have a valid transport protocol: "{tcp, udp}"'));return{family:e.family,address:e.host,port:e.port}}isThinWaistAddress(e){const t=(null!==e&&void 0!==e?e:this).protos();return 2===t.length&&((4===t[0].code||41===t[0].code)&&(6===t[1].code||273===t[1].code))}[Sg](){return"Multiaddr(".concat(Iu(Ig,this),")")}}const Ng=new Map;function Bg(e){return Boolean(null===e||void 0===e?void 0:e[xg])}function Dg(e){return new Pg(e)}const Og=e=>({match:t=>!(t.length<1)&&(!!e(t[0])&&t.slice(1)),pattern:"fn"}),Lg=e=>({match:t=>Og((t=>t===e)).match(t),pattern:e}),Mg=()=>({match:e=>Og((e=>"string"===typeof e)).match(e),pattern:"{string}"}),Fg=()=>({match:e=>Og((e=>!isNaN(parseInt(e)))).match(e),pattern:"{number}"}),Ug=()=>({match:e=>{if(e.length<2)return!1;if("p2p"!==e[0]&&"ipfs"!==e[0])return!1;if(!e[1].startsWith("Q")&&!e[1].startsWith("1"))return!1;try{mi.decode("z".concat(e[1]))}catch(t){return!1}return e.slice(2)},pattern:"/p2p/{peerid}"}),jg=()=>({match:e=>{if(e.length<2)return!1;if("certhash"!==e[0])return!1;try{hs.decode(e[1])}catch{return!1}return e.slice(2)},pattern:"/certhash/{certhash}"}),Hg=e=>({match:t=>{const n=e.match(t);return!1===n?t:n},pattern:"optional(".concat(e.pattern,")")}),zg=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{match:e=>{let n;for(const r of t){const t=r.match(e);!1!==t&&((null==n||t.length<n.length)&&(n=t))}return null!=n&&n},pattern:"or(".concat(t.map((e=>e.pattern)).join(", "),")")}},Vg=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{match:e=>{for(const n of t){const t=n.match(e);if(!1===t)return!1;e=t}return e},pattern:"and(".concat(t.map((e=>e.pattern)).join(", "),")")}};function qg(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];function r(e){let n=(e=>e.toString().split("/").slice(1))(e);for(const r of t){const e=r.match(n);if(!1===e)return!1;n=e}return n}return{matches:function(e){return!1!==r(e)},exactMatch:function(e){const t=r(e);return!1!==t&&0===t.length}}}const Gg=Vg(Lg("dns4"),Mg()),Kg=Vg(Lg("dns6"),Mg()),Wg=Vg(Lg("dnsaddr"),Mg()),Qg=Vg(Lg("dns"),Mg()),Yg=(qg(Gg),qg(Kg),qg(Wg),qg(zg(Qg,Wg,Gg,Kg))),Zg=Vg(Lg("ip4"),Og(Qp)),Jg=Vg(Lg("ip6"),Og(Yp)),Xg=zg(Zg,Jg),$g=zg(Xg,Qg,Gg,Kg,Wg),em=qg($g),tm=(qg(Zg),qg(Jg),qg(Xg)),nm=Vg($g,Lg("tcp"),Fg()),rm=Vg($g,Lg("udp"),Fg()),im=zg(nm,rm),om=(qg(nm),qg(rm),Vg(rm,Lg("quic"))),sm=Vg(rm,Lg("quic-v1")),am=zg(om,sm),cm=(qg(om),qg(sm),zg($g,nm,rm,om,sm)),lm=zg(Vg(cm,Lg("ws"),Hg(Ug()))),um=(qg(lm),zg(Vg(cm,Lg("wss"),Hg(Ug())),Vg(cm,Lg("tls"),Lg("ws"),Hg(Ug())))),dm=(qg(um),Vg(im,Lg("webrtc-direct"),jg(),Hg(jg()),Hg(Ug()))),hm=qg(dm),fm=Vg(sm,Lg("webtransport"),Hg(jg()),Hg(jg()),Hg(Ug())),pm=qg(fm),gm=zg(lm,um,Vg(nm,Hg(Ug())),Vg(am,Hg(Ug())),Vg($g,Hg(Ug())),dm,fm,Ug()),mm=(qg(gm),qg(Vg(gm,Lg("p2p-circuit"),Ug()))),vm=qg(zg(Vg(gm,Lg("p2p-circuit"),Lg("webrtc"),Ug()),Vg(gm,Lg("webrtc"),Hg(Ug())),Lg("webrtc"))),ym=qg(zg(Vg($g,Lg("tcp"),Fg(),Lg("http"),Hg(Ug())),Vg($g,Lg("http"),Hg(Ug())))),wm=qg(zg(Vg($g,Lg("tcp"),zg(Vg(Lg("443"),Lg("http")),Vg(Fg(),Lg("https"))),Hg(Ug())),Vg($g,Lg("tls"),Lg("http"),Hg(Ug())),Vg($g,Lg("https"),Hg(Ug())))),bm=[ag("tcp").code,ag("dns").code,ag("dnsaddr").code,ag("dns4").code,ag("dns6").code];function Em(e){let t;try{t=ag("sni").code}catch(BJ){return null}for(const[n,r]of e)if(n===t&&void 0!==r)return r;return null}function km(e){return e.some((e=>{let[t,n]=e;return t===ag("tls").code}))}function Am(e,t,n){const r=Sm[ag(e).name];if(void 0===r)throw new Error("Can't interpret protocol ".concat(ag(e).name));const i=r(t,n);return e===ag("ip6").code?"[".concat(i,"]"):i}const Sm={ip4:(e,t)=>e,ip6:(e,t)=>0===t.length?e:"[".concat(e,"]"),tcp:(e,t)=>{var n;const r=t.pop();if(void 0===r)throw new Error("Unexpected end of multiaddr");return"tcp://".concat(Am(r[0],null!==(n=r[1])&&void 0!==n?n:"",t),":").concat(e)},udp:(e,t)=>{var n;const r=t.pop();if(void 0===r)throw new Error("Unexpected end of multiaddr");return"udp://".concat(Am(r[0],null!==(n=r[1])&&void 0!==n?n:"",t),":").concat(e)},dnsaddr:(e,t)=>e,dns4:(e,t)=>e,dns6:(e,t)=>e,dns:(e,t)=>e,ipfs:(e,t)=>{var n;const r=t.pop();if(void 0===r)throw new Error("Unexpected end of multiaddr");return"".concat(Am(r[0],null!==(n=r[1])&&void 0!==n?n:"",t),"/ipfs/").concat(e)},p2p:(e,t)=>{var n;const r=t.pop();if(void 0===r)throw new Error("Unexpected end of multiaddr");return"".concat(Am(r[0],null!==(n=r[1])&&void 0!==n?n:"",t),"/p2p/").concat(e)},http:(e,t)=>{var n;const r=km(t),i=Em(t);if(r&&null!==i)return"https://".concat(i);const o=r?"https://":"http://",s=t.pop();if(void 0===s)throw new Error("Unexpected end of multiaddr");let a=Am(s[0],null!==(n=s[1])&&void 0!==n?n:"",t);return a=a.replace("tcp://",""),"".concat(o).concat(a)},tls:(e,t)=>{var n;const r=t.pop();if(void 0===r)throw new Error("Unexpected end of multiaddr");return Am(r[0],null!==(n=r[1])&&void 0!==n?n:"",t)},sni:(e,t)=>{var n;const r=t.pop();if(void 0===r)throw new Error("Unexpected end of multiaddr");return Am(r[0],null!==(n=r[1])&&void 0!==n?n:"",t)},https:(e,t)=>{var n;const r=t.pop();if(void 0===r)throw new Error("Unexpected end of multiaddr");let i=Am(r[0],null!==(n=r[1])&&void 0!==n?n:"",t);return i=i.replace("tcp://",""),"https://".concat(i)},ws:(e,t)=>{var n;const r=km(t),i=Em(t);if(r&&null!==i)return"wss://".concat(i);const o=r?"wss://":"ws://",s=t.pop();if(void 0===s)throw new Error("Unexpected end of multiaddr");let a=Am(s[0],null!==(n=s[1])&&void 0!==n?n:"",t);return a=a.replace("tcp://",""),"".concat(o).concat(a)},wss:(e,t)=>{var n;const r=t.pop();if(void 0===r)throw new Error("Unexpected end of multiaddr");let i=Am(r[0],null!==(n=r[1])&&void 0!==n?n:"",t);return i=i.replace("tcp://",""),"wss://".concat(i)},"p2p-websocket-star":(e,t)=>{var n;const r=t.pop();if(void 0===r)throw new Error("Unexpected end of multiaddr");return"".concat(Am(r[0],null!==(n=r[1])&&void 0!==n?n:"",t),"/p2p-websocket-star")},"p2p-webrtc-star":(e,t)=>{var n;const r=t.pop();if(void 0===r)throw new Error("Unexpected end of multiaddr");return"".concat(Am(r[0],null!==(n=r[1])&&void 0!==n?n:"",t),"/p2p-webrtc-star")},"p2p-webrtc-direct":(e,t)=>{var n;const r=t.pop();if(void 0===r)throw new Error("Unexpected end of multiaddr");return"".concat(Am(r[0],null!==(n=r[1])&&void 0!==n?n:"",t),"/p2p-webrtc-direct")}};function xm(e,t){var n;const r=Dg(e).stringTuples(),i=r.pop();if(void 0===i)throw new Error("Unexpected end of multiaddr");const o=ag(i[0]),s=Sm[o.name];if(null==s)throw new Error("No interpreter found for ".concat(o.name));let a=s(null!==(n=i[1])&&void 0!==n?n:"",r);return!1!==(null===t||void 0===t?void 0:t.assumeHttp)&&bm.includes(i[0])&&(a=a.replace(/^.*:\/\//,""),a="443"===i[1]?"https://".concat(a):"http://".concat(a)),(a.startsWith("http://")||a.startsWith("https://"))&&(a=new URL(a).toString(),a.endsWith("/")&&(a=a.substring(0,a.length-1))),a}var _m=new WeakMap,Im=new WeakMap,Rm=new WeakMap,Cm=new WeakMap,Tm=new WeakMap,Pm=new WeakSet;class Nm{constructor(e,t){Au(this,Pm),Dr(this,"url",void 0),Su(this,_m,0),Su(this,Im,0),Su(this,Rm,0),Su(this,Cm,0),Su(this,Tm,new Map),Dr(this,"log",void 0),this.url=e instanceof URL?e:new URL(e),this.log=t.forComponent("helia:trustless-gateway-block-broker:".concat(this.url.hostname))}async getRawBlock(e,t){const n=new URL(this.url.toString());if(n.pathname="/ipfs/".concat(e.toString()),n.search="?format=raw",!0===(null===t||void 0===t?void 0:t.aborted))throw new Error("Signal to fetch raw block for CID ".concat(e," from gateway ").concat(this.url," was aborted prior to fetch"));const r=xu(Pm,this,Bm).call(this,e),i=new AbortController,o=()=>{i.abort()};null===t||void 0===t||t.addEventListener("abort",o);try{let t=Iu(Tm,this).get(r);var s;if(null==t)Ru(_m,this,(s=Iu(_m,this),s++,s)),t=fetch(n.toString(),{signal:i.signal,headers:{Accept:"application/vnd.ipld.raw"},cache:"force-cache"}).then((async t=>{var r,i;if(this.log("GET %s %d",n,t.status),!t.ok)throw Ru(Im,this,(i=Iu(Im,this),i++,i)),new Error("unable to fetch raw block for CID ".concat(e," from gateway ").concat(this.url));return Ru(Cm,this,(r=Iu(Cm,this),r++,r)),new Uint8Array(await t.arrayBuffer())})),Iu(Tm,this).set(r,t);return await t}catch(c){var a;if(!0===(null===t||void 0===t?void 0:t.aborted))throw new Error("fetching raw block for CID ".concat(e," from gateway ").concat(this.url," was aborted"));throw Ru(Im,this,(a=Iu(Im,this),a++,a)),new Error("unable to fetch raw block for CID ".concat(e))}finally{null===t||void 0===t||t.removeEventListener("abort",o),Iu(Tm,this).delete(r)}}reliability(){return 0===Iu(_m,this)?1:Iu(Rm,this)>0?-1/0:Iu(Cm,this)/(Iu(_m,this)+3*Iu(Im,this))}incrementInvalidBlocks(){var e;Ru(Rm,this,(e=Iu(Rm,this),e++,e))}getStats(){return{attempts:Iu(_m,this),errors:Iu(Im,this),invalidBlocks:Iu(Rm,this),successes:Iu(Cm,this),pendingResponses:Iu(Tm,this).size}}}function Bm(e){const t=e.multihash.bytes;return us.encode(t)}function Dm(e,t,n){return e.filter((e=>!!(wm.matches(e)||t&&ym.matches(e))&&(!!n||(!!Yg.matches(e)||!1===$p(e.toOptions().host)))))}async function*Om(e,t,n,r,i,o){for await(const s of t.findProviders(e,o)){const e=Dm(s.multiaddrs,r,i);if(0===e.length)continue;const t=xm(e[0]);yield new Nm(t,n)}}class Lm extends Op{constructor(e,t){var n,r;super(e,{...t,name:"helia:trustless-gateway:session"}),Dr(this,"routing",void 0),Dr(this,"allowInsecure",void 0),Dr(this,"allowLocal",void 0),this.routing=e.routing,this.allowInsecure=null!==(n=t.allowInsecure)&&void 0!==n?n:Fm,this.allowLocal=null!==(r=t.allowLocal)&&void 0!==r?r:Um}async queryProvider(e,t,n){var r;this.log("fetching BLOCK for %c from %s",e,t.url);const i=await t.getRawBlock(e,n.signal);return this.log.trace("got block for %c from %s",e,t.url),await(null===(r=n.validateFn)||void 0===r?void 0:r.call(n,i)),i}findNewProviders(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){yield*Om(e,t.routing,t.logger,t.allowInsecure,t.allowLocal,n)}()}catch(BJ){return Promise.reject(BJ)}}toEvictionKey(e){return e.url.toString()}equals(e,t){return e.url.toString()===t.url.toString()}}class Mm{constructor(e){var t,n;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Dr(this,"allowInsecure",void 0),Dr(this,"allowLocal",void 0),Dr(this,"routing",void 0),Dr(this,"log",void 0),Dr(this,"logger",void 0),this.log=e.logger.forComponent("helia:trustless-gateway-block-broker"),this.logger=e.logger,this.routing=e.routing,this.allowInsecure=null!==(t=r.allowInsecure)&&void 0!==t?t:Fm,this.allowLocal=null!==(n=r.allowLocal)&&void 0!==n?n:Um}async retrieve(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=[];for await(const s of Om(e,this.routing,this.logger,this.allowInsecure,this.allowLocal,t)){this.log("getting block for %c from %s",e,s.url);try{const n=await s.getRawBlock(e,t.signal);this.log.trace("got block for %c from %s",e,s.url);try{var r;await(null===(r=t.validateFn)||void 0===r?void 0:r.call(t,n))}catch(o){this.log.error("failed to validate block for %c from %s",e,s.url,o);continue}return n}catch(o){var i;if(this.log.error("failed to get block for %c from %s",e,s.url,o),o instanceof Error?n.push(o):n.push(new Error("Unable to fetch raw block for CID ".concat(e," from gateway ").concat(s.url))),!0===(null===(i=t.signal)||void 0===i?void 0:i.aborted)){this.log.trace("request aborted while fetching raw block for CID %c from gateway %s",e,s.url);break}}}throw n.length>0?new AggregateError(n,"Unable to fetch raw block for CID ".concat(e," from any gateway")):new Error("Unable to fetch raw block for CID ".concat(e," from any gateway"))}createSession(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){return new Lm(e,t)}({logger:this.logger,routing:this.routing},e)}}const Fm=!1,Um=!1;function jm(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>new Mm(t,e)}class Hm{constructor(e){Dr(this,"libp2p",void 0),this.libp2p=e}async provide(e,t){await this.libp2p.contentRouting.provide(e,t)}async*findProviders(e,t){yield*this.libp2p.contentRouting.findProviders(e,t)}async put(e,t,n){await this.libp2p.contentRouting.put(e,t,n)}async get(e,t){return this.libp2p.contentRouting.get(e,t)}async findPeer(e,t){return this.libp2p.peerRouting.findPeer(e,t)}async*getClosestPeers(e,t){yield*this.libp2p.peerRouting.getClosestPeers(e,t)}}function zm(e){return new Hm(e)}const Vm="[a-fA-F\\d:]",qm=e=>e&&e.includeBoundaries?"(?:(?<=\\s|^)(?=".concat(Vm,")|(?<=").concat(Vm,")(?=\\s|$))"):"",Gm="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",Km="[a-fA-F\\d]{1,4}",Wm="\n(?:\n(?:".concat(Km,":){7}(?:").concat(Km,"|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8\n(?:").concat(Km,":){6}(?:").concat(Gm,"|:").concat(Km,"|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4\n(?:").concat(Km,":){5}(?::").concat(Gm,"|(?::").concat(Km,"){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4\n(?:").concat(Km,":){4}(?:(?::").concat(Km,"){0,1}:").concat(Gm,"|(?::").concat(Km,"){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4\n(?:").concat(Km,":){3}(?:(?::").concat(Km,"){0,2}:").concat(Gm,"|(?::").concat(Km,"){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4\n(?:").concat(Km,":){2}(?:(?::").concat(Km,"){0,3}:").concat(Gm,"|(?::").concat(Km,"){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4\n(?:").concat(Km,":){1}(?:(?::").concat(Km,"){0,4}:").concat(Gm,"|(?::").concat(Km,"){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4\n(?::(?:(?::").concat(Km,"){0,5}:").concat(Gm,"|(?::").concat(Km,"){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4\n)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1\n").replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),Qm=new RegExp("(?:^".concat(Gm,"$)|(?:^").concat(Wm,"$)")),Ym=new RegExp("^".concat(Gm,"$")),Zm=new RegExp("^".concat(Wm,"$")),Jm=e=>e&&e.exact?Qm:new RegExp("(?:".concat(qm(e)).concat(Gm).concat(qm(e),")|(?:").concat(qm(e)).concat(Wm).concat(qm(e),")"),"g");Jm.v4=e=>e&&e.exact?Ym:new RegExp("".concat(qm(e)).concat(Gm).concat(qm(e)),"g"),Jm.v6=e=>e&&e.exact?Zm:new RegExp("".concat(qm(e)).concat(Wm).concat(qm(e)),"g");const Xm=Jm;const{toString:$m}=Object.prototype;const ev={global:"g",ignoreCase:"i",multiline:"m",dotAll:"s",sticky:"y",unicode:"u"};function tv(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(n=e,"[object RegExp]"!==$m.call(n))throw new TypeError("Expected a RegExp instance");var n;const r=Object.keys(ev).map((n=>("boolean"===typeof t[n]?t[n]:e[n])?ev[n]:"")).join(""),i=new RegExp(t.source||e.source,r);return i.lastIndex="number"===typeof t.lastIndex?t.lastIndex:e.lastIndex,i}function nv(e,t){let{timeout:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{return function(e){const t=function(){return e(...arguments)};return Object.defineProperty(t,"name",{value:"functionTimeout(".concat(e.name||"<anonymous>",")"),configurable:!0}),t}((()=>tv(e).test(t)))()}catch(r){throw r}}const rv=15,iv=45,ov={timeout:400};function sv(e){return!(e.length>iv)&&nv(Xm.v6({exact:!0}),e,ov)}function av(e){return!(e.length>rv)&&nv(Xm.v4({exact:!0}),e,ov)}const cv={http:"80",https:"443",ws:"80",wss:"443"},lv=["http","https","ws","wss"];function uv(e,t){var n,r;const i=null!==(r=(t=null!==(n=t)&&void 0!==n?n:{}).defaultDnsType)&&void 0!==r?r:"dns4",{scheme:o,hostname:s,port:a}=function(e){const[t]=e.split(":");lv.includes(t)||(e="http"+e.substring(t.length));let{protocol:n,hostname:r,port:i}=new URL(e);if(null==i||""===i){const e=function(e){if(null==e||""===e||null==cv[e])return;return cv[e]}(t);null!=e&&(i=e),null==e&&"http:"===n&&(i="80")}return{scheme:t,hostname:r,port:i}}(e);return Dg("/"+[dv(s,i),hv(a,o),fv(o)].filter((e=>Boolean(e))).reduce(((e,t)=>e.concat(t)),[]).join("/"))}function dv(e,t){if(null!=e&&""!==e){if(av(e))return["ip4",e];if(sv(e))return["ip6",e];if("["===e[0]){const t=e.substring(1,e.length-1);if(sv(t))return["ip6",t]}return[t,e]}}function hv(e,t){if(null!=e&&""!==e)return"udp"===t?["udp",e]:["tcp",e]}function fv(e){if(null==e.match(/^tcp$|^udp$/))return[e]}const pv=["https://trustless-gateway.link","https://4everland.io"],gv=Symbol.for("nodejs.util.inspect.custom");class mv{constructor(e){Dr(this,"type","url"),Dr(this,"multihash",void 0),Dr(this,"privateKey",void 0),Dr(this,"publicKey",void 0),Dr(this,"url",void 0),Dr(this,qf,!0),this.url=e.toString(),this.multihash=Is.digest(Fs(this.url))}[gv](){return"PeerId(".concat(this.url,")")}toString(){return this.toCID().toString()}toCID(){return qi.createV1(2336,this.multihash)}toBytes(){return this.toCID().bytes}equals(e){return null!=e&&(e instanceof Uint8Array&&(e=cp(e)),e.toString()===this.toString())}}class vv{constructor(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Dr(this,"gateways",void 0),this.gateways=(null!==(e=t.gateways)&&void 0!==e?e:pv).map((e=>function(e){return e=e.toString(),{id:new mv(new URL(e)),multiaddrs:[uv(e)]}}(e)))}async*findProviders(e,t){yield*this.gateways.toSorted((()=>Math.random()>.5?1:-1)).map((e=>({...e,protocols:["transport-ipfs-gateway-http"]})))}}function yv(){return new vv(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function wv(e){var t;return e=null!==(t=e)&&void 0!==t?t:new Error("Open failed"),Or(e,"ERR_OPEN_FAILED")}function bv(e){var t;return e=null!==(t=e)&&void 0!==t?t:new Error("Close failed"),Or(e,"ERR_CLOSE_FAILED")}function Ev(e){var t;return e=null!==(t=e)&&void 0!==t?t:new Error("Put failed"),Or(e,"ERR_PUT_FAILED")}function kv(e){var t;return e=null!==(t=e)&&void 0!==t?t:new Error("Get failed"),Or(e,"ERR_GET_FAILED")}function Av(e){var t;return e=null!==(t=e)&&void 0!==t?t:new Error("Delete failed"),Or(e,"ERR_DELETE_FAILED")}function Sv(e){var t;return e=null!==(t=e)&&void 0!==t?t:new Error("Has failed"),Or(e,"ERR_HAS_FAILED")}function xv(e){var t;return e=null!==(t=e)&&void 0!==t?t:new Error("Not Found"),Or(e,"ERR_NOT_FOUND")}function _v(e){var t;return e=null!==(t=e)&&void 0!==t?t:new Error("Aborted"),Or(e,"ERR_ABORTED")}class Iv{has(e,t){return Promise.reject(new Error(".has is not implemented"))}put(e,t,n){return Promise.reject(new Error(".put is not implemented"))}async*putMany(e,t){for await(const{cid:n,block:r}of e)await this.put(n,r,t),yield n}get(e,t){return Promise.reject(new Error(".get is not implemented"))}async*getMany(e,t){for await(const n of e)yield{cid:n,block:await this.get(n,t)}}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}async*deleteMany(e,t){for await(const n of e)await this.delete(n,t),yield n}async*getAll(e){throw new Error(".getAll is not implemented")}}class Rv extends Iv{constructor(){super(),Dr(this,"data",void 0),this.data=new Map}put(e,t){return this.data.set(ai.encode(e.multihash.bytes),t),e}get(e){const t=this.data.get(ai.encode(e.multihash.bytes));if(null==t)throw xv();return t}has(e){return this.data.has(ai.encode(e.multihash.bytes))}async delete(e){this.data.delete(ai.encode(e.multihash.bytes))}async*getAll(){for(const[e,t]of this.data.entries())yield{cid:qi.createV1(As,Ui(ai.decode(e))),block:t}}}Ld("blockstore:core:tiered");const Cv={...m};function Tv(e){var t;return e=null!==(t=e)&&void 0!==t?t:new Error("Not Found"),Or(e,"ERR_NOT_FOUND")}const Pv="/",Nv=(new TextEncoder).encode(Pv),Bv=Nv[0];class Dv{constructor(e,t){if(Dr(this,"_buf",void 0),"string"===typeof e)this._buf=Fs(e);else{if(!(e instanceof Uint8Array))throw new Error("Invalid key, should be String of Uint8Array");this._buf=e}if(null==t&&(t=!0),t&&this.clean(),0===this._buf.byteLength||this._buf[0]!==Bv)throw new Error("Invalid key")}toString(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"utf8";return cp(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return"Key(".concat(this.toString(),")")}static withNamespaces(e){return new Dv(e.join(Pv))}static random(){return new Dv(Math.random().toString().substring(2))}static asKey(e){return e instanceof Uint8Array||"string"===typeof e?new Dv(e):"function"===typeof e.uint8Array?new Dv(e.uint8Array()):null}clean(){if(null!=this._buf&&0!==this._buf.byteLength||(this._buf=Nv),this._buf[0]!==Bv){const e=new Uint8Array(this._buf.byteLength+1);e.fill(Bv,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===Bv;)this._buf=this._buf.subarray(0,-1)}less(e){const t=this.list(),n=e.list();for(let r=0;r<t.length;r++){if(n.length<r+1)return!1;const e=t[r],i=n[r];if(e<i)return!0;if(e>i)return!1}return t.length<n.length}reverse(){return Dv.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){const e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(Pv).slice(1)}type(){return function(e){const t=e.split(":");if(t.length<2)return"";return t.slice(0,-1).join(":")}(this.baseNamespace())}name(){return function(e){const t=e.split(":");return t[t.length-1]}(this.baseNamespace())}instance(e){return new Dv(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(Pv)||(e+=Pv),e+=this.type(),new Dv(e)}parent(){const e=this.list();return 1===e.length?new Dv(Pv):new Dv(e.slice(0,-1).join(Pv))}child(e){return this.toString()===Pv?e:e.toString()===Pv?this:new Dv(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()!==this.toString()&&e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()!==this.toString()&&this.toString().startsWith(e.toString())}isTopLevel(){return 1===this.list().length}concat(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Dv.withNamespaces([...this.namespaces(),...(r=t.map((e=>e.namespaces())),[].concat(...r))]);var r}}const Ov="SHARDING";const Lv=function(e,t){return null!=e[Symbol.asyncIterator]?async function*(){const n=await Md(e);yield*n.sort(t)}():function*(){const n=Md(e);yield*n.sort(t)}()};class Mv{put(e,t,n){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}putMany(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){for await(const{key:r,value:i}of e)await t.put(r,i,n),yield r}()}catch(BJ){return Promise.reject(BJ)}}getMany(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){for await(const r of e)yield{key:r,value:await t.get(r,n)}}()}catch(BJ){return Promise.reject(BJ)}}deleteMany(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){for await(const r of e)await t.delete(r,n),yield r}()}catch(BJ){return Promise.reject(BJ)}}batch(){let e=[],t=[];return{put(t,n){e.push({key:t,value:n})},delete(e){t.push(e)},commit:async n=>{await vf(this.putMany(e,n)),e=[],await vf(this.deleteMany(t,n)),t=[]}}}async*_all(e,t){throw new Error("._all is not implemented")}async*_allKeys(e,t){throw new Error("._allKeys is not implemented")}query(e,t){let n=this._all(e,t);if(null!=e.prefix){const t=e.prefix;n=ru(n,(e=>e.key.toString().startsWith(t)))}if(Array.isArray(e.filters)&&(n=e.filters.reduce(((e,t)=>ru(e,t)),n)),Array.isArray(e.orders)&&(n=e.orders.reduce(((e,t)=>Lv(e,t)),n)),null!=e.offset){let t=0;const r=e.offset;n=ru(n,(()=>t++>=r))}return null!=e.limit&&(n=Sf(n,e.limit)),n}queryKeys(e,t){let n=this._allKeys(e,t);if(null!=e.prefix){const t=e.prefix;n=ru(n,(e=>e.toString().startsWith(t)))}if(Array.isArray(e.filters)&&(n=e.filters.reduce(((e,t)=>ru(e,t)),n)),Array.isArray(e.orders)&&(n=e.orders.reduce(((e,t)=>Lv(e,t)),n)),null!=e.offset){const t=e.offset;let r=0;n=ru(n,(()=>r++>=t))}return null!=e.limit&&(n=Sf(n,e.limit)),n}}class Fv extends Mv{constructor(){super(),Dr(this,"data",void 0),this.data=new Map}put(e,t){return this.data.set(e.toString(),t),e}get(e){const t=this.data.get(e.toString());if(null==t)throw Tv();return t}has(e){return this.data.has(e.toString())}delete(e){this.data.delete(e.toString())}*_all(){for(const[e,t]of this.data.entries())yield{key:new Dv(e),value:t}}*_allKeys(){for(const e of this.data.keys())yield new Dv(e)}}new Dv(Ov);Ld("datastore:core:tiered");const Uv=Symbol.for("@libp2p/content-routing"),jv=Symbol.for("@libp2p/peer-routing");function Hv(e){return null!=e&&"function"===typeof e.start&&"function"===typeof e.stop}async function zv(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)Hv(i)&&e.push(i);await Promise.all(e.map((async e=>{null!=e.beforeStart&&await e.beforeStart()}))),await Promise.all(e.map((async e=>{await e.start()}))),await Promise.all(e.map((async e=>{null!=e.afterStart&&await e.afterStart()})))}async function Vv(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)Hv(i)&&e.push(i);await Promise.all(e.map((async e=>{null!=e.beforeStop&&await e.beforeStop()}))),await Promise.all(e.map((async e=>{await e.stop()}))),await Promise.all(e.map((async e=>{null!=e.afterStop&&await e.afterStop()})))}function qv(e){const t=[Xv.A];return null==e?t:Array.isArray(e)?0===e.length?t:e:[e]}const Gv=60;function Kv(e){var t,n,r,i,o,s,a,c,l,u,d,h,f,p,g;return{Status:null!==(t=e.Status)&&void 0!==t?t:0,TC:null!==(n=null!==(r=e.TC)&&void 0!==r?r:e.flag_tc)&&void 0!==n&&n,RD:null!==(i=null!==(o=e.RD)&&void 0!==o?o:e.flag_rd)&&void 0!==i&&i,RA:null!==(s=null!==(a=e.RA)&&void 0!==a?a:e.flag_ra)&&void 0!==s&&s,AD:null!==(c=null!==(l=e.AD)&&void 0!==l?l:e.flag_ad)&&void 0!==c&&c,CD:null!==(u=null!==(d=e.CD)&&void 0!==d?d:e.flag_cd)&&void 0!==u&&u,Question:(null!==(h=null!==(f=e.Question)&&void 0!==f?f:e.questions)&&void 0!==h?h:[]).map((e=>({name:e.name,type:Xv[e.type]}))),Answer:(null!==(p=null!==(g=e.Answer)&&void 0!==g?g:e.answers)&&void 0!==p?p:[]).map((e=>{var t,n;return{name:e.name,type:Xv[e.type],TTL:null!==(t=null!==(n=e.TTL)&&void 0!==n?n:e.ttl)&&void 0!==t?t:Gv,data:e.data instanceof Uint8Array?cp(e.data):e.data}}))}}const Wv=4;function Qv(e){var t;const n=new Xu({concurrency:null!==(t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).queryConcurrency)&&void 0!==t?t:Wv});return async function(t){var r;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=new URLSearchParams;o.set("name",t),qv(i.types).forEach((e=>{o.append("type",Xv[e])})),null===(r=i.onProgress)||void 0===r||r.call(i,new ha("dns:query",{detail:t}));const s=await n.add((async()=>{var t;const n=await fetch("".concat(e,"?").concat(o),{headers:{accept:"application/dns-json"},signal:null===i||void 0===i?void 0:i.signal});if(200!==n.status)throw new Error("Unexpected HTTP status: ".concat(n.status," - ").concat(n.statusText));const r=Kv(await n.json());return null===(t=i.onProgress)||void 0===t||t.call(i,new ha("dns:response",{detail:r})),r}),{signal:i.signal});if(null==s)throw new Error("No DNS response received");return s}}var Yv=n(101);class Zv{constructor(e){Dr(this,"lru",void 0),this.lru=Yv(e)}get(e,t){let n=!0;const r=[];for(const i of t){const t=this.getAnswers(e,i);if(0===t.length){n=!1;break}r.push(...t)}if(n)return Kv({answers:r})}getAnswers(e,t){const n="".concat(e.toLowerCase(),"-").concat(t),r=this.lru.get(n);if(null!=r){const e=r.filter((e=>e.expires>Date.now())).map((e=>{let{expires:t,value:n}=e;return{...n,TTL:Math.round((t-Date.now())/1e3),type:Xv[n.type]}}));return 0===e.length&&this.lru.remove(n),e}return[]}add(e,t){var n,r;const i="".concat(e.toLowerCase(),"-").concat(t.type),o=null!==(n=this.lru.get(i))&&void 0!==n?n:[];o.push({expires:Date.now()+1e3*(null!==(r=t.TTL)&&void 0!==r?r:Gv),value:t}),this.lru.set(i,o)}remove(e,t){const n="".concat(e.toLowerCase(),"-").concat(t);this.lru.remove(n)}clear(){this.lru.clear()}}class Jv{constructor(e){var t,n,r;Dr(this,"resolvers",void 0),Dr(this,"cache",void 0),this.resolvers={},this.cache=(r=null!==(t=e.cacheSize)&&void 0!==t?t:1e3,new Zv(r)),Object.entries(null!==(n=e.resolvers)&&void 0!==n?n:{}).forEach((e=>{let[t,n]=e;Array.isArray(n)||(n=[n]),t.endsWith(".")||(t="".concat(t,".")),this.resolvers[t]=n})),null==this.resolvers["."]&&(this.resolvers["."]=[Qv("https://cloudflare-dns.com/dns-query"),Qv("https://dns.google/resolve")])}async query(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=qv(n.types),i=!1!==n.cached?this.cache.get(e,r):void 0;var o;if(null!=i)return null===(o=n.onProgress)||void 0===o||o.call(n,new ha("dns:cache",{detail:i})),i;const s="".concat(e.split(".").pop(),"."),a=(null!==(t=this.resolvers[s])&&void 0!==t?t:this.resolvers["."]).sort((()=>Math.random()>.5?-1:1)),c=[];for(const h of a){var l;if(!0===(null===(l=n.signal)||void 0===l?void 0:l.aborted))break;try{const t=await h(e,{...n,types:r});for(const n of t.Answer)this.cache.add(e,n);return t}catch(d){var u;c.push(d),null===(u=n.onProgress)||void 0===u||u.call(n,new ha("dns:error",{detail:d}))}}if(1===c.length)throw c[0];throw new AggregateError(c,"DNS lookup of ".concat(e," ").concat(r," failed"))}}var Xv;!function(e){e[e.A=1]="A",e[e.CNAME=5]="CNAME",e[e.TXT=16]="TXT",e[e.AAAA=28]="AAAA"}(Xv||(Xv={}));function $v(){return new Jv(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}const ey="/pin/",ty="/pinned-block/",ny=cs;function ry(e){return 0===e.version&&(e=e.toV1()),new Dv("".concat(ey).concat(e.toString(ny)))}var iy=new WeakSet;class oy{constructor(e,t,n){Au(this,iy),Dr(this,"datastore",void 0),Dr(this,"blockstore",void 0),Dr(this,"dagWalkers",void 0),this.datastore=e,this.blockstore=t,this.dagWalkers=n}add(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(r,i){const o=ry(e);if(await t.datastore.has(o))throw new Error("Already pinned");const s=Math.round(null!==(r=n.depth)&&void 0!==r?r:1/0);if(s<0)throw new Error("Depth must be greater than or equal to 0");const a=new gf({concurrency:1});for await(const l of xu(iy,t,sy).call(t,e,a,{...n,depth:s}))await xu(iy,t,ay).call(t,l,(t=>null==t.pinnedBy.find((t=>zr(t,e.bytes)))&&(t.pinCount++,t.pinnedBy.push(e.bytes),!0)),n),yield l;const c={depth:s,metadata:null!==(i=n.metadata)&&void 0!==i?i:{}};await t.datastore.put(o,Il(c),n)}()}catch(BJ){return Promise.reject(BJ)}}rm(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){const r=ry(e),i=Bl(await t.datastore.get(r,n));await t.datastore.delete(r,n);const o=new gf({concurrency:1});for await(const s of xu(iy,t,sy).call(t,e,o,{...n,depth:i.depth}))await xu(iy,t,ay).call(t,s,(t=>(t.pinCount--,t.pinnedBy=t.pinnedBy.filter((t=>zr(t,e.bytes))),!0)),{...n,depth:i.depth}),yield s}()}catch(BJ){return Promise.reject(BJ)}}ls(){try{var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return async function*(){for await(const{key:n,value:r}of e.datastore.query({prefix:ey+(null!=t.cid?"".concat(t.cid.toString(cs)):"")},t)){const e=qi.parse(n.toString().substring(5),cs),t=Bl(r);yield{cid:e,...t}}}()}catch(BJ){return Promise.reject(BJ)}}async isPinned(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=new Dv("".concat(ty).concat(ny.encode(e.multihash.bytes)));return this.datastore.has(n,t)}}async function*sy(e,t,n){if(-1===n.depth)return;const r=this.dagWalkers[e.code];if(null==r)throw new Error("No dag walker found for cid codec ".concat(e.code));const i=await this.blockstore.get(e,n);yield e;for await(const o of r.walk(i))yield*await t.add((async()=>xu(iy,this,sy).call(this,o,t,{...n,depth:n.depth-1})))}async function ay(e,t,n){var r;const i=new Dv("".concat(ty).concat(ny.encode(e.multihash.bytes)));let o={pinCount:0,pinnedBy:[]};try{o=Bl(await this.datastore.get(i,n))}catch(s){if("ERR_NOT_FOUND"!==s.code)throw s}t(o)&&(0===o.pinCount&&await this.datastore.has(i)?await this.datastore.delete(i):(await this.datastore.put(i,Il(o),n),null===(r=n.onProgress)||void 0===r||r.call(n,new ha("helia:pin:add",e))))}class cy{constructor(e,t){var n,r;Dr(this,"log",void 0),Dr(this,"routers",void 0),Dr(this,"providerLookupConcurrency",void 0),this.log=e.logger.forComponent("helia:routing"),this.routers=null!==(n=t.routers)&&void 0!==n?n:[],this.providerLookupConcurrency=null!==(r=t.providerLookupConcurrency)&&void 0!==r?r:5}async start(){await zv(...this.routers)}async stop(){await Vv(...this.routers)}findProviders(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){if(0===t.routers.length)throw new tf("No content routers available","ERR_NO_ROUTERS_AVAILABLE");const r=new mf({concurrency:t.providerLookupConcurrency});r.addEventListener("error",(()=>{}));for await(const i of pu(r.toGenerator(),...ly(t.routers,"findProviders").map((t=>t.findProviders(e,n)))))if(null!=i){if(0===i.multiaddrs.length){if(null!=r.find(i.id))continue;r.add((async()=>{try{const e=await t.findPeer(i.id,n);return 0===e.multiaddrs.length?null:e}catch(e){return t.log.error("could not load multiaddrs for peer %p",i.id,e),null}}),{peerId:i.id,signal:n.signal}).catch((e=>{t.log.error("could not load multiaddrs for peer %p",i.id,e)}))}yield i}}()}catch(BJ){return Promise.reject(BJ)}}async provide(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===this.routers.length)throw new tf("No content routers available","ERR_NO_ROUTERS_AVAILABLE");await Promise.all(ly(this.routers,"provide").map((async n=>{await n.provide(e,t)})))}async put(e,t,n){await Promise.all(ly(this.routers,"put").map((async r=>{await r.put(e,t,n)})))}async get(e,t){return Promise.any(ly(this.routers,"get").map((async n=>n.get(e,t))))}async findPeer(e,t){if(0===this.routers.length)throw new tf("No peer routers available","ERR_NO_ROUTERS_AVAILABLE");const n=this,r=pu(...ly(this.routers,"findPeer").map((r=>async function*(){try{yield await r.findPeer(e,t)}catch(i){n.log.error(i)}}())));for await(const i of r)if(null!=i)return i;throw new tf("Could not find peer in routing","ERR_NOT_FOUND")}getClosestPeers(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){if(0===t.routers.length)throw new tf("No peer routers available","ERR_NO_ROUTERS_AVAILABLE");for await(const r of pu(...ly(t.routers,"getClosestPeers").map((t=>t.getClosestPeers(e,n)))))null!=r&&(yield r)}()}catch(BJ){return Promise.reject(BJ)}}}function ly(e,t){return e.filter((e=>null!=e[t]))}const uy={},dy=e=>{e.addEventListener("message",(t=>{dy.dispatchEvent("message",e,t)})),null!=e.port&&e.port.addEventListener("message",(t=>{dy.dispatchEvent("message",e,t)}))};dy.addEventListener=(e,t)=>{null==uy[e]&&(uy[e]=[]),uy[e].push(t)},dy.removeEventListener=(e,t)=>{null!=uy[e]&&(uy[e]=uy[e].filter((e=>e===t)))},dy.dispatchEvent=function(e,t,n){null!=uy[e]&&uy[e].forEach((e=>e(t,n)))};const hy=dy,fy="lock:worker:request-read",py="lock:worker:release-read",gy="lock:master:grant-read",my="lock:worker:request-write",vy="lock:worker:release-write",yy="lock:master:grant-write",wy=(e,t,n,r,i)=>(o,s)=>{if(s.data.type!==n)return;const a={type:s.data.type,name:s.data.name,identifier:s.data.identifier};e.dispatchEvent(new MessageEvent(t,{data:{name:a.name,handler:async()=>{o.postMessage({type:i,name:a.name,identifier:a.identifier}),await new Promise((e=>{const t=n=>{if(null==n||null==n.data)return;const i=n.data.type,s=(n.data.name,n.data.identifier);i===r&&s===a.identifier&&(o.removeEventListener("message",t),e())};o.addEventListener("message",t)}))}}}))},by=(e,t,n,r)=>async()=>{const i=Math.random().toString().substring(2);return globalThis.postMessage({type:t,identifier:i,name:e}),new Promise((t=>{const o=s=>{if(null==s||null==s.data)return;const a=s.data.type,c=s.data.identifier;a===n&&c===i&&(globalThis.removeEventListener("message",o),t((()=>{globalThis.postMessage({type:r,identifier:i,name:e})})))};globalThis.addEventListener("message",o)}))},Ey={singleProcess:!1},ky={};let Ay;async function Sy(e,t){let n;const r=new Promise((e=>{n=e}));return e.add((async()=>Du((async()=>{await new Promise((e=>{n((()=>{e()}))}))})(),{milliseconds:t.timeout}))),r}const xy={name:"lock",concurrency:1/0,timeout:846e5,singleProcess:!1};function _y(e){const t=Object.assign({},xy,e);return null==Ay&&(Ay=(e=>{if(e=Object.assign({},Ey,e),Boolean(globalThis.document)||e.singleProcess){const e=new EventTarget;return hy.addEventListener("message",wy(e,"requestReadLock",fy,py,gy)),hy.addEventListener("message",wy(e,"requestWriteLock",my,vy,yy)),e}return{isWorker:!0,readLock:e=>by(e,fy,gy,py),writeLock:e=>by(e,my,yy,vy)}})(t),!0!==Ay.isWorker&&(Ay.addEventListener("requestReadLock",(e=>{null!=ky[e.data.name]&&ky[e.data.name].readLock().then((async t=>e.data.handler().finally((()=>{t()}))))})),Ay.addEventListener("requestWriteLock",(async e=>{null!=ky[e.data.name]&&ky[e.data.name].writeLock().then((async t=>e.data.handler().finally((()=>{t()}))))})))),null==ky[t.name]&&(ky[t.name]=((e,t)=>{if(!0===Ay.isWorker)return{readLock:Ay.readLock(e,t),writeLock:Ay.writeLock(e,t)};const n=new Xu({concurrency:1});let r;return{async readLock(){if(null!=r)return Sy(r,t);r=new Xu({concurrency:t.concurrency,autoStart:!1});const e=r,i=Sy(r,t);return n.add((async()=>{e.start(),await e.onIdle().then((()=>{r===e&&(r=null)}))})),i},writeLock:async()=>(r=null,Sy(n,t))}})(t.name,t)),ky[t.name]}class Iy{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Dr(this,"lock",void 0),Dr(this,"child",void 0),Dr(this,"pins",void 0),Dr(this,"started",void 0),this.child=e,this.pins=t,this.lock=_y({singleProcess:n.holdGcLock}),this.started=!1}isStarted(){return this.started}async start(){await zv(this.child),this.started=!0}async stop(){await Vv(this.child),this.started=!1}unwrap(){return this.child}async put(e,t){var n;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};null===r||void 0===r||null===(n=r.signal)||void 0===n||n.throwIfAborted();const i=await this.lock.readLock();try{return await this.child.put(e,t,r)}finally{i()}}putMany(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(r){null===n||void 0===n||null===(r=n.signal)||void 0===r||r.throwIfAborted();const i=await t.lock.readLock();try{yield*t.child.putMany(e,n)}finally{i()}}()}catch(BJ){return Promise.reject(BJ)}}async get(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null===n||void 0===n||null===(t=n.signal)||void 0===t||t.throwIfAborted();const r=await this.lock.readLock();try{return await this.child.get(e,n)}finally{r()}}getMany(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(r){null===n||void 0===n||null===(r=n.signal)||void 0===r||r.throwIfAborted();const i=await t.lock.readLock();try{yield*t.child.getMany(e,n)}finally{i()}}()}catch(BJ){return Promise.reject(BJ)}}async delete(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null===n||void 0===n||null===(t=n.signal)||void 0===t||t.throwIfAborted();const r=await this.lock.writeLock();try{if(await this.pins.isPinned(e))throw new Error("CID was pinned");await this.child.delete(e,n)}finally{r()}}deleteMany(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(r){null===n||void 0===n||null===(r=n.signal)||void 0===r||r.throwIfAborted();const i=await t.lock.writeLock();try{const r=t;yield*t.child.deleteMany(async function*(){for await(const t of e){if(await r.pins.isPinned(t))throw new Error("CID was pinned");yield t}}(),n)}finally{i()}}()}catch(BJ){return Promise.reject(BJ)}}async has(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null===n||void 0===n||null===(t=n.signal)||void 0===t||t.throwIfAborted();const r=await this.lock.readLock();try{return await this.child.has(e,n)}finally{r()}}getAll(){try{var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return async function*(n){null===t||void 0===t||null===(n=t.signal)||void 0===n||n.throwIfAborted();const r=await e.lock.readLock();try{yield*e.child.getAll(t)}finally{r()}}()}catch(BJ){return Promise.reject(BJ)}}createSession(e,t){var n;return null===t||void 0===t||null===(n=t.signal)||void 0===n||n.throwIfAborted(),this.child.createSession(e,t)}}const Ry={codec:Eo,*walk(e){const t=Ao(e);yield*t.Links.map((e=>e.Hash))}},Cy={codec:As,*walk(){}},Ty={codec:113,*walk(e){const t=[],n=[];n[42]=e=>{if(0!==e[0])throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");const n=qi.decode(e.subarray(1));return t.push(n),n},Bl(e,{tags:n}),yield*t}};class Py extends Fl{constructor(e,t){super(e,t),Dr(this,"tokenBuffer",void 0),this.tokenBuffer=[]}done(){return 0===this.tokenBuffer.length&&super.done()}_next(){return this.tokenBuffer.length>0?this.tokenBuffer.pop():super.next()}next(){const e=this._next();if(e.type===ac.map){const e=this._next();if(e.type===ac.string&&"/"===e.value){const e=this._next();if(e.type===ac.string){if(this._next().type!==ac.break)throw new Error("Invalid encoded CID form");return this.tokenBuffer.push(e),new cc(ac.tag,42,0)}if(e.type===ac.map){const e=this._next();if(e.type===ac.string&&"bytes"===e.value){const e=this._next();if(e.type===ac.string){for(let e=0;e<2;e++){if(this._next().type!==ac.break)throw new Error("Invalid encoded Bytes form")}const t=us.decode("m".concat(e.value));return new cc(ac.bytes,t,e.value.length)}this.tokenBuffer.push(e)}this.tokenBuffer.push(e)}this.tokenBuffer.push(e)}this.tokenBuffer.push(e)}return e}}const Ny={codec:297,*walk(e){const t=[],n=[];n[42]=e=>{const n=qi.parse(e);return t.push(n),n},Ul(e,{tags:n,tokenizer:new Py(e,{tags:n,allowIndefinite:!0,allowUndefined:!0,allowNaN:!0,allowInfinity:!0,allowBigInt:!0,strict:!1,rejectDuplicateMapKeys:!1})}),yield*t}},By={codec:ws,*walk(){}};const Dy=new Dv("/version");class Oy extends Iv{constructor(e){super(),Dr(this,"child",void 0),this.child=e}put(e,t){return 0===e.multihash.code||null==this.child?e:this.child.put(e,t)}get(e){if(0===e.multihash.code)return e.multihash.digest;if(null==this.child)throw Cv.notFoundError();return this.child.get(e)}has(e){return 0===e.multihash.code||null!=this.child&&this.child.has(e)}delete(e){if(0!==e.code)return null!=this.child?this.child.delete(e):void 0}getAll(e){return null!=this.child?this.child.getAll(e):[]}}function Ly(e){return null!=(null===e||void 0===e?void 0:e.then)}const My=function(e,t){let n=0;if(null!=e[Symbol.asyncIterator])return async function*(){for await(const r of e){const e=t(r,n++);Ly(e)&&await e,yield r}}();const r=nu(e),{value:i,done:o}=r.next();if(!0===o)return function*(){}();const s=t(i,n++);if("function"===typeof(null===s||void 0===s?void 0:s.then))return async function*(){yield i;for await(const e of r){const r=t(e,n++);Ly(r)&&await r,yield e}}();const a=t;return function*(){yield i;for(const e of r)a(e,n++),yield e}()};class Fy{constructor(e){var t;Dr(this,"child",void 0),Dr(this,"hashers",void 0),Dr(this,"log",void 0),Dr(this,"logger",void 0),Dr(this,"components",void 0),this.log=e.logger.forComponent("helia:networked-storage"),this.logger=e.logger,this.components=e,this.child=new Oy(e.blockstore),this.hashers=null!==(t=e.hashers)&&void 0!==t?t:{}}async put(e,t){var n,r;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var o;return await this.child.has(e,i)?(null===(o=i.onProgress)||void 0===o||o.call(i,new ha("blocks:put:duplicate",e)),e):(null===(n=i.onProgress)||void 0===n||n.call(i,new ha("blocks:put:providers:notify",e)),await Promise.all(this.components.blockBrokers.map((async n=>{var r;return null===(r=n.announce)||void 0===r?void 0:r.call(n,e,t,i)}))),null===(r=i.onProgress)||void 0===r||r.call(i,new ha("blocks:put:blockstore:put",e)),this.child.put(e,t,i))}putMany(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(r){const i=ru(e,(async e=>{let{cid:r}=e;const i=await t.child.has(r,n);var o;i&&(null===(o=n.onProgress)||void 0===o||o.call(n,new ha("blocks:put-many:duplicate",r)));return!i})),o=My(i,(async e=>{var r;let{cid:i,block:o}=e;null===(r=n.onProgress)||void 0===r||r.call(n,new ha("blocks:put-many:providers:notify",i)),await Promise.all(t.components.blockBrokers.map((async e=>{var t;return null===(t=e.announce)||void 0===t?void 0:t.call(e,i,o,n)})))}));null===(r=n.onProgress)||void 0===r||r.call(n,new ha("blocks:put-many:blockstore:put-many")),yield*t.child.putMany(o,n)}()}catch(BJ){return Promise.reject(BJ)}}async get(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!0!==n.offline&&!await this.child.has(e,n)){var r,i,o;null===(r=n.onProgress)||void 0===r||r.call(n,new ha("blocks:get:providers:get",e));const t=await Vy(e,this.components.blockBrokers,this.hashers[e.multihash.code],{...n,log:this.log});return null===(i=n.onProgress)||void 0===i||i.call(n,new ha("blocks:get:blockstore:put",e)),await this.child.put(e,t,n),null===(o=n.onProgress)||void 0===o||o.call(n,new ha("blocks:get:providers:notify",e)),await Promise.all(this.components.blockBrokers.map((async r=>{var i;return null===(i=r.announce)||void 0===i?void 0:i.call(r,e,t,n)}))),t}return null===(t=n.onProgress)||void 0===t||t.call(n,new ha("blocks:get:blockstore:get",e)),this.child.get(e,n)}getMany(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(r){null===(r=n.onProgress)||void 0===r||r.call(n,new ha("blocks:get-many:blockstore:get-many")),yield*t.child.getMany(My(e,(async e=>{if(!0!==n.offline&&!await t.child.has(e,n)){var r,i,o;null===(r=n.onProgress)||void 0===r||r.call(n,new ha("blocks:get-many:providers:get",e));const s=await Vy(e,t.components.blockBrokers,t.hashers[e.multihash.code],{...n,log:t.log});null===(i=n.onProgress)||void 0===i||i.call(n,new ha("blocks:get-many:blockstore:put",e)),await t.child.put(e,s,n),null===(o=n.onProgress)||void 0===o||o.call(n,new ha("blocks:get-many:providers:notify",e)),await Promise.all(t.components.blockBrokers.map((async t=>{var r;return null===(r=t.announce)||void 0===r?void 0:r.call(t,e,s,n)})))}})))}()}catch(BJ){return Promise.reject(BJ)}}async delete(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null===(t=n.onProgress)||void 0===t||t.call(n,new ha("blocks:delete:blockstore:delete",e)),await this.child.delete(e,n)}deleteMany(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(r){null===(r=n.onProgress)||void 0===r||r.call(n,new ha("blocks:delete-many:blockstore:delete-many")),yield*t.child.deleteMany(async function*(){for await(const t of e)yield t}(),n)}()}catch(BJ){return Promise.reject(BJ)}}async has(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.child.has(e,t)}getAll(){try{var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return async function*(n){null===(n=t.onProgress)||void 0===n||n.call(t,new ha("blocks:get-all:blockstore:get-many")),yield*e.child.getAll(t)}()}catch(BJ){return Promise.reject(BJ)}}}class Uy extends Fy{constructor(e){super(e),Dr(this,"started",void 0),this.started=!1}isStarted(){return this.started}async start(){await zv(this.child,...this.components.blockBrokers),this.started=!0}async stop(){await Vv(this.child,...this.components.blockBrokers),this.started=!1}unwrap(){return this.child}createSession(e,t){const n=this.components.blockBrokers.map((e=>null==e.createSession?e:e.createSession(t)));return new jy({blockstore:this.child,blockBrokers:n,hashers:this.hashers,logger:this.logger},{root:e})}}class jy extends Fy{constructor(e,t){super(e),Dr(this,"closeController",void 0),this.closeController=new AbortController,Wh(1/0,this.closeController.signal),this.log=e.logger.forComponent("helia:session-storage".concat(t.root))}close(){this.closeController.abort()}async put(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=Qh([this.closeController.signal,n.signal]);Wh(1/0,r);try{return await super.put(e,t,{...n,signal:r})}finally{r.clear()}}putMany(e){try{var t=()=>super.putMany,n=this;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){const i=Qh([n.closeController.signal,r.signal]);Wh(1/0,i);try{yield*t().call(n,e,{...r,signal:i})}finally{i.clear()}}()}catch(BJ){return Promise.reject(BJ)}}async get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=Qh([this.closeController.signal,t.signal]);Wh(1/0,n);try{return await super.get(e,{...t,signal:n})}finally{n.clear()}}getMany(e){try{var t=()=>super.getMany,n=this;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){const i=Qh([n.closeController.signal,r.signal]);Wh(1/0,i);try{yield*t().call(n,e,{...r,signal:i})}finally{i.clear()}}()}catch(BJ){return Promise.reject(BJ)}}async delete(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=Qh([this.closeController.signal,t.signal]);Wh(1/0,n);try{await super.delete(e,{...t,signal:n})}finally{n.clear()}}deleteMany(e){try{var t=()=>super.deleteMany,n=this;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){const i=Qh([n.closeController.signal,r.signal]);Wh(1/0,i);try{yield*t().call(n,e,{...r,signal:i})}finally{i.clear()}}()}catch(BJ){return Promise.reject(BJ)}}async has(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=Qh([this.closeController.signal,t.signal]);Wh(1/0,n);try{return await super.has(e,{...t,signal:n})}finally{n.clear()}}getAll(){try{var e=()=>super.getAll,t=this;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return async function*(){const r=Qh([t.closeController.signal,n.signal]);Wh(1/0,r);try{yield*e().call(t,{...n,signal:r})}finally{r.clear()}}()}catch(BJ){return Promise.reject(BJ)}}}function Hy(e){return"function"===typeof e.retrieve}const zy=(e,t)=>{if(null==t)throw new tf("No hasher configured for multihash code 0x".concat(e.multihash.code.toString(16),", please configure one. You can look up which hash this is at https://github.com/multiformats/multicodec/blob/master/table.csv"),"ERR_UNKNOWN_HASH_ALG");return async n=>{if(!zr((await t.digest(n)).digest,e.multihash.digest))throw new tf("Hash of downloaded block did not match multihash from passed CID","ERR_HASH_MISMATCH")}};async function Vy(e,t,n,r){const i=zy(e,n),o=new AbortController,s=Qh([o.signal,r.signal]);Wh(1/0,o.signal,s);const a=[];for(const c of t)Hy(c)&&a.push(c);try{return await Promise.any(a.map((async t=>{try{let n=!1;const o=await t.retrieve(e,{...r,signal:s,validateFn:async e=>{await i(e),n=!0}});return n||await i(o),o}catch(n){throw r.log.error("could not retrieve verified block for %c",e,n),n}})))}finally{o.abort(),s.clear()}}class qy{constructor(e){var t,n,r,i,o;Dr(this,"blockstore",void 0),Dr(this,"datastore",void 0),Dr(this,"pins",void 0),Dr(this,"logger",void 0),Dr(this,"routing",void 0),Dr(this,"dagWalkers",void 0),Dr(this,"hashers",void 0),Dr(this,"dns",void 0),Dr(this,"metrics",void 0),Dr(this,"log",void 0),this.logger=null!==(t=e.logger)&&void 0!==t?t:Od(),this.log=this.logger.forComponent("helia"),this.hashers=function(){const e={};return[Ps,Ns,Is,...arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]].forEach((t=>{e[t.code]=t})),e}(e.hashers),this.dagWalkers=function(){const e={};return[Ry,Cy,Ty,Ny,By,...arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]].forEach((t=>{e[t.codec]=t})),e}(e.dagWalkers),this.dns=null!==(n=e.dns)&&void 0!==n?n:$v(),this.metrics=e.metrics;const s={blockstore:e.blockstore,datastore:e.datastore,hashers:this.hashers,dagWalkers:this.dagWalkers,logger:this.logger,blockBrokers:[],dns:this.dns,metrics:this.metrics,...null!==(r=e.components)&&void 0!==r?r:{}};this.routing=s.routing=new cy(s,{routers:(null!==(i=e.routers)&&void 0!==i?i:[]).flatMap((e=>{const t=[e];return null!=e[Uv]&&t.push(e[Uv]),null!=e[jv]&&t.push(e[jv]),t})),providerLookupConcurrency:e.providerLookupConcurrency});const a=new Uy(s);this.pins=new oy(e.datastore,a,this.dagWalkers),this.blockstore=new Iy(a,this.pins,{holdGcLock:null===(o=e.holdGcLock)||void 0===o||o}),this.datastore=e.datastore,s.blockBrokers=e.blockBrokers.map((e=>e(s)))}async start(){await async function(e){if(!await e.has(Dy))return void await e.put(Dy,Fs("".concat(1)));const t=cp(await e.get(Dy));if(1!==parseInt(t,10))throw new Error("Unknown datastore version, a datastore migration may be required")}(this.datastore),await zv(this.blockstore,this.datastore,this.routing)}async stop(){await Vv(this.blockstore,this.datastore,this.routing)}async gc(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=await this.blockstore.lock.writeLock();try{const t=this,n=this.blockstore.unwrap();this.log("gc start"),await vf(n.deleteMany(async function*(){for await(const{cid:s}of n.getAll())try{var r;if(await t.pins.isPinned(s,e))continue;yield s,null===(r=e.onProgress)||void 0===r||r.call(e,new ha("helia:gc:deleted",s))}catch(o){var i;t.log.error("Error during gc",o),null===(i=e.onProgress)||void 0===i||i.call(e,new ha("helia:gc:error",o))}}()))}finally{t()}this.log("gc finished")}}class Gy extends qy{constructor(e){super({...e,components:{libp2p:e.libp2p}}),Dr(this,"libp2p",void 0),this.libp2p=e.libp2p}async start(){await super.start(),await this.libp2p.start()}async stop(){await super.stop(),await this.libp2p.stop()}}class Ky extends Rp{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,vp(e);const n=_p(t);if(this.iHash=e.create(),"function"!==typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const r=this.blockLen,i=new Uint8Array(r);i.set(n.length>r?e.create().update(n).digest():n);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),i.fill(0)}update(e){return yp(this),this.iHash.update(e),this}digestInto(e){yp(this),mp(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:r,destroyed:i,blockLen:o,outputLen:s}=this;return e.finished=r,e.destroyed=i,e.blockLen=o,e.outputLen=s,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Wy=(e,t,n)=>new Ky(e,t).update(n).digest();function Qy(e,t,n,r){vp(e);const i=function(e,t){if(void 0!==t&&"[object Object]"!==Cp.call(t))throw new Error("Options should be object or undefined");return Object.assign(e,t)}({dkLen:32,asyncTick:10},r),{c:o,dkLen:s,asyncTick:a}=i;if(gp(o),gp(s),gp(a),o<1)throw new Error("PBKDF2: iterations (c) should be >= 1");const c=_p(t),l=_p(n),u=new Uint8Array(s),d=Wy.create(e,c),h=d._cloneInto().update(l);return{c:o,dkLen:s,asyncTick:a,DK:u,PRF:d,PRFSalt:h}}function Yy(e,t,n,r,i){return e.destroy(),t.destroy(),r&&r.destroy(),i.fill(0),n}async function Zy(e,t,n,r){const{c:i,dkLen:o,asyncTick:s,DK:a,PRF:c,PRFSalt:l}=Qy(e,t,n,r);let u;const d=new Uint8Array(4),h=bp(d),f=new Uint8Array(c.outputLen);for(let p=1,g=0;g<o;p++,g+=c.outputLen){const e=a.subarray(g,g+c.outputLen);h.setInt32(0,p,!1),(u=l._cloneInto(u)).update(d).digestInto(f),e.set(f.subarray(0,e.length)),await Sp(i-1,s,(()=>{c._cloneInto(u).update(f).digestInto(f);for(let t=0;t<e.length;t++)e[t]^=f[t]}))}return Yy(c,l,a,u,f)}Wy.create=(e,t)=>new Ky(e,t);const Jy=(e,t,n)=>e&t^~e&n,Xy=(e,t,n)=>e&t^e&n^t&n;class $y extends Rp{constructor(e,t,n,r){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=bp(this.buffer)}update(e){yp(this);const{view:t,buffer:n,blockLen:r}=this,i=(e=_p(e)).length;for(let o=0;o<i;){const s=Math.min(r-this.pos,i-o);if(s!==r)n.set(e.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===r&&(this.process(t,0),this.pos=0);else{const t=bp(e);for(;r<=i-o;o+=r)this.process(t,o)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){yp(this),wp(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:r,isLE:i}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>r-o&&(this.process(n,0),o=0);for(let u=o;u<r;u++)t[u]=0;!function(e,t,n,r){if("function"===typeof e.setBigUint64)return e.setBigUint64(t,n,r);const i=BigInt(32),o=BigInt(4294967295),s=Number(n>>i&o),a=Number(n&o),c=r?4:0,l=r?0:4;e.setUint32(t+c,s,r),e.setUint32(t+l,a,r)}(n,r-8,BigInt(8*this.length),i),this.process(n,0);const s=bp(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,l=this.get();if(c>l.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<c;u++)s.setUint32(4*u,l[u],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:r,finished:i,destroyed:o,pos:s}=this;return e.length=r,e.pos=s,e.finished=i,e.destroyed=o,r%t&&e.buffer.set(n),e}}const ew=new Uint32Array([1732584193,4023233417,2562383102,271733878,3285377520]),tw=new Uint32Array(80);class nw extends $y{constructor(){super(64,20,8,!1),this.A=0|ew[0],this.B=0|ew[1],this.C=0|ew[2],this.D=0|ew[3],this.E=0|ew[4]}get(){const{A:e,B:t,C:n,D:r,E:i}=this;return[e,t,n,r,i]}set(e,t,n,r,i){this.A=0|e,this.B=0|t,this.C=0|n,this.D=0|r,this.E=0|i}process(e,t){for(let a=0;a<16;a++,t+=4)tw[a]=e.getUint32(t,!1);for(let a=16;a<80;a++)tw[a]=kp(tw[a-3]^tw[a-8]^tw[a-14]^tw[a-16],1);let{A:n,B:r,C:i,D:o,E:s}=this;for(let a=0;a<80;a++){let e,t;a<20?(e=Jy(r,i,o),t=1518500249):a<40?(e=r^i^o,t=1859775393):a<60?(e=Xy(r,i,o),t=2400959708):(e=r^i^o,t=3395469782);const c=kp(n,5)+e+s+t+tw[a]|0;s=o,o=i,i=kp(r,30),r=n,n=c}n=n+this.A|0,r=r+this.B|0,i=i+this.C|0,o=o+this.D|0,s=s+this.E|0,this.set(n,r,i,o,s)}roundClean(){tw.fill(0)}destroy(){this.set(0,0,0,0,0),this.buffer.fill(0)}}const rw=Tp((()=>new nw)),iw=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ow=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),sw=new Uint32Array(64);class aw extends $y{constructor(){super(64,32,8,!1),this.A=0|ow[0],this.B=0|ow[1],this.C=0|ow[2],this.D=0|ow[3],this.E=0|ow[4],this.F=0|ow[5],this.G=0|ow[6],this.H=0|ow[7]}get(){const{A:e,B:t,C:n,D:r,E:i,F:o,G:s,H:a}=this;return[e,t,n,r,i,o,s,a]}set(e,t,n,r,i,o,s,a){this.A=0|e,this.B=0|t,this.C=0|n,this.D=0|r,this.E=0|i,this.F=0|o,this.G=0|s,this.H=0|a}process(e,t){for(let u=0;u<16;u++,t+=4)sw[u]=e.getUint32(t,!1);for(let u=16;u<64;u++){const e=sw[u-15],t=sw[u-2],n=Ep(e,7)^Ep(e,18)^e>>>3,r=Ep(t,17)^Ep(t,19)^t>>>10;sw[u]=r+sw[u-7]+n+sw[u-16]|0}let{A:n,B:r,C:i,D:o,E:s,F:a,G:c,H:l}=this;for(let u=0;u<64;u++){const e=l+(Ep(s,6)^Ep(s,11)^Ep(s,25))+Jy(s,a,c)+iw[u]+sw[u]|0,t=(Ep(n,2)^Ep(n,13)^Ep(n,22))+Xy(n,r,i)|0;l=c,c=a,a=s,s=o+e|0,o=i,i=r,r=n,n=e+t|0}n=n+this.A|0,r=r+this.B|0,i=i+this.C|0,o=o+this.D|0,s=s+this.E|0,a=a+this.F|0,c=c+this.G|0,l=l+this.H|0,this.set(n,r,i,o,s,a,c,l)}roundClean(){sw.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const cw=Tp((()=>new aw)),lw=BigInt(2**32-1),uw=BigInt(32);function dw(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?{h:Number(e&lw),l:Number(e>>uw&lw)}:{h:0|Number(e>>uw&lw),l:0|Number(e&lw)}}const hw={fromBig:dw,split:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=new Uint32Array(e.length),r=new Uint32Array(e.length);for(let i=0;i<e.length;i++){const{h:o,l:s}=dw(e[i],t);[n[i],r[i]]=[o,s]}return[n,r]},toBig:(e,t)=>BigInt(e>>>0)<<uw|BigInt(t>>>0),shrSH:(e,t,n)=>e>>>n,shrSL:(e,t,n)=>e<<32-n|t>>>n,rotrSH:(e,t,n)=>e>>>n|t<<32-n,rotrSL:(e,t,n)=>e<<32-n|t>>>n,rotrBH:(e,t,n)=>e<<64-n|t>>>n-32,rotrBL:(e,t,n)=>e>>>n-32|t<<64-n,rotr32H:(e,t)=>t,rotr32L:(e,t)=>e,rotlSH:(e,t,n)=>e<<n|t>>>32-n,rotlSL:(e,t,n)=>t<<n|e>>>32-n,rotlBH:(e,t,n)=>t<<n-32|e>>>64-n,rotlBL:(e,t,n)=>e<<n-32|t>>>64-n,add:function(e,t,n,r){const i=(t>>>0)+(r>>>0);return{h:e+n+(i/2**32|0)|0,l:0|i}},add3L:(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),add3H:(e,t,n,r)=>t+n+r+(e/2**32|0)|0,add4L:(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),add4H:(e,t,n,r,i)=>t+n+r+i+(e/2**32|0)|0,add5H:(e,t,n,r,i,o)=>t+n+r+i+o+(e/2**32|0)|0,add5L:(e,t,n,r,i)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(i>>>0)},fw=hw,[pw,gw]=(()=>fw.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((e=>BigInt(e)))))(),mw=new Uint32Array(80),vw=new Uint32Array(80);class yw extends $y{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:n,Bl:r,Ch:i,Cl:o,Dh:s,Dl:a,Eh:c,El:l,Fh:u,Fl:d,Gh:h,Gl:f,Hh:p,Hl:g}=this;return[e,t,n,r,i,o,s,a,c,l,u,d,h,f,p,g]}set(e,t,n,r,i,o,s,a,c,l,u,d,h,f,p,g){this.Ah=0|e,this.Al=0|t,this.Bh=0|n,this.Bl=0|r,this.Ch=0|i,this.Cl=0|o,this.Dh=0|s,this.Dl=0|a,this.Eh=0|c,this.El=0|l,this.Fh=0|u,this.Fl=0|d,this.Gh=0|h,this.Gl=0|f,this.Hh=0|p,this.Hl=0|g}process(e,t){for(let y=0;y<16;y++,t+=4)mw[y]=e.getUint32(t),vw[y]=e.getUint32(t+=4);for(let y=16;y<80;y++){const e=0|mw[y-15],t=0|vw[y-15],n=fw.rotrSH(e,t,1)^fw.rotrSH(e,t,8)^fw.shrSH(e,t,7),r=fw.rotrSL(e,t,1)^fw.rotrSL(e,t,8)^fw.shrSL(e,t,7),i=0|mw[y-2],o=0|vw[y-2],s=fw.rotrSH(i,o,19)^fw.rotrBH(i,o,61)^fw.shrSH(i,o,6),a=fw.rotrSL(i,o,19)^fw.rotrBL(i,o,61)^fw.shrSL(i,o,6),c=fw.add4L(r,a,vw[y-7],vw[y-16]),l=fw.add4H(c,n,s,mw[y-7],mw[y-16]);mw[y]=0|l,vw[y]=0|c}let{Ah:n,Al:r,Bh:i,Bl:o,Ch:s,Cl:a,Dh:c,Dl:l,Eh:u,El:d,Fh:h,Fl:f,Gh:p,Gl:g,Hh:m,Hl:v}=this;for(let y=0;y<80;y++){const e=fw.rotrSH(u,d,14)^fw.rotrSH(u,d,18)^fw.rotrBH(u,d,41),t=fw.rotrSL(u,d,14)^fw.rotrSL(u,d,18)^fw.rotrBL(u,d,41),w=u&h^~u&p,b=d&f^~d&g,E=fw.add5L(v,t,b,gw[y],vw[y]),k=fw.add5H(E,m,e,w,pw[y],mw[y]),A=0|E,S=fw.rotrSH(n,r,28)^fw.rotrBH(n,r,34)^fw.rotrBH(n,r,39),x=fw.rotrSL(n,r,28)^fw.rotrBL(n,r,34)^fw.rotrBL(n,r,39),_=n&i^n&s^i&s,I=r&o^r&a^o&a;m=0|p,v=0|g,p=0|h,g=0|f,h=0|u,f=0|d,({h:u,l:d}=fw.add(0|c,0|l,0|k,0|A)),c=0|s,l=0|a,s=0|i,a=0|o,i=0|n,o=0|r;const R=fw.add3L(A,x,I);n=fw.add3H(R,k,S,_),r=0|R}({h:n,l:r}=fw.add(0|this.Ah,0|this.Al,0|n,0|r)),({h:i,l:o}=fw.add(0|this.Bh,0|this.Bl,0|i,0|o)),({h:s,l:a}=fw.add(0|this.Ch,0|this.Cl,0|s,0|a)),({h:c,l:l}=fw.add(0|this.Dh,0|this.Dl,0|c,0|l)),({h:u,l:d}=fw.add(0|this.Eh,0|this.El,0|u,0|d)),({h:h,l:f}=fw.add(0|this.Fh,0|this.Fl,0|h,0|f)),({h:p,l:g}=fw.add(0|this.Gh,0|this.Gl,0|p,0|g)),({h:m,l:v}=fw.add(0|this.Hh,0|this.Hl,0|m,0|v)),this.set(n,r,i,o,s,a,c,l,u,d,h,f,p,g,m,v)}roundClean(){mw.fill(0),vw.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const ww=Tp((()=>new yw)),bw={sha1:rw,"sha2-256":cw,"sha2-512":ww};function Ew(e,t,n,r,i){if("sha1"!==i&&"sha2-256"!==i&&"sha2-512"!==i){const e=Object.keys(bw).join(" / ");throw new tf("Hash '".concat(i,"' is unknown or not supported. Must be ").concat(e),"ERR_UNSUPPORTED_HASH_TYPE")}const o=function(e,t,n,r){const{c:i,dkLen:o,DK:s,PRF:a,PRFSalt:c}=Qy(e,t,n,r);let l;const u=new Uint8Array(4),d=bp(u),h=new Uint8Array(a.outputLen);for(let f=1,p=0;p<o;f++,p+=a.outputLen){const e=s.subarray(p,p+a.outputLen);d.setInt32(0,f,!1),(l=c._cloneInto(l)).update(u).digestInto(h),e.set(h.subarray(0,e.length));for(let t=1;t<i;t++){a._cloneInto(l).update(h).digestInto(h);for(let t=0;t<e.length;t++)e[t]^=h[t]}}return Yy(a,c,s,l,h)}(bw[i],e,t,{c:n,dkLen:r});return us.encode(o).substring(1)}function kw(e){return null!=e&&("function"===typeof e.then&&"function"===typeof e.catch&&"function"===typeof e.finally)}BigInt(0);const Aw=BigInt(1),Sw=BigInt(2);function xw(e){return e instanceof Uint8Array||null!=e&&"object"===typeof e&&"Uint8Array"===e.constructor.name}function _w(e){if(!xw(e))throw new Error("Uint8Array expected")}const Iw=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function Rw(e){_w(e);let t="";for(let n=0;n<e.length;n++)t+=Iw[e[n]];return t}function Cw(e){if("string"!==typeof e)throw new Error("hex string expected, got "+typeof e);return BigInt(""===e?"0":"0x".concat(e))}const Tw={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function Pw(e){return e>=Tw._0&&e<=Tw._9?e-Tw._0:e>=Tw._A&&e<=Tw._F?e-(Tw._A-10):e>=Tw._a&&e<=Tw._f?e-(Tw._a-10):void 0}function Nw(e){if("string"!==typeof e)throw new Error("hex string expected, got "+typeof e);const t=e.length,n=t/2;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(n);for(let i=0,o=0;i<n;i++,o+=2){const t=Pw(e.charCodeAt(o)),n=Pw(e.charCodeAt(o+1));if(void 0===t||void 0===n){const t=e[o]+e[o+1];throw new Error('hex string expected, got non-hex character "'+t+'" at index '+o)}r[i]=16*t+n}return r}function Bw(e){return Cw(Rw(e))}function Dw(e){return _w(e),Cw(Rw(Uint8Array.from(e).reverse()))}function Ow(e,t){return Nw(e.toString(16).padStart(2*t,"0"))}function Lw(e,t){return Ow(e,t).reverse()}function Mw(e,t,n){let r;if("string"===typeof t)try{r=Nw(t)}catch(BJ){throw new Error("".concat(e,' must be valid hex string, got "').concat(t,'". Cause: ').concat(BJ))}else{if(!xw(t))throw new Error("".concat(e," must be hex string or Uint8Array"));r=Uint8Array.from(t)}const i=r.length;if("number"===typeof n&&i!==n)throw new Error("".concat(e," expected ").concat(n," bytes, got ").concat(i));return r}function Fw(){let e=0;for(let n=0;n<arguments.length;n++){const t=n<0||arguments.length<=n?void 0:arguments[n];_w(t),e+=t.length}const t=new Uint8Array(e);for(let n=0,r=0;n<arguments.length;n++){const e=n<0||arguments.length<=n?void 0:arguments[n];t.set(e,r),r+=e.length}return t}const Uw=e=>(Sw<<BigInt(e-1))-Aw,jw=e=>new Uint8Array(e),Hw=e=>Uint8Array.from(e);function zw(e,t,n){if("number"!==typeof e||e<2)throw new Error("hashLen must be a number");if("number"!==typeof t||t<2)throw new Error("qByteLen must be a number");if("function"!==typeof n)throw new Error("hmacFn must be a function");let r=jw(e),i=jw(e),o=0;const s=()=>{r.fill(1),i.fill(0),o=0},a=function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return n(i,r,...t)},c=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:jw();i=a(Hw([0]),e),r=a(),0!==e.length&&(i=a(Hw([1]),e),r=a())},l=()=>{if(o++>=1e3)throw new Error("drbg: tried 1000 values");let e=0;const n=[];for(;e<t;){r=a();const t=r.slice();n.push(t),e+=r.length}return Fw(...n)};return(e,t)=>{let n;for(s(),c(e);!(n=t(l()));)c();return s(),n}}const Vw={bigint:e=>"bigint"===typeof e,function:e=>"function"===typeof e,boolean:e=>"boolean"===typeof e,string:e=>"string"===typeof e,stringOrUint8Array:e=>"string"===typeof e||xw(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"===typeof e&&Number.isSafeInteger(e.outputLen)};function qw(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=(t,n,r)=>{const i=Vw[n];if("function"!==typeof i)throw new Error('Invalid validator "'.concat(n,'", expected function'));const o=e[t];if((!r||void 0!==o)&&!i(o,e))throw new Error("Invalid param ".concat(String(t),"=").concat(o," (").concat(typeof o,"), expected ").concat(n))};for(const[i,o]of Object.entries(t))r(i,o,!1);for(const[i,o]of Object.entries(n))r(i,o,!0);return e}const Gw=BigInt(0),Kw=BigInt(1),Ww=BigInt(2),Qw=BigInt(3),Yw=BigInt(4),Zw=BigInt(5),Jw=BigInt(8);BigInt(9),BigInt(16);function Xw(e,t){const n=e%t;return n>=Gw?n:t+n}function $w(e,t,n){if(n<=Gw||t<Gw)throw new Error("Expected power/modulo > 0");if(n===Kw)return Gw;let r=Kw;for(;t>Gw;)t&Kw&&(r=r*e%n),e=e*e%n,t>>=Kw;return r}function eb(e,t,n){let r=e;for(;t-- >Gw;)r*=r,r%=n;return r}function tb(e,t){if(e===Gw||t<=Gw)throw new Error("invert: expected positive integers, got n=".concat(e," mod=").concat(t));let n=Xw(e,t),r=t,i=Gw,o=Kw,s=Kw,a=Gw;for(;n!==Gw;){const e=r/n,t=r%n,c=i-s*e,l=o-a*e;r=n,n=t,i=s,o=a,s=c,a=l}if(r!==Kw)throw new Error("invert: does not exist");return Xw(i,t)}function nb(e){if(e%Yw===Qw){const t=(e+Kw)/Yw;return function(e,n){const r=e.pow(n,t);if(!e.eql(e.sqr(r),n))throw new Error("Cannot find square root");return r}}if(e%Jw===Zw){const t=(e-Zw)/Jw;return function(e,n){const r=e.mul(n,Ww),i=e.pow(r,t),o=e.mul(n,i),s=e.mul(e.mul(o,Ww),i),a=e.mul(o,e.sub(s,e.ONE));if(!e.eql(e.sqr(a),n))throw new Error("Cannot find square root");return a}}return function(e){const t=(e-Kw)/Ww;let n,r,i;for(n=e-Kw,r=0;n%Ww===Gw;n/=Ww,r++);for(i=Ww;i<e&&$w(i,t,e)!==e-Kw;i++);if(1===r){const t=(e+Kw)/Yw;return function(e,n){const r=e.pow(n,t);if(!e.eql(e.sqr(r),n))throw new Error("Cannot find square root");return r}}const o=(n+Kw)/Ww;return function(e,s){if(e.pow(s,t)===e.neg(e.ONE))throw new Error("Cannot find square root");let a=r,c=e.pow(e.mul(e.ONE,i),n),l=e.pow(s,o),u=e.pow(s,n);for(;!e.eql(u,e.ONE);){if(e.eql(u,e.ZERO))return e.ZERO;let t=1;for(let r=e.sqr(u);t<a&&!e.eql(r,e.ONE);t++)r=e.sqr(r);const n=e.pow(c,Kw<<BigInt(a-t-1));c=e.sqr(n),l=e.mul(l,n),u=e.mul(u,c),a=t}return l}}(e)}const rb=(e,t)=>(Xw(e,t)&Kw)===Kw,ib=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function ob(e,t){const n=void 0!==t?t:e.toString(2).length;return{nBitLength:n,nByteLength:Math.ceil(n/8)}}function sb(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(e<=Gw)throw new Error("Expected Field ORDER > 0, got ".concat(e));const{nBitLength:i,nByteLength:o}=ob(e,t);if(o>2048)throw new Error("Field lengths over 2048 bytes are not supported");const s=nb(e),a=Object.freeze({ORDER:e,BITS:i,BYTES:o,MASK:Uw(i),ZERO:Gw,ONE:Kw,create:t=>Xw(t,e),isValid:t=>{if("bigint"!==typeof t)throw new Error("Invalid field element: expected bigint, got ".concat(typeof t));return Gw<=t&&t<e},is0:e=>e===Gw,isOdd:e=>(e&Kw)===Kw,neg:t=>Xw(-t,e),eql:(e,t)=>e===t,sqr:t=>Xw(t*t,e),add:(t,n)=>Xw(t+n,e),sub:(t,n)=>Xw(t-n,e),mul:(t,n)=>Xw(t*n,e),pow:(e,t)=>function(e,t,n){if(n<Gw)throw new Error("Expected power > 0");if(n===Gw)return e.ONE;if(n===Kw)return t;let r=e.ONE,i=t;for(;n>Gw;)n&Kw&&(r=e.mul(r,i)),i=e.sqr(i),n>>=Kw;return r}(a,e,t),div:(t,n)=>Xw(t*tb(n,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>tb(t,e),sqrt:r.sqrt||(e=>s(a,e)),invertBatch:e=>function(e,t){const n=new Array(t.length),r=t.reduce(((t,r,i)=>e.is0(r)?t:(n[i]=t,e.mul(t,r))),e.ONE),i=e.inv(r);return t.reduceRight(((t,r,i)=>e.is0(r)?t:(n[i]=e.mul(t,n[i]),e.mul(t,r))),i),n}(a,e),cmov:(e,t,n)=>n?t:e,toBytes:e=>n?Lw(e,o):Ow(e,o),fromBytes:e=>{if(e.length!==o)throw new Error("Fp.fromBytes: expected ".concat(o,", got ").concat(e.length));return n?Dw(e):Bw(e)}});return Object.freeze(a)}function ab(e){if("bigint"!==typeof e)throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function cb(e){const t=ab(e);return t+Math.ceil(t/2)}const lb=BigInt(0),ub=BigInt(1);function db(e,t){const n=(e,t)=>{const n=t.negate();return e?n:t},r=e=>({windows:Math.ceil(t/e)+1,windowSize:2**(e-1)});return{constTimeNegate:n,unsafeLadder(t,n){let r=e.ZERO,i=t;for(;n>lb;)n&ub&&(r=r.add(i)),i=i.double(),n>>=ub;return r},precomputeWindow(e,t){const{windows:n,windowSize:i}=r(t),o=[];let s=e,a=s;for(let r=0;r<n;r++){a=s,o.push(a);for(let e=1;e<i;e++)a=a.add(s),o.push(a);s=a.double()}return o},wNAF(t,i,o){const{windows:s,windowSize:a}=r(t);let c=e.ZERO,l=e.BASE;const u=BigInt(2**t-1),d=2**t,h=BigInt(t);for(let e=0;e<s;e++){const t=e*a;let r=Number(o&u);o>>=h,r>a&&(r-=d,o+=ub);const s=t,f=t+Math.abs(r)-1,p=e%2!==0,g=r<0;0===r?l=l.add(n(p,i[s])):c=c.add(n(g,i[f]))}return{p:c,f:l}},wNAFCached(e,t,n,r){const i=e._WINDOW_SIZE||1;let o=t.get(e);return o||(o=this.precomputeWindow(e,i),1!==i&&t.set(e,r(o))),this.wNAF(i,o,n)}}}function hb(e){return function(e){const t=ib.reduce(((e,t)=>(e[t]="function",e)),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"});qw(e,t)}(e.Fp),qw(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...ob(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}const fb=BigInt(0),pb=BigInt(1),gb=BigInt(2),mb=BigInt(8),vb={zip215:!0};function yb(e){const t=function(e){const t=hb(e);return qw(e,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}(e),{Fp:n,n:r,prehash:i,hash:o,randomBytes:s,nByteLength:a,h:c}=t,l=gb<<BigInt(8*a)-pb,u=n.create,d=t.uvRatio||((e,t)=>{try{return{isValid:!0,value:n.sqrt(e*n.inv(t))}}catch(BJ){return{isValid:!1,value:fb}}}),h=t.adjustScalarBytes||(e=>e),f=t.domain||((e,t,n)=>{if(t.length||n)throw new Error("Contexts/pre-hash are not supported");return e}),p=e=>"bigint"===typeof e&&fb<e,g=(e,t)=>p(e)&&p(t)&&e<t,m=e=>e===fb||g(e,l);function v(e,t){if(g(e,t))return e;throw new Error("Expected valid scalar < ".concat(t,", got ").concat(typeof e," ").concat(e))}function y(e){return e===fb?e:v(e,r)}const w=new Map;function b(e){if(!(e instanceof E))throw new Error("ExtendedPoint expected")}class E{constructor(e,t,n,r){if(this.ex=e,this.ey=t,this.ez=n,this.et=r,!m(e))throw new Error("x required");if(!m(t))throw new Error("y required");if(!m(n))throw new Error("z required");if(!m(r))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(e){if(e instanceof E)throw new Error("extended point not allowed");const{x:t,y:n}=e||{};if(!m(t)||!m(n))throw new Error("invalid affine point");return new E(t,n,pb,u(t*n))}static normalizeZ(e){const t=n.invertBatch(e.map((e=>e.ez)));return e.map(((e,n)=>e.toAffine(t[n]))).map(E.fromAffine)}_setWindowSize(e){this._WINDOW_SIZE=e,w.delete(this)}assertValidity(){const{a:e,d:n}=t;if(this.is0())throw new Error("bad point: ZERO");const{ex:r,ey:i,ez:o,et:s}=this,a=u(r*r),c=u(i*i),l=u(o*o),d=u(l*l),h=u(a*e);if(u(l*u(h+c))!==u(d+u(n*u(a*c))))throw new Error("bad point: equation left != right (1)");if(u(r*i)!==u(o*s))throw new Error("bad point: equation left != right (2)")}equals(e){b(e);const{ex:t,ey:n,ez:r}=this,{ex:i,ey:o,ez:s}=e,a=u(t*s),c=u(i*r),l=u(n*s),d=u(o*r);return a===c&&l===d}is0(){return this.equals(E.ZERO)}negate(){return new E(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){const{a:e}=t,{ex:n,ey:r,ez:i}=this,o=u(n*n),s=u(r*r),a=u(gb*u(i*i)),c=u(e*o),l=n+r,d=u(u(l*l)-o-s),h=c+s,f=h-a,p=c-s,g=u(d*f),m=u(h*p),v=u(d*p),y=u(f*h);return new E(g,m,y,v)}add(e){b(e);const{a:n,d:r}=t,{ex:i,ey:o,ez:s,et:a}=this,{ex:c,ey:l,ez:d,et:h}=e;if(n===BigInt(-1)){const e=u((o-i)*(l+c)),t=u((o+i)*(l-c)),n=u(t-e);if(n===fb)return this.double();const r=u(s*gb*h),f=u(a*gb*d),p=f+r,g=t+e,m=f-r,v=u(p*n),y=u(g*m),w=u(p*m),b=u(n*g);return new E(v,y,b,w)}const f=u(i*c),p=u(o*l),g=u(a*r*h),m=u(s*d),v=u((i+o)*(c+l)-f-p),y=m-g,w=m+g,k=u(p-n*f),A=u(v*y),S=u(w*k),x=u(v*k),_=u(y*w);return new E(A,S,_,x)}subtract(e){return this.add(e.negate())}wNAF(e){return S.wNAFCached(this,w,e,E.normalizeZ)}multiply(e){const{p:t,f:n}=this.wNAF(v(e,r));return E.normalizeZ([t,n])[0]}multiplyUnsafe(e){let t=y(e);return t===fb?A:this.equals(A)||t===pb?this:this.equals(k)?this.wNAF(t).p:S.unsafeLadder(this,t)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return S.unsafeLadder(this,r).is0()}toAffine(e){const{ex:t,ey:r,ez:i}=this,o=this.is0();null==e&&(e=o?mb:n.inv(i));const s=u(t*e),a=u(r*e),c=u(i*e);if(o)return{x:fb,y:pb};if(c!==pb)throw new Error("invZ was invalid");return{x:s,y:a}}clearCofactor(){const{h:e}=t;return e===pb?this:this.multiplyUnsafe(e)}static fromHex(e){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{d:i,a:o}=t,s=n.BYTES,a=(e=Mw("pointHex",e,s)).slice(),c=e[s-1];a[s-1]=-129&c;const h=Dw(a);h===fb||v(h,r?l:n.ORDER);const f=u(h*h),p=u(f-pb),g=u(i*f-o);let{isValid:m,value:y}=d(p,g);if(!m)throw new Error("Point.fromHex: invalid y coordinate");const w=(y&pb)===pb,b=0!==(128&c);if(!r&&y===fb&&b)throw new Error("Point.fromHex: x=0 and x_0=1");return b!==w&&(y=u(-y)),E.fromAffine({x:y,y:h})}static fromPrivateKey(e){return I(e).point}toRawBytes(){const{x:e,y:t}=this.toAffine(),r=Lw(t,n.BYTES);return r[r.length-1]|=e&pb?128:0,r}toHex(){return Rw(this.toRawBytes())}}E.BASE=new E(t.Gx,t.Gy,pb,u(t.Gx*t.Gy)),E.ZERO=new E(fb,pb,pb,fb);const{BASE:k,ZERO:A}=E,S=db(E,8*a);function x(e){return Xw(e,r)}function _(e){return x(Dw(e))}function I(e){const t=a;e=Mw("private key",e,t);const n=Mw("hashed private key",o(e),2*t),r=h(n.slice(0,t)),i=n.slice(t,2*t),s=_(r),c=k.multiply(s),l=c.toRawBytes();return{head:r,prefix:i,scalar:s,point:c,pointBytes:l}}function R(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Uint8Array;for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const s=Fw(...n);return _(o(f(s,Mw("context",e),!!i)))}const C=vb;k._setWindowSize(8);const T={getExtendedPublicKey:I,randomPrivateKey:()=>s(n.BYTES),precompute(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:E.BASE;return t._setWindowSize(e),t.multiply(BigInt(3)),t}};return{CURVE:t,getPublicKey:function(e){return I(e).pointBytes},sign:function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e=Mw("message",e),i&&(e=i(e));const{prefix:o,scalar:s,pointBytes:c}=I(t),l=R(r.context,o,e),u=k.multiply(l).toRawBytes(),d=x(l+R(r.context,u,c,e)*s);return y(d),Mw("result",Fw(u,Lw(d,n.BYTES)),2*a)},verify:function(e,t,r){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:C;const{context:s,zip215:a}=o,c=n.BYTES;e=Mw("signature",e,2*c),t=Mw("message",t),i&&(t=i(t));const l=Dw(e.slice(c,2*c));let u,d,h;try{u=E.fromHex(r,a),d=E.fromHex(e.slice(0,c),a),h=k.multiplyUnsafe(l)}catch(p){return!1}if(!a&&u.isSmallOrder())return!1;const f=R(s,d.toRawBytes(),u.toRawBytes(),t);return d.add(u.multiplyUnsafe(f)).subtract(h).clearCofactor().equals(E.ZERO)},ExtendedPoint:E,utils:T}}const wb=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),bb=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),Eb=(BigInt(0),BigInt(1)),kb=BigInt(2),Ab=BigInt(5),Sb=BigInt(10),xb=BigInt(20),_b=BigInt(40),Ib=BigInt(80);function Rb(e){const t=wb,n=e*e%t*e%t,r=eb(n,kb,t)*n%t,i=eb(r,Eb,t)*e%t,o=eb(i,Ab,t)*i%t,s=eb(o,Sb,t)*o%t,a=eb(s,xb,t)*s%t,c=eb(a,_b,t)*a%t,l=eb(c,Ib,t)*c%t,u=eb(l,Ib,t)*c%t,d=eb(u,Sb,t)*o%t;return{pow_p_5_8:eb(d,kb,t)*e%t,b2:n}}function Cb(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function Tb(e,t){const n=wb,r=Xw(t*t*t,n),i=Xw(r*r*t,n);let o=Xw(e*r*Rb(e*i).pow_p_5_8,n);const s=Xw(t*o*o,n),a=o,c=Xw(o*bb,n),l=s===e,u=s===Xw(-e,n),d=s===Xw(-e*bb,n);return l&&(o=a),(u||d)&&(o=c),rb(o,n)&&(o=Xw(-o,n)),{isValid:l||u,value:o}}const Pb=sb(wb,void 0,!0),Nb={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Pb,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:ww,randomBytes:Pp,adjustScalarBytes:Cb,uvRatio:Tb},Bb=yb(Nb);function Db(e,t,n){if(t.length>255)throw new Error("Context is too big");return Ip(xp("SigEd25519 no Ed25519 collisions"),new Uint8Array([n?1:0,t.length]),t,e)}const Ob=(Pb.ORDER+BigInt(3))/BigInt(8);Pb.pow(kb,Ob),Pb.sqrt(Pb.neg(Pb.ONE)),Pb.ORDER,BigInt(5),BigInt(8),BigInt(486662);!function(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");const n=e.sqrt(t);e.isOdd(n)&&e.neg(n)}(Pb,Pb.neg(BigInt(486664)));BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");const Lb=32,Mb=64,Fb=32;function Ub(e,t){const n=new Uint8Array(Mb);for(let r=0;r<Fb;r++)n[r]=e[r],n[Fb+r]=t[r];return n}const jb={get(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:globalThis).crypto;if(null==e||null==e.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p/blob/main/packages/crypto/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}},Hb={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};function zb(e){var t,n,r,i,o,s;const a=null!==(t=null===e||void 0===e?void 0:e.algorithm)&&void 0!==t?t:"AES-GCM";let c=null!==(n=null===e||void 0===e?void 0:e.keyLength)&&void 0!==n?n:16;const l=null!==(r=null===e||void 0===e?void 0:e.nonceLength)&&void 0!==r?r:12,u=null!==(i=null===e||void 0===e?void 0:e.digest)&&void 0!==i?i:"SHA-256",d=null!==(o=null===e||void 0===e?void 0:e.saltLength)&&void 0!==o?o:16,h=null!==(s=null===e||void 0===e?void 0:e.iterations)&&void 0!==s?s:32767,f=jb.get();c*=8;return{encrypt:async function(e,t){const n=f.getRandomValues(new Uint8Array(d)),r=f.getRandomValues(new Uint8Array(l)),i={name:a,iv:r};let o;if("string"===typeof t&&(t=Fs(t)),0===t.length){o=await f.subtle.importKey("jwk",Hb,{name:"AES-GCM"},!0,["encrypt"]);try{const e={name:"PBKDF2",salt:n,iterations:h,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);o=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["encrypt"])}catch{o=await f.subtle.importKey("jwk",Hb,{name:"AES-GCM"},!0,["encrypt"])}}else{const e={name:"PBKDF2",salt:n,iterations:h,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);o=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["encrypt"])}const s=await f.subtle.encrypt(i,o,e);return Hr([n,i.iv,new Uint8Array(s)])},decrypt:async function(e,t){const n=e.subarray(0,d),r=e.subarray(d,d+l),i=e.subarray(d+l),o={name:a,iv:r};let s;if("string"===typeof t&&(t=Fs(t)),0===t.length)try{const e={name:"PBKDF2",salt:n,iterations:h,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);s=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["decrypt"])}catch{s=await f.subtle.importKey("jwk",Hb,{name:"AES-GCM"},!0,["decrypt"])}else{const e={name:"PBKDF2",salt:n,iterations:h,hash:{name:u}},r=await f.subtle.importKey("raw",t,{name:"PBKDF2"},!1,["deriveKey"]);s=await f.subtle.deriveKey(e,r,{name:a,length:c},!0,["decrypt"])}const p=await f.subtle.decrypt(o,s,i);return new Uint8Array(p)}}}async function Vb(e,t){const n=zb(),r=await n.encrypt(e,t);return us.encode(r)}var qb,Gb,Kb,Wb;!function(e){e.RSA="RSA",e.Ed25519="Ed25519",e.Secp256k1="Secp256k1"}(qb||(qb={})),function(e){e[e.RSA=0]="RSA",e[e.Ed25519=1]="Ed25519",e[e.Secp256k1=2]="Secp256k1"}(Gb||(Gb={})),function(e){e.codec=()=>ia(Gb)}(qb||(qb={})),function(e){let t;e.codec=()=>(null==t&&(t=oa((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),qb.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.Type=qb.codec().decode(e);break;case 2:n.Data=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>Xs(t,e.codec()),e.decode=t=>$o(t,e.codec())}(Kb||(Kb={})),function(e){let t;e.codec=()=>(null==t&&(t=oa((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),qb.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.Type=qb.codec().decode(e);break;case 2:n.Data=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>Xs(t,e.codec()),e.decode=t=>$o(t,e.codec())}(Wb||(Wb={}));class Qb{constructor(e){Dr(this,"_key",void 0),this._key=eE(e,Lb)}verify(e,t){return function(e,t,n){return Bb.verify(t,n instanceof Uint8Array?n:n.subarray(),e)}(this._key,t,e)}marshal(){return this._key}get bytes(){return Kb.encode({Type:qb.Ed25519,Data:this.marshal()}).subarray()}equals(e){return zr(this.bytes,e.bytes)}hash(){const e=Ps.digest(this.bytes);return kw(e)?e.then((e=>{let{bytes:t}=e;return t})):e.bytes}}class Yb{constructor(e,t){Dr(this,"_key",void 0),Dr(this,"_publicKey",void 0),this._key=eE(e,Mb),this._publicKey=eE(t,Lb)}sign(e){return function(e,t){const n=e.subarray(0,Fb);return Bb.sign(t instanceof Uint8Array?t:t.subarray(),n)}(this._key,e)}get public(){return new Qb(this._publicKey)}marshal(){return this._key}get bytes(){return Wb.encode({Type:qb.Ed25519,Data:this.marshal()}).subarray()}equals(e){return zr(this.bytes,e.bytes)}async hash(){const e=Ps.digest(this.bytes);let t;return kw(e)?({bytes:t}=await e):t=e.bytes,t}async id(){const e=Is.digest(this.public.bytes);return mi.encode(e.bytes).substring(1)}async export(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"libp2p-key";if("libp2p-key"===t)return Vb(this.bytes,e);throw new tf("export format '".concat(t,"' is not supported"),"ERR_INVALID_EXPORT_FORMAT")}}function Zb(e){if(e.length>Mb){const t=(e=eE(e,Mb+Lb)).subarray(0,Mb),n=e.subarray(Mb,e.length);return new Yb(t,n)}const t=(e=eE(e,Mb)).subarray(0,Mb),n=e.subarray(Lb);return new Yb(t,n)}function Jb(e){return e=eE(e,Lb),new Qb(e)}async function Xb(){const{privateKey:e,publicKey:t}=function(){const e=Bb.utils.randomPrivateKey(),t=Bb.getPublicKey(e);return{privateKey:Ub(e,t),publicKey:t}}();return new Yb(e,t)}async function $b(e){const{privateKey:t,publicKey:n}=function(e){if(e.length!==Fb)throw new TypeError('"seed" must be 32 bytes in length.');if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');const t=e,n=Bb.getPublicKey(t);return{privateKey:Ub(t,n),publicKey:n}}(e);return new Yb(t,n)}function eE(e,t){var n;if((e=Uint8Array.from(null!==(n=e)&&void 0!==n?n:[])).length!==t)throw new tf("Key must be a Uint8Array of length ".concat(t,", got ").concat(e.length),"ERR_INVALID_KEY_TYPE");return e}async function tE(e){const t=[await jb.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await rE(e)],n=await nE({privateKey:t[0],publicKey:t[1]});return{privateKey:n[0],publicKey:n[1]}}async function nE(e){if(null==e.privateKey||null==e.publicKey)throw new tf("Private and public key are required","ERR_INVALID_PARAMETERS");return Promise.all([jb.get().subtle.exportKey("jwk",e.privateKey),jb.get().subtle.exportKey("jwk",e.publicKey)])}async function rE(e){return jb.get().subtle.importKey("jwk",{kty:e.kty,n:e.n,e:e.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function iE(e){if("RSA"!==e.kty)throw new tf("invalid key type","ERR_INVALID_KEY_TYPE");if(null==e.n)throw new tf("invalid key modulus","ERR_INVALID_KEY_MODULUS");return 8*Fs(e.n,"base64url").length}var oE=n(8275);function sE(e,t){let n=0;if(1===e.length)return e[0];for(let r=e.length-1;r>=0;r--)n+=e[e.length-1-r]*Math.pow(2,t*r);return n}function aE(e,t){const n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;let r=e,i=0,o=Math.pow(2,t);for(let s=1;s<8;s++){if(e<o){let e;if(n<0)e=new ArrayBuffer(s),i=s;else{if(n<s)return new ArrayBuffer(0);e=new ArrayBuffer(n),i=n}const o=new Uint8Array(e);for(let n=s-1;n>=0;n--){const e=Math.pow(2,n*t);o[i-n-1]=Math.floor(r/e),r-=o[i-n-1]*e}return e}o*=Math.pow(2,t)}return new ArrayBuffer(0)}function cE(){let e=0,t=0;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];for(const a of r)e+=a.length;const o=new ArrayBuffer(e),s=new Uint8Array(o);for(const a of r)s.set(a,t),t+=a.length;return s}function lE(){const e=new Uint8Array(this.valueHex);if(this.valueHex.byteLength>=2){const t=255===e[0]&&128&e[1],n=0===e[0]&&0===(128&e[1]);(t||n)&&this.warnings.push("Needlessly long format")}const t=new ArrayBuffer(this.valueHex.byteLength),n=new Uint8Array(t);for(let s=0;s<this.valueHex.byteLength;s++)n[s]=0;n[0]=128&e[0];const r=sE(n,8),i=new ArrayBuffer(this.valueHex.byteLength),o=new Uint8Array(i);for(let s=0;s<this.valueHex.byteLength;s++)o[s]=e[s];o[0]&=127;return sE(o,8)-r}function uE(e,t){const n=e.toString(10);if(t<n.length)return"";const r=t-n.length,i=new Array(r);for(let o=0;o<r;o++)i[o]="0";return i.join("").concat(n)}Math.log(2);function dE(){if("undefined"===typeof BigInt)throw new Error("BigInt is not defined. Your environment doesn't implement BigInt.")}function hE(e){let t=0,n=0;for(let i=0;i<e.length;i++){t+=e[i].byteLength}const r=new Uint8Array(t);for(let i=0;i<e.length;i++){const t=e[i];r.set(new Uint8Array(t),n),n+=t.byteLength}return r.buffer}function fE(e,t,n,r){return t instanceof Uint8Array?t.byteLength?n<0?(e.error="Wrong parameter: inputOffset less than zero",!1):r<0?(e.error="Wrong parameter: inputLength less than zero",!1):!(t.byteLength-n-r<0)||(e.error="End of input reached before message was fully decoded (inconsistent offset and length values)",!1):(e.error="Wrong parameter: inputBuffer has zero length",!1):(e.error="Wrong parameter: inputBuffer must be 'Uint8Array'",!1)}class pE{constructor(){this.items=[]}write(e){this.items.push(e)}final(){return hE(this.items)}}const gE=[new Uint8Array([1])],mE="0123456789",vE="",yE=new ArrayBuffer(0),wE=new Uint8Array(0),bE="EndOfContent",EE="OCTET STRING",kE="BIT STRING";function AE(e){var t;return t=class extends e{constructor(){var e;super(...arguments);const t=(arguments.length<=0?void 0:arguments[0])||{};this.isHexOnly=null!==(e=t.isHexOnly)&&void 0!==e&&e,this.valueHexView=t.valueHex?oE._H.toUint8Array(t.valueHex):wE}get valueHex(){return this.valueHexView.slice().buffer}set valueHex(e){this.valueHexView=new Uint8Array(e)}fromBER(e,t,n){const r=e instanceof ArrayBuffer?new Uint8Array(e):e;if(!fE(this,r,t,n))return-1;const i=t+n;return this.valueHexView=r.subarray(t,i),this.valueHexView.length?(this.blockLength=n,i):(this.warnings.push("Zero buffer length"),t)}toBER(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.isHexOnly?e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.byteLength===this.valueHexView.buffer.byteLength?this.valueHexView.buffer:this.valueHexView.slice().buffer:(this.error="Flag 'isHexOnly' is not set, abort",yE)}toJSON(){return{...super.toJSON(),isHexOnly:this.isHexOnly,valueHex:oE.U$.ToHex(this.valueHexView)}}},t.NAME="hexBlock",t}class SE{constructor(){let{blockLength:e=0,error:t=vE,warnings:n=[],valueBeforeDecode:r=wE}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.blockLength=e,this.error=t,this.warnings=n,this.valueBeforeDecodeView=oE._H.toUint8Array(r)}static blockName(){return this.NAME}get valueBeforeDecode(){return this.valueBeforeDecodeView.slice().buffer}set valueBeforeDecode(e){this.valueBeforeDecodeView=new Uint8Array(e)}toJSON(){return{blockName:this.constructor.NAME,blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:oE.U$.ToHex(this.valueBeforeDecodeView)}}}SE.NAME="baseBlock";class xE extends SE{fromBER(e,t,n){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}toBER(e,t){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}}xE.NAME="valueBlock";class _E extends(AE(SE)){constructor(){let{idBlock:e={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t,n,r,i;super(),e?(this.isHexOnly=null!==(t=e.isHexOnly)&&void 0!==t&&t,this.valueHexView=e.valueHex?oE._H.toUint8Array(e.valueHex):wE,this.tagClass=null!==(n=e.tagClass)&&void 0!==n?n:-1,this.tagNumber=null!==(r=e.tagNumber)&&void 0!==r?r:-1,this.isConstructed=null!==(i=e.isConstructed)&&void 0!==i&&i):(this.tagClass=-1,this.tagNumber=-1,this.isConstructed=!1)}toBER(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0;switch(this.tagClass){case 1:t|=0;break;case 2:t|=64;break;case 3:t|=128;break;case 4:t|=192;break;default:return this.error="Unknown tag class",yE}if(this.isConstructed&&(t|=32),this.tagNumber<31&&!this.isHexOnly){const n=new Uint8Array(1);if(!e){let e=this.tagNumber;e&=31,t|=e,n[0]=t}return n.buffer}if(!this.isHexOnly){const n=aE(this.tagNumber,7),r=new Uint8Array(n),i=n.byteLength,o=new Uint8Array(i+1);if(o[0]=31|t,!e){for(let e=0;e<i-1;e++)o[e+1]=128|r[e];o[i]=r[i-1]}return o.buffer}const n=new Uint8Array(this.valueHexView.byteLength+1);if(n[0]=31|t,!e){const e=this.valueHexView;for(let t=0;t<e.length-1;t++)n[t+1]=128|e[t];n[this.valueHexView.byteLength]=e[e.length-1]}return n.buffer}fromBER(e,t,n){const r=oE._H.toUint8Array(e);if(!fE(this,r,t,n))return-1;const i=r.subarray(t,t+n);if(0===i.length)return this.error="Zero buffer length",-1;switch(192&i[0]){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=32===(32&i[0]),this.isHexOnly=!1;const o=31&i[0];if(31!==o)this.tagNumber=o,this.blockLength=1;else{let e=1,t=this.valueHexView=new Uint8Array(255),n=255;for(;128&i[e];){if(t[e-1]=127&i[e],e++,e>=i.length)return this.error="End of input reached before message was fully decoded",-1;if(e===n){n+=255;const e=new Uint8Array(n);for(let n=0;n<t.length;n++)e[n]=t[n];t=this.valueHexView=new Uint8Array(n)}}this.blockLength=e+1,t[e-1]=127&i[e];const r=new Uint8Array(e);for(let i=0;i<e;i++)r[i]=t[i];t=this.valueHexView=new Uint8Array(e),t.set(r),this.blockLength<=9?this.tagNumber=sE(t,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(1===this.tagClass&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return t+this.blockLength}toJSON(){return{...super.toJSON(),tagClass:this.tagClass,tagNumber:this.tagNumber,isConstructed:this.isConstructed}}}_E.NAME="identificationBlock";class IE extends SE{constructor(){let{lenBlock:e={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t,n,r;super(),this.isIndefiniteForm=null!==(t=e.isIndefiniteForm)&&void 0!==t&&t,this.longFormUsed=null!==(n=e.longFormUsed)&&void 0!==n&&n,this.length=null!==(r=e.length)&&void 0!==r?r:0}fromBER(e,t,n){const r=oE._H.toUint8Array(e);if(!fE(this,r,t,n))return-1;const i=r.subarray(t,t+n);if(0===i.length)return this.error="Zero buffer length",-1;if(255===i[0])return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=128===i[0],this.isIndefiniteForm)return this.blockLength=1,t+this.blockLength;if(this.longFormUsed=!!(128&i[0]),!1===this.longFormUsed)return this.length=i[0],this.blockLength=1,t+this.blockLength;const o=127&i[0];if(o>8)return this.error="Too big integer",-1;if(o+1>i.length)return this.error="End of input reached before message was fully decoded",-1;const s=t+1,a=r.subarray(s,s+o);return 0===a[o-1]&&this.warnings.push("Needlessly long encoded length"),this.length=sE(a,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unnecessary usage of long length form"),this.blockLength=o+1,t+this.blockLength}toBER(){let e,t,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return e=new ArrayBuffer(1),!1===n&&(t=new Uint8Array(e),t[0]=128),e;if(this.longFormUsed){const r=aE(this.length,8);if(r.byteLength>127)return this.error="Too big length",yE;if(e=new ArrayBuffer(r.byteLength+1),n)return e;const i=new Uint8Array(r);t=new Uint8Array(e),t[0]=128|r.byteLength;for(let e=0;e<r.byteLength;e++)t[e+1]=i[e];return e}return e=new ArrayBuffer(1),!1===n&&(t=new Uint8Array(e),t[0]=this.length),e}toJSON(){return{...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,longFormUsed:this.longFormUsed,length:this.length}}}IE.NAME="lengthBlock";const RE={};class CE extends SE{constructor(){let{name:e=vE,optional:t=!1,primitiveSchema:n,...r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;super(r),this.name=e,this.optional=t,n&&(this.primitiveSchema=n),this.idBlock=new _E(r),this.lenBlock=new IE(r),this.valueBlock=i?new i(r):new xE(r)}fromBER(e,t,n){const r=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?n:this.lenBlock.length);return-1===r?(this.error=this.valueBlock.error,r):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),r)}toBER(e,t){const n=t||new pE;t||TE(this);const r=this.idBlock.toBER(e);if(n.write(r),this.lenBlock.isIndefiniteForm)n.write(new Uint8Array([128]).buffer),this.valueBlock.toBER(e,n),n.write(new ArrayBuffer(2));else{const t=this.valueBlock.toBER(e);this.lenBlock.length=t.byteLength;const r=this.lenBlock.toBER(e);n.write(r),n.write(t)}return t?yE:n.final()}toJSON(){const e={...super.toJSON(),idBlock:this.idBlock.toJSON(),lenBlock:this.lenBlock.toJSON(),valueBlock:this.valueBlock.toJSON(),name:this.name,optional:this.optional};return this.primitiveSchema&&(e.primitiveSchema=this.primitiveSchema.toJSON()),e}toString(){return"ascii"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ascii")?this.onAsciiEncoding():oE.U$.ToHex(this.toBER())}onAsciiEncoding(){return"".concat(this.constructor.NAME," : ").concat(oE.U$.ToHex(this.valueBlock.valueBeforeDecodeView))}isEqual(e){if(this===e)return!0;if(!(e instanceof this.constructor))return!1;return function(e,t){if(e.byteLength!==t.byteLength)return!1;const n=new Uint8Array(e),r=new Uint8Array(t);for(let i=0;i<n.length;i++)if(n[i]!==r[i])return!1;return!0}(this.toBER(),e.toBER())}}function TE(e){if(e instanceof RE.Constructed)for(const t of e.valueBlock.value)TE(t)&&(e.lenBlock.isIndefiniteForm=!0);return!!e.lenBlock.isIndefiniteForm}CE.NAME="BaseBlock";class PE extends CE{constructor(){let{value:e=vE,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(t,arguments.length>1?arguments[1]:void 0),e&&this.fromString(e)}getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}fromBER(e,t,n){const r=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?n:this.lenBlock.length);return-1===r?(this.error=this.valueBlock.error,r):(this.fromBuffer(this.valueBlock.valueHexView),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),r)}onAsciiEncoding(){return"".concat(this.constructor.NAME," : '").concat(this.valueBlock.value,"'")}}PE.NAME="BaseStringBlock";class NE extends(AE(xE)){constructor(){let{isHexOnly:e=!0,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(t),this.isHexOnly=e}}var BE,DE,OE,LE,ME,FE,UE,jE,HE,zE,VE,qE,GE,KE,WE,QE,YE,ZE,JE,XE,$E,ek,tk,nk,rk,ik,ok,sk,ak,ck,lk,uk,dk;NE.NAME="PrimitiveValueBlock";class hk extends CE{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},NE),this.idBlock.isConstructed=!1}}function fk(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length;const r=t;let i=new CE({},xE);const o=new SE;if(!fE(o,e,t,n))return i.error=o.error,{offset:-1,result:i};if(!e.subarray(t,t+n).length)return i.error="Zero buffer length",{offset:-1,result:i};let s=i.idBlock.fromBER(e,t,n);if(i.idBlock.warnings.length&&i.warnings.concat(i.idBlock.warnings),-1===s)return i.error=i.idBlock.error,{offset:-1,result:i};if(t=s,n-=i.idBlock.blockLength,s=i.lenBlock.fromBER(e,t,n),i.lenBlock.warnings.length&&i.warnings.concat(i.lenBlock.warnings),-1===s)return i.error=i.lenBlock.error,{offset:-1,result:i};if(t=s,n-=i.lenBlock.blockLength,!i.idBlock.isConstructed&&i.lenBlock.isIndefiniteForm)return i.error="Indefinite length form used for primitive encoding form",{offset:-1,result:i};let a=CE;if(1===i.idBlock.tagClass){if(i.idBlock.tagNumber>=37&&!1===i.idBlock.isHexOnly)return i.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:i};switch(i.idBlock.tagNumber){case 0:if(i.idBlock.isConstructed&&i.lenBlock.length>0)return i.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:i};a=RE.EndOfContent;break;case 1:a=RE.Boolean;break;case 2:a=RE.Integer;break;case 3:a=RE.BitString;break;case 4:a=RE.OctetString;break;case 5:a=RE.Null;break;case 6:a=RE.ObjectIdentifier;break;case 10:a=RE.Enumerated;break;case 12:a=RE.Utf8String;break;case 13:a=RE.RelativeObjectIdentifier;break;case 14:a=RE.TIME;break;case 15:return i.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:i};case 16:a=RE.Sequence;break;case 17:a=RE.Set;break;case 18:a=RE.NumericString;break;case 19:a=RE.PrintableString;break;case 20:a=RE.TeletexString;break;case 21:a=RE.VideotexString;break;case 22:a=RE.IA5String;break;case 23:a=RE.UTCTime;break;case 24:a=RE.GeneralizedTime;break;case 25:a=RE.GraphicString;break;case 26:a=RE.VisibleString;break;case 27:a=RE.GeneralString;break;case 28:a=RE.UniversalString;break;case 29:a=RE.CharacterString;break;case 30:a=RE.BmpString;break;case 31:a=RE.DATE;break;case 32:a=RE.TimeOfDay;break;case 33:a=RE.DateTime;break;case 34:a=RE.Duration;break;default:{const e=i.idBlock.isConstructed?new RE.Constructed:new RE.Primitive;e.idBlock=i.idBlock,e.lenBlock=i.lenBlock,e.warnings=i.warnings,i=e}}}else a=i.idBlock.isConstructed?RE.Constructed:RE.Primitive;return i=function(e,t){if(e instanceof t)return e;const n=new t;return n.idBlock=e.idBlock,n.lenBlock=e.lenBlock,n.warnings=e.warnings,n.valueBeforeDecodeView=e.valueBeforeDecodeView,n}(i,a),s=i.fromBER(e,t,i.lenBlock.isIndefiniteForm?n:i.lenBlock.length),i.valueBeforeDecodeView=e.subarray(r,r+i.blockLength),{offset:s,result:i}}function pk(e){if(!e.byteLength){const e=new CE({},xE);return e.error="Input buffer has zero length",{offset:-1,result:e}}return fk(oE._H.toUint8Array(e).slice(),0,e.byteLength)}BE=hk,RE.Primitive=BE,hk.NAME="PRIMITIVE";class gk extends xE{constructor(){let{value:e=[],isIndefiniteForm:t=!1,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(n),this.value=e,this.isIndefiniteForm=t}fromBER(e,t,n){const r=oE._H.toUint8Array(e);if(!fE(this,r,t,n))return-1;if(this.valueBeforeDecodeView=r.subarray(t,t+n),0===this.valueBeforeDecodeView.length)return this.warnings.push("Zero buffer length"),t;let i=t;for(;o=this.isIndefiniteForm,s=n,(o?1:s)>0;){const e=fk(r,i,n);if(-1===e.offset)return this.error=e.result.error,this.warnings.concat(e.result.warnings),-1;if(i=e.offset,this.blockLength+=e.result.blockLength,n-=e.result.blockLength,this.value.push(e.result),this.isIndefiniteForm&&e.result.constructor.NAME===bE)break}var o,s;return this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.NAME===bE?this.value.pop():this.warnings.push("No EndOfContent block encoded")),i}toBER(e,t){const n=t||new pE;for(let r=0;r<this.value.length;r++)this.value[r].toBER(e,n);return t?yE:n.final()}toJSON(){const e={...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,value:[]};for(const t of this.value)e.value.push(t.toJSON());return e}}gk.NAME="ConstructedValueBlock";class mk extends CE{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},gk),this.idBlock.isConstructed=!0}fromBER(e,t,n){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;const r=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?n:this.lenBlock.length);return-1===r?(this.error=this.valueBlock.error,r):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),r)}onAsciiEncoding(){const e=[];for(const n of this.valueBlock.value)e.push(n.toString("ascii").split("\n").map((e=>"  ".concat(e))).join("\n"));const t=3===this.idBlock.tagClass?"[".concat(this.idBlock.tagNumber,"]"):this.constructor.NAME;return e.length?"".concat(t," :\n").concat(e.join("\n")):"".concat(t," :")}}DE=mk,RE.Constructed=DE,mk.NAME="CONSTRUCTED";class vk extends xE{fromBER(e,t,n){return t}toBER(e){return yE}}vk.override="EndOfContentValueBlock";class yk extends CE{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},vk),this.idBlock.tagClass=1,this.idBlock.tagNumber=0}}OE=yk,RE.EndOfContent=OE,yk.NAME=bE;class wk extends CE{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},xE),this.idBlock.tagClass=1,this.idBlock.tagNumber=5}fromBER(e,t,n){return this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=n,t+n>e.byteLength?(this.error="End of input reached before message was fully decoded (inconsistent offset and length values)",-1):t+n}toBER(e,t){const n=new ArrayBuffer(2);if(!e){const e=new Uint8Array(n);e[0]=5,e[1]=0}return t&&t.write(n),n}onAsciiEncoding(){return"".concat(this.constructor.NAME)}}LE=wk,RE.Null=LE,wk.NAME="NULL";class bk extends(AE(xE)){constructor(){let{value:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(t),t.valueHex?this.valueHexView=oE._H.toUint8Array(t.valueHex):this.valueHexView=new Uint8Array(1),e&&(this.value=e)}get value(){for(const e of this.valueHexView)if(e>0)return!0;return!1}set value(e){this.valueHexView[0]=e?255:0}fromBER(e,t,n){const r=oE._H.toUint8Array(e);return fE(this,r,t,n)?(this.valueHexView=r.subarray(t,t+n),n>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.isHexOnly=!0,lE.call(this),this.blockLength=n,t+n):-1}toBER(){return this.valueHexView.slice()}toJSON(){return{...super.toJSON(),value:this.value}}}bk.NAME="BooleanValueBlock";class Ek extends CE{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},bk),this.idBlock.tagClass=1,this.idBlock.tagNumber=1}getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}onAsciiEncoding(){return"".concat(this.constructor.NAME," : ").concat(this.getValue)}}ME=Ek,RE.Boolean=ME,Ek.NAME="BOOLEAN";class kk extends(AE(gk)){constructor(){let{isConstructed:e=!1,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(t),this.isConstructed=e}fromBER(e,t,n){let r=0;if(this.isConstructed){if(this.isHexOnly=!1,r=gk.prototype.fromBER.call(this,e,t,n),-1===r)return r;for(let e=0;e<this.value.length;e++){const t=this.value[e].constructor.NAME;if(t===bE){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1}if(t!==EE)return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,r=super.fromBER(e,t,n),this.blockLength=n;return r}toBER(e,t){return this.isConstructed?gk.prototype.toBER.call(this,e,t):e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),isConstructed:this.isConstructed}}}kk.NAME="OctetStringValueBlock";class Ak extends CE{constructor(){let{idBlock:e={},lenBlock:t={},...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var r,i;null!==(r=n.isConstructed)&&void 0!==r||(n.isConstructed=!!(null===(i=n.value)||void 0===i?void 0:i.length)),super({idBlock:{isConstructed:n.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!n.isIndefiniteForm},...n},kk),this.idBlock.tagClass=1,this.idBlock.tagNumber=4}fromBER(e,t,n){if(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,0===n)return 0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),t;if(!this.valueBlock.isConstructed){const r=(e instanceof ArrayBuffer?new Uint8Array(e):e).subarray(t,t+n);try{if(r.byteLength){const e=fk(r,0,r.byteLength);-1!==e.offset&&e.offset===n&&(this.valueBlock.value=[e.result])}}catch(BJ){}}return super.fromBER(e,t,n)}onAsciiEncoding(){return this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length?mk.prototype.onAsciiEncoding.call(this):"".concat(this.constructor.NAME," : ").concat(oE.U$.ToHex(this.valueBlock.valueHexView))}getValue(){if(!this.idBlock.isConstructed)return this.valueBlock.valueHexView.slice().buffer;const e=[];for(const t of this.valueBlock.value)t instanceof Ak&&e.push(t.valueBlock.valueHexView);return oE._H.concat(e)}}FE=Ak,RE.OctetString=FE,Ak.NAME=EE;class Sk extends(AE(gk)){constructor(){let{unusedBits:e=0,isConstructed:t=!1,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(n),this.unusedBits=e,this.isConstructed=t,this.blockLength=this.valueHexView.byteLength}fromBER(e,t,n){if(!n)return t;let r=-1;if(this.isConstructed){if(r=gk.prototype.fromBER.call(this,e,t,n),-1===r)return r;for(const e of this.value){const t=e.constructor.NAME;if(t===bE){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1}if(t!==kE)return this.error="BIT STRING may consists of BIT STRINGs only",-1;const n=e.valueBlock;if(this.unusedBits>0&&n.unusedBits>0)return this.error='Using of "unused bits" inside constructive BIT STRING allowed for least one only',-1;this.unusedBits=n.unusedBits}return r}const i=oE._H.toUint8Array(e);if(!fE(this,i,t,n))return-1;const o=i.subarray(t,t+n);if(this.unusedBits=o[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;if(!this.unusedBits){const e=o.subarray(1);try{if(e.byteLength){const t=fk(e,0,e.byteLength);-1!==t.offset&&t.offset===n-1&&(this.value=[t.result])}}catch(BJ){}}return this.valueHexView=o.subarray(1),this.blockLength=o.length,t+n}toBER(e,t){if(this.isConstructed)return gk.prototype.toBER.call(this,e,t);if(e)return new ArrayBuffer(this.valueHexView.byteLength+1);if(!this.valueHexView.byteLength)return yE;const n=new Uint8Array(this.valueHexView.length+1);return n[0]=this.unusedBits,n.set(this.valueHexView,1),n.buffer}toJSON(){return{...super.toJSON(),unusedBits:this.unusedBits,isConstructed:this.isConstructed}}}Sk.NAME="BitStringValueBlock";class xk extends CE{constructor(){let{idBlock:e={},lenBlock:t={},...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var r,i;null!==(r=n.isConstructed)&&void 0!==r||(n.isConstructed=!!(null===(i=n.value)||void 0===i?void 0:i.length)),super({idBlock:{isConstructed:n.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!n.isIndefiniteForm},...n},Sk),this.idBlock.tagClass=1,this.idBlock.tagNumber=3}fromBER(e,t,n){return this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,super.fromBER(e,t,n)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return mk.prototype.onAsciiEncoding.call(this);{const e=[],t=this.valueBlock.valueHexView;for(const r of t)e.push(r.toString(2).padStart(8,"0"));const n=e.join("");return"".concat(this.constructor.NAME," : ").concat(n.substring(0,n.length-this.valueBlock.unusedBits))}}}function _k(e,t){const n=new Uint8Array([0]),r=new Uint8Array(e),i=new Uint8Array(t);let o=r.slice(0);const s=o.length-1,a=i.slice(0),c=a.length-1;let l=0;let u=0;for(let d=c<s?s:c;d>=0;d--,u++){if(!0===u<a.length)l=o[s-u]+a[c-u]+n[0];else l=o[s-u]+n[0];if(n[0]=l/10,!0===u>=o.length)o=cE(new Uint8Array([l%10]),o);else o[s-u]=l%10}return n[0]>0&&(o=cE(n,o)),o}function Ik(e){if(e>=gE.length)for(let t=gE.length;t<=e;t++){const e=new Uint8Array([0]);let n=gE[t-1].slice(0);for(let t=n.length-1;t>=0;t--){const r=new Uint8Array([(n[t]<<1)+e[0]]);e[0]=r[0]/10,n[t]=r[0]%10}e[0]>0&&(n=cE(e,n)),gE.push(n)}return gE[e]}function Rk(e,t){let n=0;const r=new Uint8Array(e),i=new Uint8Array(t),o=r.slice(0),s=o.length-1,a=i.slice(0),c=a.length-1;let l,u=0;for(let d=c;d>=0;d--,u++)if(l=o[s-u]-a[c-u]-n,!0===l<0)n=1,o[s-u]=l+10;else n=0,o[s-u]=l;if(n>0)for(let d=s-c+1;d>=0;d--,u++){if(l=o[s-u]-n,!(l<0)){n=0,o[s-u]=l;break}n=1,o[s-u]=l+10}return o.slice()}UE=xk,RE.BitString=UE,xk.NAME=kE;class Ck extends(AE(xE)){constructor(){let{value:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(t),this._valueDec=0,t.valueHex&&this.setValueHex(),void 0!==e&&(this.valueDec=e)}setValueHex(){this.valueHexView.length>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,this.valueHexView.length>0&&(this._valueDec=lE.call(this)))}set valueDec(e){this._valueDec=e,this.isHexOnly=!1,this.valueHexView=new Uint8Array(function(e){const t=e<0?-1*e:e;let n=128;for(let r=1;r<8;r++){if(t<=n){if(e<0){const e=aE(n-t,8,r);return new Uint8Array(e)[0]|=128,e}let i=aE(t,8,r),o=new Uint8Array(i);if(128&o[0]){const e=i.slice(0),t=new Uint8Array(e);i=new ArrayBuffer(i.byteLength+1),o=new Uint8Array(i);for(let n=0;n<e.byteLength;n++)o[n+1]=t[n];o[0]=0}return i}n*=Math.pow(2,8)}return new ArrayBuffer(0)}(e))}get valueDec(){return this._valueDec}fromDER(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const i=this.fromBER(e,t,n);if(-1===i)return i;const o=this.valueHexView;return 0===o[0]&&0!==(128&o[1])?this.valueHexView=o.subarray(1):0!==r&&o.length<r&&(r-o.length>1&&(r=o.length+1),this.valueHexView=o.subarray(r-o.length)),i}toDER(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.valueHexView;switch(!0){case 0!==(128&t[0]):{const e=new Uint8Array(this.valueHexView.length+1);e[0]=0,e.set(t,1),this.valueHexView=e}break;case 0===t[0]&&0===(128&t[1]):this.valueHexView=this.valueHexView.subarray(1)}return this.toBER(e)}fromBER(e,t,n){const r=super.fromBER(e,t,n);return-1===r||this.setValueHex(),r}toBER(e){return e?new ArrayBuffer(this.valueHexView.length):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}toString(){const e=8*this.valueHexView.length-1;let t,n=new Uint8Array(8*this.valueHexView.length/3),r=0;const i=this.valueHexView;let o="",s=!1;for(let a=i.byteLength-1;a>=0;a--){t=i[a];for(let i=0;i<8;i++){if(1===(1&t))if(r===e)n=Rk(Ik(r),n),o="-";else n=_k(n,Ik(r));r++,t>>=1}}for(let a=0;a<n.length;a++)n[a]&&(s=!0),s&&(o+=mE.charAt(n[a]));return!1===s&&(o+=mE.charAt(0)),o}}jE=Ck,Ck.NAME="IntegerValueBlock",Object.defineProperty(jE.prototype,"valueHex",{set:function(e){this.valueHexView=new Uint8Array(e),this.setValueHex()},get:function(){return this.valueHexView.slice().buffer}});class Tk extends CE{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},Ck),this.idBlock.tagClass=1,this.idBlock.tagNumber=2}toBigInt(){return dE(),BigInt(this.valueBlock.toString())}static fromBigInt(e){dE();const t=BigInt(e),n=new pE,r=t.toString(16).replace(/^-/,""),i=new Uint8Array(oE.U$.FromHex(r));if(t<0){const e=new Uint8Array(i.length+(128&i[0]?1:0));e[0]|=128;const r=BigInt("0x".concat(oE.U$.ToHex(e)))+t,o=oE._H.toUint8Array(oE.U$.FromHex(r.toString(16)));o[0]|=128,n.write(o)}else 128&i[0]&&n.write(new Uint8Array([0])),n.write(i);return new Tk({valueHex:n.final()})}convertToDER(){const e=new Tk({valueHex:this.valueBlock.valueHexView});return e.valueBlock.toDER(),e}convertFromDER(){return new Tk({valueHex:0===this.valueBlock.valueHexView[0]?this.valueBlock.valueHexView.subarray(1):this.valueBlock.valueHexView})}onAsciiEncoding(){return"".concat(this.constructor.NAME," : ").concat(this.valueBlock.toString())}}HE=Tk,RE.Integer=HE,Tk.NAME="INTEGER";class Pk extends Tk{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this.idBlock.tagClass=1,this.idBlock.tagNumber=10}}zE=Pk,RE.Enumerated=zE,Pk.NAME="ENUMERATED";class Nk extends(AE(xE)){constructor(){let{valueDec:e=-1,isFirstSid:t=!1,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(n),this.valueDec=e,this.isFirstSid=t}fromBER(e,t,n){if(!n)return t;const r=oE._H.toUint8Array(e);if(!fE(this,r,t,n))return-1;const i=r.subarray(t,t+n);this.valueHexView=new Uint8Array(n);for(let s=0;s<n&&(this.valueHexView[s]=127&i[s],this.blockLength++,0!==(128&i[s]));s++);const o=new Uint8Array(this.blockLength);for(let s=0;s<this.blockLength;s++)o[s]=this.valueHexView[s];return this.valueHexView=o,0!==(128&i[this.blockLength-1])?(this.error="End of input reached before message was fully decoded",-1):(0===this.valueHexView[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=sE(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}set valueBigInt(e){dE();let t=BigInt(e).toString(2);for(;t.length%7;)t="0"+t;const n=new Uint8Array(t.length/7);for(let r=0;r<n.length;r++)n[r]=parseInt(t.slice(7*r,7*r+7),2)+(r+1<n.length?128:0);this.fromBER(n.buffer,0,n.length)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);const t=this.valueHexView,n=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength-1;e++)n[e]=128|t[e];return n[this.blockLength-1]=t[this.blockLength-1],n.buffer}const t=aE(this.valueDec,7);if(0===t.byteLength)return this.error="Error during encoding SID value",yE;const n=new Uint8Array(t.byteLength);if(!e){const e=new Uint8Array(t),r=t.byteLength-1;for(let t=0;t<r;t++)n[t]=128|e[t];n[r]=e[r]}return n}toString(){let e="";if(this.isHexOnly)e=oE.U$.ToHex(this.valueHexView);else if(this.isFirstSid){let t=this.valueDec;this.valueDec<=39?e="0.":this.valueDec<=79?(e="1.",t-=40):(e="2.",t-=80),e+=t.toString()}else e=this.valueDec.toString();return e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec,isFirstSid:this.isFirstSid}}}Nk.NAME="sidBlock";class Bk extends xE{constructor(){let{value:e=vE,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,n){let r=t;for(;n>0;){const t=new Nk;if(r=t.fromBER(e,r,n),-1===r)return this.blockLength=0,this.error=t.error,r;0===this.value.length&&(t.isFirstSid=!0),this.blockLength+=t.blockLength,n-=t.blockLength,this.value.push(t)}return r}toBER(e){const t=[];for(let n=0;n<this.value.length;n++){const r=this.value[n].toBER(e);if(0===r.byteLength)return this.error=this.value[n].error,yE;t.push(r)}return hE(t)}fromString(e){this.value=[];let t=0,n=0,r="",i=!1;do{if(n=e.indexOf(".",t),r=-1===n?e.substring(t):e.substring(t,n),t=n+1,i){const e=this.value[0];let t=0;switch(e.valueDec){case 0:break;case 1:t=40;break;case 2:t=80;break;default:return void(this.value=[])}const n=parseInt(r,10);if(isNaN(n))return;e.valueDec=n+t,i=!1}else{const e=new Nk;if(r>Number.MAX_SAFE_INTEGER){dE();const t=BigInt(r);e.valueBigInt=t}else if(e.valueDec=parseInt(r,10),isNaN(e.valueDec))return;this.value.length||(e.isFirstSid=!0,i=!0),this.value.push(e)}}while(-1!==n)}toString(){let e="",t=!1;for(let n=0;n<this.value.length;n++){t=this.value[n].isHexOnly;let r=this.value[n].toString();0!==n&&(e="".concat(e,".")),t?(r="{".concat(r,"}"),this.value[n].isFirstSid?e="2.{".concat(r," - 80}"):e+=r):e+=r}return e}toJSON(){const e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}Bk.NAME="ObjectIdentifierValueBlock";class Dk extends CE{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},Bk),this.idBlock.tagClass=1,this.idBlock.tagNumber=6}getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}onAsciiEncoding(){return"".concat(this.constructor.NAME," : ").concat(this.valueBlock.toString()||"empty")}toJSON(){return{...super.toJSON(),value:this.getValue()}}}VE=Dk,RE.ObjectIdentifier=VE,Dk.NAME="OBJECT IDENTIFIER";class Ok extends(AE(SE)){constructor(){let{valueDec:e=0,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(t),this.valueDec=e}fromBER(e,t,n){if(0===n)return t;const r=oE._H.toUint8Array(e);if(!fE(this,r,t,n))return-1;const i=r.subarray(t,t+n);this.valueHexView=new Uint8Array(n);for(let s=0;s<n&&(this.valueHexView[s]=127&i[s],this.blockLength++,0!==(128&i[s]));s++);const o=new Uint8Array(this.blockLength);for(let s=0;s<this.blockLength;s++)o[s]=this.valueHexView[s];return this.valueHexView=o,0!==(128&i[this.blockLength-1])?(this.error="End of input reached before message was fully decoded",-1):(0===this.valueHexView[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=sE(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);const t=this.valueHexView,n=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength-1;e++)n[e]=128|t[e];return n[this.blockLength-1]=t[this.blockLength-1],n.buffer}const t=aE(this.valueDec,7);if(0===t.byteLength)return this.error="Error during encoding SID value",yE;const n=new Uint8Array(t.byteLength);if(!e){const e=new Uint8Array(t),r=t.byteLength-1;for(let t=0;t<r;t++)n[t]=128|e[t];n[r]=e[r]}return n.buffer}toString(){let e="";return e=this.isHexOnly?oE.U$.ToHex(this.valueHexView):this.valueDec.toString(),e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}}Ok.NAME="relativeSidBlock";class Lk extends xE{constructor(){let{value:e=vE,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,n){let r=t;for(;n>0;){const t=new Ok;if(r=t.fromBER(e,r,n),-1===r)return this.blockLength=0,this.error=t.error,r;this.blockLength+=t.blockLength,n-=t.blockLength,this.value.push(t)}return r}toBER(e,t){const n=[];for(let r=0;r<this.value.length;r++){const t=this.value[r].toBER(e);if(0===t.byteLength)return this.error=this.value[r].error,yE;n.push(t)}return hE(n)}fromString(e){this.value=[];let t=0,n=0,r="";do{n=e.indexOf(".",t),r=-1===n?e.substring(t):e.substring(t,n),t=n+1;const i=new Ok;if(i.valueDec=parseInt(r,10),isNaN(i.valueDec))return!0;this.value.push(i)}while(-1!==n);return!0}toString(){let e="",t=!1;for(let n=0;n<this.value.length;n++){t=this.value[n].isHexOnly;let r=this.value[n].toString();0!==n&&(e="".concat(e,".")),t?(r="{".concat(r,"}"),e+=r):e+=r}return e}toJSON(){const e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}Lk.NAME="RelativeObjectIdentifierValueBlock";class Mk extends CE{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},Lk),this.idBlock.tagClass=1,this.idBlock.tagNumber=13}getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}onAsciiEncoding(){return"".concat(this.constructor.NAME," : ").concat(this.valueBlock.toString()||"empty")}toJSON(){return{...super.toJSON(),value:this.getValue()}}}qE=Mk,RE.RelativeObjectIdentifier=qE,Mk.NAME="RelativeObjectIdentifier";class Fk extends mk{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this.idBlock.tagClass=1,this.idBlock.tagNumber=16}}GE=Fk,RE.Sequence=GE,Fk.NAME="SEQUENCE";class Uk extends mk{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this.idBlock.tagClass=1,this.idBlock.tagNumber=17}}KE=Uk,RE.Set=KE,Uk.NAME="SET";class jk extends(AE(xE)){constructor(){let{...e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(e),this.isHexOnly=!0,this.value=vE}toJSON(){return{...super.toJSON(),value:this.value}}}jk.NAME="StringValueBlock";class Hk extends jk{}Hk.NAME="SimpleStringValueBlock";class zk extends PE{constructor(){let{...e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(e,Hk)}fromBuffer(e){this.valueBlock.value=String.fromCharCode.apply(null,oE._H.toUint8Array(e))}fromString(e){const t=e.length,n=this.valueBlock.valueHexView=new Uint8Array(t);for(let r=0;r<t;r++)n[r]=e.charCodeAt(r);this.valueBlock.value=e}}zk.NAME="SIMPLE STRING";class Vk extends zk{fromBuffer(e){this.valueBlock.valueHexView=oE._H.toUint8Array(e);try{this.valueBlock.value=oE.U$.ToUtf8String(e)}catch(t){this.warnings.push('Error during "decodeURIComponent": '.concat(t,", using raw string")),this.valueBlock.value=oE.U$.ToBinary(e)}}fromString(e){this.valueBlock.valueHexView=new Uint8Array(oE.U$.FromUtf8String(e)),this.valueBlock.value=e}}Vk.NAME="Utf8StringValueBlock";class qk extends Vk{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this.idBlock.tagClass=1,this.idBlock.tagNumber=12}}WE=qk,RE.Utf8String=WE,qk.NAME="UTF8String";class Gk extends zk{fromBuffer(e){this.valueBlock.value=oE.U$.ToUtf16String(e),this.valueBlock.valueHexView=oE._H.toUint8Array(e)}fromString(e){this.valueBlock.value=e,this.valueBlock.valueHexView=new Uint8Array(oE.U$.FromUtf16String(e))}}Gk.NAME="BmpStringValueBlock";class Kk extends Gk{constructor(){let{...e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=30}}QE=Kk,RE.BmpString=QE,Kk.NAME="BMPString";class Wk extends zk{fromBuffer(e){const t=ArrayBuffer.isView(e)?e.slice().buffer:e.slice(0),n=new Uint8Array(t);for(let r=0;r<n.length;r+=4)n[r]=n[r+3],n[r+1]=n[r+2],n[r+2]=0,n[r+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(t))}fromString(e){const t=e.length,n=this.valueBlock.valueHexView=new Uint8Array(4*t);for(let r=0;r<t;r++){const t=aE(e.charCodeAt(r),8),i=new Uint8Array(t);if(i.length>4)continue;const o=4-i.length;for(let e=i.length-1;e>=0;e--)n[4*r+e+o]=i[e]}this.valueBlock.value=e}}Wk.NAME="UniversalStringValueBlock";class Qk extends Wk{constructor(){let{...e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=28}}YE=Qk,RE.UniversalString=YE,Qk.NAME="UniversalString";class Yk extends zk{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this.idBlock.tagClass=1,this.idBlock.tagNumber=18}}ZE=Yk,RE.NumericString=ZE,Yk.NAME="NumericString";class Zk extends zk{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this.idBlock.tagClass=1,this.idBlock.tagNumber=19}}JE=Zk,RE.PrintableString=JE,Zk.NAME="PrintableString";class Jk extends zk{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this.idBlock.tagClass=1,this.idBlock.tagNumber=20}}XE=Jk,RE.TeletexString=XE,Jk.NAME="TeletexString";class Xk extends zk{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this.idBlock.tagClass=1,this.idBlock.tagNumber=21}}$E=Xk,RE.VideotexString=$E,Xk.NAME="VideotexString";class $k extends zk{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this.idBlock.tagClass=1,this.idBlock.tagNumber=22}}ek=$k,RE.IA5String=ek,$k.NAME="IA5String";class eA extends zk{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this.idBlock.tagClass=1,this.idBlock.tagNumber=25}}tk=eA,RE.GraphicString=tk,eA.NAME="GraphicString";class tA extends zk{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this.idBlock.tagClass=1,this.idBlock.tagNumber=26}}nk=tA,RE.VisibleString=nk,tA.NAME="VisibleString";class nA extends zk{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this.idBlock.tagClass=1,this.idBlock.tagNumber=27}}rk=nA,RE.GeneralString=rk,nA.NAME="GeneralString";class rA extends zk{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this.idBlock.tagClass=1,this.idBlock.tagNumber=29}}ik=rA,RE.CharacterString=ik,rA.NAME="CharacterString";class iA extends tA{constructor(){let{value:e,valueDate:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(super(n),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,e){this.fromString(e),this.valueBlock.valueHexView=new Uint8Array(e.length);for(let t=0;t<e.length;t++)this.valueBlock.valueHexView[t]=e.charCodeAt(t)}t&&(this.fromDate(t),this.valueBlock.valueHexView=new Uint8Array(this.toBuffer())),this.idBlock.tagClass=1,this.idBlock.tagNumber=23}fromBuffer(e){this.fromString(String.fromCharCode.apply(null,oE._H.toUint8Array(e)))}toBuffer(){const e=this.toString(),t=new ArrayBuffer(e.length),n=new Uint8Array(t);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return t}fromDate(e){this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}fromString(e){const t=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/gi.exec(e);if(null===t)return void(this.error="Wrong input string for conversion");const n=parseInt(t[1],10);this.year=n>=50?1900+n:2e3+n,this.month=parseInt(t[2],10),this.day=parseInt(t[3],10),this.hour=parseInt(t[4],10),this.minute=parseInt(t[5],10),this.second=parseInt(t[6],10)}toString(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"iso";if("iso"===e){const e=new Array(7);return e[0]=uE(this.year<2e3?this.year-1900:this.year-2e3,2),e[1]=uE(this.month,2),e[2]=uE(this.day,2),e[3]=uE(this.hour,2),e[4]=uE(this.minute,2),e[5]=uE(this.second,2),e[6]="Z",e.join("")}return super.toString(e)}onAsciiEncoding(){return"".concat(this.constructor.NAME," : ").concat(this.toDate().toISOString())}toJSON(){return{...super.toJSON(),year:this.year,month:this.month,day:this.day,hour:this.hour,minute:this.minute,second:this.second}}}ok=iA,RE.UTCTime=ok,iA.NAME="UTCTime";class oA extends iA{constructor(){var e;super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),null!==(e=this.millisecond)&&void 0!==e||(this.millisecond=0),this.idBlock.tagClass=1,this.idBlock.tagNumber=24}fromDate(e){super.fromDate(e),this.millisecond=e.getUTCMilliseconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond))}fromString(e){let t,n=!1,r="",i="",o=0,s=0,a=0;if("Z"===e[e.length-1])r=e.substring(0,e.length-1),n=!0;else{const t=new Number(e[e.length-1]);if(isNaN(t.valueOf()))throw new Error("Wrong input string for conversion");r=e}if(n){if(-1!==r.indexOf("+"))throw new Error("Wrong input string for conversion");if(-1!==r.indexOf("-"))throw new Error("Wrong input string for conversion")}else{let e=1,t=r.indexOf("+"),n="";if(-1===t&&(t=r.indexOf("-"),e=-1),-1!==t){if(n=r.substring(t+1),r=r.substring(0,t),2!==n.length&&4!==n.length)throw new Error("Wrong input string for conversion");let i=parseInt(n.substring(0,2),10);if(isNaN(i.valueOf()))throw new Error("Wrong input string for conversion");if(s=e*i,4===n.length){if(i=parseInt(n.substring(2,4),10),isNaN(i.valueOf()))throw new Error("Wrong input string for conversion");a=e*i}}}let c=r.indexOf(".");if(-1===c&&(c=r.indexOf(",")),-1!==c){const e=new Number("0".concat(r.substring(c)));if(isNaN(e.valueOf()))throw new Error("Wrong input string for conversion");o=e.valueOf(),i=r.substring(0,c)}else i=r;switch(!0){case 8===i.length:if(t=/(\d{4})(\d{2})(\d{2})/gi,-1!==c)throw new Error("Wrong input string for conversion");break;case 10===i.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})/gi,-1!==c){let e=60*o;this.minute=Math.floor(e),e=60*(e-this.minute),this.second=Math.floor(e),e=1e3*(e-this.second),this.millisecond=Math.floor(e)}break;case 12===i.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==c){let e=60*o;this.second=Math.floor(e),e=1e3*(e-this.second),this.millisecond=Math.floor(e)}break;case 14===i.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==c){const e=1e3*o;this.millisecond=Math.floor(e)}break;default:throw new Error("Wrong input string for conversion")}const l=t.exec(i);if(null===l)throw new Error("Wrong input string for conversion");for(let u=1;u<l.length;u++)switch(u){case 1:this.year=parseInt(l[u],10);break;case 2:this.month=parseInt(l[u],10);break;case 3:this.day=parseInt(l[u],10);break;case 4:this.hour=parseInt(l[u],10)+s;break;case 5:this.minute=parseInt(l[u],10)+a;break;case 6:this.second=parseInt(l[u],10);break;default:throw new Error("Wrong input string for conversion")}if(!1===n){const e=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=e.getUTCFullYear(),this.month=e.getUTCMonth(),this.day=e.getUTCDay(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds(),this.millisecond=e.getUTCMilliseconds()}}toString(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"iso";if("iso"===e){const e=[];return e.push(uE(this.year,4)),e.push(uE(this.month,2)),e.push(uE(this.day,2)),e.push(uE(this.hour,2)),e.push(uE(this.minute,2)),e.push(uE(this.second,2)),0!==this.millisecond&&(e.push("."),e.push(uE(this.millisecond,3))),e.push("Z"),e.join("")}return super.toString(e)}toJSON(){return{...super.toJSON(),millisecond:this.millisecond}}}sk=oA,RE.GeneralizedTime=sk,oA.NAME="GeneralizedTime";class sA extends qk{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this.idBlock.tagClass=1,this.idBlock.tagNumber=31}}ak=sA,RE.DATE=ak,sA.NAME="DATE";class aA extends qk{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this.idBlock.tagClass=1,this.idBlock.tagNumber=32}}ck=aA,RE.TimeOfDay=ck,aA.NAME="TimeOfDay";class cA extends qk{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this.idBlock.tagClass=1,this.idBlock.tagNumber=33}}lk=cA,RE.DateTime=lk,cA.NAME="DateTime";class lA extends qk{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this.idBlock.tagClass=1,this.idBlock.tagNumber=34}}uk=lA,RE.Duration=uk,lA.NAME="Duration";class uA extends qk{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this.idBlock.tagClass=1,this.idBlock.tagNumber=14}}dk=uA,RE.TIME=dk,uA.NAME="TIME";function dA(e){let t=e.toString(16);t.length%2>0&&(t="0".concat(t));const n=t.length/2,r=new Uint8Array(n);let i=0,o=0;for(;i<n;)r[i]=parseInt(t.slice(o,o+2),16),i+=1,o+=2;return r}function hA(e){const t=[];return e.forEach((function(e){let n=e.toString(16);n.length%2>0&&(n="0".concat(n)),t.push(n)})),BigInt("0x"+t.join(""))}const fA=32,pA=1e4;async function gA(e,t){const n=jb.get();let r;if(e.includes("-----BEGIN ENCRYPTED PRIVATE KEY-----")){const i=Fs(e.replace("-----BEGIN ENCRYPTED PRIVATE KEY-----","").replace("-----END ENCRYPTED PRIVATE KEY-----","").replace(/\n/g,"").trim(),"base64pad"),{result:o}=pk(i),{iv:s,salt:a,iterations:c,keySize:l,cipherText:u}=function(e){const t=e.valueBlock.value[0];if("OBJECT IDENTIFIER : 1.2.840.113549.1.5.13"!==t.valueBlock.value[0].toString())throw new tf("Only pkcs5PBES2 encrypted private keys are supported","ERR_INVALID_PARAMS");const n=t.valueBlock.value[1].valueBlock.value[0];if("OBJECT IDENTIFIER : 1.2.840.113549.1.5.12"!==n.valueBlock.value[0].toString())throw new tf("Only pkcs5PBKDF2 key derivation functions are supported","ERR_INVALID_PARAMS");const r=n.valueBlock.value[1],i=vA(r.valueBlock.value[0].getValue());let o=pA,s=fA;if(3===r.valueBlock.value.length)o=Number(r.valueBlock.value[1].toBigInt()),s=Number(r.valueBlock.value[2].toBigInt());else if(2===r.valueBlock.value.length)throw new tf("Could not derive key size and iterations from PEM file - please use @libp2p/rsa to re-import your key","ERR_INVALID_PARAMS");const a=t.valueBlock.value[1].valueBlock.value[1],c=a.valueBlock.value[0].toString();if("OBJECT IDENTIFIER : 1.2.840.113549.3.7"===c);else if("OBJECT IDENTIFIER : 1.3.14.3.2.7"===c);else if("OBJECT IDENTIFIER : 2.16.840.1.101.3.4.1.2"===c);else if("OBJECT IDENTIFIER : 2.16.840.1.101.3.4.1.22"===c);else if("OBJECT IDENTIFIER : 2.16.840.1.101.3.4.1.42"!==c)throw new tf("Only AES-CBC encryption schemes are supported","ERR_INVALID_PARAMS");const l=vA(a.valueBlock.value[1].getValue());return{cipherText:vA(e.valueBlock.value[1].getValue()),salt:i,iterations:o,keySize:s,iv:l}}(o),d=await Zy(ww,t,a,{c:c,dkLen:l}),h=await n.subtle.importKey("raw",d,"AES-CBC",!1,["decrypt"]),f=vA(await n.subtle.decrypt({name:"AES-CBC",iv:s},h,u)),{result:p}=pk(f);r=mA(p)}else{if(!e.includes("-----BEGIN PRIVATE KEY-----"))throw new tf("Could not parse private key from PEM data","ERR_INVALID_PARAMETERS");{const t=Fs(e.replace("-----BEGIN PRIVATE KEY-----","").replace("-----END PRIVATE KEY-----","").replace(/\n/g,"").trim(),"base64pad"),{result:n}=pk(t);r=mA(n)}}return EA(r)}function mA(e){return vA(e.valueBlock.value[2].getValue())}function vA(e){return new Uint8Array(e,0,e.byteLength)}const yA=8192;class wA{constructor(e){Dr(this,"_key",void 0),this._key=e}verify(e,t){return async function(e,t,n){const r=await jb.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return jb.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},r,t,n instanceof Uint8Array?n:n.subarray())}(this._key,t,e)}marshal(){return function(e){if(null==e.n||null==e.e)throw new tf("JWK was missing components","ERR_INVALID_PARAMETERS");const t=new Fk({value:[new Fk({value:[new Dk({value:"1.2.840.113549.1.1.1"}),new wk]}),new xk({valueHex:new Fk({value:[Tk.fromBigInt(hA(Fs(e.n,"base64url"))),Tk.fromBigInt(hA(Fs(e.e,"base64url")))]}).toBER()})]}).toBER();return new Uint8Array(t,0,t.byteLength)}(this._key)}get bytes(){return Kb.encode({Type:qb.RSA,Data:this.marshal()}).subarray()}equals(e){return zr(this.bytes,e.bytes)}hash(){const e=Ps.digest(this.bytes);return kw(e)?e.then((e=>{let{bytes:t}=e;return t})):e.bytes}}class bA{constructor(e,t){Dr(this,"_key",void 0),Dr(this,"_publicKey",void 0),this._key=e,this._publicKey=t}genSecret(){return Np(16)}sign(e){return async function(e,t){const n=await jb.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),r=await jb.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},n,t instanceof Uint8Array?t:t.subarray());return new Uint8Array(r,0,r.byteLength)}(this._key,e)}get public(){if(null==this._publicKey)throw new tf("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new wA(this._publicKey)}marshal(){return function(e){if(null==e.n||null==e.e||null==e.d||null==e.p||null==e.q||null==e.dp||null==e.dq||null==e.qi)throw new tf("JWK was missing components","ERR_INVALID_PARAMETERS");const t=new Fk({value:[new Tk({value:0}),Tk.fromBigInt(hA(Fs(e.n,"base64url"))),Tk.fromBigInt(hA(Fs(e.e,"base64url"))),Tk.fromBigInt(hA(Fs(e.d,"base64url"))),Tk.fromBigInt(hA(Fs(e.p,"base64url"))),Tk.fromBigInt(hA(Fs(e.q,"base64url"))),Tk.fromBigInt(hA(Fs(e.dp,"base64url"))),Tk.fromBigInt(hA(Fs(e.dq,"base64url"))),Tk.fromBigInt(hA(Fs(e.qi,"base64url")))]}).toBER();return new Uint8Array(t,0,t.byteLength)}(this._key)}get bytes(){return Wb.encode({Type:qb.RSA,Data:this.marshal()}).subarray()}equals(e){return zr(this.bytes,e.bytes)}hash(){const e=Ps.digest(this.bytes);return kw(e)?e.then((e=>{let{bytes:t}=e;return t})):e.bytes}async id(){return cp(await this.public.hash(),"base58btc")}async export(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"pkcs-8";if("pkcs-8"===t)return async function(e,t){const n=jb.get(),r=new Fk({value:[new Tk({value:0}),new Fk({value:[new Dk({value:"1.2.840.113549.1.1.1"}),new wk]}),new Ak({valueHex:e.marshal()})]}).toBER(),i=new Uint8Array(r,0,r.byteLength),o=Np(16),s=await Zy(ww,t,o,{c:pA,dkLen:fA}),a=Np(16),c=await n.subtle.importKey("raw",s,"AES-CBC",!1,["encrypt"]),l=await n.subtle.encrypt({name:"AES-CBC",iv:a},c,i),u=new Fk({value:[new Ak({valueHex:o}),new Tk({value:pA}),new Tk({value:fA}),new Fk({value:[new Dk({value:"1.2.840.113549.2.11"}),new wk]})]}),d=new Fk({value:[new Dk({value:"1.2.840.113549.1.5.13"}),new Fk({value:[new Fk({value:[new Dk({value:"1.2.840.113549.1.5.12"}),u]}),new Fk({value:[new Dk({value:"2.16.840.1.101.3.4.1.42"}),new Ak({valueHex:a})]})]})]}),h=new Fk({value:[d,new Ak({valueHex:l})]}).toBER();return["-----BEGIN ENCRYPTED PRIVATE KEY-----",...cp(new Uint8Array(h,0,h.byteLength),"base64pad").split(/(.{64})/).filter(Boolean),"-----END ENCRYPTED PRIVATE KEY-----"].join("\n")}(this,e);if("libp2p-key"===t)return Vb(this.bytes,e);throw new tf("export format '".concat(t,"' is not supported"),"ERR_INVALID_EXPORT_FORMAT")}}async function EA(e){const t=function(e){const{result:t}=pk(e),n=t.valueBlock.value;return{n:cp(dA(n[1].toBigInt()),"base64url"),e:cp(dA(n[2].toBigInt()),"base64url"),d:cp(dA(n[3].toBigInt()),"base64url"),p:cp(dA(n[4].toBigInt()),"base64url"),q:cp(dA(n[5].toBigInt()),"base64url"),dp:cp(dA(n[6].toBigInt()),"base64url"),dq:cp(dA(n[7].toBigInt()),"base64url"),qi:cp(dA(n[8].toBigInt()),"base64url"),kty:"RSA",alg:"RS256"}}(e);if(iE(t)>yA)throw new tf("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const n=await tE(t);return new bA(n.privateKey,n.publicKey)}function kA(e){const t=function(e){const{result:t}=pk(e),n=t.valueBlock.value[1].valueBlock.value[0].valueBlock.value;return{kty:"RSA",n:cp(dA(n[0].toBigInt()),"base64url"),e:cp(dA(n[1].toBigInt()),"base64url")}}(e);if(iE(t)>yA)throw new tf("key size is too large","ERR_KEY_SIZE_TOO_LARGE");return new wA(t)}async function AA(e){if(iE(e)>yA)throw new tf("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const t=await tE(e);return new bA(t.privateKey,t.publicKey)}async function SA(e){if(e>yA)throw new tf("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const t=await async function(e){const t=await jb.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),n=await nE(t);return{privateKey:n[0],publicKey:n[1]}}(e);return new bA(t.privateKey,t.publicKey)}const{bytesToNumberBE:xA,hexToBytes:_A}=v,IA={Err:class extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")}},_parseInt(e){const{Err:t}=IA;if(e.length<2||2!==e[0])throw new t("Invalid signature integer tag");const n=e[1],r=e.subarray(2,n+2);if(!n||r.length!==n)throw new t("Invalid signature integer: wrong length");if(128&r[0])throw new t("Invalid signature integer: negative");if(0===r[0]&&!(128&r[1]))throw new t("Invalid signature integer: unnecessary leading zero");return{d:xA(r),l:e.subarray(n+2)}},toSig(e){const{Err:t}=IA,n="string"===typeof e?_A(e):e;_w(n);let r=n.length;if(r<2||48!=n[0])throw new t("Invalid signature tag");if(n[1]!==r-2)throw new t("Invalid signature: incorrect length");const{d:i,l:o}=IA._parseInt(n.subarray(2)),{d:s,l:a}=IA._parseInt(o);if(a.length)throw new t("Invalid signature: left bytes after parsing");return{r:i,s:s}},hexFromSig(e){const t=e=>8&Number.parseInt(e[0],16)?"00"+e:e,n=e=>{const t=e.toString(16);return 1&t.length?"0".concat(t):t},r=t(n(e.s)),i=t(n(e.r)),o=r.length/2,s=i.length/2,a=n(o),c=n(s);return"30".concat(n(s+o+4),"02").concat(c).concat(i,"02").concat(a).concat(r)}},RA=BigInt(0),CA=BigInt(1),TA=(BigInt(2),BigInt(3));BigInt(4);function PA(e){const t=function(e){const t=hb(e);qw(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:n,Fp:r,a:i}=t;if(n){if(!r.eql(i,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if("object"!==typeof n||"bigint"!==typeof n.beta||"function"!==typeof n.splitScalar)throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}(e),{Fp:n}=t,r=t.toBytes||((e,t,r)=>{const i=t.toAffine();return Fw(Uint8Array.from([4]),n.toBytes(i.x),n.toBytes(i.y))}),i=t.fromBytes||(e=>{const t=e.subarray(1);return{x:n.fromBytes(t.subarray(0,n.BYTES)),y:n.fromBytes(t.subarray(n.BYTES,2*n.BYTES))}});function o(e){const{a:r,b:i}=t,o=n.sqr(e),s=n.mul(o,e);return n.add(n.add(s,n.mul(e,r)),i)}if(!n.eql(n.sqr(t.Gy),o(t.Gx)))throw new Error("bad generator point: equation left != right");function s(e){return"bigint"===typeof e&&RA<e&&e<t.n}function a(e){if(!s(e))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(e){const{allowedPrivateKeyLengths:n,nByteLength:r,wrapPrivateKey:i,n:o}=t;if(n&&"bigint"!==typeof e){if(xw(e)&&(e=Rw(e)),"string"!==typeof e||!n.includes(e.length))throw new Error("Invalid key");e=e.padStart(2*r,"0")}let s;try{s="bigint"===typeof e?e:Bw(Mw("private key",e,r))}catch(c){throw new Error("private key must be ".concat(r," bytes, hex or bigint, not ").concat(typeof e))}return i&&(s=Xw(s,o)),a(s),s}const l=new Map;function u(e){if(!(e instanceof d))throw new Error("ProjectivePoint expected")}class d{constructor(e,t,r){if(this.px=e,this.py=t,this.pz=r,null==e||!n.isValid(e))throw new Error("x required");if(null==t||!n.isValid(t))throw new Error("y required");if(null==r||!n.isValid(r))throw new Error("z required")}static fromAffine(e){const{x:t,y:r}=e||{};if(!e||!n.isValid(t)||!n.isValid(r))throw new Error("invalid affine point");if(e instanceof d)throw new Error("projective point not allowed");const i=e=>n.eql(e,n.ZERO);return i(t)&&i(r)?d.ZERO:new d(t,r,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(e){const t=n.invertBatch(e.map((e=>e.pz)));return e.map(((e,n)=>e.toAffine(t[n]))).map(d.fromAffine)}static fromHex(e){const t=d.fromAffine(i(Mw("pointHex",e)));return t.assertValidity(),t}static fromPrivateKey(e){return d.BASE.multiply(c(e))}_setWindowSize(e){this._WINDOW_SIZE=e,l.delete(this)}assertValidity(){if(this.is0()){if(t.allowInfinityPoint&&!n.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:e,y:r}=this.toAffine();if(!n.isValid(e)||!n.isValid(r))throw new Error("bad point: x or y not FE");const i=n.sqr(r),s=o(e);if(!n.eql(i,s))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:e}=this.toAffine();if(n.isOdd)return!n.isOdd(e);throw new Error("Field doesn't support isOdd")}equals(e){u(e);const{px:t,py:r,pz:i}=this,{px:o,py:s,pz:a}=e,c=n.eql(n.mul(t,a),n.mul(o,i)),l=n.eql(n.mul(r,a),n.mul(s,i));return c&&l}negate(){return new d(this.px,n.neg(this.py),this.pz)}double(){const{a:e,b:r}=t,i=n.mul(r,TA),{px:o,py:s,pz:a}=this;let c=n.ZERO,l=n.ZERO,u=n.ZERO,h=n.mul(o,o),f=n.mul(s,s),p=n.mul(a,a),g=n.mul(o,s);return g=n.add(g,g),u=n.mul(o,a),u=n.add(u,u),c=n.mul(e,u),l=n.mul(i,p),l=n.add(c,l),c=n.sub(f,l),l=n.add(f,l),l=n.mul(c,l),c=n.mul(g,c),u=n.mul(i,u),p=n.mul(e,p),g=n.sub(h,p),g=n.mul(e,g),g=n.add(g,u),u=n.add(h,h),h=n.add(u,h),h=n.add(h,p),h=n.mul(h,g),l=n.add(l,h),p=n.mul(s,a),p=n.add(p,p),h=n.mul(p,g),c=n.sub(c,h),u=n.mul(p,f),u=n.add(u,u),u=n.add(u,u),new d(c,l,u)}add(e){u(e);const{px:r,py:i,pz:o}=this,{px:s,py:a,pz:c}=e;let l=n.ZERO,h=n.ZERO,f=n.ZERO;const p=t.a,g=n.mul(t.b,TA);let m=n.mul(r,s),v=n.mul(i,a),y=n.mul(o,c),w=n.add(r,i),b=n.add(s,a);w=n.mul(w,b),b=n.add(m,v),w=n.sub(w,b),b=n.add(r,o);let E=n.add(s,c);return b=n.mul(b,E),E=n.add(m,y),b=n.sub(b,E),E=n.add(i,o),l=n.add(a,c),E=n.mul(E,l),l=n.add(v,y),E=n.sub(E,l),f=n.mul(p,b),l=n.mul(g,y),f=n.add(l,f),l=n.sub(v,f),f=n.add(v,f),h=n.mul(l,f),v=n.add(m,m),v=n.add(v,m),y=n.mul(p,y),b=n.mul(g,b),v=n.add(v,y),y=n.sub(m,y),y=n.mul(p,y),b=n.add(b,y),m=n.mul(v,b),h=n.add(h,m),m=n.mul(E,b),l=n.mul(w,l),l=n.sub(l,m),m=n.mul(w,v),f=n.mul(E,f),f=n.add(f,m),new d(l,h,f)}subtract(e){return this.add(e.negate())}is0(){return this.equals(d.ZERO)}wNAF(e){return f.wNAFCached(this,l,e,(e=>{const t=n.invertBatch(e.map((e=>e.pz)));return e.map(((e,n)=>e.toAffine(t[n]))).map(d.fromAffine)}))}multiplyUnsafe(e){const r=d.ZERO;if(e===RA)return r;if(a(e),e===CA)return this;const{endo:i}=t;if(!i)return f.unsafeLadder(this,e);let{k1neg:o,k1:s,k2neg:c,k2:l}=i.splitScalar(e),u=r,h=r,p=this;for(;s>RA||l>RA;)s&CA&&(u=u.add(p)),l&CA&&(h=h.add(p)),p=p.double(),s>>=CA,l>>=CA;return o&&(u=u.negate()),c&&(h=h.negate()),h=new d(n.mul(h.px,i.beta),h.py,h.pz),u.add(h)}multiply(e){a(e);let r,i,o=e;const{endo:s}=t;if(s){const{k1neg:e,k1:t,k2neg:a,k2:c}=s.splitScalar(o);let{p:l,f:u}=this.wNAF(t),{p:h,f:p}=this.wNAF(c);l=f.constTimeNegate(e,l),h=f.constTimeNegate(a,h),h=new d(n.mul(h.px,s.beta),h.py,h.pz),r=l.add(h),i=u.add(p)}else{const{p:e,f:t}=this.wNAF(o);r=e,i=t}return d.normalizeZ([r,i])[0]}multiplyAndAddUnsafe(e,t,n){const r=d.BASE,i=(e,t)=>t!==RA&&t!==CA&&e.equals(r)?e.multiply(t):e.multiplyUnsafe(t),o=i(this,t).add(i(e,n));return o.is0()?void 0:o}toAffine(e){const{px:t,py:r,pz:i}=this,o=this.is0();null==e&&(e=o?n.ONE:n.inv(i));const s=n.mul(t,e),a=n.mul(r,e),c=n.mul(i,e);if(o)return{x:n.ZERO,y:n.ZERO};if(!n.eql(c,n.ONE))throw new Error("invZ was invalid");return{x:s,y:a}}isTorsionFree(){const{h:e,isTorsionFree:n}=t;if(e===CA)return!0;if(n)return n(d,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:e,clearCofactor:n}=t;return e===CA?this:n?n(d,this):this.multiplyUnsafe(t.h)}toRawBytes(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.assertValidity(),r(d,this,e)}toHex(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return Rw(this.toRawBytes(e))}}d.BASE=new d(t.Gx,t.Gy,n.ONE),d.ZERO=new d(n.ZERO,n.ONE,n.ZERO);const h=t.nBitLength,f=db(d,t.endo?Math.ceil(h/2):h);return{CURVE:t,ProjectivePoint:d,normPrivateKeyToScalar:c,weierstrassEquation:o,isWithinCurveOrder:s}}function NA(e){const t=function(e){const t=hb(e);return qw(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}(e),{Fp:n,n:r}=t,i=n.BYTES+1,o=2*n.BYTES+1;function s(e){return Xw(e,r)}function a(e){return tb(e,r)}const{ProjectivePoint:c,normPrivateKeyToScalar:l,weierstrassEquation:u,isWithinCurveOrder:d}=PA({...t,toBytes(e,t,r){const i=t.toAffine(),o=n.toBytes(i.x),s=Fw;return r?s(Uint8Array.from([t.hasEvenY()?2:3]),o):s(Uint8Array.from([4]),o,n.toBytes(i.y))},fromBytes(e){const t=e.length,r=e[0],s=e.subarray(1);if(t!==i||2!==r&&3!==r){if(t===o&&4===r){return{x:n.fromBytes(s.subarray(0,n.BYTES)),y:n.fromBytes(s.subarray(n.BYTES,2*n.BYTES))}}throw new Error("Point of length ".concat(t," was invalid. Expected ").concat(i," compressed bytes or ").concat(o," uncompressed bytes"))}{const e=Bw(s);if(!(RA<(a=e)&&a<n.ORDER))throw new Error("Point is not on curve");const t=u(e);let i;try{i=n.sqrt(t)}catch(c){const e=c instanceof Error?": "+c.message:"";throw new Error("Point is not on curve"+e)}return 1===(1&r)!==((i&CA)===CA)&&(i=n.neg(i)),{x:e,y:i}}var a}}),h=e=>Rw(Ow(e,t.nByteLength));function f(e){return e>r>>CA}const p=(e,t,n)=>Bw(e.slice(t,n));class g{constructor(e,t,n){this.r=e,this.s=t,this.recovery=n,this.assertValidity()}static fromCompact(e){const n=t.nByteLength;return e=Mw("compactSignature",e,2*n),new g(p(e,0,n),p(e,n,2*n))}static fromDER(e){const{r:t,s:n}=IA.toSig(Mw("DER",e));return new g(t,n)}assertValidity(){if(!d(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!d(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(e){return new g(this.r,this.s,e)}recoverPublicKey(e){const{r:r,s:i,recovery:o}=this,l=w(Mw("msgHash",e));if(null==o||![0,1,2,3].includes(o))throw new Error("recovery id invalid");const u=2===o||3===o?r+t.n:r;if(u>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const d=0===(1&o)?"02":"03",f=c.fromHex(d+h(u)),p=a(u),g=s(-l*p),m=s(i*p),v=c.BASE.multiplyAndAddUnsafe(f,g,m);if(!v)throw new Error("point at infinify");return v.assertValidity(),v}hasHighS(){return f(this.s)}normalizeS(){return this.hasHighS()?new g(this.r,s(-this.s),this.recovery):this}toDERRawBytes(){return Nw(this.toDERHex())}toDERHex(){return IA.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Nw(this.toCompactHex())}toCompactHex(){return h(this.r)+h(this.s)}}const m={isValidPrivateKey(e){try{return l(e),!0}catch(t){return!1}},normPrivateKeyToScalar:l,randomPrivateKey:()=>{const e=cb(t.n);return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=e.length,i=ab(t),o=cb(t);if(r<16||r<o||r>1024)throw new Error("expected ".concat(o,"-1024 bytes of input, got ").concat(r));const s=Xw(n?Bw(e):Dw(e),t-Kw)+Kw;return n?Lw(s,i):Ow(s,i)}(t.randomBytes(e),t.n)},precompute(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.BASE;return t._setWindowSize(e),t.multiply(BigInt(3)),t}};function v(e){const t=xw(e),n="string"===typeof e,r=(t||n)&&e.length;return t?r===i||r===o:n?r===2*i||r===2*o:e instanceof c}const y=t.bits2int||function(e){const n=Bw(e),r=8*e.length-t.nBitLength;return r>0?n>>BigInt(r):n},w=t.bits2int_modN||function(e){return s(y(e))},b=Uw(t.nBitLength);function E(e){if("bigint"!==typeof e)throw new Error("bigint expected");if(!(RA<=e&&e<b))throw new Error("bigint expected < 2^".concat(t.nBitLength));return Ow(e,t.nByteLength)}function k(e,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:A;if(["recovered","canonical"].some((e=>e in i)))throw new Error("sign() legacy options not supported");const{hash:o,randomBytes:u}=t;let{lowS:h,prehash:p,extraEntropy:m}=i;null==h&&(h=!0),e=Mw("msgHash",e),p&&(e=Mw("prehashed msgHash",o(e)));const v=w(e),b=l(r),k=[E(b),E(v)];if(null!=m&&!1!==m){const e=!0===m?u(n.BYTES):m;k.push(Mw("extraEntropy",e))}const S=Fw(...k),x=v;return{seed:S,k2sig:function(e){const t=y(e);if(!d(t))return;const n=a(t),r=c.BASE.multiply(t).toAffine(),i=s(r.x);if(i===RA)return;const o=s(n*s(x+i*b));if(o===RA)return;let l=(r.x===i?0:2)|Number(r.y&CA),u=o;return h&&f(o)&&(u=function(e){return f(e)?s(-e):e}(o),l^=1),new g(i,u,l)}}}const A={lowS:t.lowS,prehash:!1},S={lowS:t.lowS,prehash:!1};return c.BASE._setWindowSize(8),{CURVE:t,getPublicKey:function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return c.fromPrivateKey(e).toRawBytes(t)},getSharedSecret:function(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(v(e))throw new Error("first arg must be private key");if(!v(t))throw new Error("second arg must be public key");return c.fromHex(t).multiply(l(e)).toRawBytes(n)},sign:function(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:A;const{seed:i,k2sig:o}=k(e,n,r),s=t;return zw(s.hash.outputLen,s.nByteLength,s.hmac)(i,o)},verify:function(e,n,r){var i;let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:S;const l=e;if(n=Mw("msgHash",n),r=Mw("publicKey",r),"strict"in o)throw new Error("options.strict was renamed to lowS");const{lowS:u,prehash:d}=o;let h,f;try{if("string"===typeof l||xw(l))try{h=g.fromDER(l)}catch(A){if(!(A instanceof IA.Err))throw A;h=g.fromCompact(l)}else{if("object"!==typeof l||"bigint"!==typeof l.r||"bigint"!==typeof l.s)throw new Error("PARSE");{const{r:e,s:t}=l;h=new g(e,t)}}f=c.fromHex(r)}catch(x){if("PARSE"===x.message)throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(u&&h.hasHighS())return!1;d&&(n=t.hash(n));const{r:p,s:m}=h,v=w(n),y=a(m),b=s(v*y),E=s(p*y),k=null===(i=c.BASE.multiplyAndAddUnsafe(f,b,E))||void 0===i?void 0:i.toAffine();return!!k&&s(k.x)===p},ProjectivePoint:c,Signature:g,utils:m}}function BA(e){return{hash:e,hmac:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return Wy(e,t,Ip(...r))},randomBytes:Pp}}const DA=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),OA=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),LA=BigInt(1),MA=BigInt(2),FA=(e,t)=>(e+t/MA)/t;function UA(e){const t=DA,n=BigInt(3),r=BigInt(6),i=BigInt(11),o=BigInt(22),s=BigInt(23),a=BigInt(44),c=BigInt(88),l=e*e*e%t,u=l*l*e%t,d=eb(u,n,t)*u%t,h=eb(d,n,t)*u%t,f=eb(h,MA,t)*l%t,p=eb(f,i,t)*f%t,g=eb(p,o,t)*p%t,m=eb(g,a,t)*g%t,v=eb(m,c,t)*m%t,y=eb(v,a,t)*g%t,w=eb(y,n,t)*u%t,b=eb(w,s,t)*p%t,E=eb(b,r,t)*l%t,k=eb(E,MA,t);if(!jA.eql(jA.sqr(k),e))throw new Error("Cannot find square root");return k}const jA=sb(DA,void 0,void 0,{sqrt:UA}),HA=function(e,t){const n=t=>NA({...e,...BA(t)});return Object.freeze({...n(t),create:n})}({a:BigInt(0),b:BigInt(7),Fp:jA,n:OA,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{const t=OA,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-LA*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=n,s=BigInt("0x100000000000000000000000000000000"),a=FA(o*e,t),c=FA(-r*e,t);let l=Xw(e-a*n-c*i,t),u=Xw(-a*r-c*o,t);const d=l>s,h=u>s;if(d&&(l=t-l),h&&(u=t-u),l>s||u>s)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:d,k1:l,k2neg:h,k2:u}}}},cw);BigInt(0);HA.ProjectivePoint;function zA(e){try{HA.ProjectivePoint.fromHex(e)}catch(t){throw new tf(String(t),"ERR_INVALID_PUBLIC_KEY")}}class VA{constructor(e){Dr(this,"_key",void 0),zA(e),this._key=e}verify(e,t){return function(e,t,n){const r=Ps.digest(n instanceof Uint8Array?n:n.subarray());if(kw(r))return r.then((n=>{let{digest:r}=n;return HA.verify(t,r,e)})).catch((e=>{throw new tf(String(e),"ERR_INVALID_INPUT")}));try{return HA.verify(t,r.digest,e)}catch(i){throw new tf(String(i),"ERR_INVALID_INPUT")}}(this._key,t,e)}marshal(){return e=this._key,HA.ProjectivePoint.fromHex(e).toRawBytes(!0);var e}get bytes(){return Kb.encode({Type:qb.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return zr(this.bytes,e.bytes)}async hash(){const e=Ps.digest(this.bytes);let t;return kw(e)?({bytes:t}=await e):t=e.bytes,t}}class qA{constructor(e,t){Dr(this,"_key",void 0),Dr(this,"_publicKey",void 0),this._key=e,this._publicKey=null!==t&&void 0!==t?t:function(e){try{return HA.getPublicKey(e,!0)}catch(t){throw new tf(String(t),"ERR_INVALID_PRIVATE_KEY")}}(e),function(e){try{HA.getPublicKey(e,!0)}catch(t){throw new tf(String(t),"ERR_INVALID_PRIVATE_KEY")}}(this._key),zA(this._publicKey)}sign(e){return function(e,t){const n=Ps.digest(t instanceof Uint8Array?t:t.subarray());if(kw(n))return n.then((t=>{let{digest:n}=t;return HA.sign(n,e).toDERRawBytes()})).catch((e=>{throw new tf(String(e),"ERR_INVALID_INPUT")}));try{return HA.sign(n.digest,e).toDERRawBytes()}catch(r){throw new tf(String(r),"ERR_INVALID_INPUT")}}(this._key,e)}get public(){return new VA(this._publicKey)}marshal(){return this._key}get bytes(){return Wb.encode({Type:qb.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return zr(this.bytes,e.bytes)}hash(){const e=Ps.digest(this.bytes);return kw(e)?e.then((e=>{let{bytes:t}=e;return t})):e.bytes}async id(){return cp(await this.public.hash(),"base58btc")}async export(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"libp2p-key";if("libp2p-key"===t)return Vb(this.bytes,e);throw new tf("export format '".concat(t,"' is not supported"),"ERR_INVALID_EXPORT_FORMAT")}}function GA(e){return new qA(e)}function KA(e){return new VA(e)}async function WA(){const e=HA.utils.randomPrivateKey();return new qA(e)}const QA={rsa:w,ed25519:y,secp256k1:b};function YA(e){const t=Object.keys(QA).join(" / ");return new tf("invalid or unsupported key type ".concat(e,". Must be ").concat(t),"ERR_UNSUPPORTED_KEY_TYPE")}function ZA(e){if("rsa"===(e=e.toLowerCase())||"ed25519"===e||"secp256k1"===e)return QA[e];throw YA(e)}async function JA(e,t){return ZA(e).generateKeyPair(null!==t&&void 0!==t?t:2048)}function XA(e){var t,n;const r=Kb.decode(e),i=null!==(t=r.Data)&&void 0!==t?t:new Uint8Array;switch(r.Type){case qb.RSA:return QA.rsa.unmarshalRsaPublicKey(i);case qb.Ed25519:return QA.ed25519.unmarshalEd25519PublicKey(i);case qb.Secp256k1:return QA.secp256k1.unmarshalSecp256k1PublicKey(i);default:throw YA(null!==(n=r.Type)&&void 0!==n?n:"unknown")}}function $A(e,t){var n;return ZA(t=(null!==(n=t)&&void 0!==n?n:"rsa").toLowerCase()),e.bytes}async function eS(e){var t,n;const r=Wb.decode(e),i=null!==(t=r.Data)&&void 0!==t?t:new Uint8Array;switch(r.Type){case qb.RSA:return QA.rsa.unmarshalRsaPrivateKey(i);case qb.Ed25519:return QA.ed25519.unmarshalEd25519PrivateKey(i);case qb.Secp256k1:return QA.secp256k1.unmarshalSecp256k1PrivateKey(i);default:throw YA(null!==(n=r.Type)&&void 0!==n?n:"RSA")}}async function tS(e,t){try{const n=await async function(e,t){const n=us.decode(e);return zb().decrypt(n,t)}(e,t);return await eS(n)}catch(n){}if(!e.includes("BEGIN"))throw new tf("Encrypted key was not a libp2p-key or a PEM file","ERR_INVALID_IMPORT_FORMAT");return gA(e,t)}var nS,rS=n(1287);!function(e){e.ERR_INVALID_PARAMETERS="ERR_INVALID_PARAMETERS",e.ERR_INVALID_KEY_NAME="ERR_INVALID_KEY_NAME",e.ERR_INVALID_KEY_TYPE="ERR_INVALID_KEY_TYPE",e.ERR_KEY_ALREADY_EXISTS="ERR_KEY_ALREADY_EXISTS",e.ERR_INVALID_KEY_SIZE="ERR_INVALID_KEY_SIZE",e.ERR_KEY_NOT_FOUND="ERR_KEY_NOT_FOUND",e.ERR_OLD_KEY_NAME_INVALID="ERR_OLD_KEY_NAME_INVALID",e.ERR_NEW_KEY_NAME_INVALID="ERR_NEW_KEY_NAME_INVALID",e.ERR_PASSWORD_REQUIRED="ERR_PASSWORD_REQUIRED",e.ERR_PEM_REQUIRED="ERR_PEM_REQUIRED",e.ERR_CANNOT_READ_KEY="ERR_CANNOT_READ_KEY",e.ERR_MISSING_PRIVATE_KEY="ERR_MISSING_PRIVATE_KEY",e.ERR_INVALID_OLD_PASS_TYPE="ERR_INVALID_OLD_PASS_TYPE",e.ERR_INVALID_NEW_PASS_TYPE="ERR_INVALID_NEW_PASS_TYPE",e.ERR_INVALID_PASS_LENGTH="ERR_INVALID_PASS_LENGTH"}(nS||(nS={}));const iS="/info/",oS=new WeakMap,sS=14,aS=16,cS=1e3,lS={dek:{keyLength:64,iterationCount:1e4,salt:"you should override this value with a crypto secure random number",hash:"sha2-512"}};function uS(e){return null!=e&&("string"===typeof e&&(e===rS(e.trim())&&e.length>0))}async function dS(){const e=800*Math.random()+200;await new Promise((t=>setTimeout(t,e)))}function hS(e){return new Dv("/pkcs8/"+e)}function fS(e){return new Dv(iS+e)}class pS{constructor(e,t){var n,r,i,o,s,a,c,l,u;if(Dr(this,"components",void 0),Dr(this,"init",void 0),Dr(this,"log",void 0),this.components=e,this.log=e.logger.forComponent("libp2p:keychain"),this.init=Ad(lS,t),null!=this.init.pass&&(null===(n=this.init.pass)||void 0===n?void 0:n.length)<20)throw new Error("pass must be least 20 characters");if(null!=(null===(r=this.init.dek)||void 0===r?void 0:r.keyLength)&&this.init.dek.keyLength<sS)throw new Error("dek.keyLength must be least ".concat(sS," bytes"));if(null!=(null===(i=this.init.dek)||void 0===i||null===(i=i.salt)||void 0===i?void 0:i.length)&&this.init.dek.salt.length<aS)throw new Error("dek.saltLength must be least ".concat(aS," bytes"));if(null!=(null===(o=this.init.dek)||void 0===o?void 0:o.iterationCount)&&this.init.dek.iterationCount<cS)throw new Error("dek.iterationCount must be least ".concat(cS));const d=null!=this.init.pass&&null!=(null===(s=this.init.dek)||void 0===s?void 0:s.salt)?Ew(this.init.pass,null===(a=this.init.dek)||void 0===a?void 0:a.salt,null===(c=this.init.dek)||void 0===c?void 0:c.iterationCount,null===(l=this.init.dek)||void 0===l?void 0:l.keyLength,null===(u=this.init.dek)||void 0===u?void 0:u.hash):"";oS.set(this,{dek:d})}static generateOptions(){const e=Object.assign({},lS),t=3*Math.ceil(aS/3);return e.dek.salt=cp(Np(t),"base64"),e}static get options(){return lS}async createKey(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2048;if(!uS(e)||"self"===e)throw await dS(),new tf("Invalid key name",nS.ERR_INVALID_KEY_NAME);if("string"!==typeof t)throw await dS(),new tf("Invalid key type",nS.ERR_INVALID_KEY_TYPE);const r=hS(e);if(await this.components.datastore.has(r))throw await dS(),new tf("Key name already exists",nS.ERR_KEY_ALREADY_EXISTS);if("rsa"===t.toLowerCase())if(!Number.isSafeInteger(n)||n<2048)throw await dS(),new tf("Invalid RSA key size",nS.ERR_INVALID_KEY_SIZE);let i;try{const o=await JA(t,n),s=await o.id(),a=oS.get(this);if(null==a)throw new tf("dek missing",nS.ERR_INVALID_PARAMETERS);const c=a.dek,l=await o.export(c);i={name:e,id:s};const u=this.components.datastore.batch();u.put(r,Fs(l)),u.put(fS(e),Fs(JSON.stringify(i))),await u.commit()}catch(o){throw await dS(),o}return i}async listKeys(){const e={prefix:iS},t=[];for await(const n of this.components.datastore.query(e))t.push(JSON.parse(cp(n.value)));return t}async findKeyById(e){try{const t=(await this.listKeys()).find((t=>t.id===e));if(null==t)throw new tf("Key with id '".concat(e,"' does not exist."),nS.ERR_KEY_NOT_FOUND);return t}catch(t){throw await dS(),t}}async findKeyByName(e){if(!uS(e))throw await dS(),new tf("Invalid key name '".concat(e,"'"),nS.ERR_INVALID_KEY_NAME);const t=fS(e);try{const e=await this.components.datastore.get(t);return JSON.parse(cp(e))}catch(n){throw await dS(),this.log.error(n),new tf("Key '".concat(e,"' does not exist."),nS.ERR_KEY_NOT_FOUND)}}async removeKey(e){if(!uS(e)||"self"===e)throw await dS(),new tf("Invalid key name '".concat(e,"'"),nS.ERR_INVALID_KEY_NAME);const t=hS(e),n=await this.findKeyByName(e),r=this.components.datastore.batch();return r.delete(t),r.delete(fS(e)),await r.commit(),n}async renameKey(e,t){if(!uS(e)||"self"===e)throw await dS(),new tf("Invalid old key name '".concat(e,"'"),nS.ERR_OLD_KEY_NAME_INVALID);if(!uS(t)||"self"===t)throw await dS(),new tf("Invalid new key name '".concat(t,"'"),nS.ERR_NEW_KEY_NAME_INVALID);const n=hS(e),r=hS(t),i=fS(e),o=fS(t);if(await this.components.datastore.has(r))throw await dS(),new tf("Key '".concat(t,"' already exists"),nS.ERR_KEY_ALREADY_EXISTS);try{const e=await this.components.datastore.get(n),s=await this.components.datastore.get(i),a=JSON.parse(cp(s));a.name=t;const c=this.components.datastore.batch();return c.put(r,e),c.put(o,Fs(JSON.stringify(a))),c.delete(n),c.delete(i),await c.commit(),a}catch(s){throw await dS(),s}}async exportKey(e,t){if(!uS(e))throw await dS(),new tf("Invalid key name '".concat(e,"'"),nS.ERR_INVALID_KEY_NAME);if(null==t)throw await dS(),new tf("Password is required",nS.ERR_PASSWORD_REQUIRED);const n=hS(e);try{const e=cp(await this.components.datastore.get(n)),r=oS.get(this);if(null==r)throw new tf("dek missing",nS.ERR_INVALID_PARAMETERS);const i=r.dek,o=await tS(e,i);return await o.export(t)}catch(r){throw await dS(),r}}async exportPeerId(e){const t="temporary-password",n=await this.exportKey(e,t),r=await tS(n,t);return rp(r.public.bytes,r.bytes)}async importKey(e,t,n){if(!uS(e)||"self"===e)throw await dS(),new tf("Invalid key name '".concat(e,"'"),nS.ERR_INVALID_KEY_NAME);if(null==t)throw await dS(),new tf("PEM encoded key is required",nS.ERR_PEM_REQUIRED);const r=hS(e);if(await this.components.datastore.has(r))throw await dS(),new tf("Key '".concat(e,"' already exists"),nS.ERR_KEY_ALREADY_EXISTS);let i,o;try{i=await tS(t,n)}catch(c){throw await dS(),new tf("Cannot read the key, most likely the password is wrong",nS.ERR_CANNOT_READ_KEY)}try{o=await i.id();const e=oS.get(this);if(null==e)throw new tf("dek missing",nS.ERR_INVALID_PARAMETERS);const n=e.dek;t=await i.export(n)}catch(c){throw await dS(),c}const s={name:e,id:o},a=this.components.datastore.batch();return a.put(r,Fs(t)),a.put(fS(e),Fs(JSON.stringify(s))),await a.commit(),s}async importPeer(e,t){try{if(!uS(e))throw new tf("Invalid key name '".concat(e,"'"),nS.ERR_INVALID_KEY_NAME);if(null==t)throw new tf("PeerId is required",nS.ERR_MISSING_PRIVATE_KEY);if(null==t.privateKey)throw new tf("PeerId.privKey is required",nS.ERR_MISSING_PRIVATE_KEY);const n=await eS(t.privateKey),r=hS(e);if(await this.components.datastore.has(r))throw await dS(),new tf("Key '".concat(e,"' already exists"),nS.ERR_KEY_ALREADY_EXISTS);const i=oS.get(this);if(null==i)throw new tf("dek missing",nS.ERR_INVALID_PARAMETERS);const o=i.dek,s=await n.export(o),a={name:e,id:t.toString()},c=this.components.datastore.batch();return c.put(r,Fs(s)),c.put(fS(e),Fs(JSON.stringify(a))),await c.commit(),a}catch(n){throw await dS(),n}}async getPrivateKey(e){if(!uS(e))throw await dS(),new tf("Invalid key name '".concat(e,"'"),nS.ERR_INVALID_KEY_NAME);try{const t=hS(e);return cp(await this.components.datastore.get(t))}catch(t){throw await dS(),this.log.error(t),new tf("Key '".concat(e,"' does not exist."),nS.ERR_KEY_NOT_FOUND)}}async rotateKeychainPass(e,t){var n,r,i,o;if("string"!==typeof e)throw await dS(),new tf("Invalid old pass type '".concat(typeof e,"'"),nS.ERR_INVALID_OLD_PASS_TYPE);if("string"!==typeof t)throw await dS(),new tf("Invalid new pass type '".concat(typeof t,"'"),nS.ERR_INVALID_NEW_PASS_TYPE);if(t.length<20)throw await dS(),new tf("Invalid pass length ".concat(t.length),nS.ERR_INVALID_PASS_LENGTH);this.log("recreating keychain");const s=oS.get(this);if(null==s)throw new tf("dek missing",nS.ERR_INVALID_PARAMETERS);const a=s.dek;this.init.pass=t;const c=null!=t&&null!=(null===(n=this.init.dek)||void 0===n?void 0:n.salt)?Ew(t,this.init.dek.salt,null===(r=this.init.dek)||void 0===r?void 0:r.iterationCount,null===(i=this.init.dek)||void 0===i?void 0:i.keyLength,null===(o=this.init.dek)||void 0===o?void 0:o.hash):"";oS.set(this,{dek:c});const l=await this.listKeys();for(const u of l){const e=cp(await this.components.datastore.get(hS(u.name))),t=await tS(e,a),n=c.toString(),r=await t.export(n),i=this.components.datastore.batch(),o={name:u.name,id:u.id};i.put(hS(u.name),Fs(r)),i.put(fS(u.name),Fs(JSON.stringify(o))),await i.commit()}this.log("keychain reconstructed")}}function gS(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>new pS(t,e)}const mS=Symbol.for("@libp2p/peer-discovery");class vS{constructor(e){if(Dr(this,"set",void 0),this.set=new Set,null!=e)for(const t of e)this.set.add(t.toString())}get size(){return this.set.size}[Symbol.iterator](){return this.values()}add(e){this.set.add(e.toString())}clear(){this.set.clear()}delete(e){this.set.delete(e.toString())}entries(){return ip(this.set.entries(),(e=>{const t=tp(e[0]);return[t,t]}))}forEach(e){this.set.forEach((t=>{const n=tp(t);e(n,n,this)}))}has(e){return this.set.has(e.toString())}values(){return ip(this.set.values(),(e=>tp(e)))}intersection(e){const t=new vS;for(const n of e)this.has(n)&&t.add(n);return t}difference(e){const t=new vS;for(const n of this)e.has(n)||t.add(n);return t}union(e){const t=new vS;for(const n of e)t.add(n);for(const n of this)t.add(n);return t}}const yS=async()=>{const e=await JA("Ed25519"),t=await wS(e);if("Ed25519"===t.type)return t;throw new Error('Generated unexpected PeerId type "'.concat(t.type,'"'))};async function wS(e){return rp($A(e.public),function(e,t){var n;return ZA(t=(null!==(n=t)&&void 0!==n?n:"rsa").toLowerCase()),e.bytes}(e))}const bS="ERR_SIGNATURE_NOT_VALID";var ES,kS;!function(e){let t;e.codec=()=>(null==t&&(t=oa((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.publicKey&&e.publicKey.byteLength>0&&(t.uint32(10),t.bytes(e.publicKey)),null!=e.payloadType&&e.payloadType.byteLength>0&&(t.uint32(18),t.bytes(e.payloadType)),null!=e.payload&&e.payload.byteLength>0&&(t.uint32(26),t.bytes(e.payload)),null!=e.signature&&e.signature.byteLength>0&&(t.uint32(42),t.bytes(e.signature)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={publicKey:new Uint8Array(0),payloadType:new Uint8Array(0),payload:new Uint8Array(0),signature:new Uint8Array(0)},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.publicKey=e.bytes();break;case 2:n.payloadType=e.bytes();break;case 3:n.payload=e.bytes();break;case 5:n.signature=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>Xs(t,e.codec()),e.decode=t=>$o(t,e.codec())}(ES||(ES={}));class AS{constructor(e){Dr(this,"peerId",void 0),Dr(this,"payloadType",void 0),Dr(this,"payload",void 0),Dr(this,"signature",void 0),Dr(this,"marshaled",void 0);const{peerId:t,payloadType:n,payload:r,signature:i}=e;this.peerId=t,this.payloadType=n,this.payload=r,this.signature=i}marshal(){if(null==this.peerId.publicKey)throw new Error("Missing public key");return null==this.marshaled&&(this.marshaled=ES.encode({publicKey:this.peerId.publicKey,payloadType:this.payloadType,payload:this.payload.subarray(),signature:this.signature})),this.marshaled}equals(e){return zr(this.marshal(),e.marshal())}async validate(e){const t=SS(e,this.payloadType,this.payload);if(null==this.peerId.publicKey)throw new Error("Missing public key");return XA(this.peerId.publicKey).verify(t.subarray(),this.signature)}}kS=AS,Dr(AS,"createFromProtobuf",(async e=>{const t=ES.decode(e),n=await rp(t.publicKey);return new kS({peerId:n,payloadType:t.payloadType,payload:t.payload,signature:t.signature})})),Dr(AS,"seal",(async(e,t)=>{if(null==t.privateKey)throw new Error("Missing private key");const n=e.domain,r=e.codec,i=e.marshal(),o=SS(n,r,i),s=await eS(t.privateKey),a=await s.sign(o.subarray());return new kS({peerId:t,payloadType:r,payload:i,signature:a})})),Dr(AS,"openAndCertify",(async(e,t)=>{const n=await kS.createFromProtobuf(e);if(!await n.validate(t))throw new tf("envelope signature is not valid for the given domain",bS);return n}));const SS=(e,t,n)=>{const r=Fs(e),i=Lo(r.byteLength),o=Lo(t.length),s=Lo(n.length);return new Kr(i,r,o,t,s,n)};const xS=Uint8Array.from([3,1]);var _S,IS;!function(e){let t,n;!function(e){let t;e.codec=()=>(null==t&&(t=oa((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.multiaddr&&e.multiaddr.byteLength>0&&(t.uint32(10),t.bytes(e.multiaddr)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={multiaddr:new Uint8Array(0)},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();if(t>>>3===1)n.multiaddr=e.bytes();else e.skipType(7&t)}return n}))),t),e.encode=t=>Xs(t,e.codec()),e.decode=t=>$o(t,e.codec())}(t=e.AddressInfo||(e.AddressInfo={})),e.codec=()=>(null==n&&(n=oa((function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==r.lengthDelimited&&n.fork(),null!=t.peerId&&t.peerId.byteLength>0&&(n.uint32(10),n.bytes(t.peerId)),null!=t.seq&&0n!==t.seq&&(n.uint32(16),n.uint64(t.seq)),null!=t.addresses)for(const i of t.addresses)n.uint32(26),e.AddressInfo.codec().encode(i,n);!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={peerId:new Uint8Array(0),seq:0n,addresses:[]},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.peerId=t.bytes();break;case 2:r.seq=t.uint64();break;case 3:r.addresses.push(e.AddressInfo.codec().decode(t,t.uint32()));break;default:t.skipType(7&n)}}return r}))),n),e.encode=t=>Xs(t,e.codec()),e.decode=t=>$o(t,e.codec())}(_S||(_S={}));class RS{constructor(e){Dr(this,"peerId",void 0),Dr(this,"multiaddrs",void 0),Dr(this,"seqNumber",void 0),Dr(this,"domain",RS.DOMAIN),Dr(this,"codec",RS.CODEC),Dr(this,"marshaled",void 0);const{peerId:t,multiaddrs:n,seqNumber:r}=e;this.peerId=t,this.multiaddrs=null!==n&&void 0!==n?n:[],this.seqNumber=null!==r&&void 0!==r?r:BigInt(Date.now())}marshal(){return null==this.marshaled&&(this.marshaled=_S.encode({peerId:this.peerId.toBytes(),seq:BigInt(this.seqNumber),addresses:this.multiaddrs.map((e=>({multiaddr:e.bytes})))})),this.marshaled}equals(e){return e instanceof RS&&(!!this.peerId.equals(e.peerId)&&(this.seqNumber===e.seqNumber&&!!function(e,t){const n=(e,t)=>e.toString().localeCompare(t.toString());return e.length===t.length&&(t.sort(n),e.sort(n).every(((e,n)=>t[n].equals(e))))}(this.multiaddrs,e.multiaddrs)))}}IS=RS,Dr(RS,"createFromProtobuf",(e=>{var t;const n=_S.decode(e),r=np(n.peerId),i=(null!==(t=n.addresses)&&void 0!==t?t:[]).map((e=>Dg(e.multiaddr))),o=n.seq;return new IS({peerId:r,multiaddrs:i,seqNumber:o})})),Dr(RS,"DOMAIN","libp2p-peer-record"),Dr(RS,"CODEC",xS);const CS={ERR_INVALID_PARAMETERS:"ERR_INVALID_PARAMETERS"};var TS,PS,NS;function BS(e,t){var n;const r=TS.decode(t);null!=r.publicKey&&null==e.publicKey&&(e=function(e){if("RSA"===e.type)return new Xf(e);if("Ed25519"===e.type)return new $f(e);if("secp256k1"===e.type)return new ep(e);throw new tf("Not a PeerId","ERR_INVALID_PARAMETERS")}({...e,publicKey:e.publicKey}));const i=new Map,o=BigInt(Date.now());for(const[s,a]of r.tags.entries())null!=a.expiry&&a.expiry<o||i.set(s,a);return{...r,id:e,addresses:r.addresses.map((e=>{let{multiaddr:t,isCertified:n}=e;return{multiaddr:Dg(t),isCertified:null!==n&&void 0!==n&&n}})),metadata:r.metadata,peerRecordEnvelope:null!==(n=r.peerRecordEnvelope)&&void 0!==n?n:void 0,tags:i}}!function(e){let t,n,r;!function(e){let t;e.codec=()=>(null==t&&(t=oa((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.key&&""!==e.key&&(t.uint32(10),t.string(e.key)),null!=e.value&&e.value.byteLength>0&&(t.uint32(18),t.bytes(e.value)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={key:"",value:new Uint8Array(0)},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.key=e.string();break;case 2:n.value=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>Xs(t,e.codec()),e.decode=t=>$o(t,e.codec())}(t=e.Peer$metadataEntry||(e.Peer$metadataEntry={})),function(e){let t;e.codec=()=>(null==t&&(t=oa((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.key&&""!==e.key&&(t.uint32(10),t.string(e.key)),null!=e.value&&(t.uint32(18),NS.codec().encode(e.value,t)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={key:""},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.key=e.string();break;case 2:n.value=NS.codec().decode(e,e.uint32());break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>Xs(t,e.codec()),e.decode=t=>$o(t,e.codec())}(n=e.Peer$tagsEntry||(e.Peer$tagsEntry={})),e.codec=()=>(null==r&&(r=oa((function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==r.lengthDelimited&&n.fork(),null!=t.addresses)for(const e of t.addresses)n.uint32(10),PS.codec().encode(e,n);if(null!=t.protocols)for(const e of t.protocols)n.uint32(18),n.string(e);if(null!=t.publicKey&&(n.uint32(34),n.bytes(t.publicKey)),null!=t.peerRecordEnvelope&&(n.uint32(42),n.bytes(t.peerRecordEnvelope)),null!=t.metadata&&0!==t.metadata.size)for(const[i,o]of t.metadata.entries())n.uint32(50),e.Peer$metadataEntry.codec().encode({key:i,value:o},n);if(null!=t.tags&&0!==t.tags.size)for(const[i,o]of t.tags.entries())n.uint32(58),e.Peer$tagsEntry.codec().encode({key:i,value:o},n);!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={addresses:[],protocols:[],metadata:new Map,tags:new Map},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.addresses.push(PS.codec().decode(t,t.uint32()));break;case 2:r.protocols.push(t.string());break;case 4:r.publicKey=t.bytes();break;case 5:r.peerRecordEnvelope=t.bytes();break;case 6:{const n=e.Peer$metadataEntry.codec().decode(t,t.uint32());r.metadata.set(n.key,n.value);break}case 7:{const n=e.Peer$tagsEntry.codec().decode(t,t.uint32());r.tags.set(n.key,n.value);break}default:t.skipType(7&n)}}return r}))),r),e.encode=t=>Xs(t,e.codec()),e.decode=t=>$o(t,e.codec())}(TS||(TS={})),function(e){let t;e.codec=()=>(null==t&&(t=oa((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.multiaddr&&e.multiaddr.byteLength>0&&(t.uint32(10),t.bytes(e.multiaddr)),null!=e.isCertified&&(t.uint32(16),t.bool(e.isCertified)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={multiaddr:new Uint8Array(0)},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.multiaddr=e.bytes();break;case 2:n.isCertified=e.bool();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>Xs(t,e.codec()),e.decode=t=>$o(t,e.codec())}(PS||(PS={})),function(e){let t;e.codec=()=>(null==t&&(t=oa((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.value&&0!==e.value&&(t.uint32(8),t.uint32(e.value)),null!=e.expiry&&(t.uint32(16),t.uint64(e.expiry)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={value:0},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.value=e.uint32();break;case 2:n.expiry=e.uint64();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>Xs(t,e.codec()),e.decode=t=>$o(t,e.codec())}(NS||(NS={}));const DS="/peers/";function OS(e){if(!Gf(e)||null==e.type)throw new tf("Invalid PeerId",CS.ERR_INVALID_PARAMETERS);const t=e.toCID().toString();return new Dv("".concat(DS).concat(t))}async function LS(e,t,n){const r=new Map;for(const o of n){var i;if(null==o)continue;if(o.multiaddr instanceof Uint8Array&&(o.multiaddr=Dg(o.multiaddr)),!Bg(o.multiaddr))throw new tf("Multiaddr was invalid",CS.ERR_INVALID_PARAMETERS);if(!await t(e,o.multiaddr))continue;const n=null!==(i=o.isCertified)&&void 0!==i&&i,s=o.multiaddr.toString(),a=r.get(s);null!=a?o.isCertified=a.isCertified||n:r.set(s,{multiaddr:o.multiaddr,isCertified:n})}return[...r.values()].sort(((e,t)=>e.multiaddr.toString().localeCompare(t.multiaddr.toString()))).map((e=>{let{isCertified:t,multiaddr:n}=e;return{isCertified:t,multiaddr:n.bytes}}))}async function MS(e,t,n,r){var i,o,s,a,c,l,u;if(null==t)throw new tf("Invalid PeerData",CS.ERR_INVALID_PARAMETERS);if(null!=t.publicKey&&null!=e.publicKey&&!zr(t.publicKey,e.publicKey))throw new tf("publicKey bytes do not match peer id publicKey bytes",CS.ERR_INVALID_PARAMETERS);const d=r.existingPeer;if(null!=d&&!e.equals(d.id))throw new tf("peer id did not match existing peer id",CS.ERR_INVALID_PARAMETERS);let h=null!==(i=null===d||void 0===d?void 0:d.addresses)&&void 0!==i?i:[],f=new Set(null!==(o=null===d||void 0===d?void 0:d.protocols)&&void 0!==o?o:[]),p=null!==(s=null===d||void 0===d?void 0:d.metadata)&&void 0!==s?s:new Map,g=null!==(a=null===d||void 0===d?void 0:d.tags)&&void 0!==a?a:new Map,m=null===d||void 0===d?void 0:d.peerRecordEnvelope;if("patch"===n){if(null==t.multiaddrs&&null==t.addresses||(h=[],null!=t.multiaddrs&&h.push(...t.multiaddrs.map((e=>({isCertified:!1,multiaddr:e})))),null!=t.addresses&&h.push(...t.addresses)),null!=t.protocols&&(f=new Set(t.protocols)),null!=t.metadata){p=FS(t.metadata instanceof Map?[...t.metadata.entries()]:Object.entries(t.metadata),{validate:US})}if(null!=t.tags){g=FS(t.tags instanceof Map?[...t.tags.entries()]:Object.entries(t.tags),{validate:jS,map:HS})}null!=t.peerRecordEnvelope&&(m=t.peerRecordEnvelope)}if("merge"===n){if(null!=t.multiaddrs&&h.push(...t.multiaddrs.map((e=>({isCertified:!1,multiaddr:e})))),null!=t.addresses&&h.push(...t.addresses),null!=t.protocols&&(f=new Set([...f,...t.protocols])),null!=t.metadata){const e=t.metadata instanceof Map?[...t.metadata.entries()]:Object.entries(t.metadata);for(const[t,n]of e)null==n?p.delete(t):p.set(t,n);p=FS([...p.entries()],{validate:US})}if(null!=t.tags){const e=t.tags instanceof Map?[...t.tags.entries()]:Object.entries(t.tags),n=new Map(g);for(const[t,r]of e)null==r?n.delete(t):n.set(t,r);g=FS([...n.entries()],{validate:jS,map:HS})}null!=t.peerRecordEnvelope&&(m=t.peerRecordEnvelope)}const v={addresses:await LS(e,null!==(c=r.addressFilter)&&void 0!==c?c:async()=>!0,h),protocols:[...f.values()].sort(((e,t)=>e.localeCompare(t))),metadata:p,tags:g,publicKey:null!==(l=null!==(u=null===d||void 0===d?void 0:d.id.publicKey)&&void 0!==u?u:t.publicKey)&&void 0!==l?l:e.publicKey,peerRecordEnvelope:m};return"RSA"!==e.type&&delete v.publicKey,v}function FS(e,t){const n=new Map;for(const[o,s]of e)null!=s&&t.validate(o,s);for(const[o,s]of e.sort(((e,t)=>{let[n]=e,[r]=t;return n.localeCompare(r)}))){var r,i;if(null!=s)n.set(o,null!==(r=null===(i=t.map)||void 0===i?void 0:i.call(t,o,s))&&void 0!==r?r:s)}return n}function US(e,t){if("string"!==typeof e)throw new tf("Metadata key must be a string",CS.ERR_INVALID_PARAMETERS);if(!(t instanceof Uint8Array))throw new tf("Metadata value must be a Uint8Array",CS.ERR_INVALID_PARAMETERS)}function jS(e,t){if("string"!==typeof e)throw new tf("Tag name must be a string",CS.ERR_INVALID_PARAMETERS);if(null!=t.value){if(parseInt("".concat(t.value),10)!==t.value)throw new tf("Tag value must be an integer",CS.ERR_INVALID_PARAMETERS);if(t.value<0||t.value>100)throw new tf("Tag value must be between 0-100",CS.ERR_INVALID_PARAMETERS)}if(null!=t.ttl){if(parseInt("".concat(t.ttl),10)!==t.ttl)throw new tf("Tag ttl must be an integer",CS.ERR_INVALID_PARAMETERS);if(t.ttl<0)throw new tf("Tag ttl must be between greater than 0",CS.ERR_INVALID_PARAMETERS)}}function HS(e,t){var n;let r;return null!=t.expiry&&(r=t.expiry),null!=t.ttl&&(r=BigInt(Date.now()+Number(t.ttl))),{value:null!==(n=t.value)&&void 0!==n?n:0,expiry:r}}function zS(e,t,n){const r=e.toString().split("/")[2],i=np(ai.decode(r)),o=n.get(i);if(null!=o)return o;const s=BS(i,t);return n.set(i,s),s}var VS=new WeakSet;class qS{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Au(this,VS),Dr(this,"peerId",void 0),Dr(this,"datastore",void 0),Dr(this,"lock",void 0),Dr(this,"addressFilter",void 0),this.peerId=e.peerId,this.datastore=e.datastore,this.addressFilter=t.addressFilter,this.lock=_y({name:"peer-store",singleProcess:!0})}async has(e){return this.datastore.has(OS(e))}async delete(e){if(this.peerId.equals(e))throw new tf("Cannot delete self peer",CS.ERR_INVALID_PARAMETERS);await this.datastore.delete(OS(e))}async load(e){return BS(e,await this.datastore.get(OS(e)))}async save(e,t){const{existingBuf:n,existingPeer:r}=await xu(VS,this,GS).call(this,e),i=await MS(e,t,"patch",{addressFilter:this.addressFilter});return xu(VS,this,KS).call(this,e,i,n,r)}async patch(e,t){const{existingBuf:n,existingPeer:r}=await xu(VS,this,GS).call(this,e),i=await MS(e,t,"patch",{addressFilter:this.addressFilter,existingPeer:r});return xu(VS,this,KS).call(this,e,i,n,r)}async merge(e,t){const{existingBuf:n,existingPeer:r}=await xu(VS,this,GS).call(this,e),i=await MS(e,t,"merge",{addressFilter:this.addressFilter,existingPeer:r});return xu(VS,this,KS).call(this,e,i,n,r)}async*all(e){const t=new op;for await(const{key:n,value:r}of this.datastore.query(function(e,t){var n,r;return null==e?{}:{prefix:DS,filters:(null!==(n=e.filters)&&void 0!==n?n:[]).map((e=>n=>{let{key:r,value:i}=n;return e(zS(r,i,t))})),orders:(null!==(r=e.orders)&&void 0!==r?r:[]).map((e=>(n,r)=>e(zS(n.key,n.value,t),zS(r.key,r.value,t))))}}(null!==e&&void 0!==e?e:{},t))){const e=zS(n,r,t);e.id.equals(this.peerId)||(yield e)}}}async function GS(e){try{const t=await this.datastore.get(OS(e));return{existingBuf:t,existingPeer:BS(e,t)}}catch(t){if("ERR_NOT_FOUND"!==t.code)throw t}return{}}async function KS(e,t,n,r){const i=TS.encode(t);return null!=n&&zr(i,n)?{peer:BS(e,i),previous:r,updated:!1}:(await this.datastore.put(OS(e),i),{peer:BS(e,i),previous:r,updated:!0})}var WS=new WeakSet;class QS{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Au(this,WS),Dr(this,"store",void 0),Dr(this,"events",void 0),Dr(this,"peerId",void 0),Dr(this,"log",void 0),this.log=e.logger.forComponent("libp2p:peer-store"),this.events=e.events,this.peerId=e.peerId,this.store=new qS(e,t)}async forEach(e,t){this.log.trace("forEach await read lock");const n=await this.store.lock.readLock();this.log.trace("forEach got read lock");try{for await(const n of this.store.all(t))e(n)}finally{this.log.trace("forEach release read lock"),n()}}async all(e){this.log.trace("all await read lock");const t=await this.store.lock.readLock();this.log.trace("all got read lock");try{return await Md(this.store.all(e))}finally{this.log.trace("all release read lock"),t()}}async delete(e){this.log.trace("delete await write lock");const t=await this.store.lock.writeLock();this.log.trace("delete got write lock");try{await this.store.delete(e)}finally{this.log.trace("delete release write lock"),t()}}async has(e){this.log.trace("has await read lock");const t=await this.store.lock.readLock();this.log.trace("has got read lock");try{return await this.store.has(e)}finally{this.log.trace("has release read lock"),t()}}async get(e){this.log.trace("get await read lock");const t=await this.store.lock.readLock();this.log.trace("get got read lock");try{return await this.store.load(e)}finally{this.log.trace("get release read lock"),t()}}async save(e,t){this.log.trace("save await write lock");const n=await this.store.lock.writeLock();this.log.trace("save got write lock");try{const n=await this.store.save(e,t);return xu(WS,this,YS).call(this,e,n),n.peer}finally{this.log.trace("save release write lock"),n()}}async patch(e,t){this.log.trace("patch await write lock");const n=await this.store.lock.writeLock();this.log.trace("patch got write lock");try{const n=await this.store.patch(e,t);return xu(WS,this,YS).call(this,e,n),n.peer}finally{this.log.trace("patch release write lock"),n()}}async merge(e,t){this.log.trace("merge await write lock");const n=await this.store.lock.writeLock();this.log.trace("merge got write lock");try{const n=await this.store.merge(e,t);return xu(WS,this,YS).call(this,e,n),n.peer}finally{this.log.trace("merge release write lock"),n()}}async consumePeerRecord(e,t){var n;const r=await AS.openAndCertify(e,RS.DOMAIN);if(!1===(null===t||void 0===t?void 0:t.equals(r.peerId)))return this.log("envelope peer id was not the expected peer id - expected: %p received: %p",t,r.peerId),!1;const i=RS.createFromProtobuf(r.payload);let o;try{o=await this.get(r.peerId)}catch(s){if("ERR_NOT_FOUND"!==s.code)throw s}if(null!=(null===(n=o)||void 0===n?void 0:n.peerRecordEnvelope)){const e=await AS.createFromProtobuf(o.peerRecordEnvelope),t=RS.createFromProtobuf(e.payload);if(t.seqNumber>=i.seqNumber)return this.log("sequence number was lower or equal to existing sequence number - stored: %d received: %d",t.seqNumber,i.seqNumber),!1}return await this.patch(i.peerId,{peerRecordEnvelope:e,addresses:i.multiaddrs.map((e=>({isCertified:!0,multiaddr:e})))}),!0}}function YS(e,t){t.updated&&(this.peerId.equals(e)?this.events.safeDispatchEvent("self:peer:update",{detail:t}):this.events.safeDispatchEvent("peer:update",{detail:t}))}const ZS=e=>e;function JS(e,t){const n=e.getPeerId();if(null!=n){tp(n).equals(t)&&(e=e.decapsulate(Dg("/p2p/".concat(t.toString()))))}return e}class XS{constructor(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Dr(this,"log",void 0),Dr(this,"components",void 0),Dr(this,"listen",void 0),Dr(this,"announce",void 0),Dr(this,"observed",void 0),Dr(this,"announceFilter",void 0);const{listen:r=[],announce:i=[]}=n;this.components=e,this.log=e.logger.forComponent("libp2p:address-manager"),this.listen=r.map((e=>e.toString())),this.announce=new Set(i.map((e=>e.toString()))),this.observed=new Map,this.announceFilter=null!==(t=n.announceFilter)&&void 0!==t?t:ZS,this._updatePeerStoreAddresses=function(e,t){let n;return function(){clearTimeout(n),n=setTimeout((function(){n=void 0,e()}),t)}}(this._updatePeerStoreAddresses.bind(this),1e3),e.events.addEventListener("transport:listening",(()=>{this._updatePeerStoreAddresses()})),e.events.addEventListener("transport:close",(()=>{this._updatePeerStoreAddresses()}))}_updatePeerStoreAddresses(){const e=this.getAnnounceAddrs().concat(this.components.transportManager.getAddrs()).concat([...this.observed.entries()].filter((e=>{let[t,n]=e;return n.confident})).map((e=>{let[t]=e;return Dg(t)}))).map((e=>e.getPeerId()===this.components.peerId.toString()?e.decapsulate("/p2p/".concat(this.components.peerId.toString())):e));this.components.peerStore.patch(this.components.peerId,{multiaddrs:e}).catch((e=>{this.log.error("error updating addresses",e)}))}getListenAddrs(){return Array.from(this.listen).map((e=>Dg(e)))}getAnnounceAddrs(){return Array.from(this.announce).map((e=>Dg(e)))}getObservedAddrs(){return Array.from(this.observed).map((e=>{let[t]=e;return Dg(t)}))}addObservedAddr(e){const t=(e=JS(e,this.components.peerId)).toString();this.observed.has(t)||this.observed.set(t,{confident:!1})}confirmObservedAddr(e){var t;const n=(e=JS(e,this.components.peerId)).toString(),r=(null!==(t=this.observed.get(n))&&void 0!==t?t:{confident:!1}).confident;this.observed.set(n,{confident:!0}),r||this._updatePeerStoreAddresses()}removeObservedAddr(e){const t=(e=JS(e,this.components.peerId)).toString();this.observed.delete(t)}getAddresses(){let e=this.getAnnounceAddrs().map((e=>e.toString()));0===e.length&&(e=this.components.transportManager.getAddrs().map((e=>e.toString()))),e=e.concat(Array.from(this.observed).filter((e=>{let[t,n]=e;return n.confident})).map((e=>{let[t]=e;return t})));const t=new Set(e);return this.announceFilter(Array.from(t).map((e=>Dg(e)))).map((e=>{var t;return!0===(null===(t=e.protos().pop())||void 0===t?void 0:t.path)||e.getPeerId()===this.components.peerId.toString()?e:e.encapsulate("/p2p/".concat(this.components.peerId.toString()))}))}}class $S{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Dr(this,"components",{}),Dr(this,"_started",!1),this.components={};for(const[t,n]of Object.entries(e))this.components[t]=n;null==this.components.logger&&(this.components.logger=Od())}isStarted(){return this._started}async _invokeStartableMethod(e){await Promise.all(Object.values(this.components).filter((e=>Hv(e))).map((async t=>{var n;await(null===(n=t[e])||void 0===n?void 0:n.call(t))})))}async beforeStart(){await this._invokeStartableMethod("beforeStart")}async start(){await this._invokeStartableMethod("start"),this._started=!0}async afterStart(){await this._invokeStartableMethod("afterStart")}async beforeStop(){await this._invokeStartableMethod("beforeStop")}async stop(){await this._invokeStartableMethod("stop"),this._started=!1}async afterStop(){await this._invokeStartableMethod("afterStop")}}const ex=["metrics","connectionProtector","dns"],tx=["components","isStarted","beforeStart","start","afterStart","beforeStop","stop","afterStop","then","_invokeStartableMethod"];function nx(){return{denyDialPeer:async()=>!1,denyDialMultiaddr:async e=>{const t=e.stringTuples();return(4===t[0][0]||41===t[0][0])&&Boolean($p("".concat(t[0][1])))},denyInboundConnection:async()=>!1,denyOutboundConnection:async()=>!1,denyInboundEncryptedConnection:async()=>!1,denyOutboundEncryptedConnection:async()=>!1,denyInboundUpgradedConnection:async()=>!1,denyOutboundUpgradedConnection:async()=>!1,filterMultiaddrForPeer:async()=>!0,...arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}}}const rx=Symbol.for("@libp2p/transport");var ix;function ox(e){try{const{address:t}=e.nodeAddress();return Boolean($p(t))}catch{return!0}}function sx(e,t){const n=function(e,t){const n=ox(e.multiaddr),r=ox(t.multiaddr);return n&&!r?1:!n&&r?-1:0}(e,t);if(0!==n)return n;const r=function(e,t){const n=mm.exactMatch(e.multiaddr),r=mm.exactMatch(t.multiaddr);return n&&!r?1:!n&&r?-1:0}(e,t);if(0!==r)return r;const i=function(e,t){return e.isCertified&&!t.isCertified?-1:!e.isCertified&&t.isCertified?1:0}(e,t);return i}!function(e){e[e.FATAL_ALL=0]="FATAL_ALL",e[e.NO_FATAL=1]="NO_FATAL"}(ix||(ix={}));const{code:ax}=ag("dnsaddr"),cx=async function(e){var t,n,r;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=null!==(t=i.maxRecursiveDepth)&&void 0!==t?t:32;if(0===o)throw new tf("Max recursive depth reached","ERR_MAX_RECURSIVE_DEPTH_REACHED");const[,s]=null!==(n=e.stringTuples().find((e=>{let[t]=e;return t===ax})))&&void 0!==n?n:[],a=null!==(r=null===i||void 0===i?void 0:i.dns)&&void 0!==r?r:$v(),c=await a.query("_dnsaddr.".concat(s),{signal:null===i||void 0===i?void 0:i.signal,types:[Xv.TXT]}),l=e.getPeerId(),u=[];for(const d of c.Answer){const e=d.data.split("=")[1];if(null==e)continue;if(null!=l&&!e.includes(l))continue;const t=Dg(e);if(e.startsWith("/dnsaddr")){const e=await t.resolve({...i,maxRecursiveDepth:o-1});u.push(...e.map((e=>e.toString())))}else u.push(t.toString())}return u};var lx,ux;!function(e){e.NOT_STARTED_YET="The libp2p node is not started yet",e.ERR_PROTECTOR_REQUIRED="Private network is enforced, but no protector was provided",e.NOT_FOUND="Not found"}(lx||(lx={})),function(e){e.ERR_PROTECTOR_REQUIRED="ERR_PROTECTOR_REQUIRED",e.ERR_PEER_DIAL_INTERCEPTED="ERR_PEER_DIAL_INTERCEPTED",e.ERR_CONNECTION_INTERCEPTED="ERR_CONNECTION_INTERCEPTED",e.ERR_INVALID_PROTOCOLS_FOR_STREAM="ERR_INVALID_PROTOCOLS_FOR_STREAM",e.ERR_CONNECTION_ENDED="ERR_CONNECTION_ENDED",e.ERR_CONNECTION_FAILED="ERR_CONNECTION_FAILED",e.ERR_NODE_NOT_STARTED="ERR_NODE_NOT_STARTED",e.ERR_ALREADY_ABORTED="ERR_ALREADY_ABORTED",e.ERR_TOO_MANY_ADDRESSES="ERR_TOO_MANY_ADDRESSES",e.ERR_NO_VALID_ADDRESSES="ERR_NO_VALID_ADDRESSES",e.ERR_RELAYED_DIAL="ERR_RELAYED_DIAL",e.ERR_DIALED_SELF="ERR_DIALED_SELF",e.ERR_DISCOVERED_SELF="ERR_DISCOVERED_SELF",e.ERR_DUPLICATE_TRANSPORT="ERR_DUPLICATE_TRANSPORT",e.ERR_ENCRYPTION_FAILED="ERR_ENCRYPTION_FAILED",e.ERR_HOP_REQUEST_FAILED="ERR_HOP_REQUEST_FAILED",e.ERR_INVALID_KEY="ERR_INVALID_KEY",e.ERR_INVALID_MESSAGE="ERR_INVALID_MESSAGE",e.ERR_INVALID_PARAMETERS="ERR_INVALID_PARAMETERS",e.ERR_INVALID_PEER="ERR_INVALID_PEER",e.ERR_MUXER_UNAVAILABLE="ERR_MUXER_UNAVAILABLE",e.ERR_NOT_FOUND="ERR_NOT_FOUND",e.ERR_TRANSPORT_UNAVAILABLE="ERR_TRANSPORT_UNAVAILABLE",e.ERR_TRANSPORT_DIAL_FAILED="ERR_TRANSPORT_DIAL_FAILED",e.ERR_UNSUPPORTED_PROTOCOL="ERR_UNSUPPORTED_PROTOCOL",e.ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED="ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED",e.ERR_INVALID_MULTIADDR="ERR_INVALID_MULTIADDR",e.ERR_SIGNATURE_NOT_VALID="ERR_SIGNATURE_NOT_VALID",e.ERR_FIND_SELF="ERR_FIND_SELF",e.ERR_NO_ROUTERS_AVAILABLE="ERR_NO_ROUTERS_AVAILABLE",e.ERR_CONNECTION_NOT_MULTIPLEXED="ERR_CONNECTION_NOT_MULTIPLEXED",e.ERR_NO_DIAL_TOKENS="ERR_NO_DIAL_TOKENS",e.ERR_INVALID_CMS="ERR_INVALID_CMS",e.ERR_MISSING_KEYS="ERR_MISSING_KEYS",e.ERR_NO_KEY="ERR_NO_KEY",e.ERR_INVALID_KEY_NAME="ERR_INVALID_KEY_NAME",e.ERR_INVALID_KEY_TYPE="ERR_INVALID_KEY_TYPE",e.ERR_KEY_ALREADY_EXISTS="ERR_KEY_ALREADY_EXISTS",e.ERR_INVALID_KEY_SIZE="ERR_INVALID_KEY_SIZE",e.ERR_KEY_NOT_FOUND="ERR_KEY_NOT_FOUND",e.ERR_OLD_KEY_NAME_INVALID="ERR_OLD_KEY_NAME_INVALID",e.ERR_NEW_KEY_NAME_INVALID="ERR_NEW_KEY_NAME_INVALID",e.ERR_PASSWORD_REQUIRED="ERR_PASSWORD_REQUIRED",e.ERR_PEM_REQUIRED="ERR_PEM_REQUIRED",e.ERR_CANNOT_READ_KEY="ERR_CANNOT_READ_KEY",e.ERR_MISSING_PRIVATE_KEY="ERR_MISSING_PRIVATE_KEY",e.ERR_MISSING_PUBLIC_KEY="ERR_MISSING_PUBLIC_KEY",e.ERR_INVALID_OLD_PASS_TYPE="ERR_INVALID_OLD_PASS_TYPE",e.ERR_INVALID_NEW_PASS_TYPE="ERR_INVALID_NEW_PASS_TYPE",e.ERR_INVALID_PASS_LENGTH="ERR_INVALID_PASS_LENGTH",e.ERR_NOT_IMPLEMENTED="ERR_NOT_IMPLEMENTED",e.ERR_WRONG_PING_ACK="ERR_WRONG_PING_ACK",e.ERR_INVALID_RECORD="ERR_INVALID_RECORD",e.ERR_ALREADY_SUCCEEDED="ERR_ALREADY_SUCCEEDED",e.ERR_NO_HANDLER_FOR_PROTOCOL="ERR_NO_HANDLER_FOR_PROTOCOL",e.ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS="ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS",e.ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS="ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS",e.ERR_CONNECTION_DENIED="ERR_CONNECTION_DENIED",e.ERR_TRANSFER_LIMIT_EXCEEDED="ERR_TRANSFER_LIMIT_EXCEEDED"}(ux||(ux={}));const dx={addresses:{listen:[],announce:[],noAnnounce:[],announceFilter:e=>e},connectionManager:{resolvers:{dnsaddr:cx},addressSorter:sx},transportManager:{faultTolerance:ix.FATAL_ALL}};const hx=()=>{const e=new Error("Delay aborted");return e.name="AbortError",e},fx=new WeakMap;const px=function(){let{clearTimeout:e,setTimeout:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(n){let r,i,o,{value:s,signal:a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null!==a&&void 0!==a&&a.aborted)return Promise.reject(hx());const c=null!==e&&void 0!==e?e:clearTimeout,l=()=>{c(r),o(hx())},u=new Promise(((e,c)=>{i=()=>{a&&a.removeEventListener("abort",l),e(s)},o=c,r=(null!==t&&void 0!==t?t:setTimeout)(i,n)}));return a&&a.addEventListener("abort",l,{once:!0}),fx.set(u,(()=>{c(r),r=null,i()})),u}}(),gx=px;class mx{constructor(){var e,t,n,r,i,o;let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Dr(this,"memoryStorage",void 0),Dr(this,"points",void 0),Dr(this,"duration",void 0),Dr(this,"blockDuration",void 0),Dr(this,"execEvenly",void 0),Dr(this,"execEvenlyMinDelayMs",void 0),Dr(this,"keyPrefix",void 0),this.points=null!==(e=s.points)&&void 0!==e?e:4,this.duration=null!==(t=s.duration)&&void 0!==t?t:1,this.blockDuration=null!==(n=s.blockDuration)&&void 0!==n?n:0,this.execEvenly=null!==(r=s.execEvenly)&&void 0!==r&&r,this.execEvenlyMinDelayMs=null!==(i=s.execEvenlyMinDelayMs)&&void 0!==i?i:1e3*this.duration/this.points,this.keyPrefix=null!==(o=s.keyPrefix)&&void 0!==o?o:"rlflx",this.memoryStorage=new vx}async consume(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=this.getKey(e),i=this._getKeySecDuration(n);let o=this.memoryStorage.incrby(r,t,i);if(o.remainingPoints=Math.max(this.points-o.consumedPoints,0),o.consumedPoints>this.points)throw this.blockDuration>0&&o.consumedPoints<=this.points+t&&(o=this.memoryStorage.set(r,o.consumedPoints,this.blockDuration)),new tf("Rate limit exceeded","ERR_RATE_LIMIT_EXCEEDED",o);if(this.execEvenly&&o.msBeforeNext>0&&!o.isFirstInDuration){let e=Math.ceil(o.msBeforeNext/(o.remainingPoints+2));e<this.execEvenlyMinDelayMs&&(e=o.consumedPoints*this.execEvenlyMinDelayMs),await gx(e)}return o}penalty(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=this.getKey(e),i=this._getKeySecDuration(n),o=this.memoryStorage.incrby(r,t,i);return o.remainingPoints=Math.max(this.points-o.consumedPoints,0),o}reward(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=this.getKey(e),i=this._getKeySecDuration(n),o=this.memoryStorage.incrby(r,-t,i);return o.remainingPoints=Math.max(this.points-o.consumedPoints,0),o}block(e,t){const n=1e3*t,r=this.points+1;return this.memoryStorage.set(this.getKey(e),r,t),{remainingPoints:0,msBeforeNext:0===n?-1:n,consumedPoints:r,isFirstInDuration:!1}}set(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=1e3*(n>=0?n:this.duration);return this.memoryStorage.set(this.getKey(e),t,n),{remainingPoints:0,msBeforeNext:0===r?-1:r,consumedPoints:t,isFirstInDuration:!1}}get(e){const t=this.memoryStorage.get(this.getKey(e));return null!=t&&(t.remainingPoints=Math.max(this.points-t.consumedPoints,0)),t}delete(e){this.memoryStorage.delete(this.getKey(e))}_getKeySecDuration(e){return null!=(null===e||void 0===e?void 0:e.customDuration)&&e.customDuration>=0?e.customDuration:this.duration}getKey(e){return this.keyPrefix.length>0?"".concat(this.keyPrefix,":").concat(e):e}parseKey(e){return e.substring(this.keyPrefix.length)}}class vx{constructor(){Dr(this,"storage",void 0),this.storage=new Map}incrby(e,t,n){const r=this.storage.get(e);if(null!=r){const i=null!=r.expiresAt?r.expiresAt.getTime()-(new Date).getTime():-1;return null==r.expiresAt||i>0?(r.value+=t,{remainingPoints:0,msBeforeNext:i,consumedPoints:r.value,isFirstInDuration:!1}):this.set(e,t,n)}return this.set(e,t,n)}set(e,t,n){const r=1e3*n,i=this.storage.get(e);null!=i&&clearTimeout(i.timeoutId);const o={value:t,expiresAt:r>0?new Date(Date.now()+r):void 0};return this.storage.set(e,o),r>0&&(o.timeoutId=setTimeout((()=>{this.storage.delete(e)}),r),null!=o.timeoutId.unref&&o.timeoutId.unref()),{remainingPoints:0,msBeforeNext:0===r?-1:r,consumedPoints:o.value,isFirstInDuration:!0}}get(e){const t=this.storage.get(e);if(null!=t){return{remainingPoints:0,msBeforeNext:null!=t.expiresAt?t.expiresAt.getTime()-(new Date).getTime():-1,consumedPoints:t.value,isFirstInDuration:!1}}}delete(e){const t=this.storage.get(e);return null!=t&&(null!=t.timeoutId&&clearTimeout(t.timeoutId),this.storage.delete(e),!0)}}function yx(e){if(Gf(e))return{peerId:e,multiaddrs:[]};let t;if(Array.isArray(e)||(e=[e]),e.length>0){const n=e[0].getPeerId();t=null==n?void 0:tp(n),e.forEach((e=>{if(!Bg(e))throw new tf("Invalid Multiaddr",ux.ERR_INVALID_MULTIADDR);const n=e.getPeerId();if(null==n){if(null!=t)throw new tf("Multiaddrs must all have the same peer id or have no peer id",ux.ERR_INVALID_PARAMETERS)}else{const e=tp(n);if(null==t||!t.equals(e))throw new tf("Multiaddrs must all have the same peer id or have no peer id",ux.ERR_INVALID_PARAMETERS)}}))}return{peerId:t,multiaddrs:e}}const wx="last-dial-failure",bx={minConnections:5,maxQueueLength:100,autoDialConcurrency:25,autoDialPriority:0,autoDialInterval:5e3,autoDialPeerRetryThreshold:42e4,autoDialDiscoveredPeersDebounce:10};class Ex{constructor(e,t){var n,r,i,o,s,a,c;let l;Dr(this,"connectionManager",void 0),Dr(this,"peerStore",void 0),Dr(this,"queue",void 0),Dr(this,"minConnections",void 0),Dr(this,"autoDialPriority",void 0),Dr(this,"autoDialIntervalMs",void 0),Dr(this,"autoDialMaxQueueLength",void 0),Dr(this,"autoDialPeerRetryThresholdMs",void 0),Dr(this,"autoDialDiscoveredPeersDebounce",void 0),Dr(this,"autoDialInterval",void 0),Dr(this,"started",void 0),Dr(this,"running",void 0),Dr(this,"log",void 0),this.connectionManager=e.connectionManager,this.peerStore=e.peerStore,this.minConnections=null!==(n=t.minConnections)&&void 0!==n?n:bx.minConnections,this.autoDialPriority=null!==(r=t.autoDialPriority)&&void 0!==r?r:bx.autoDialPriority,this.autoDialIntervalMs=null!==(i=t.autoDialInterval)&&void 0!==i?i:bx.autoDialInterval,this.autoDialMaxQueueLength=null!==(o=t.maxQueueLength)&&void 0!==o?o:bx.maxQueueLength,this.autoDialPeerRetryThresholdMs=null!==(s=t.autoDialPeerRetryThreshold)&&void 0!==s?s:bx.autoDialPeerRetryThreshold,this.autoDialDiscoveredPeersDebounce=null!==(a=t.autoDialDiscoveredPeersDebounce)&&void 0!==a?a:bx.autoDialDiscoveredPeersDebounce,this.log=e.logger.forComponent("libp2p:connection-manager:auto-dial"),this.started=!1,this.running=!1,this.queue=new mf({concurrency:null!==(c=t.autoDialConcurrency)&&void 0!==c?c:bx.autoDialConcurrency,metricName:"libp2p_autodial_queue",metrics:e.metrics}),this.queue.addEventListener("error",(e=>{this.log.error("error during auto-dial",e.detail)})),e.events.addEventListener("connection:close",(()=>{this.autoDial().catch((e=>{this.log.error(e)}))})),e.events.addEventListener("peer:discovery",(()=>{clearTimeout(l),l=setTimeout((()=>{this.autoDial().catch((e=>{this.log.error(e)}))}),this.autoDialDiscoveredPeersDebounce)}))}isStarted(){return this.started}start(){this.started=!0}afterStart(){this.autoDial().catch((e=>{this.log.error("error while autodialing",e)}))}stop(){this.queue.clear(),clearTimeout(this.autoDialInterval),this.started=!1,this.running=!1}async autoDial(){if(!this.started||this.running)return;const e=this.connectionManager.getConnectionsMap(),t=e.size;if(t>=this.minConnections)return void(this.minConnections>0&&this.log.trace("have enough connections %d/%d",t,this.minConnections));if(this.queue.size>this.autoDialMaxQueueLength)return this.log("not enough connections %d/%d but auto dial queue is full",t,this.minConnections),void this.sheduleNextAutodial();this.running=!0,this.log("not enough connections %d/%d - will dial peers to increase the number of connections",t,this.minConnections);const n=new vS(this.connectionManager.getDialQueue().map((e=>e.peerId)).filter(Boolean)),r=await this.peerStore.all({filters:[t=>0===t.addresses.length?(this.log.trace("not autodialing %p because they have no addresses",t.id),!1):e.has(t.id)?(this.log.trace("not autodialing %p because they are already connected",t.id),!1):n.has(t.id)?(this.log.trace("not autodialing %p because they are already being dialed",t.id),!1):!this.queue.has(t.id)||(this.log.trace("not autodialing %p because they are already being autodialed",t.id),!1)]}),i=r.sort((()=>Math.random()>.5?1:-1)),o=new op;for(const a of i)o.has(a.id)||o.set(a.id,[...a.tags.values()].reduce(((e,t)=>e+t.value),0));const s=i.sort(((e,t)=>{var n,r;const i=null!==(n=o.get(e.id))&&void 0!==n?n:0,s=null!==(r=o.get(t.id))&&void 0!==r?r:0;return i>s?-1:i<s?1:0})).filter((e=>{const t=e.metadata.get(wx);if(null==t)return!0;const n=parseInt(cp(t));return!!isNaN(n)||Date.now()-n>this.autoDialPeerRetryThresholdMs}));this.log("selected %d/%d peers to dial",s.length,r.length);for(const a of s)this.queue.add((async()=>{const e=this.connectionManager.getConnectionsMap().size;if(e>=this.minConnections)return this.log("got enough connections now %d/%d",e,this.minConnections),void this.queue.clear();this.log("connecting to a peerStore stored peer %p",a.id),await this.connectionManager.openConnection(a.id,{priority:this.autoDialPriority})}),{peerId:a.id}).catch((e=>{this.log.error("could not connect to peerStore stored peer",e)}));this.running=!1,this.sheduleNextAutodial()}sheduleNextAutodial(){this.started&&(this.autoDialInterval=setTimeout((()=>{this.autoDial().catch((e=>{this.log.error("error while autodialing",e)}))}),this.autoDialIntervalMs))}}const kx={maxConnections:100,allow:[]};class Ax{constructor(e){var t,n;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Dr(this,"maxConnections",void 0),Dr(this,"connectionManager",void 0),Dr(this,"peerStore",void 0),Dr(this,"allow",void 0),Dr(this,"events",void 0),Dr(this,"log",void 0),this.maxConnections=null!==(t=r.maxConnections)&&void 0!==t?t:kx.maxConnections,this.allow=null!==(n=r.allow)&&void 0!==n?n:kx.allow,this.connectionManager=e.connectionManager,this.peerStore=e.peerStore,this.events=e.events,this.log=e.logger.forComponent("libp2p:connection-manager:connection-pruner"),e.events.addEventListener("connection:open",(()=>{this.maybePruneConnections().catch((e=>{this.log.error(e)}))}))}async maybePruneConnections(){const e=this.connectionManager.getConnections(),t=e.length,n=Math.max(t-this.maxConnections,0);if(this.log("checking max connections limit %d/%d",t,this.maxConnections),t<=this.maxConnections)return;this.log("max connections limit exceeded %d/%d, pruning %d connection(s)",t,this.maxConnections,n);const r=new op;for(const a of e){const e=a.remotePeer;if(!r.has(e)){r.set(e,0);try{const t=await this.peerStore.get(e);r.set(e,[...t.tags.values()].reduce(((e,t)=>e+t.value),0))}catch(s){"ERR_NOT_FOUND"!==s.code&&this.log.error("error loading peer tags",s)}}}const i=e.sort(((e,t)=>{var n,i;const o=null!==(n=r.get(e.remotePeer))&&void 0!==n?n:0,s=null!==(i=r.get(t.remotePeer))&&void 0!==i?i:0;if(o>s)return 1;if(o<s)return-1;const a=e.timeline.open,c=t.timeline.open;return a<c?1:a>c?-1:0})),o=[];for(const a of i){this.log("too many connections open - closing a connection to %p",a.remotePeer);if(this.allow.some((e=>a.remoteAddr.toString().startsWith(e.toString())))||o.push(a),o.length===n)break}await Promise.all(o.map((async e=>{try{await e.close()}catch(s){this.log.error(s)}}))),this.events.safeDispatchEvent("connection:prune",{detail:o})}}const Sx={addressSorter:sx,maxParallelDials:50,maxDialQueueLength:500,maxPeerAddrsToDial:25,dialTimeout:5e3,resolvers:{dnsaddr:cx}};class xx{constructor(e){var t,n,r,i,o,s;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Dr(this,"queue",void 0),Dr(this,"components",void 0),Dr(this,"addressSorter",void 0),Dr(this,"maxPeerAddrsToDial",void 0),Dr(this,"maxDialQueueLength",void 0),Dr(this,"dialTimeout",void 0),Dr(this,"shutDownController",void 0),Dr(this,"connections",void 0),Dr(this,"log",void 0),this.addressSorter=null!==(t=a.addressSorter)&&void 0!==t?t:Sx.addressSorter,this.maxPeerAddrsToDial=null!==(n=a.maxPeerAddrsToDial)&&void 0!==n?n:Sx.maxPeerAddrsToDial,this.maxDialQueueLength=null!==(r=a.maxDialQueueLength)&&void 0!==r?r:Sx.maxDialQueueLength,this.dialTimeout=null!==(i=a.dialTimeout)&&void 0!==i?i:Sx.dialTimeout,this.connections=null!==(o=a.connections)&&void 0!==o?o:new op,this.log=e.logger.forComponent("libp2p:connection-manager:dial-queue"),this.components=e,this.shutDownController=new AbortController,Wh(1/0,this.shutDownController.signal);for(const[l,u]of Object.entries(null!==(c=a.resolvers)&&void 0!==c?c:{})){var c;Ng.set(l,u)}this.queue=new gf({concurrency:null!==(s=a.maxParallelDials)&&void 0!==s?s:Sx.maxParallelDials,metricName:"libp2p_dial_queue",metrics:e.metrics}),this.queue.addEventListener("error",(e=>{this.log.error("error in dial queue",e.detail)}))}start(){this.shutDownController=new AbortController,Wh(1/0,this.shutDownController.signal)}stop(){this.shutDownController.abort(),this.queue.abort()}async dial(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{peerId:n,multiaddrs:r}=yx(e),i=Array.from(this.connections.values()).flat().find((e=>!0!==t.force&&(!!e.remotePeer.equals(n)||r.find((t=>t.equals(e.remoteAddr))))));if(null!=i)return this.log("already connected to %a",i.remoteAddr),i;const o=this.queue.queue.find((e=>{if(!0===(null===n||void 0===n?void 0:n.equals(e.options.peerId)))return!0;const t=e.options.multiaddrs;if(null==t)return!1;for(const n of r)if(t.has(n.toString()))return!0;return!1}));if(null!=o){this.log("joining existing dial target for %p",n);for(const e of r)o.options.multiaddrs.add(e.toString());return o.join(t)}if(this.queue.size>=this.maxDialQueueLength)throw new tf("Dial queue is full","ERR_DIAL_QUEUE_FULL");return this.log("creating dial target for %p",n,r.map((e=>e.toString()))),this.queue.add((async e=>{const t=this.createDialAbortController(null===e||void 0===e?void 0:e.signal);let r;try{r=await this.calculateMultiaddrs(n,null===e||void 0===e?void 0:e.multiaddrs,{...e,signal:t}),r.map((e=>{let{multiaddr:t}=e;return t.toString()})).forEach((t=>{null===e||void 0===e||e.multiaddrs.add(t)}))}catch(i){throw t.clear(),i}try{let o=0;const s=[];for(const a of r){if(o===this.maxPeerAddrsToDial)throw this.log("dialed maxPeerAddrsToDial (%d) addresses for %p, not trying any others",o,n),new tf("Peer had more than maxPeerAddrsToDial",ux.ERR_TOO_MANY_ADDRESSES);o++;try{const n=await this.components.transportManager.dial(a.multiaddr,{...e,signal:t});return this.log("dial to %a succeeded",a.multiaddr),n}catch(i){if(this.log.error("dial failed to %a",a.multiaddr,i),null!=n)try{await this.components.peerStore.patch(n,{metadata:{[wx]:Fs(Date.now().toString())}})}catch(i){this.log.error("could not update last dial failure key for %p",n,i)}if(t.aborted)throw new tf(i.message,af);s.push(i)}}if(1===s.length)throw s[0];throw new nf(s,"All multiaddr dials failed",ux.ERR_TRANSPORT_DIAL_FAILED)}finally{t.clear()}}),{peerId:n,priority:t.priority,multiaddrs:new Set(r.map((e=>e.toString()))),signal:t.signal})}createDialAbortController(e){const t=Qh([AbortSignal.timeout(this.dialTimeout),this.shutDownController.signal,e]);return Wh(1/0,t),t}async calculateMultiaddrs(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Set,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=[...t].map((e=>({multiaddr:Dg(e),isCertified:!1})));if(null!=e){var i,o;if(this.components.peerId.equals(e))throw new tf("Tried to dial self",ux.ERR_DIALED_SELF);if(!0===await(null===(i=(o=this.components.connectionGater).denyDialPeer)||void 0===i?void 0:i.call(o,e)))throw new tf("The dial request is blocked by gater.allowDialPeer",ux.ERR_PEER_DIAL_INTERCEPTED);if(0===r.length){this.log("loading multiaddrs for %p",e);try{const t=await this.components.peerStore.get(e);r.push(...t.addresses),this.log("loaded multiaddrs for %p",e,r.map((e=>{let{multiaddr:t}=e;return t.toString()})))}catch(h){if(h.code!==ux.ERR_NOT_FOUND)throw h}}if(0===r.length){this.log("looking up multiaddrs for %p in the peer routing",e);try{const t=await this.components.peerRouting.findPeer(e);this.log("found multiaddrs for %p in the peer routing",e,r.map((e=>{let{multiaddr:t}=e;return t.toString()}))),r.push(...t.multiaddrs.map((e=>({multiaddr:e,isCertified:!1}))))}catch(h){h.code!==ux.ERR_NO_ROUTERS_AVAILABLE&&this.log.error("looking up multiaddrs for %p in the peer routing failed",e,h)}}}let s=(await Promise.all(r.map((async e=>{const t=await async function(e,t){let n=!1;for(const i of Ng.keys())if(n=e.protoNames().includes(i),n)break;if(!n)return[e];const r=await e.resolve(t);return t.log("resolved %s to",e,r.map((e=>e.toString()))),r}(e.multiaddr,{dns:this.components.dns,...n,log:this.log});return 1===t.length&&t[0].equals(e.multiaddr)?e:t.map((e=>({multiaddr:e,isCertified:!1})))})))).flat();if(null!=e){const t="/p2p/".concat(e.toString());s=s.map((e=>{const n=e.multiaddr.protos().pop();return!0===(null===n||void 0===n?void 0:n.path)?e:null==e.multiaddr.getPeerId()?{multiaddr:e.multiaddr.encapsulate(t),isCertified:e.isCertified}:e}))}const a=s.filter((t=>{if(null==this.components.transportManager.dialTransportForMultiaddr(t.multiaddr))return!1;const n=t.multiaddr.getPeerId();return null==e||null==n||e.equals(n)})),c=new Map;for(const f of a){const e=f.multiaddr.toString(),t=c.get(e);null==t?c.set(e,f):t.isCertified=t.isCertified||f.isCertified||!1}const l=[...c.values()];if(0===l.length)throw new tf("The dial request has no valid addresses",ux.ERR_NO_VALID_ADDRESSES);const u=[];for(const f of l)null!=this.components.connectionGater.denyDialMultiaddr&&await this.components.connectionGater.denyDialMultiaddr(f.multiaddr)||u.push(f);const d=u.sort(this.addressSorter);if(0===d.length)throw new tf("The connection gater denied all addresses in the dial request",ux.ERR_NO_VALID_ADDRESSES);return this.log.trace("addresses for %p before filtering",null!==e&&void 0!==e?e:"unknown peer",s.map((e=>{let{multiaddr:t}=e;return t.toString()}))),this.log.trace("addresses for %p after filtering",null!==e&&void 0!==e?e:"unknown peer",d.map((e=>{let{multiaddr:t}=e;return t.toString()}))),d}async isDialable(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Array.isArray(e)||(e=[e]);try{const n=await this.calculateMultiaddrs(void 0,new Set(e.map((e=>e.toString()))),t);return!1!==t.runOnTransientConnection||null!=n.find((e=>!mm.matches(e.multiaddr)))}catch(n){this.log.trace("error calculating if multiaddr(s) were dialable",n)}return!1}}const _x=5,Ix=100,Rx=5,Cx=10,Tx=25,Px=0,Nx=100;class Bx{constructor(e){var t,n,r,i,o,s,a,c,l,u,d,h,f,p,g;let m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Dr(this,"started",void 0),Dr(this,"connections",void 0),Dr(this,"allow",void 0),Dr(this,"deny",void 0),Dr(this,"maxIncomingPendingConnections",void 0),Dr(this,"incomingPendingConnections",void 0),Dr(this,"maxConnections",void 0),Dr(this,"dialQueue",void 0),Dr(this,"autoDial",void 0),Dr(this,"connectionPruner",void 0),Dr(this,"inboundConnectionRateLimiter",void 0),Dr(this,"peerStore",void 0),Dr(this,"metrics",void 0),Dr(this,"events",void 0),Dr(this,"log",void 0),this.maxConnections=null!==(t=m.maxConnections)&&void 0!==t?t:Ix;const v=null!==(n=m.minConnections)&&void 0!==n?n:_x;if(this.maxConnections<v)throw new tf("Connection Manager maxConnections must be greater than minConnections",ux.ERR_INVALID_PARAMETERS);this.connections=new op,this.started=!1,this.peerStore=e.peerStore,this.metrics=e.metrics,this.events=e.events,this.log=e.logger.forComponent("libp2p:connection-manager"),this.onConnect=this.onConnect.bind(this),this.onDisconnect=this.onDisconnect.bind(this),this.events.addEventListener("connection:open",this.onConnect),this.events.addEventListener("connection:close",this.onDisconnect),this.allow=(null!==(r=m.allow)&&void 0!==r?r:[]).map((e=>Dg(e))),this.deny=(null!==(i=m.deny)&&void 0!==i?i:[]).map((e=>Dg(e))),this.incomingPendingConnections=0,this.maxIncomingPendingConnections=null!==(o=m.maxIncomingPendingConnections)&&void 0!==o?o:Cx,this.inboundConnectionRateLimiter=new mx({points:null!==(s=m.inboundConnectionThreshold)&&void 0!==s?s:Rx,duration:1}),this.autoDial=new Ex({connectionManager:this,peerStore:e.peerStore,events:e.events,logger:e.logger},{minConnections:v,autoDialConcurrency:null!==(a=m.autoDialConcurrency)&&void 0!==a?a:Tx,autoDialPriority:null!==(c=m.autoDialPriority)&&void 0!==c?c:Px,maxQueueLength:null!==(l=m.autoDialMaxQueueLength)&&void 0!==l?l:Nx}),this.connectionPruner=new Ax({connectionManager:this,peerStore:e.peerStore,events:e.events,logger:e.logger},{maxConnections:this.maxConnections,allow:this.allow}),this.dialQueue=new xx(e,{addressSorter:null!==(u=m.addressSorter)&&void 0!==u?u:sx,maxParallelDials:null!==(d=m.maxParallelDials)&&void 0!==d?d:50,maxDialQueueLength:null!==(h=m.maxDialQueueLength)&&void 0!==h?h:500,maxPeerAddrsToDial:null!==(f=m.maxPeerAddrsToDial)&&void 0!==f?f:25,dialTimeout:null!==(p=m.dialTimeout)&&void 0!==p?p:5e3,resolvers:null!==(g=m.resolvers)&&void 0!==g?g:{dnsaddr:cx},connections:this.connections})}isStarted(){return this.started}async start(){var e,t,n;null===(e=this.metrics)||void 0===e||e.registerMetricGroup("libp2p_connection_manager_connections",{calculate:()=>{const e={inbound:0,outbound:0};for(const t of this.connections.values())for(const n of t)"inbound"===n.direction?e.inbound++:e.outbound++;return e}}),null===(t=this.metrics)||void 0===t||t.registerMetricGroup("libp2p_protocol_streams_total",{label:"protocol",calculate:()=>{const e={};for(const r of this.connections.values())for(const i of r)for(const r of i.streams){var t,n;const i="".concat(r.direction," ").concat(null!==(t=r.protocol)&&void 0!==t?t:"unnegotiated");e[i]=(null!==(n=e[i])&&void 0!==n?n:0)+1}return e}}),null===(n=this.metrics)||void 0===n||n.registerMetricGroup("libp2p_connection_manager_protocol_streams_per_connection_90th_percentile",{label:"protocol",calculate:()=>{const e={};for(const o of this.connections.values())for(const i of o){const o={};for(const e of i.streams){var t,n;const r="".concat(e.direction," ").concat(null!==(t=e.protocol)&&void 0!==t?t:"unnegotiated");o[r]=(null!==(n=o[r])&&void 0!==n?n:0)+1}for(const[t,n]of Object.entries(o)){var r;e[t]=null!==(r=e[t])&&void 0!==r?r:[],e[t].push(n)}}const i={};for(let[o,s]of Object.entries(e)){s=s.sort(((e,t)=>e-t));const e=Math.floor(.9*s.length);i[o]=s[e]}return i}}),this.dialQueue.start(),this.autoDial.start(),this.started=!0,this.log("started")}async afterStart(){Promise.resolve().then((async()=>{const e=await this.peerStore.all({filters:[e=>e.tags.has("keep-alive")]});await Promise.all(e.map((async e=>{await this.openConnection(e.id).catch((e=>{this.log.error(e)}))})))})).catch((e=>{this.log.error(e)})),this.autoDial.afterStart()}async stop(){this.dialQueue.stop(),this.autoDial.stop();const e=[];for(const t of this.connections.values())for(const n of t)e.push((async()=>{try{await n.close()}catch(e){this.log.error(e)}})());this.log("closing %d connections",e.length),await Promise.all(e),this.connections.clear(),this.log("stopped")}onConnect(e){this._onConnect(e).catch((e=>{this.log.error(e)}))}async _onConnect(e){const{detail:t}=e;if(!this.started)return void await t.close();const n=t.remotePeer,r=this.connections.get(n);let i=!1;null!=r?r.push(t):(i=!0,this.connections.set(n,[t])),null!=n.publicKey&&"RSA"===n.type&&await this.peerStore.patch(n,{publicKey:n.publicKey}),i&&this.events.safeDispatchEvent("peer:connect",{detail:t.remotePeer})}onDisconnect(e){const{detail:t}=e;if(!this.started)return;const n=t.remotePeer;let r=this.connections.get(n);null!=r&&r.length>1?(r=r.filter((e=>e.id!==t.id)),this.connections.set(n,r)):null!=r&&(this.connections.delete(n),this.events.safeDispatchEvent("peer:disconnect",{detail:t.remotePeer}))}getConnections(e){var t;if(null!=e)return null!==(t=this.connections.get(e))&&void 0!==t?t:[];let n=[];for(const r of this.connections.values())n=n.concat(r);return n}getConnectionsMap(){return this.connections}async openConnection(e){var t,n;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isStarted())throw new tf("Not started",ux.ERR_NODE_NOT_STARTED);null===(t=r.signal)||void 0===t||t.throwIfAborted();const{peerId:i}=yx(e);if(null!=i&&!0!==r.force){this.log("dial %p",i);const e=this.getConnections(i).find((e=>!e.transient));if(null!=e)return this.log("had an existing non-transient connection to %p",i),e}const o=await this.dialQueue.dial(e,{...r,priority:null!==(n=r.priority)&&void 0!==n?n:50});let s=this.connections.get(o.remotePeer);null==s&&(s=[],this.connections.set(o.remotePeer,s));let a=!1;for(const c of s)c.id===o.id&&(a=!0);return a||s.push(o),o}async closeConnections(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=null!==(t=this.connections.get(e))&&void 0!==t?t:[];await Promise.all(r.map((async e=>{try{await e.close(n)}catch(t){e.abort(t)}})))}async acceptIncomingConnection(e){if(this.deny.some((t=>e.remoteAddr.toString().startsWith(t.toString()))))return this.log("connection from %a refused - connection remote address was in deny list",e.remoteAddr),!1;if(this.allow.some((t=>e.remoteAddr.toString().startsWith(t.toString()))))return this.incomingPendingConnections++,!0;if(this.incomingPendingConnections===this.maxIncomingPendingConnections)return this.log("connection from %a refused - incomingPendingConnections exceeded by host",e.remoteAddr),!1;if(e.remoteAddr.isThinWaistAddress()){const t=e.remoteAddr.nodeAddress().address;try{await this.inboundConnectionRateLimiter.consume(t,1)}catch{return this.log("connection from %a refused - inboundConnectionThreshold exceeded by host %s",e.remoteAddr,t),!1}}return this.getConnections().length<this.maxConnections?(this.incomingPendingConnections++,!0):(this.log("connection from %a refused - maxConnections exceeded",e.remoteAddr),!1)}afterUpgradeInbound(){this.incomingPendingConnections--}getDialQueue(){const e={queued:"queued",running:"active",errored:"error",complete:"success"};return this.dialQueue.queue.queue.map((t=>({id:t.id,status:e[t.status],peerId:t.options.peerId,multiaddrs:[...t.options.multiaddrs].map((e=>Dg(e)))})))}async isDialable(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.dialQueue.isDialable(e,t)}}class Dx{constructor(e,t){var n;Dr(this,"routers",void 0),Dr(this,"started",void 0),Dr(this,"components",void 0),this.routers=null!==(n=t.routers)&&void 0!==n?n:[],this.started=!1,this.components=e}isStarted(){return this.started}async start(){this.started=!0}async stop(){this.started=!1}findProviders(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){if(0===t.routers.length)throw new tf("No content routers available",ux.ERR_NO_ROUTERS_AVAILABLE);const r=t,i=new vS;for await(const o of pu(...r.routers.map((t=>t.findProviders(e,n)))))null!=o&&(o.multiaddrs.length>0&&await t.components.peerStore.merge(o.id,{multiaddrs:o.multiaddrs}),i.has(o.id)||(i.add(o.id),yield o))}()}catch(BJ){return Promise.reject(BJ)}}async provide(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===this.routers.length)throw new tf("No content routers available",ux.ERR_NO_ROUTERS_AVAILABLE);await Promise.all(this.routers.map((async n=>{await n.provide(e,t)})))}async put(e,t,n){if(!this.isStarted())throw new tf(lx.NOT_STARTED_YET,ux.ERR_NODE_NOT_STARTED);await Promise.all(this.routers.map((async r=>{await r.put(e,t,n)})))}async get(e,t){if(!this.isStarted())throw new tf(lx.NOT_STARTED_YET,ux.ERR_NODE_NOT_STARTED);return Promise.any(this.routers.map((async n=>n.get(e,t))))}}class Ox{constructor(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Dr(this,"log",void 0),Dr(this,"peerId",void 0),Dr(this,"peerStore",void 0),Dr(this,"routers",void 0),this.log=e.logger.forComponent("libp2p:peer-routing"),this.peerId=e.peerId,this.peerStore=e.peerStore,this.routers=null!==(t=n.routers)&&void 0!==t?t:[]}async findPeer(e,t){if(0===this.routers.length)throw new tf("No peer routers available",ux.ERR_NO_ROUTERS_AVAILABLE);if(e.toString()===this.peerId.toString())throw new tf("Should not try to find self",ux.ERR_FIND_SELF);const n=this,r=pu(...this.routers.map((r=>async function*(){try{yield await r.findPeer(e,t)}catch(i){n.log.error(i)}}())));for await(const i of r)if(null!=i)return i.multiaddrs.length>0&&await this.peerStore.merge(i.id,{multiaddrs:i.multiaddrs}),i;throw new tf(lx.NOT_FOUND,ux.ERR_NOT_FOUND)}getClosestPeers(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){if(0===t.routers.length)throw new tf("No peer routers available",ux.ERR_NO_ROUTERS_AVAILABLE);const r=t,i=new vS;for await(const o of cu(async function*(){const t=pu(...r.routers.map((t=>t.getClosestPeers(e,n))));for await(let e of t)yield async()=>{if(0===e.multiaddrs.length)try{e=await r.findPeer(e.id,{...n,useCache:!1})}catch(t){return void r.log.error("could not find peer multiaddrs",t)}return e}}()))null!=o&&(o.multiaddrs.length>0&&await t.peerStore.merge(o.id,{multiaddrs:o.multiaddrs}),i.has(o.id)||(i.add(o.id),yield o))}()}catch(BJ){return Promise.reject(BJ)}}}class Lx extends Jh{constructor(e){super(),Dr(this,"peerRouting",void 0),Dr(this,"log",void 0),Dr(this,"walking",void 0),Dr(this,"walkers",void 0),Dr(this,"shutdownController",void 0),Dr(this,"walkController",void 0),Dr(this,"needNext",void 0),this.log=e.logger.forComponent("libp2p:random-walk"),this.peerRouting=e.peerRouting,this.walkers=0,this.walking=!1,this.shutdownController=new AbortController,Wh(1/0,this.shutdownController.signal)}start(){this.shutdownController=new AbortController,Wh(1/0,this.shutdownController.signal)}stop(){this.shutdownController.abort()}async*walk(e){this.walking||this.startWalk(),this.walkers++;const t=Qh([this.shutdownController.signal,null===e||void 0===e?void 0:e.signal]);Wh(1/0,t);try{for(;;){var n;null===(n=this.needNext)||void 0===n||n.resolve(),this.needNext=ou();const e=await uf(this,"walk:peer",t,{errorEvent:"walk:error"});yield e.detail}}finally{var r;if(t.clear(),this.walkers--,0===this.walkers)null===(r=this.walkController)||void 0===r||r.abort(),this.walkController=void 0}}startWalk(){this.walking=!0,this.walkController=new AbortController,Wh(1/0,this.walkController.signal);const e=Qh([this.walkController.signal,this.shutdownController.signal]);Wh(1/0,e);const t=Date.now();let n=0;Promise.resolve().then((async()=>{for(this.log("start walk");this.walkers>0;)try{for await(const t of this.peerRouting.getClosestPeers(Np(32),{signal:e}))e.throwIfAborted(),this.log("found peer %p",t.id),n++,this.safeDispatchEvent("walk:peer",{detail:t}),1===this.walkers&&null!=this.needNext&&await hf(this.needNext.promise,e)}catch(t){this.log.error("randomwalk errored",t),this.safeDispatchEvent("walk:error",{detail:t})}})).catch((e=>{this.log.error("randomwalk errored",e)})).finally((()=>{this.log("finished walk, found %d peers after %dms",n,Date.now()-t),this.walking=!1}))}}class Mx{constructor(e){Dr(this,"log",void 0),Dr(this,"topologies",void 0),Dr(this,"handlers",void 0),Dr(this,"components",void 0),this.log=e.logger.forComponent("libp2p:registrar"),this.topologies=new Map,this.handlers=new Map,this.components=e,this._onDisconnect=this._onDisconnect.bind(this),this._onPeerUpdate=this._onPeerUpdate.bind(this),this._onPeerIdentify=this._onPeerIdentify.bind(this),this.components.events.addEventListener("peer:disconnect",this._onDisconnect),this.components.events.addEventListener("peer:update",this._onPeerUpdate),this.components.events.addEventListener("peer:identify",this._onPeerIdentify)}getProtocols(){return Array.from(new Set([...this.handlers.keys()])).sort()}getHandler(e){const t=this.handlers.get(e);if(null==t)throw new tf("No handler registered for protocol ".concat(e),ux.ERR_NO_HANDLER_FOR_PROTOCOL);return t}getTopologies(e){const t=this.topologies.get(e);return null==t?[]:[...t.values()]}async handle(e,t,n){if(this.handlers.has(e))throw new tf("Handler already registered for protocol ".concat(e),ux.ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED);const r=Ad.bind({ignoreUndefined:!0})({maxInboundStreams:32,maxOutboundStreams:64},n);this.handlers.set(e,{handler:t,options:r}),await this.components.peerStore.merge(this.components.peerId,{protocols:[e]})}async unhandle(e){(Array.isArray(e)?e:[e]).forEach((e=>{this.handlers.delete(e)})),await this.components.peerStore.patch(this.components.peerId,{protocols:this.getProtocols()})}async register(e,t){if(null==t)throw new tf("invalid topology",ux.ERR_INVALID_PARAMETERS);const n="".concat((1e9*Math.random()).toString(36)).concat(Date.now());let r=this.topologies.get(e);return null==r&&(r=new Map,this.topologies.set(e,r)),r.set(n,t),n}unregister(e){for(const[t,n]of this.topologies.entries())n.has(e)&&(n.delete(e),0===n.size&&this.topologies.delete(t))}_onDisconnect(e){const t=e.detail;this.components.peerStore.get(t).then((e=>{for(const r of e.protocols){const e=this.topologies.get(r);if(null!=e)for(const r of e.values()){var n;null===(n=r.onDisconnect)||void 0===n||n.call(r,t)}}})).catch((e=>{e.code!==ux.ERR_NOT_FOUND&&this.log.error("could not inform topologies of disconnecting peer %p",t,e)}))}_onPeerUpdate(e){var t;const{peer:n,previous:r}=e.detail,i=(null!==(t=null===r||void 0===r?void 0:r.protocols)&&void 0!==t?t:[]).filter((e=>!n.protocols.includes(e)));for(const s of i){const e=this.topologies.get(s);if(null!=e)for(const t of e.values()){var o;null===(o=t.onDisconnect)||void 0===o||o.call(t,n.id)}}}_onPeerIdentify(e){const t=e.detail.protocols,n=e.detail.connection,r=e.detail.peerId;for(const o of t){const e=this.topologies.get(o);if(null!=e)for(const t of e.values()){var i;n.transient&&!0!==t.notifyOnTransient||(null===(i=t.onConnect)||void 0===i||i.call(t,r,n))}}}}class Fx{constructor(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Dr(this,"log",void 0),Dr(this,"components",void 0),Dr(this,"transports",void 0),Dr(this,"listeners",void 0),Dr(this,"faultTolerance",void 0),Dr(this,"started",void 0),this.log=e.logger.forComponent("libp2p:transports"),this.components=e,this.started=!1,this.transports=new Map,this.listeners=Up({name:"libp2p_transport_manager_listeners",metrics:this.components.metrics}),this.faultTolerance=null!==(t=n.faultTolerance)&&void 0!==t?t:ix.FATAL_ALL}add(e){const t=e[Symbol.toStringTag];if(null==t)throw new tf("Transport must have a valid tag",ux.ERR_INVALID_KEY);if(this.transports.has(t))throw new tf("There is already a transport with the tag ".concat(t),ux.ERR_DUPLICATE_TRANSPORT);this.log("adding transport %s",t),this.transports.set(t,e),this.listeners.has(t)||this.listeners.set(t,[])}isStarted(){return this.started}start(){this.started=!0}async afterStart(){const e=this.components.addressManager.getListenAddrs();await this.listen(e)}async stop(){const e=[];for(const[t,n]of this.listeners)for(this.log("closing listeners for %s",t);n.length>0;){const t=n.pop();null!=t&&e.push(t.close())}await Promise.all(e),this.log("all listeners closed");for(const t of this.listeners.keys())this.listeners.set(t,[]);this.started=!1}async dial(e,t){const n=this.dialTransportForMultiaddr(e);if(null==n)throw new tf("No transport available for address ".concat(String(e)),ux.ERR_TRANSPORT_UNAVAILABLE);try{return await n.dial(e,{...t,upgrader:this.components.upgrader})}catch(r){throw null==r.code&&(r.code=ux.ERR_TRANSPORT_DIAL_FAILED),r}}getAddrs(){let e=[];for(const t of this.listeners.values())for(const n of t)e=[...e,...n.getAddrs()];return e}getTransports(){return Array.of(...this.transports.values())}getListeners(){return Array.of(...this.listeners.values()).flat()}dialTransportForMultiaddr(e){for(const t of this.transports.values()){if(t.dialFilter([e]).length>0)return t}}listenTransportForMultiaddr(e){for(const t of this.transports.values()){if(t.listenFilter([e]).length>0)return t}}async listen(e){if(!this.isStarted())throw new tf("Not started",ux.ERR_NODE_NOT_STARTED);if(null==e||0===e.length)return void this.log("no addresses were provided for listening, this node is dial only");const t=[];for(const[r,i]of this.transports.entries()){const o=i.listenFilter(e),s=[];for(const e of o){var n;this.log("creating listener for %s on %a",r,e);const t=i.createListener({upgrader:this.components.upgrader});let o=null!==(n=this.listeners.get(r))&&void 0!==n?n:[];null==o&&(o=[],this.listeners.set(r,o)),o.push(t),t.addEventListener("listening",(()=>{this.components.events.safeDispatchEvent("transport:listening",{detail:t})})),t.addEventListener("close",(()=>{const e=o.findIndex((e=>e===t));o.splice(e,1),this.components.events.safeDispatchEvent("transport:close",{detail:t})})),s.push(t.listen(e))}if(0===s.length){t.push(r);continue}if(null==(await Promise.allSettled(s)).find((e=>"fulfilled"===e.status))&&this.faultTolerance!==ix.NO_FATAL)throw new tf("Transport (".concat(r,") could not listen on any available address"),ux.ERR_NO_VALID_ADDRESSES)}if(t.length===this.transports.size){const e="no valid addresses were provided for transports [".concat(t.join(", "),"]");if(this.faultTolerance===ix.FATAL_ALL)throw new tf(e,ux.ERR_NO_VALID_ADDRESSES);this.log("libp2p in dial mode only: ".concat(e))}}async remove(e){var t;const n=null!==(t=this.listeners.get(e))&&void 0!==t?t:[];this.log.trace("removing transport %s",e);const r=[];for(this.log.trace("closing listeners for %s",e);n.length>0;){const e=n.pop();null!=e&&r.push(e.close())}await Promise.all(r),this.transports.delete(e),this.listeners.delete(e)}async removeAll(){const e=[];for(const t of this.transports.keys())e.push(this.remove(t));await Promise.all(e)}}class Ux{constructor(){Dr(this,"readNext",void 0),Dr(this,"haveNext",void 0),Dr(this,"ended",void 0),Dr(this,"nextResult",void 0),this.ended=!1,this.readNext=ou(),this.haveNext=ou()}[Symbol.asyncIterator](){return this}async next(){if(null==this.nextResult&&await this.haveNext.promise,null==this.nextResult)throw new Error("HaveNext promise resolved but nextResult was undefined");const e=this.nextResult;return this.nextResult=void 0,this.readNext.resolve(),this.readNext=ou(),e}async throw(e){this.ended=!0,null!=e&&this.haveNext.reject(e);return{done:!0,value:void 0}}async return(){const e={done:!0,value:void 0};return await this._push(void 0),e}async push(e,t){await this._push(e,t)}async end(e,t){null!=e?await this.throw(e):await this._push(void 0,t)}async _push(e,t){if(null!=e&&this.ended)throw new Error("Cannot push value onto an ended pushable");if(null!=this.nextResult&&(await this.readNext.promise,null!=this.nextResult))throw new Error("NeedNext promise resolved but nextResult was not consumed");null!=e?this.nextResult={done:!1,value:e}:(this.ended=!0,this.nextResult={done:!0,value:void 0}),this.haveNext.resolve(),this.haveNext=ou(),await hf(this.readNext.promise,null===t||void 0===t?void 0:t.signal,t)}}class jx extends Error{constructor(e,t){super(e),Dr(this,"code",void 0),this.code=t}}class Hx extends jx{constructor(e){super(e,"ABORT_ERR"),Dr(this,"type",void 0),this.type="aborted"}}function zx(e,t){const n=new Ux;e.sink(n).catch((async e=>{await n.end(e)})),e.sink=async e=>{for await(const t of e)await n.push(t);await n.end()};let r=e.source;null!=e.source[Symbol.iterator]?r=e.source[Symbol.iterator]():null!=e.source[Symbol.asyncIterator]&&(r=e.source[Symbol.asyncIterator]());const i=new Kr,o={read:async(e,t)=>{var n;let o;null===t||void 0===t||null===(n=t.signal)||void 0===n||n.throwIfAborted();const s=new Promise(((e,n)=>{var r;o=()=>{n(new Hx("Read aborted"))},null===t||void 0===t||null===(r=t.signal)||void 0===r||r.addEventListener("abort",o)}));try{if(null==e){const{done:e,value:t}=await Promise.race([r.next(),s]);return!0===e?new Kr:t}for(;i.byteLength<e;){const{value:e,done:t}=await Promise.race([r.next(),s]);if(!0===t)throw new jx("unexpected end of input","ERR_UNEXPECTED_EOF");i.append(e)}const t=i.sublist(0,e);return i.consume(e),t}finally{var a;if(null!=o)null===t||void 0===t||null===(a=t.signal)||void 0===a||a.removeEventListener("abort",o)}},write:async(e,t)=>{var r;null===t||void 0===t||null===(r=t.signal)||void 0===r||r.throwIfAborted(),e instanceof Uint8Array?await n.push(e,t):await n.push(e.subarray(),t)},unwrap:()=>{if(i.byteLength>0){const n=e.source;e.source=async function*(){!1===(null===t||void 0===t?void 0:t.yieldBytes)?yield i:yield*i,yield*n}()}return e}};return o}class Vx extends Error{constructor(e,t){super(e),Dr(this,"code",void 0),this.code=t}}function qx(e){var t,n;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=zx(e,r);null!=r.maxDataLength&&null==r.maxLengthLength&&(r.maxLengthLength=Bo(r.maxDataLength));const o=null!==(t=null===r||void 0===r?void 0:r.lengthDecoder)&&void 0!==t?t:Mo,s=null!==(n=null===r||void 0===r?void 0:r.lengthEncoder)&&void 0!==n?n:Lo,a={read:async e=>{let t=-1;const n=new Kr;for(;;){n.append(await i.read(1,e));try{t=o(n)}catch(s){if(s instanceof RangeError)continue;throw s}if(null!=(null===r||void 0===r?void 0:r.maxLengthLength)&&n.byteLength>r.maxLengthLength)throw new Vx("message length length too long","ERR_MSG_LENGTH_TOO_LONG");if(t>-1)break}if(null!=(null===r||void 0===r?void 0:r.maxDataLength)&&t>r.maxDataLength)throw new Vx("message length too long","ERR_MSG_DATA_TOO_LONG");return i.read(t,e)},write:async(e,t)=>{await i.write(new Kr(s(e.byteLength),e),t)},writeV:async(e,t)=>{const n=new Kr(...e.flatMap((e=>[s(e.byteLength),e])));await i.write(n,t)},unwrap:()=>i.unwrap()};return a}const Gx="/multistream/1.0.0",Kx=1024,Wx=Fs("\n");async function Qx(e,t,n){await e.write(t,n)}async function Yx(e,t){const n=await async function(e,t){const n=await e.read(t);if(0===n.byteLength||n.get(n.byteLength-1)!==Wx[0])throw t.log.error("Invalid mss message - missing newline",n),new tf("missing newline","ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");return n.sublist(0,-1)}(e,t);return cp(n.subarray())}async function Zx(e,t,n){t=Array.isArray(t)?t:[t],n.log.trace("handle: available protocols %s",t);const r=qx(e,{...n,maxDataLength:Kx,maxLengthLength:2});for(;;){n.log.trace("handle: reading incoming string");const e=await Yx(r,n);if(n.log.trace('handle: read "%s"',e),e!==Gx){if(t.includes(e))return n.log.trace('handle: respond with "%s" for "%s"',e,e),await Qx(r,Fs("".concat(e,"\n")),n),n.log.trace('handle: responded with "%s" for "%s"',e,e),{stream:r.unwrap(),protocol:e};if("ls"!==e)n.log('handle: respond with "na" for "%s"',e),await Qx(r,Fs("na\n"),n),n.log('handle: responded with "na" for "%s"',e);else{const i=new Kr(...t.map((e=>bf.single(Fs("".concat(e,"\n"))))),Fs("\n"));n.log.trace('handle: respond with "%s" for %s',t,e),await Qx(r,i,n),n.log.trace('handle: responded with "%s" for %s',t,e)}}else n.log.trace('handle: respond with "%s" for "%s"',Gx,e),await Qx(r,Fs("".concat(Gx,"\n")),n),n.log.trace('handle: responded with "%s" for "%s"',Gx,e)}}async function Jx(e,t,n){if(1===(t=Array.isArray(t)?[...t]:[t]).length&&!1===n.negotiateFully)return function(e,t,n){const r=e.sink.bind(e),i=e.source;let o=!1,s=!1;const a=ou();let c=!1,l=!1;const u=ou();let d=!1,h=!1;const f=ou(),p=qx({sink:r,source:i},{...n,maxDataLength:Kx});async function g(){if(s)return n.log.trace("optimistic: already negotiating %s stream",t),void await a.promise;s=!0;try{c||(n.log.trace("optimistic: doing send protocol for %s stream",t),await m()),d||(n.log.trace("optimistic: doing read protocol for %s stream",t),await v())}finally{s=!1,o=!0,a.resolve()}}async function m(){if(l)await u.promise;else{l=!0;try{n.log.trace('optimistic: write ["%s", "%s", data] in source',Gx,t),await p.writeV([Fs("".concat(Gx,"\n")),Fs("".concat(t,"\n"))]),n.log.trace('optimistic: wrote ["%s", "%s", data] in source',Gx,t)}finally{c=!0,l=!1,u.resolve()}}}async function v(){if(h)await f.promise;else{h=!0;try{n.log.trace("optimistic: reading multistream select header");let e=await Yx(p,n);if(n.log.trace('optimistic: read multistream select header "%s"',e),e===Gx&&(e=await Yx(p,n)),n.log.trace('optimistic: read protocol "%s", expecting "%s"',e,t),e!==t)throw new tf("protocol selection failed","ERR_UNSUPPORTED_PROTOCOL")}finally{d=!0,h=!1,f.resolve()}}}if(e.sink=async e=>{const{sink:r}=p.unwrap();await r(async function*(){let r=!1;for await(const i of e){if(l&&await u.promise,c)yield i;else{l=!0,n.log.trace('optimistic: write ["%s", "%s", data(%d)] in sink',Gx,t,i.byteLength);const e="".concat(t,"\n");yield new Kr(Uint8Array.from([19]),Fs("".concat(Gx,"\n")),Lo(e.length),Fs(e),i).subarray(),n.log.trace('optimistic: wrote ["%s", "%s", data(%d)] in sink',Gx,t,i.byteLength),c=!0,l=!1,u.resolve(),g().catch((e=>{n.log.error("could not finish optimistic protocol negotiation of %s",t,e)}))}r=!0}r||await g()}())},e.source=async function*(){await g(),n.log.trace('optimistic: reading data from "%s" stream',t),yield*p.unwrap().source}(),null!=e.closeRead){const t=e.closeRead.bind(e);e.closeRead=async e=>{o||await g().catch((e=>{n.log.error("could not negotiate protocol before close read",e)})),await t(e)}}if(null!=e.closeWrite){const t=e.closeWrite.bind(e);e.closeWrite=async e=>{o||await g().catch((e=>{n.log.error("could not negotiate protocol before close write",e)})),await t(e)}}if(null!=e.close){const t=e.close.bind(e);e.close=async e=>{const n=[];l&&n.push(u.promise),h&&n.push(f.promise),n.length>0?await hf(Promise.all(n),null===e||void 0===e?void 0:e.signal):(o=!0,s=!1,a.resolve()),await t(e)}}return{stream:e,protocol:t}}(e,t[0],n);const r=qx(e,{...n,maxDataLength:Kx}),i=t.shift();if(null==i)throw new Error("At least one protocol must be specified");n.log.trace('select: write ["%s", "%s"]',Gx,i);const o=Fs("".concat(Gx,"\n")),s=Fs("".concat(i,"\n"));await async function(e,t,n){await e.writeV(t,n)}(r,[o,s],n),n.log.trace("select: reading multistream-select header");let a=await Yx(r,n);if(n.log.trace('select: read "%s"',a),a===Gx&&(n.log.trace("select: reading protocol response"),a=await Yx(r,n),n.log.trace('select: read "%s"',a)),a===i)return{stream:r.unwrap(),protocol:i};for(const c of t){n.log.trace('select: write "%s"',c),await Qx(r,Fs("".concat(c,"\n")),n),n.log.trace("select: reading protocol response");const e=await Yx(r,n);if(n.log.trace('select: read "%s" for "%s"',e,c),e===c)return{stream:r.unwrap(),protocol:c}}throw new tf("protocol selection failed","ERR_UNSUPPORTED_PROTOCOL")}const Xx=Symbol.for("@libp2p/connection");class $x{constructor(e){var t;Dr(this,"id",void 0),Dr(this,"remoteAddr",void 0),Dr(this,"remotePeer",void 0),Dr(this,"direction",void 0),Dr(this,"timeline",void 0),Dr(this,"multiplexer",void 0),Dr(this,"encryption",void 0),Dr(this,"status",void 0),Dr(this,"transient",void 0),Dr(this,"log",void 0),Dr(this,"tags",void 0),Dr(this,"_newStream",void 0),Dr(this,"_close",void 0),Dr(this,"_abort",void 0),Dr(this,"_getStreams",void 0),Dr(this,Symbol.toStringTag,"Connection"),Dr(this,Xx,!0);const{remoteAddr:n,remotePeer:r,newStream:i,close:o,abort:s,getStreams:a}=e;this.id="".concat(parseInt(String(1e9*Math.random())).toString(36)).concat(Date.now()),this.remoteAddr=n,this.remotePeer=r,this.direction=e.direction,this.status="open",this.timeline=e.timeline,this.multiplexer=e.multiplexer,this.encryption=e.encryption,this.transient=null!==(t=e.transient)&&void 0!==t&&t,this.log=e.logger.forComponent("libp2p:connection:".concat(this.direction,":").concat(this.id)),null==this.remoteAddr.getPeerId()&&(this.remoteAddr=this.remoteAddr.encapsulate("/p2p/".concat(this.remotePeer))),this._newStream=i,this._close=o,this._abort=s,this._getStreams=a,this.tags=[]}get streams(){return this._getStreams()}async newStream(e,t){if("closing"===this.status)throw new tf("the connection is being closed","ERR_CONNECTION_BEING_CLOSED");if("closed"===this.status)throw new tf("the connection is closed","ERR_CONNECTION_CLOSED");if(Array.isArray(e)||(e=[e]),this.transient&&!0!==(null===t||void 0===t?void 0:t.runOnTransientConnection))throw new tf("Cannot open protocol stream on transient connection","ERR_TRANSIENT_CONNECTION");const n=await this._newStream(e,t);return n.direction="outbound",n}async close(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("closed"!==this.status&&"closing"!==this.status){if(this.log("closing connection to %a",this.remoteAddr),this.status="closing",null==e.signal){const t=AbortSignal.timeout(500);Wh(1/0,t),e={...e,signal:t}}try{this.log.trace("closing all streams"),await Promise.all(this.streams.map((async t=>t.close(e)))),this.log.trace("closing underlying transport"),await this._close(e),this.log.trace("updating timeline with close time"),this.status="closed",this.timeline.close=Date.now()}catch(t){this.log.error("error encountered during graceful close of connection to %a",this.remoteAddr,t),this.abort(t)}}}abort(e){this.log.error("aborting connection to %a due to error",this.remoteAddr,e),this.status="closing",this.streams.forEach((t=>{t.abort(e)})),this.log.error("all streams aborted",this.streams.length),this._abort(e),this.timeline.close=Date.now(),this.status="closed"}}function e_(e,t,n){let r=0;return n.streams.forEach((n=>{n.direction===t&&n.protocol===e&&r++})),r}class t_{constructor(e,t){var n;Dr(this,"components",void 0),Dr(this,"connectionEncryption",void 0),Dr(this,"muxers",void 0),Dr(this,"inboundUpgradeTimeout",void 0),Dr(this,"events",void 0),this.components=e,this.connectionEncryption=new Map,t.connectionEncryption.forEach((e=>{this.connectionEncryption.set(e.protocol,e)})),this.muxers=new Map,t.muxers.forEach((e=>{this.muxers.set(e.protocol,e)})),this.inboundUpgradeTimeout=null!==(n=t.inboundUpgradeTimeout)&&void 0!==n?n:2e3,this.events=e.events}async shouldBlockConnection(e,t,n){const r=this.components.connectionGater[n];if(void 0!==r&&await r(e,t))throw new tf("The multiaddr connection is blocked by gater.".concat(n),ux.ERR_CONNECTION_INTERCEPTED)}async upgradeInbound(e,t){if(!await this.components.connectionManager.acceptIncomingConnection(e))throw new tf("connection denied",ux.ERR_CONNECTION_DENIED);let n,r,i,o,s;const a=AbortSignal.timeout(this.inboundUpgradeTimeout),c=()=>{e.abort(new tf("inbound upgrade timeout",af))};a.addEventListener("abort",c,{once:!0}),Wh(1/0,a);try{var l,u,d;if(!0===await(null===(l=(u=this.components.connectionGater).denyInboundConnection)||void 0===l?void 0:l.call(u,e)))throw new tf("The multiaddr connection is blocked by gater.acceptConnection",ux.ERR_CONNECTION_INTERCEPTED);null===(d=this.components.metrics)||void 0===d||d.trackMultiaddrConnection(e),e.log("starting the inbound connection upgrade");let a=e;if(!0!==(null===t||void 0===t?void 0:t.skipProtection)){const t=this.components.connectionProtector;null!=t&&(e.log("protecting the inbound connection"),a=await t.protect(e))}try{if(n=a,!0!==(null===t||void 0===t?void 0:t.skipEncryption)){({conn:n,remotePeer:r,protocol:s}=await this._encryptInbound(a));const e={...a,...n};await this.shouldBlockConnection(r,e,"denyInboundEncryptedConnection")}else{const t=e.remoteAddr.getPeerId();if(null==t)throw new tf("inbound connection that skipped encryption must have a peer id",ux.ERR_INVALID_MULTIADDR);const n=tp(t);s="native",r=n}if(i=n,null!=(null===t||void 0===t?void 0:t.muxerFactory))o=t.muxerFactory;else if(this.muxers.size>0){const e=await this._multiplexInbound({...a,...n},this.muxers);o=e.muxerFactory,i=e.stream}}catch(h){throw e.log.error("failed to upgrade inbound connection",h),h}return await this.shouldBlockConnection(r,e,"denyInboundUpgradedConnection"),e.log("successfully upgraded inbound connection"),this._createConnection({cryptoProtocol:s,direction:"inbound",maConn:e,upgradedConn:i,muxerFactory:o,remotePeer:r,transient:null===t||void 0===t?void 0:t.transient})}finally{a.removeEventListener("abort",c),this.components.connectionManager.afterUpgradeInbound()}}async upgradeOutbound(e,t){var n;const r=e.remoteAddr.getPeerId();let i,o,s,a,c,l;null!=r&&(i=tp(r),await this.shouldBlockConnection(i,e,"denyOutboundConnection")),null===(n=this.components.metrics)||void 0===n||n.trackMultiaddrConnection(e),e.log("starting the outbound connection upgrade");let u=e;if(!0!==(null===t||void 0===t?void 0:t.skipProtection)){const t=this.components.connectionProtector;null!=t&&(u=await t.protect(e))}try{if(o=u,!0!==(null===t||void 0===t?void 0:t.skipEncryption)){({conn:o,remotePeer:s,protocol:c}=await this._encryptOutbound(u,i));const e={...u,...o};await this.shouldBlockConnection(s,e,"denyOutboundEncryptedConnection")}else{if(null==i)throw new tf("Encryption was skipped but no peer id was passed",ux.ERR_INVALID_PEER);c="native",s=i}if(a=o,null!=(null===t||void 0===t?void 0:t.muxerFactory))l=t.muxerFactory;else if(this.muxers.size>0){const e=await this._multiplexOutbound({...u,...o},this.muxers);l=e.muxerFactory,a=e.stream}}catch(d){throw e.log.error("failed to upgrade outbound connection",d),await e.close(d),d}return await this.shouldBlockConnection(s,e,"denyOutboundUpgradedConnection"),e.log("successfully upgraded outbound connection"),this._createConnection({cryptoProtocol:c,direction:"outbound",maConn:e,upgradedConn:a,muxerFactory:l,remotePeer:s,transient:null===t||void 0===t?void 0:t.transient})}_createConnection(e){var t,n,r=this;const{cryptoProtocol:i,direction:o,maConn:s,upgradedConn:a,remotePeer:c,muxerFactory:l,transient:u}=e;let d,h,f;null!=l&&(d=l.createStreamMuxer({direction:o,onIncomingStream:e=>{null!=f&&Promise.resolve().then((async()=>{var t;const n=this.components.registrar.getProtocols(),{stream:r,protocol:i}=await Zx(e,n,{log:e.log,yieldBytes:!1});if(null==f)return;f.log("incoming stream opened on %s",i);const o=function(e,t){try{const{options:n}=t.getHandler(e);return n.maxInboundStreams}catch(n){if(n.code!==ux.ERR_NO_HANDLER_FOR_PROTOCOL)throw n}return 32}(i,this.components.registrar);if(e_(i,"inbound",f)===o){const t=new tf('Too many inbound protocol streams for protocol "'.concat(i,'" - limit ').concat(o),ux.ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS);throw e.abort(t),t}e.source=r.source,e.sink=r.sink,e.protocol=i,null!=r.closeWrite&&(e.closeWrite=r.closeWrite),null!=r.closeRead&&(e.closeRead=r.closeRead),null!=r.close&&(e.close=r.close),await this.components.peerStore.merge(c,{protocols:[i]}),null===(t=this.components.metrics)||void 0===t||t.trackProtocolStream(e,f),this._onStream({connection:f,stream:e,protocol:i})})).catch((async t=>{f.log.error("error handling incoming stream id %s",e.id,t.message,t.code,t.stack),null==e.timeline.close&&await e.close()}))}}),h=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null==d)throw new tf("Stream is not multiplexed",ux.ERR_MUXER_UNAVAILABLE);f.log("starting new stream for protocols %s",e);const n=await d.newStream();f.log.trace("started new stream %s for protocols %s",n.id,e);try{var i;if(null==t.signal){n.log("no abort signal was passed while trying to negotiate protocols %s falling back to default timeout",e);const r=AbortSignal.timeout(3e4);Wh(1/0,r),t={...t,signal:r}}n.log.trace("selecting protocol from protocols %s",e);const{stream:o,protocol:s}=await Jx(n,e,{...t,log:n.log,yieldBytes:!0});n.log("selected protocol %s",s);const a=function(e,t){var n;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{const{options:n}=t.getHandler(e);if(null!=n.maxOutboundStreams)return n.maxOutboundStreams}catch(i){if(i.code!==ux.ERR_NO_HANDLER_FOR_PROTOCOL)throw i}return null!==(n=r.maxOutboundStreams)&&void 0!==n?n:64}(s,r.components.registrar,t),l=e_(s,"outbound",f);if(l>=a){const e=new tf('Too many outbound protocol streams for protocol "'.concat(s,'" - ').concat(l,"/").concat(a),ux.ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS);throw n.abort(e),e}return await r.components.peerStore.merge(c,{protocols:[s]}),n.source=o.source,n.sink=o.sink,n.protocol=s,null!=o.closeWrite&&(n.closeWrite=o.closeWrite),null!=o.closeRead&&(n.closeRead=o.closeRead),null!=o.close&&(n.close=o.close),null===(i=r.components.metrics)||void 0===i||i.trackProtocolStream(n,f),n}catch(o){if(f.log.error("could not create new stream for protocols %s",e,o),null==n.timeline.close&&n.abort(o),null!=o.code)throw o;throw new tf(String(o),ux.ERR_UNSUPPORTED_PROTOCOL)}},Promise.all([d.sink(a.source),a.sink(d.source)]).catch((e=>{f.log.error("error piping data through muxer",e)})));const p=s.timeline;s.timeline=new Proxy(p,{set:function(){return null!=f&&"close"===(arguments.length<=1?void 0:arguments[1])&&null!=(arguments.length<=2?void 0:arguments[2])&&null==p.close&&(async()=>{try{"open"===f.status&&await f.close()}catch(e){f.log.error("error closing connection after timeline close",e)}finally{r.events.safeDispatchEvent("connection:close",{detail:f})}})().catch((e=>{f.log.error("error thrown while dispatching connection:close event",e)})),Reflect.set(...arguments)}}),s.timeline.upgraded=Date.now();return f=function(e){return new $x(e)}({remoteAddr:s.remoteAddr,remotePeer:c,status:"open",direction:o,timeline:s.timeline,multiplexer:null===(t=d)||void 0===t?void 0:t.protocol,encryption:i,transient:u,logger:this.components.logger,newStream:null!==(n=h)&&void 0!==n?n:()=>{throw new tf("connection is not multiplexed",ux.ERR_CONNECTION_NOT_MULTIPLEXED)},getStreams:()=>null!=d?d.streams:[],close:async e=>{null!=d&&(f.log.trace("close muxer"),await d.close(e)),f.log.trace("close maconn"),await s.close(e),f.log.trace("closed maconn")},abort:e=>{s.abort(e),null!=d&&d.abort(e)}}),this.events.safeDispatchEvent("connection:open",{detail:f}),f}_onStream(e){const{connection:t,stream:n,protocol:r}=e,{handler:i,options:o}=this.components.registrar.getHandler(r);if(t.transient&&!0!==o.runOnTransientConnection)throw new tf("Cannot open protocol stream on transient connection","ERR_TRANSIENT_CONNECTION");i({connection:t,stream:n})}async _encryptInbound(e){const t=Array.from(this.connectionEncryption.keys());e.log("handling inbound crypto protocol selection",t);try{const{stream:n,protocol:r}=await Zx(e,t,{log:e.log}),i=this.connectionEncryption.get(r);if(null==i)throw new Error("no crypto module found for ".concat(r));return e.log("encrypting inbound connection using",r),{...await i.secureInbound(this.components.peerId,n),protocol:r}}catch(n){throw e.log.error("encrypting inbound connection to %p failed",n),new tf(n.message,ux.ERR_ENCRYPTION_FAILED)}}async _encryptOutbound(e,t){const n=Array.from(this.connectionEncryption.keys());e.log("selecting outbound crypto protocol",n);try{e.log.trace("selecting encrypter from %s",n);const{stream:r,protocol:i}=await Jx(e,n,{log:e.log,yieldBytes:!0}),o=this.connectionEncryption.get(i);if(null==o)throw new Error("no crypto module found for ".concat(i));return e.log("encrypting outbound connection to %p using %s",t,o),{...await o.secureOutbound(this.components.peerId,r,t),protocol:i}}catch(r){throw e.log.error("encrypting outbound connection to %p failed",r),new tf(r.message,ux.ERR_ENCRYPTION_FAILED)}}async _multiplexOutbound(e,t){const n=Array.from(t.keys());e.log("outbound selecting muxer %s",n);try{e.log.trace("selecting stream muxer from %s",n);const{stream:r,protocol:i}=await Jx(e,n,{log:e.log,yieldBytes:!0});e.log("selected %s as muxer protocol",i);return{stream:r,muxerFactory:t.get(i)}}catch(r){throw e.log.error("error multiplexing outbound connection",r),new tf(String(r),ux.ERR_MUXER_UNAVAILABLE)}}async _multiplexInbound(e,t){const n=Array.from(t.keys());e.log("inbound handling muxers %s",n);try{const{stream:r,protocol:i}=await Zx(e,n,{log:e.log});return{stream:r,muxerFactory:t.get(i)}}catch(r){throw e.log.error("error multiplexing inbound connection",r),new tf(String(r),ux.ERR_MUXER_UNAVAILABLE)}}}const n_="1.5.1",r_="libp2p";var i_,o_=new WeakSet;class s_ extends Jh{constructor(e){var t,n,r,i,o,s,a,c,l;super(),Au(this,o_),Dr(this,"peerId",void 0),Dr(this,"peerStore",void 0),Dr(this,"contentRouting",void 0),Dr(this,"peerRouting",void 0),Dr(this,"metrics",void 0),Dr(this,"services",void 0),Dr(this,"logger",void 0),Dr(this,"status",void 0),Dr(this,"components",void 0),Dr(this,"log",void 0),this.status="stopped";const u=new Jh,d=u.dispatchEvent.bind(u);u.dispatchEvent=e=>{const t=d(e),n=this.dispatchEvent(new $h(e.type,{detail:e.detail}));return t||n},Wh(1/0,u),this.peerId=e.peerId,this.logger=null!==(t=e.logger)&&void 0!==t?t:Od(),this.log=this.logger.forComponent("libp2p"),this.services={};const h=this.components=function(){const e=new $S(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});return new Proxy(e,{get(t,n,r){if("string"===typeof n&&!tx.includes(n)){const t=e.components[n];if(null==t&&!ex.includes(n))throw new tf("".concat(n," not set"),"ERR_SERVICE_MISSING");return t}return Reflect.get(t,n,r)},set:(t,n,r)=>("string"===typeof n?e.components[n]=r:Reflect.set(t,n,r),!0)})}({peerId:e.peerId,privateKey:e.privateKey,nodeInfo:null!==(n=e.nodeInfo)&&void 0!==n?n:{name:r_,version:n_},logger:this.logger,events:u,datastore:null!==(r=e.datastore)&&void 0!==r?r:new Fv,connectionGater:nx(e.connectionGater),dns:e.dns});this.peerStore=this.configureComponent("peerStore",new QS(h,{addressFilter:this.components.connectionGater.filterMultiaddrForPeer,...e.peerStore})),null!=e.metrics&&(this.metrics=this.configureComponent("metrics",e.metrics(this.components))),h.events.addEventListener("peer:update",(e=>{if(null==e.detail.previous){const t={id:e.detail.peer.id,multiaddrs:e.detail.peer.addresses.map((e=>e.multiaddr))};h.events.safeDispatchEvent("peer:discovery",{detail:t})}})),null!=e.connectionProtector&&this.configureComponent("connectionProtector",e.connectionProtector(h)),this.components.upgrader=new t_(this.components,{connectionEncryption:(null!==(i=e.connectionEncryption)&&void 0!==i?i:[]).map(((e,t)=>this.configureComponent("connection-encryption-".concat(t),e(this.components)))),muxers:(null!==(o=e.streamMuxers)&&void 0!==o?o:[]).map(((e,t)=>this.configureComponent("stream-muxers-".concat(t),e(this.components)))),inboundUpgradeTimeout:e.connectionManager.inboundUpgradeTimeout}),this.configureComponent("transportManager",new Fx(this.components,e.transportManager)),this.configureComponent("connectionManager",new Bx(this.components,e.connectionManager)),this.configureComponent("registrar",new Mx(this.components)),this.configureComponent("addressManager",new XS(this.components,e.addresses));const f=(null!==(s=e.peerRouters)&&void 0!==s?s:[]).map(((e,t)=>this.configureComponent("peer-router-".concat(t),e(this.components))));this.peerRouting=this.components.peerRouting=this.configureComponent("peerRouting",new Ox(this.components,{routers:f}));const p=(null!==(a=e.contentRouters)&&void 0!==a?a:[]).map(((e,t)=>this.configureComponent("content-router-".concat(t),e(this.components))));if(this.contentRouting=this.components.contentRouting=this.configureComponent("contentRouting",new Dx(this.components,{routers:p})),this.configureComponent("randomWalk",new Lx(this.components)),(null!==(c=e.peerDiscovery)&&void 0!==c?c:[]).forEach(((e,t)=>{this.configureComponent("peer-discovery-".concat(t),e(this.components)).addEventListener("peer",(e=>{xu(o_,this,a_).call(this,e)}))})),null===(l=e.transports)||void 0===l||l.forEach(((e,t)=>{this.components.transportManager.add(this.configureComponent("transport-".concat(t),e(this.components)))})),null!=e.services)for(const v of Object.keys(e.services)){const t=(0,e.services[v])(this.components);var g,m;if(null!=t){if(this.services[v]=t,this.configureComponent(v,t),null!=t[Uv]&&(this.log("registering service %s for content routing",v),p.push(t[Uv])),null!=t[jv]&&(this.log("registering service %s for peer routing",v),f.push(t[jv])),null!=t[mS])this.log("registering service %s for peer discovery",v),null===(g=(m=t[mS]).addEventListener)||void 0===g||g.call(m,"peer",(e=>{xu(o_,this,a_).call(this,e)}))}else this.log.error("service factory %s returned null or undefined instance",v)}}configureComponent(e,t){return null==t&&this.log.error("component %s was null or undefined",e),this.components[e]=t,t}async start(){if("stopped"===this.status){this.status="starting",this.log("libp2p is starting");try{var e,t,n,r;await(null===(e=(t=this.components).beforeStart)||void 0===e?void 0:e.call(t)),await this.components.start(),await(null===(n=(r=this.components).afterStart)||void 0===n?void 0:n.call(r)),this.status="started",this.safeDispatchEvent("start",{detail:this}),this.log("libp2p has started")}catch(i){throw this.log.error("An error occurred starting libp2p",i),this.status="started",await this.stop(),i}}}async stop(){var e,t,n,r;"started"===this.status&&(this.log("libp2p is stopping"),this.status="stopping",await(null===(e=(t=this.components).beforeStop)||void 0===e?void 0:e.call(t)),await this.components.stop(),await(null===(n=(r=this.components).afterStop)||void 0===n?void 0:n.call(r)),this.status="stopped",this.safeDispatchEvent("stop",{detail:this}),this.log("libp2p has stopped"))}getConnections(e){return this.components.connectionManager.getConnections(e)}getDialQueue(){return this.components.connectionManager.getDialQueue()}getPeers(){const e=new vS;for(const t of this.components.connectionManager.getConnections())e.add(t.remotePeer);return Array.from(e)}async dial(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.components.connectionManager.openConnection(e,{priority:75,...t})}async dialProtocol(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null==t)throw new tf("no protocols were provided to open a stream",ux.ERR_INVALID_PROTOCOLS_FOR_STREAM);if(0===(t=Array.isArray(t)?t:[t]).length)throw new tf("no protocols were provided to open a stream",ux.ERR_INVALID_PROTOCOLS_FOR_STREAM);return(await this.dial(e,n)).newStream(t,n)}getMultiaddrs(){return this.components.addressManager.getAddresses()}getProtocols(){return this.components.registrar.getProtocols()}async hangUp(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;Bg(e)&&(e=tp(null!==(n=e.getPeerId())&&void 0!==n?n:""));await this.components.connectionManager.closeConnections(e,t)}async getPublicKey(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.log("getPublicKey %p",e),null!=e.publicKey)return e.publicKey;try{const t=await this.peerStore.get(e);if(null!=t.id.publicKey)return t.id.publicKey}catch(i){if(i.code!==ux.ERR_NOT_FOUND)throw i}const n=Hr([Fs("/pk/"),e.multihash.digest]),r=await this.contentRouting.get(n,t);return XA(r),await this.peerStore.patch(e,{publicKey:r}),r}async handle(e,t,n){Array.isArray(e)||(e=[e]),await Promise.all(e.map((async e=>{await this.components.registrar.handle(e,t,n)})))}async unhandle(e){Array.isArray(e)||(e=[e]),await Promise.all(e.map((async e=>{await this.components.registrar.unhandle(e)})))}async register(e,t){return this.components.registrar.register(e,t)}unregister(e){this.components.registrar.unregister(e)}async isDialable(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.components.connectionManager.isDialable(e,t)}}function a_(e){const{detail:t}=e;t.id.toString()!==this.peerId.toString()?this.components.peerStore.merge(t.id,{multiaddrs:t.multiaddrs}).catch((e=>{this.log.error(e)})):this.log.error(new Error(ux.ERR_DISCOVERED_SELF))}async function c_(){var e,t;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r=null!==(e=n.peerId)&&void 0!==e?e:n.peerId=await yS();if(null==r.privateKey)throw new tf("peer id was missing private key","ERR_MISSING_PRIVATE_KEY");return null!==(t=n.privateKey)&&void 0!==t||(n.privateKey=await eS(r.privateKey)),new s_(await async function(e){var t;const n=Ad(dx,e);if(null===n.connectionProtector&&null!=(null===(t=globalThis.process)||void 0===t||null===(t=t.env)||void 0===t?void 0:t.LIBP2P_FORCE_PNET))throw new tf(lx.ERR_PROTECTOR_REQUIRED,ux.ERR_PROTECTOR_REQUIRED);if(!(await rp(n.privateKey.public.bytes,n.privateKey.bytes)).equals(n.peerId))throw new tf("Private key doesn't match peer id",ux.ERR_INVALID_KEY);return n}(n))}function l_(){const e=ou();let t=!1;return{sink:async n=>{if(t)throw new Error("already piped");t=!0,e.resolve(n)},source:async function*(){const t=await e.promise;yield*t}()}}const u_=65535,d_=Boolean(null===(i_=globalThis.process)||void 0===i_||null===(i_=i_.env)||void 0===i_?void 0:i_.DUMP_SESSION_KEYS),h_=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4));function f_(e){return e instanceof Uint8Array||null!=e&&"object"===typeof e&&"Uint8Array"===e.constructor.name}const p_=e=>new DataView(e.buffer,e.byteOffset,e.byteLength);if(!(68===new Uint8Array(new Uint32Array([287454020]).buffer)[0]))throw new Error("Non little-endian hardware is not supported");function g_(e){if("string"!==typeof e)throw new Error("utf8ToBytes expected string, got ".concat(typeof e));return new Uint8Array((new TextEncoder).encode(e))}function m_(e){if("string"===typeof e)e=g_(e);else{if(!f_(e))throw new Error("expected Uint8Array, got ".concat(typeof e));e=e.slice()}return e}const v_=e=>"[object Object]"===Object.prototype.toString.call(e)&&e.constructor===Object;function y_(e,t){if(!f_(e))throw new Error("Uint8Array expected");if("number"===typeof t&&e.length!==t)throw new Error("Uint8Array length ".concat(t," expected"))}const w_=(e,t)=>(Object.assign(t,e),t);function b_(e,t,n,r){if("function"===typeof e.setBigUint64)return e.setBigUint64(t,n,r);const i=BigInt(32),o=BigInt(4294967295),s=Number(n>>i&o),a=Number(n&o),c=r?4:0,l=r?0:4;e.setUint32(t+c,s,r),e.setUint32(t+l,a,r)}function E_(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("wrong positive integer: ".concat(e))}function k_(e){if("boolean"!==typeof e)throw new Error("boolean expected, not ".concat(e))}function A_(e){if(null==(t=e)||"object"!==typeof t||!(t instanceof Uint8Array||"Uint8Array"===t.constructor.name))throw new Error("Uint8Array expected");for(var t,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(r.length>0&&!r.includes(e.length))throw new Error("Uint8Array expected of length ".concat(r,", not of length=").concat(e.length))}function S_(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function x_(e,t){A_(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least ".concat(n))}const __=(e,t)=>255&e[t++]|(255&e[t++])<<8;class I_{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,y_(e=m_(e),32);const t=__(e,0),n=__(e,2),r=__(e,4),i=__(e,6),o=__(e,8),s=__(e,10),a=__(e,12),c=__(e,14);this.r[0]=8191&t,this.r[1]=8191&(t>>>13|n<<3),this.r[2]=7939&(n>>>10|r<<6),this.r[3]=8191&(r>>>7|i<<9),this.r[4]=255&(i>>>4|o<<12),this.r[5]=o>>>1&8190,this.r[6]=8191&(o>>>14|s<<2),this.r[7]=8065&(s>>>11|a<<5),this.r[8]=8191&(a>>>8|c<<8),this.r[9]=c>>>5&127;for(let l=0;l<8;l++)this.pad[l]=__(e,16+2*l)}process(e,t){const n=arguments.length>2&&void 0!==arguments[2]&&arguments[2]?0:2048,{h:r,r:i}=this,o=i[0],s=i[1],a=i[2],c=i[3],l=i[4],u=i[5],d=i[6],h=i[7],f=i[8],p=i[9],g=__(e,t+0),m=__(e,t+2),v=__(e,t+4),y=__(e,t+6),w=__(e,t+8),b=__(e,t+10),E=__(e,t+12),k=__(e,t+14);let A=r[0]+(8191&g),S=r[1]+(8191&(g>>>13|m<<3)),x=r[2]+(8191&(m>>>10|v<<6)),_=r[3]+(8191&(v>>>7|y<<9)),I=r[4]+(8191&(y>>>4|w<<12)),R=r[5]+(w>>>1&8191),C=r[6]+(8191&(w>>>14|b<<2)),T=r[7]+(8191&(b>>>11|E<<5)),P=r[8]+(8191&(E>>>8|k<<8)),N=r[9]+(k>>>5|n),B=0,D=B+A*o+S*(5*p)+x*(5*f)+_*(5*h)+I*(5*d);B=D>>>13,D&=8191,D+=R*(5*u)+C*(5*l)+T*(5*c)+P*(5*a)+N*(5*s),B+=D>>>13,D&=8191;let O=B+A*s+S*o+x*(5*p)+_*(5*f)+I*(5*h);B=O>>>13,O&=8191,O+=R*(5*d)+C*(5*u)+T*(5*l)+P*(5*c)+N*(5*a),B+=O>>>13,O&=8191;let L=B+A*a+S*s+x*o+_*(5*p)+I*(5*f);B=L>>>13,L&=8191,L+=R*(5*h)+C*(5*d)+T*(5*u)+P*(5*l)+N*(5*c),B+=L>>>13,L&=8191;let M=B+A*c+S*a+x*s+_*o+I*(5*p);B=M>>>13,M&=8191,M+=R*(5*f)+C*(5*h)+T*(5*d)+P*(5*u)+N*(5*l),B+=M>>>13,M&=8191;let F=B+A*l+S*c+x*a+_*s+I*o;B=F>>>13,F&=8191,F+=R*(5*p)+C*(5*f)+T*(5*h)+P*(5*d)+N*(5*u),B+=F>>>13,F&=8191;let U=B+A*u+S*l+x*c+_*a+I*s;B=U>>>13,U&=8191,U+=R*o+C*(5*p)+T*(5*f)+P*(5*h)+N*(5*d),B+=U>>>13,U&=8191;let j=B+A*d+S*u+x*l+_*c+I*a;B=j>>>13,j&=8191,j+=R*s+C*o+T*(5*p)+P*(5*f)+N*(5*h),B+=j>>>13,j&=8191;let H=B+A*h+S*d+x*u+_*l+I*c;B=H>>>13,H&=8191,H+=R*a+C*s+T*o+P*(5*p)+N*(5*f),B+=H>>>13,H&=8191;let z=B+A*f+S*h+x*d+_*u+I*l;B=z>>>13,z&=8191,z+=R*c+C*a+T*s+P*o+N*(5*p),B+=z>>>13,z&=8191;let V=B+A*p+S*f+x*h+_*d+I*u;B=V>>>13,V&=8191,V+=R*l+C*c+T*a+P*s+N*o,B+=V>>>13,V&=8191,B=(B<<2)+B|0,B=B+D|0,D=8191&B,B>>>=13,O+=B,r[0]=D,r[1]=O,r[2]=L,r[3]=M,r[4]=F,r[5]=U,r[6]=j,r[7]=H,r[8]=z,r[9]=V}finalize(){const{h:e,pad:t}=this,n=new Uint16Array(10);let r=e[1]>>>13;e[1]&=8191;for(let s=2;s<10;s++)e[s]+=r,r=e[s]>>>13,e[s]&=8191;e[0]+=5*r,r=e[0]>>>13,e[0]&=8191,e[1]+=r,r=e[1]>>>13,e[1]&=8191,e[2]+=r,n[0]=e[0]+5,r=n[0]>>>13,n[0]&=8191;for(let s=1;s<10;s++)n[s]=e[s]+r,r=n[s]>>>13,n[s]&=8191;n[9]-=8192;let i=(1^r)-1;for(let s=0;s<10;s++)n[s]&=i;i=~i;for(let s=0;s<10;s++)e[s]=e[s]&i|n[s];e[0]=65535&(e[0]|e[1]<<13),e[1]=65535&(e[1]>>>3|e[2]<<10),e[2]=65535&(e[2]>>>6|e[3]<<7),e[3]=65535&(e[3]>>>9|e[4]<<4),e[4]=65535&(e[4]>>>12|e[5]<<1|e[6]<<14),e[5]=65535&(e[6]>>>2|e[7]<<11),e[6]=65535&(e[7]>>>5|e[8]<<8),e[7]=65535&(e[8]>>>8|e[9]<<5);let o=e[0]+t[0];e[0]=65535&o;for(let s=1;s<8;s++)o=(e[s]+t[s]|0)+(o>>>16)|0,e[s]=65535&o}update(e){S_(this);const{buffer:t,blockLen:n}=this,r=(e=m_(e)).length;for(let i=0;i<r;){const o=Math.min(n-this.pos,r-i);if(o!==n)t.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===n&&(this.process(t,0,!1),this.pos=0);else for(;n<=r-i;i+=n)this.process(e,i)}return this}destroy(){this.h.fill(0),this.r.fill(0),this.buffer.fill(0),this.pad.fill(0)}digestInto(e){S_(this),x_(e,this),this.finished=!0;const{buffer:t,h:n}=this;let{pos:r}=this;if(r){for(t[r++]=1;r<16;r++)t[r]=0;this.process(t,0,!0)}this.finalize();let i=0;for(let o=0;o<8;o++)e[i++]=n[o]>>>0,e[i++]=n[o]>>>8;return e}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}}const R_=function(e){const t=(t,n)=>e(n).update(m_(t)).digest(),n=e(new Uint8Array(32));return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=t=>e(t),t}((e=>new I_(e))),C_=g_("expand 16-byte k"),T_=g_("expand 32-byte k"),P_=h_(C_),N_=h_(T_);function B_(e,t){return e<<t|e>>>32-t}function D_(e){return e.byteOffset%4===0}const O_=64,L_=16,M_=2**32-1,F_=new Uint32Array;function U_(e,t){const{allowShortKeys:n,extendNonceFn:r,counterLength:i,counterRight:o,rounds:s}=function(e,t){if(void 0!==t&&("object"!==typeof t||!v_(t)))throw new Error("options must be object or undefined");return Object.assign(e,t)}({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if("function"!==typeof e)throw new Error("core must be a function");return E_(i),E_(s),k_(o),k_(n),function(t,a,c,l){let u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;A_(t),A_(a),A_(c);const d=c.length;if(l||(l=new Uint8Array(d)),A_(l),E_(u),u<0||u>=M_)throw new Error("arx: counter overflow");if(l.length<d)throw new Error("arx: output (".concat(l.length,") is shorter than data (").concat(d,")"));const h=[];let f,p,g=t.length;if(32===g)f=t.slice(),h.push(f),p=N_;else{if(16!==g||!n)throw new Error("arx: invalid 32-byte key, got length=".concat(g));f=new Uint8Array(32),f.set(t),f.set(t,16),p=P_,h.push(f)}D_(a)||(a=a.slice(),h.push(a));const m=h_(f);if(r){if(24!==a.length)throw new Error("arx: extended nonce must be 24 bytes");r(p,m,h_(a.subarray(0,16)),m),a=a.subarray(16)}const v=16-i;if(v!==a.length)throw new Error("arx: nonce must be ".concat(v," or 16 bytes"));if(12!==v){const e=new Uint8Array(12);e.set(a,o?0:12-a.length),a=e,h.push(a)}const y=h_(a);for(!function(e,t,n,r,i,o,s,a){const c=i.length,l=new Uint8Array(O_),u=h_(l),d=D_(i)&&D_(o),h=d?h_(i):F_,f=d?h_(o):F_;for(let p=0;p<c;s++){if(e(t,n,r,u,s,a),s>=M_)throw new Error("arx: counter overflow");const g=Math.min(O_,c-p);if(d&&g===O_){const e=p/4;if(p%4!==0)throw new Error("arx: invalid block position");for(let t,n=0;n<L_;n++)t=e+n,f[t]=h[t]^u[n];p+=O_}else{for(let e,t=0;t<g;t++)e=p+t,o[e]=i[e]^l[t];p+=g}}}(e,p,m,y,c,l,u,s);h.length>0;)h.pop().fill(0);return l}}function j_(e,t,n,r,i){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:20,s=e[0],a=e[1],c=e[2],l=e[3],u=t[0],d=t[1],h=t[2],f=t[3],p=t[4],g=t[5],m=t[6],v=t[7],y=i,w=n[0],b=n[1],E=n[2],k=s,A=a,S=c,x=l,_=u,I=d,R=h,C=f,T=p,P=g,N=m,B=v,D=y,O=w,L=b,M=E;for(let U=0;U<o;U+=2)k=k+_|0,D=B_(D^k,16),T=T+D|0,_=B_(_^T,12),k=k+_|0,D=B_(D^k,8),T=T+D|0,_=B_(_^T,7),A=A+I|0,O=B_(O^A,16),P=P+O|0,I=B_(I^P,12),A=A+I|0,O=B_(O^A,8),P=P+O|0,I=B_(I^P,7),S=S+R|0,L=B_(L^S,16),N=N+L|0,R=B_(R^N,12),S=S+R|0,L=B_(L^S,8),N=N+L|0,R=B_(R^N,7),x=x+C|0,M=B_(M^x,16),B=B+M|0,C=B_(C^B,12),x=x+C|0,M=B_(M^x,8),B=B+M|0,C=B_(C^B,7),k=k+I|0,M=B_(M^k,16),N=N+M|0,I=B_(I^N,12),k=k+I|0,M=B_(M^k,8),N=N+M|0,I=B_(I^N,7),A=A+R|0,D=B_(D^A,16),B=B+D|0,R=B_(R^B,12),A=A+R|0,D=B_(D^A,8),B=B+D|0,R=B_(R^B,7),S=S+C|0,O=B_(O^S,16),T=T+O|0,C=B_(C^T,12),S=S+C|0,O=B_(O^S,8),T=T+O|0,C=B_(C^T,7),x=x+_|0,L=B_(L^x,16),P=P+L|0,_=B_(_^P,12),x=x+_|0,L=B_(L^x,8),P=P+L|0,_=B_(_^P,7);let F=0;r[F++]=s+k|0,r[F++]=a+A|0,r[F++]=c+S|0,r[F++]=l+x|0,r[F++]=u+_|0,r[F++]=d+I|0,r[F++]=h+R|0,r[F++]=f+C|0,r[F++]=p+T|0,r[F++]=g+P|0,r[F++]=m+N|0,r[F++]=v+B|0,r[F++]=y+D|0,r[F++]=w+O|0,r[F++]=b+L|0,r[F++]=E+M|0}const H_=U_(j_,{counterRight:!1,counterLength:4,allowShortKeys:!1}),z_=U_(j_,{counterRight:!1,counterLength:8,extendNonceFn:function(e,t,n,r){let i=e[0],o=e[1],s=e[2],a=e[3],c=t[0],l=t[1],u=t[2],d=t[3],h=t[4],f=t[5],p=t[6],g=t[7],m=n[0],v=n[1],y=n[2],w=n[3];for(let E=0;E<20;E+=2)i=i+c|0,m=B_(m^i,16),h=h+m|0,c=B_(c^h,12),i=i+c|0,m=B_(m^i,8),h=h+m|0,c=B_(c^h,7),o=o+l|0,v=B_(v^o,16),f=f+v|0,l=B_(l^f,12),o=o+l|0,v=B_(v^o,8),f=f+v|0,l=B_(l^f,7),s=s+u|0,y=B_(y^s,16),p=p+y|0,u=B_(u^p,12),s=s+u|0,y=B_(y^s,8),p=p+y|0,u=B_(u^p,7),a=a+d|0,w=B_(w^a,16),g=g+w|0,d=B_(d^g,12),a=a+d|0,w=B_(w^a,8),g=g+w|0,d=B_(d^g,7),i=i+l|0,w=B_(w^i,16),p=p+w|0,l=B_(l^p,12),i=i+l|0,w=B_(w^i,8),p=p+w|0,l=B_(l^p,7),o=o+u|0,m=B_(m^o,16),g=g+m|0,u=B_(u^g,12),o=o+u|0,m=B_(m^o,8),g=g+m|0,u=B_(u^g,7),s=s+d|0,v=B_(v^s,16),h=h+v|0,d=B_(d^h,12),s=s+d|0,v=B_(v^s,8),h=h+v|0,d=B_(d^h,7),a=a+c|0,y=B_(y^a,16),f=f+y|0,c=B_(c^f,12),a=a+c|0,y=B_(y^a,8),f=f+y|0,c=B_(c^f,7);let b=0;r[b++]=i,r[b++]=o,r[b++]=s,r[b++]=a,r[b++]=m,r[b++]=v,r[b++]=y,r[b++]=w},allowShortKeys:!1}),V_=new Uint8Array(16),q_=(e,t)=>{e.update(t);const n=t.length%16;n&&e.update(V_.subarray(n))},G_=new Uint8Array(32);function K_(e,t,n,r,i){const o=e(t,n,G_),s=R_.create(o);i&&q_(s,i),q_(s,r);const a=new Uint8Array(16),c=p_(a);b_(c,0,BigInt(i?i.length:0),!0),b_(c,8,BigInt(r.length),!0),s.update(a);const l=s.digest();return o.fill(0),l}const W_=e=>(t,n,r)=>{const i=16;return y_(t,32),y_(n),{encrypt:(o,s)=>{const a=o.length,c=a+i;s?y_(s,c):s=new Uint8Array(c),e(t,n,o,s,1);const l=K_(e,t,n,s.subarray(0,-16),r);return s.set(l,a),s},decrypt:(o,s)=>{const a=o.length,c=a-i;if(a<i)throw new Error("encrypted data must be at least ".concat(i," bytes"));s?y_(s,c):s=new Uint8Array(c);const l=o.subarray(0,-16);if(!function(e,t){if(e.length!==t.length)return!1;let n=0;for(let r=0;r<e.length;r++)n|=e[r]^t[r];return 0===n}(o.subarray(-16),K_(e,t,n,l,r)))throw new Error("invalid tag");return e(t,n,l,s,1),s}}},Q_=w_({blockSize:64,nonceLength:12,tagLength:16},W_(H_));W_(z_);function Y_(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("Wrong positive integer: ".concat(e))}function Z_(e){if(!((t=e)instanceof Uint8Array||null!=t&&"object"===typeof t&&"Uint8Array"===t.constructor.name))throw new Error("Expected Uint8Array");for(var t,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(r.length>0&&!r.includes(e.length))throw new Error("Expected Uint8Array of length ".concat(r,", not of length=").concat(e.length))}function J_(e){if("function"!==typeof e||"function"!==typeof e.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");Y_(e.outputLen),Y_(e.blockLen)}function X_(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function $_(e,t){Z_(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least ".concat(n))}const eI={number:Y_,bool:function(e){if("boolean"!==typeof e)throw new Error("Expected boolean, not ".concat(e))},bytes:Z_,hash:J_,exists:X_,output:$_},tI="object"===typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,nI=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4));function rI(e){return e instanceof Uint8Array||null!=e&&"object"===typeof e&&"Uint8Array"===e.constructor.name}const iI=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),oI=(e,t)=>e<<32-t|e>>>t;if(!(68===new Uint8Array(new Uint32Array([287454020]).buffer)[0]))throw new Error("Non little-endian hardware is not supported");function sI(e){if("string"!==typeof e)throw new Error("utf8ToBytes expected string, got ".concat(typeof e));return new Uint8Array((new TextEncoder).encode(e))}function aI(e){if("string"===typeof e&&(e=sI(e)),!rI(e))throw new Error("expected Uint8Array, got ".concat(typeof e));return e}function cI(){let e=0;for(let n=0;n<arguments.length;n++){const t=n<0||arguments.length<=n?void 0:arguments[n];if(!rI(t))throw new Error("Uint8Array expected");e+=t.length}const t=new Uint8Array(e);for(let n=0,r=0;n<arguments.length;n++){const e=n<0||arguments.length<=n?void 0:arguments[n];t.set(e,r),r+=e.length}return t}class lI{clone(){return this._cloneInto()}}const uI={}.toString;function dI(e,t){if(void 0!==t&&"[object Object]"!==uI.call(t))throw new Error("Options should be object or undefined");return Object.assign(e,t)}function hI(e){const t=t=>e().update(aI(t)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function fI(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;if(tI&&"function"===typeof tI.getRandomValues)return tI.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}class pI extends lI{constructor(e,t,n,r){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=iI(this.buffer)}update(e){X_(this);const{view:t,buffer:n,blockLen:r}=this,i=(e=aI(e)).length;for(let o=0;o<i;){const s=Math.min(r-this.pos,i-o);if(s!==r)n.set(e.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===r&&(this.process(t,0),this.pos=0);else{const t=iI(e);for(;r<=i-o;o+=r)this.process(t,o)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){X_(this),$_(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:r,isLE:i}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>r-o&&(this.process(n,0),o=0);for(let u=o;u<r;u++)t[u]=0;!function(e,t,n,r){if("function"===typeof e.setBigUint64)return e.setBigUint64(t,n,r);const i=BigInt(32),o=BigInt(4294967295),s=Number(n>>i&o),a=Number(n&o),c=r?4:0,l=r?0:4;e.setUint32(t+c,s,r),e.setUint32(t+l,a,r)}(n,r-8,BigInt(8*this.length),i),this.process(n,0);const s=iI(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,l=this.get();if(c>l.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<c;u++)s.setUint32(4*u,l[u],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:r,finished:i,destroyed:o,pos:s}=this;return e.length=r,e.pos=s,e.finished=i,e.destroyed=o,r%t&&e.buffer.set(n),e}}const gI=BigInt(2**32-1),mI=BigInt(32);function vI(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?{h:Number(e&gI),l:Number(e>>mI&gI)}:{h:0|Number(e>>mI&gI),l:0|Number(e&gI)}}function yI(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=new Uint32Array(e.length),r=new Uint32Array(e.length);for(let i=0;i<e.length;i++){const{h:o,l:s}=vI(e[i],t);[n[i],r[i]]=[o,s]}return[n,r]}const wI=(e,t,n)=>e<<n|t>>>32-n,bI=(e,t,n)=>t<<n|e>>>32-n,EI=(e,t,n)=>t<<n-32|e>>>64-n,kI=(e,t,n)=>e<<n-32|t>>>64-n;const AI={fromBig:vI,split:yI,toBig:(e,t)=>BigInt(e>>>0)<<mI|BigInt(t>>>0),shrSH:(e,t,n)=>e>>>n,shrSL:(e,t,n)=>e<<32-n|t>>>n,rotrSH:(e,t,n)=>e>>>n|t<<32-n,rotrSL:(e,t,n)=>e<<32-n|t>>>n,rotrBH:(e,t,n)=>e<<64-n|t>>>n-32,rotrBL:(e,t,n)=>e>>>n-32|t<<64-n,rotr32H:(e,t)=>t,rotr32L:(e,t)=>e,rotlSH:wI,rotlSL:bI,rotlBH:EI,rotlBL:kI,add:function(e,t,n,r){const i=(t>>>0)+(r>>>0);return{h:e+n+(i/2**32|0)|0,l:0|i}},add3L:(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),add3H:(e,t,n,r)=>t+n+r+(e/2**32|0)|0,add4L:(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),add4H:(e,t,n,r,i)=>t+n+r+i+(e/2**32|0)|0,add5H:(e,t,n,r,i,o)=>t+n+r+i+o+(e/2**32|0)|0,add5L:(e,t,n,r,i)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(i>>>0)},SI=AI,[xI,_I]=(()=>SI.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((e=>BigInt(e)))))(),II=new Uint32Array(80),RI=new Uint32Array(80);class CI extends pI{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:n,Bl:r,Ch:i,Cl:o,Dh:s,Dl:a,Eh:c,El:l,Fh:u,Fl:d,Gh:h,Gl:f,Hh:p,Hl:g}=this;return[e,t,n,r,i,o,s,a,c,l,u,d,h,f,p,g]}set(e,t,n,r,i,o,s,a,c,l,u,d,h,f,p,g){this.Ah=0|e,this.Al=0|t,this.Bh=0|n,this.Bl=0|r,this.Ch=0|i,this.Cl=0|o,this.Dh=0|s,this.Dl=0|a,this.Eh=0|c,this.El=0|l,this.Fh=0|u,this.Fl=0|d,this.Gh=0|h,this.Gl=0|f,this.Hh=0|p,this.Hl=0|g}process(e,t){for(let y=0;y<16;y++,t+=4)II[y]=e.getUint32(t),RI[y]=e.getUint32(t+=4);for(let y=16;y<80;y++){const e=0|II[y-15],t=0|RI[y-15],n=SI.rotrSH(e,t,1)^SI.rotrSH(e,t,8)^SI.shrSH(e,t,7),r=SI.rotrSL(e,t,1)^SI.rotrSL(e,t,8)^SI.shrSL(e,t,7),i=0|II[y-2],o=0|RI[y-2],s=SI.rotrSH(i,o,19)^SI.rotrBH(i,o,61)^SI.shrSH(i,o,6),a=SI.rotrSL(i,o,19)^SI.rotrBL(i,o,61)^SI.shrSL(i,o,6),c=SI.add4L(r,a,RI[y-7],RI[y-16]),l=SI.add4H(c,n,s,II[y-7],II[y-16]);II[y]=0|l,RI[y]=0|c}let{Ah:n,Al:r,Bh:i,Bl:o,Ch:s,Cl:a,Dh:c,Dl:l,Eh:u,El:d,Fh:h,Fl:f,Gh:p,Gl:g,Hh:m,Hl:v}=this;for(let y=0;y<80;y++){const e=SI.rotrSH(u,d,14)^SI.rotrSH(u,d,18)^SI.rotrBH(u,d,41),t=SI.rotrSL(u,d,14)^SI.rotrSL(u,d,18)^SI.rotrBL(u,d,41),w=u&h^~u&p,b=d&f^~d&g,E=SI.add5L(v,t,b,_I[y],RI[y]),k=SI.add5H(E,m,e,w,xI[y],II[y]),A=0|E,S=SI.rotrSH(n,r,28)^SI.rotrBH(n,r,34)^SI.rotrBH(n,r,39),x=SI.rotrSL(n,r,28)^SI.rotrBL(n,r,34)^SI.rotrBL(n,r,39),_=n&i^n&s^i&s,I=r&o^r&a^o&a;m=0|p,v=0|g,p=0|h,g=0|f,h=0|u,f=0|d,({h:u,l:d}=SI.add(0|c,0|l,0|k,0|A)),c=0|s,l=0|a,s=0|i,a=0|o,i=0|n,o=0|r;const R=SI.add3L(A,x,I);n=SI.add3H(R,k,S,_),r=0|R}({h:n,l:r}=SI.add(0|this.Ah,0|this.Al,0|n,0|r)),({h:i,l:o}=SI.add(0|this.Bh,0|this.Bl,0|i,0|o)),({h:s,l:a}=SI.add(0|this.Ch,0|this.Cl,0|s,0|a)),({h:c,l:l}=SI.add(0|this.Dh,0|this.Dl,0|c,0|l)),({h:u,l:d}=SI.add(0|this.Eh,0|this.El,0|u,0|d)),({h:h,l:f}=SI.add(0|this.Fh,0|this.Fl,0|h,0|f)),({h:p,l:g}=SI.add(0|this.Gh,0|this.Gl,0|p,0|g)),({h:m,l:v}=SI.add(0|this.Hh,0|this.Hl,0|m,0|v)),this.set(n,r,i,o,s,a,c,l,u,d,h,f,p,g,m,v)}roundClean(){II.fill(0),RI.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const TI=hI((()=>new CI)),PI=(BigInt(0),BigInt(1)),NI=BigInt(2);function BI(e){return e instanceof Uint8Array||null!=e&&"object"===typeof e&&"Uint8Array"===e.constructor.name}const DI=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function OI(e){if(!BI(e))throw new Error("Uint8Array expected");let t="";for(let n=0;n<e.length;n++)t+=DI[e[n]];return t}function LI(e){if("string"!==typeof e)throw new Error("hex string expected, got "+typeof e);return BigInt(""===e?"0":"0x".concat(e))}const MI={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function FI(e){return e>=MI._0&&e<=MI._9?e-MI._0:e>=MI._A&&e<=MI._F?e-(MI._A-10):e>=MI._a&&e<=MI._f?e-(MI._a-10):void 0}function UI(e){if("string"!==typeof e)throw new Error("hex string expected, got "+typeof e);const t=e.length,n=t/2;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(n);for(let i=0,o=0;i<n;i++,o+=2){const t=FI(e.charCodeAt(o)),n=FI(e.charCodeAt(o+1));if(void 0===t||void 0===n){const t=e[o]+e[o+1];throw new Error('hex string expected, got non-hex character "'+t+'" at index '+o)}r[i]=16*t+n}return r}function jI(e){return LI(OI(e))}function HI(e){if(!BI(e))throw new Error("Uint8Array expected");return LI(OI(Uint8Array.from(e).reverse()))}function zI(e,t){return UI(e.toString(16).padStart(2*t,"0"))}function VI(e,t){return zI(e,t).reverse()}function qI(e,t,n){let r;if("string"===typeof t)try{r=UI(t)}catch(BJ){throw new Error("".concat(e,' must be valid hex string, got "').concat(t,'". Cause: ').concat(BJ))}else{if(!BI(t))throw new Error("".concat(e," must be hex string or Uint8Array"));r=Uint8Array.from(t)}const i=r.length;if("number"===typeof n&&i!==n)throw new Error("".concat(e," expected ").concat(n," bytes, got ").concat(i));return r}function GI(){let e=0;for(let r=0;r<arguments.length;r++){const t=r<0||arguments.length<=r?void 0:arguments[r];if(!BI(t))throw new Error("Uint8Array expected");e+=t.length}let t=new Uint8Array(e),n=0;for(let r=0;r<arguments.length;r++){const e=r<0||arguments.length<=r?void 0:arguments[r];t.set(e,n),n+=e.length}return t}const KI=e=>(NI<<BigInt(e-1))-PI,WI=e=>new Uint8Array(e),QI=e=>Uint8Array.from(e);function YI(e,t,n){if("number"!==typeof e||e<2)throw new Error("hashLen must be a number");if("number"!==typeof t||t<2)throw new Error("qByteLen must be a number");if("function"!==typeof n)throw new Error("hmacFn must be a function");let r=WI(e),i=WI(e),o=0;const s=()=>{r.fill(1),i.fill(0),o=0},a=function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return n(i,r,...t)},c=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:WI();i=a(QI([0]),e),r=a(),0!==e.length&&(i=a(QI([1]),e),r=a())},l=()=>{if(o++>=1e3)throw new Error("drbg: tried 1000 values");let e=0;const n=[];for(;e<t;){r=a();const t=r.slice();n.push(t),e+=r.length}return GI(...n)};return(e,t)=>{let n;for(s(),c(e);!(n=t(l()));)c();return s(),n}}const ZI={bigint:e=>"bigint"===typeof e,function:e=>"function"===typeof e,boolean:e=>"boolean"===typeof e,string:e=>"string"===typeof e,stringOrUint8Array:e=>"string"===typeof e||BI(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"===typeof e&&Number.isSafeInteger(e.outputLen)};function JI(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=(t,n,r)=>{const i=ZI[n];if("function"!==typeof i)throw new Error('Invalid validator "'.concat(n,'", expected function'));const o=e[t];if((!r||void 0!==o)&&!i(o,e))throw new Error("Invalid param ".concat(String(t),"=").concat(o," (").concat(typeof o,"), expected ").concat(n))};for(const[i,o]of Object.entries(t))r(i,o,!1);for(const[i,o]of Object.entries(n))r(i,o,!0);return e}const XI=BigInt(0),$I=BigInt(1),eR=BigInt(2),tR=BigInt(3),nR=BigInt(4),rR=BigInt(5),iR=BigInt(8);BigInt(9),BigInt(16);function oR(e,t){const n=e%t;return n>=XI?n:t+n}function sR(e,t,n){if(n<=XI||t<XI)throw new Error("Expected power/modulo > 0");if(n===$I)return XI;let r=$I;for(;t>XI;)t&$I&&(r=r*e%n),e=e*e%n,t>>=$I;return r}function aR(e,t,n){let r=e;for(;t-- >XI;)r*=r,r%=n;return r}function cR(e,t){if(e===XI||t<=XI)throw new Error("invert: expected positive integers, got n=".concat(e," mod=").concat(t));let n=oR(e,t),r=t,i=XI,o=$I,s=$I,a=XI;for(;n!==XI;){const e=r/n,t=r%n,c=i-s*e,l=o-a*e;r=n,n=t,i=s,o=a,s=c,a=l}if(r!==$I)throw new Error("invert: does not exist");return oR(i,t)}function lR(e){if(e%nR===tR){const t=(e+$I)/nR;return function(e,n){const r=e.pow(n,t);if(!e.eql(e.sqr(r),n))throw new Error("Cannot find square root");return r}}if(e%iR===rR){const t=(e-rR)/iR;return function(e,n){const r=e.mul(n,eR),i=e.pow(r,t),o=e.mul(n,i),s=e.mul(e.mul(o,eR),i),a=e.mul(o,e.sub(s,e.ONE));if(!e.eql(e.sqr(a),n))throw new Error("Cannot find square root");return a}}return function(e){const t=(e-$I)/eR;let n,r,i;for(n=e-$I,r=0;n%eR===XI;n/=eR,r++);for(i=eR;i<e&&sR(i,t,e)!==e-$I;i++);if(1===r){const t=(e+$I)/nR;return function(e,n){const r=e.pow(n,t);if(!e.eql(e.sqr(r),n))throw new Error("Cannot find square root");return r}}const o=(n+$I)/eR;return function(e,s){if(e.pow(s,t)===e.neg(e.ONE))throw new Error("Cannot find square root");let a=r,c=e.pow(e.mul(e.ONE,i),n),l=e.pow(s,o),u=e.pow(s,n);for(;!e.eql(u,e.ONE);){if(e.eql(u,e.ZERO))return e.ZERO;let t=1;for(let r=e.sqr(u);t<a&&!e.eql(r,e.ONE);t++)r=e.sqr(r);const n=e.pow(c,$I<<BigInt(a-t-1));c=e.sqr(n),l=e.mul(l,n),u=e.mul(u,c),a=t}return l}}(e)}const uR=(e,t)=>(oR(e,t)&$I)===$I,dR=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function hR(e,t){const n=void 0!==t?t:e.toString(2).length;return{nBitLength:n,nByteLength:Math.ceil(n/8)}}function fR(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(e<=XI)throw new Error("Expected Field ORDER > 0, got ".concat(e));const{nBitLength:i,nByteLength:o}=hR(e,t);if(o>2048)throw new Error("Field lengths over 2048 bytes are not supported");const s=lR(e),a=Object.freeze({ORDER:e,BITS:i,BYTES:o,MASK:KI(i),ZERO:XI,ONE:$I,create:t=>oR(t,e),isValid:t=>{if("bigint"!==typeof t)throw new Error("Invalid field element: expected bigint, got ".concat(typeof t));return XI<=t&&t<e},is0:e=>e===XI,isOdd:e=>(e&$I)===$I,neg:t=>oR(-t,e),eql:(e,t)=>e===t,sqr:t=>oR(t*t,e),add:(t,n)=>oR(t+n,e),sub:(t,n)=>oR(t-n,e),mul:(t,n)=>oR(t*n,e),pow:(e,t)=>function(e,t,n){if(n<XI)throw new Error("Expected power > 0");if(n===XI)return e.ONE;if(n===$I)return t;let r=e.ONE,i=t;for(;n>XI;)n&$I&&(r=e.mul(r,i)),i=e.sqr(i),n>>=$I;return r}(a,e,t),div:(t,n)=>oR(t*cR(n,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>cR(t,e),sqrt:r.sqrt||(e=>s(a,e)),invertBatch:e=>function(e,t){const n=new Array(t.length),r=t.reduce(((t,r,i)=>e.is0(r)?t:(n[i]=t,e.mul(t,r))),e.ONE),i=e.inv(r);return t.reduceRight(((t,r,i)=>e.is0(r)?t:(n[i]=e.mul(t,n[i]),e.mul(t,r))),i),n}(a,e),cmov:(e,t,n)=>n?t:e,toBytes:e=>n?VI(e,o):zI(e,o),fromBytes:e=>{if(e.length!==o)throw new Error("Fp.fromBytes: expected ".concat(o,", got ").concat(e.length));return n?HI(e):jI(e)}});return Object.freeze(a)}function pR(e){if("bigint"!==typeof e)throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function gR(e){const t=pR(e);return t+Math.ceil(t/2)}const mR=BigInt(0),vR=BigInt(1);function yR(e,t){const n=(e,t)=>{const n=t.negate();return e?n:t},r=e=>({windows:Math.ceil(t/e)+1,windowSize:2**(e-1)});return{constTimeNegate:n,unsafeLadder(t,n){let r=e.ZERO,i=t;for(;n>mR;)n&vR&&(r=r.add(i)),i=i.double(),n>>=vR;return r},precomputeWindow(e,t){const{windows:n,windowSize:i}=r(t),o=[];let s=e,a=s;for(let r=0;r<n;r++){a=s,o.push(a);for(let e=1;e<i;e++)a=a.add(s),o.push(a);s=a.double()}return o},wNAF(t,i,o){const{windows:s,windowSize:a}=r(t);let c=e.ZERO,l=e.BASE;const u=BigInt(2**t-1),d=2**t,h=BigInt(t);for(let e=0;e<s;e++){const t=e*a;let r=Number(o&u);o>>=h,r>a&&(r-=d,o+=vR);const s=t,f=t+Math.abs(r)-1,p=e%2!==0,g=r<0;0===r?l=l.add(n(p,i[s])):c=c.add(n(g,i[f]))}return{p:c,f:l}},wNAFCached(e,t,n,r){const i=e._WINDOW_SIZE||1;let o=t.get(e);return o||(o=this.precomputeWindow(e,i),1!==i&&t.set(e,r(o))),this.wNAF(i,o,n)}}}function wR(e){return function(e){const t=dR.reduce(((e,t)=>(e[t]="function",e)),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"});JI(e,t)}(e.Fp),JI(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...hR(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}const bR=BigInt(0),ER=BigInt(1),kR=BigInt(2),AR=BigInt(8),SR={zip215:!0};function xR(e){const t=function(e){const t=wR(e);return JI(e,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}(e),{Fp:n,n:r,prehash:i,hash:o,randomBytes:s,nByteLength:a,h:c}=t,l=kR<<BigInt(8*a)-ER,u=n.create,d=t.uvRatio||((e,t)=>{try{return{isValid:!0,value:n.sqrt(e*n.inv(t))}}catch(BJ){return{isValid:!1,value:bR}}}),h=t.adjustScalarBytes||(e=>e),f=t.domain||((e,t,n)=>{if(t.length||n)throw new Error("Contexts/pre-hash are not supported");return e}),p=e=>"bigint"===typeof e&&bR<e,g=(e,t)=>p(e)&&p(t)&&e<t,m=e=>e===bR||g(e,l);function v(e,t){if(g(e,t))return e;throw new Error("Expected valid scalar < ".concat(t,", got ").concat(typeof e," ").concat(e))}function y(e){return e===bR?e:v(e,r)}const w=new Map;function b(e){if(!(e instanceof E))throw new Error("ExtendedPoint expected")}class E{constructor(e,t,n,r){if(this.ex=e,this.ey=t,this.ez=n,this.et=r,!m(e))throw new Error("x required");if(!m(t))throw new Error("y required");if(!m(n))throw new Error("z required");if(!m(r))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(e){if(e instanceof E)throw new Error("extended point not allowed");const{x:t,y:n}=e||{};if(!m(t)||!m(n))throw new Error("invalid affine point");return new E(t,n,ER,u(t*n))}static normalizeZ(e){const t=n.invertBatch(e.map((e=>e.ez)));return e.map(((e,n)=>e.toAffine(t[n]))).map(E.fromAffine)}_setWindowSize(e){this._WINDOW_SIZE=e,w.delete(this)}assertValidity(){const{a:e,d:n}=t;if(this.is0())throw new Error("bad point: ZERO");const{ex:r,ey:i,ez:o,et:s}=this,a=u(r*r),c=u(i*i),l=u(o*o),d=u(l*l),h=u(a*e);if(u(l*u(h+c))!==u(d+u(n*u(a*c))))throw new Error("bad point: equation left != right (1)");if(u(r*i)!==u(o*s))throw new Error("bad point: equation left != right (2)")}equals(e){b(e);const{ex:t,ey:n,ez:r}=this,{ex:i,ey:o,ez:s}=e,a=u(t*s),c=u(i*r),l=u(n*s),d=u(o*r);return a===c&&l===d}is0(){return this.equals(E.ZERO)}negate(){return new E(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){const{a:e}=t,{ex:n,ey:r,ez:i}=this,o=u(n*n),s=u(r*r),a=u(kR*u(i*i)),c=u(e*o),l=n+r,d=u(u(l*l)-o-s),h=c+s,f=h-a,p=c-s,g=u(d*f),m=u(h*p),v=u(d*p),y=u(f*h);return new E(g,m,y,v)}add(e){b(e);const{a:n,d:r}=t,{ex:i,ey:o,ez:s,et:a}=this,{ex:c,ey:l,ez:d,et:h}=e;if(n===BigInt(-1)){const e=u((o-i)*(l+c)),t=u((o+i)*(l-c)),n=u(t-e);if(n===bR)return this.double();const r=u(s*kR*h),f=u(a*kR*d),p=f+r,g=t+e,m=f-r,v=u(p*n),y=u(g*m),w=u(p*m),b=u(n*g);return new E(v,y,b,w)}const f=u(i*c),p=u(o*l),g=u(a*r*h),m=u(s*d),v=u((i+o)*(c+l)-f-p),y=m-g,w=m+g,k=u(p-n*f),A=u(v*y),S=u(w*k),x=u(v*k),_=u(y*w);return new E(A,S,_,x)}subtract(e){return this.add(e.negate())}wNAF(e){return S.wNAFCached(this,w,e,E.normalizeZ)}multiply(e){const{p:t,f:n}=this.wNAF(v(e,r));return E.normalizeZ([t,n])[0]}multiplyUnsafe(e){let t=y(e);return t===bR?A:this.equals(A)||t===ER?this:this.equals(k)?this.wNAF(t).p:S.unsafeLadder(this,t)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return S.unsafeLadder(this,r).is0()}toAffine(e){const{ex:t,ey:r,ez:i}=this,o=this.is0();null==e&&(o?AR:n.inv(i));const s=u(t*e),a=u(r*e),c=u(i*e);if(o)return{x:bR,y:ER};if(c!==ER)throw new Error("invZ was invalid");return{x:s,y:a}}clearCofactor(){const{h:e}=t;return e===ER?this:this.multiplyUnsafe(e)}static fromHex(e){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{d:i,a:o}=t,s=n.BYTES,a=qI("pointHex",e,s).slice(),c=e[s-1];a[s-1]=-129&c;const h=HI(a);h===bR||v(h,r?l:n.ORDER);const f=u(h*h),p=u(f-ER),g=u(i*f-o);let{isValid:m,value:y}=d(p,g);if(!m)throw new Error("Point.fromHex: invalid y coordinate");const w=(y&ER)===ER,b=0!==(128&c);if(!r&&y===bR&&b)throw new Error("Point.fromHex: x=0 and x_0=1");return b!==w&&u(-y),E.fromAffine({x:y,y:h})}static fromPrivateKey(e){return I(e).point}toRawBytes(){const{x:e,y:t}=this.toAffine(),r=VI(t,n.BYTES);return r[r.length-1]|=e&ER?128:0,r}toHex(){return OI(this.toRawBytes())}}E.BASE=new E(t.Gx,t.Gy,ER,u(t.Gx*t.Gy)),E.ZERO=new E(bR,ER,ER,bR);const{BASE:k,ZERO:A}=E,S=yR(E,8*a);function x(e){return oR(e,r)}function _(e){return x(HI(e))}function I(e){const t=a;qI("private key",e,t);const n=qI("hashed private key",o(e),2*t),r=h(n.slice(0,t)),i=n.slice(t,2*t),s=_(r),c=k.multiply(s),l=c.toRawBytes();return{head:r,prefix:i,scalar:s,point:c,pointBytes:l}}function R(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Uint8Array;for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const s=GI(...n);return _(o(f(s,qI("context",e),!!i)))}const C=SR;k._setWindowSize(8);const T={getExtendedPublicKey:I,randomPrivateKey:()=>s(n.BYTES),precompute(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:E.BASE;return t._setWindowSize(e),t.multiply(BigInt(3)),t}};return{CURVE:t,getPublicKey:function(e){return I(e).pointBytes},sign:function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};qI("message",e),i&&i(e);const{prefix:o,scalar:s,pointBytes:c}=I(t),l=R(r.context,o,e),u=k.multiply(l).toRawBytes(),d=x(l+R(r.context,u,c,e)*s);return y(d),qI("result",GI(u,VI(d,n.BYTES)),2*a)},verify:function(e,t,r){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:C;const{context:s,zip215:a}=o,c=n.BYTES;qI("signature",e,2*c),qI("message",t),i&&i(t);const l=HI(e.slice(c,2*c));let u,d,h;try{E.fromHex(r,a),E.fromHex(e.slice(0,c),a),k.multiplyUnsafe(l)}catch(p){return!1}if(!a&&u.isSmallOrder())return!1;const f=R(s,d.toRawBytes(),u.toRawBytes(),t);return d.add(u.multiplyUnsafe(f)).subtract(h).clearCofactor().equals(E.ZERO)},ExtendedPoint:E,utils:T}}const _R=BigInt(0),IR=BigInt(1);function RR(e){const t=(JI(n=e,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...n}));var n;const{P:r}=t,i=e=>oR(e,r),o=t.montgomeryBits,s=Math.ceil(o/8),a=t.nByteLength,c=t.adjustScalarBytes||(e=>e),l=t.powPminus2||(e=>sR(e,r-BigInt(2),r));function u(e,t,n){const r=i(e*(t-n));return[t=i(t-r),n=i(n+r)]}function d(e){if("bigint"===typeof e&&_R<=e&&e<r)return e;throw new Error("Expected valid scalar 0 < scalar < CURVE.P")}const h=(t.a-BigInt(2))/BigInt(4);function f(e){return VI(i(e),s)}function p(e,t){const n=function(e){const t=qI("u coordinate",e,s);return 32===a&&(t[31]&=127),HI(t)}(t),r=function(e){const t=qI("scalar",e),n=t.length;if(n!==s&&n!==a)throw new Error("Expected ".concat(s," or ").concat(a," bytes, got ").concat(n));return HI(c(t))}(e),p=function(e,t){const n=d(e),r=d(t),s=n;let a,c=IR,f=_R,p=n,g=IR,m=_R;for(let l=BigInt(o-1);l>=_R;l--){const e=r>>l&IR;m^=e,a=u(m,c,p),c=a[0],p=a[1],a=u(m,f,g),f=a[0],g=a[1],m=e;const t=c+f,n=i(t*t),o=c-f,d=i(o*o),v=n-d,y=p+g,w=i((p-g)*t),b=i(y*o),E=w+b,k=w-b;p=i(E*E),g=i(s*i(k*k)),c=i(n*d),f=i(v*(n+i(h*v)))}a=u(m,c,p),c=a[0],p=a[1],a=u(m,f,g),f=a[0],g=a[1];const v=l(f);return i(c*v)}(n,r);if(p===_R)throw new Error("Invalid private or public key received");return f(p)}const g=f(t.Gu);function m(e){return p(e,g)}return{scalarMult:p,scalarMultBase:m,getSharedSecret:(e,t)=>p(e,t),getPublicKey:e=>m(e),utils:{randomPrivateKey:()=>t.randomBytes(t.nByteLength)},GuBytes:g}}const CR=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),TR=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),PR=(BigInt(0),BigInt(1)),NR=BigInt(2),BR=BigInt(5),DR=BigInt(10),OR=BigInt(20),LR=BigInt(40),MR=BigInt(80);function FR(e){const t=CR,n=e*e%t*e%t,r=aR(n,NR,t)*n%t,i=aR(r,PR,t)*e%t,o=aR(i,BR,t)*i%t,s=aR(o,DR,t)*o%t,a=aR(s,OR,t)*s%t,c=aR(a,LR,t)*a%t,l=aR(c,MR,t)*c%t,u=aR(l,MR,t)*c%t,d=aR(u,DR,t)*o%t;return{pow_p_5_8:aR(d,NR,t)*e%t,b2:n}}function UR(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function jR(e,t){const n=CR,r=oR(t*t*t,n),i=oR(r*r*t,n);let o=oR(e*r*FR(e*i).pow_p_5_8,n);const s=oR(t*o*o,n),a=o,c=oR(o*TR,n),l=s===e,u=s===oR(-e,n),d=s===oR(-e*TR,n);return l&&(o=a),(u||d)&&(o=c),uR(o,n)&&(o=oR(-o,n)),{isValid:l||u,value:o}}const HR=fR(CR,void 0,!0),zR={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:HR,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:TI,randomBytes:fI,adjustScalarBytes:UR,uvRatio:jR};function VR(e,t,n){if(t.length>255)throw new Error("Context is too big");return cI(sI("SigEd25519 no Ed25519 collisions"),new Uint8Array([n?1:0,t.length]),t,e)}const qR=(()=>RR({P:CR,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:e=>{const t=CR,{pow_p_5_8:n,b2:r}=FR(e);return oR(aR(n,BigInt(3),t)*r,t)},adjustScalarBytes:UR,randomBytes:fI}))();const GR=(HR.ORDER+BigInt(3))/BigInt(8);HR.pow(NR,GR),HR.sqrt(HR.neg(HR.ONE)),HR.ORDER,BigInt(5),BigInt(8),BigInt(486662);!function(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");const n=e.sqrt(t);e.isOdd(n)&&e.neg(n)}(HR,HR.neg(BigInt(486664)));BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");class KR extends lI{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,J_(e);const n=aI(t);if(this.iHash=e.create(),"function"!==typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const r=this.blockLen,i=new Uint8Array(r);i.set(n.length>r?e.create().update(n).digest():n);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),i.fill(0)}update(e){return X_(this),this.iHash.update(e),this}digestInto(e){X_(this),Z_(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:r,destroyed:i,blockLen:o,outputLen:s}=this;return e.finished=r,e.destroyed=i,e.blockLen=o,e.outputLen=s,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const WR=(e,t,n)=>new KR(e,t).update(n).digest();function QR(e,t,n){return J_(e),void 0===n&&(n=new Uint8Array(e.outputLen)),WR(e,aI(n),aI(t))}WR.create=(e,t)=>new KR(e,t);const YR=new Uint8Array([0]),ZR=new Uint8Array;function JR(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:32;if(J_(e),Y_(r),r>255*e.outputLen)throw new Error("Length should be <= 255*HashLen");const i=Math.ceil(r/e.outputLen);void 0===n&&(n=ZR);const o=new Uint8Array(i*e.outputLen),s=WR.create(e,t),a=s._cloneInto(),c=new Uint8Array(s.outputLen);for(let l=0;l<i;l++)YR[0]=l+1,a.update(0===l?ZR:c).update(n).update(YR).digestInto(c),o.set(c,e.outputLen*l),s._cloneInto(a);return s.destroy(),a.destroy(),c.fill(0),YR.fill(0),o.slice(0,r)}const XR=(e,t,n)=>e&t^e&n^t&n,$R=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),eC=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),tC=new Uint32Array(64);class nC extends pI{constructor(){super(64,32,8,!1),this.A=0|eC[0],this.B=0|eC[1],this.C=0|eC[2],this.D=0|eC[3],this.E=0|eC[4],this.F=0|eC[5],this.G=0|eC[6],this.H=0|eC[7]}get(){const{A:e,B:t,C:n,D:r,E:i,F:o,G:s,H:a}=this;return[e,t,n,r,i,o,s,a]}set(e,t,n,r,i,o,s,a){this.A=0|e,this.B=0|t,this.C=0|n,this.D=0|r,this.E=0|i,this.F=0|o,this.G=0|s,this.H=0|a}process(e,t){for(let d=0;d<16;d++,t+=4)tC[d]=e.getUint32(t,!1);for(let d=16;d<64;d++){const e=tC[d-15],t=tC[d-2],n=oI(e,7)^oI(e,18)^e>>>3,r=oI(t,17)^oI(t,19)^t>>>10;tC[d]=r+tC[d-7]+n+tC[d-16]|0}let{A:n,B:r,C:i,D:o,E:s,F:a,G:c,H:l}=this;for(let d=0;d<64;d++){const e=l+(oI(s,6)^oI(s,11)^oI(s,25))+((u=s)&a^~u&c)+$R[d]+tC[d]|0,t=(oI(n,2)^oI(n,13)^oI(n,22))+XR(n,r,i)|0;l=c,c=a,a=s,s=o+e|0,o=i,i=r,r=n,n=e+t|0}var u;n=n+this.A|0,r=r+this.B|0,i=i+this.C|0,o=o+this.D|0,s=s+this.E|0,a=a+this.F|0,c=c+this.G|0,l=l+this.H|0,this.set(n,r,i,o,s,a,c,l)}roundClean(){tC.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const rC=hI((()=>new nC)),iC={hashSHA256:e=>rC(e.subarray()),getHKDF(e,t){const n=QR(rC,t,e),r=JR(rC,n,void 0,96);return[r.subarray(0,32),r.subarray(32,64),r.subarray(64,96)]},generateX25519KeyPair(){const e=qR.utils.randomPrivateKey();return{publicKey:qR.getPublicKey(e),privateKey:e}},generateX25519KeyPairFromSeed:e=>({publicKey:qR.getPublicKey(e),privateKey:e}),generateX25519SharedKey:(e,t)=>qR.getSharedSecret(e.subarray(),t.subarray()),chaCha20Poly1305Encrypt:(e,t,n,r)=>Q_(r,t,n).encrypt(e.subarray()),chaCha20Poly1305Decrypt:(e,t,n,r,i)=>Q_(r,t,n).decrypt(e.subarray(),i)};const oC=e=>{const t=jr(2);return t[0]=e>>8,t[1]=e,t};oC.bytes=2;const sC=e=>{if(e.length<2)throw RangeError("Could not decode int16BE");if(e instanceof Uint8Array){let t=0;return t+=e[0]<<8,t+=e[1],t}return e.getUint16(0)};function aC(e,t){t.enabled&&d_&&(e?(t("LOCAL_STATIC_PUBLIC_KEY ".concat(cp(e.publicKey,"hex"))),t("LOCAL_STATIC_PRIVATE_KEY ".concat(cp(e.privateKey,"hex")))):t("Missing local static keys."))}function cC(e,t){t.enabled&&d_&&(e?(t("LOCAL_PUBLIC_EPHEMERAL_KEY ".concat(cp(e.publicKey,"hex"))),t("LOCAL_PRIVATE_EPHEMERAL_KEY ".concat(cp(e.privateKey,"hex")))):t("Missing local ephemeral keys."))}function lC(e,t){t.enabled&&d_&&t(e?"REMOTE_EPHEMERAL_PUBLIC_KEY ".concat(cp(e.subarray(),"hex")):"Missing remote ephemeral keys.")}function uC(e,t,n){n.enabled&&d_&&(n("CIPHER_STATE_1 ".concat(e.n.getUint64()," ").concat(e.k&&cp(e.k,"hex"))),n("CIPHER_STATE_2 ".concat(t.n.getUint64()," ").concat(t.k&&cp(t.k,"hex"))))}sC.bytes=2;class dC extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected Peer"),Dr(this,"code",void 0),this.code=dC.code}}Dr(dC,"code","ERR_UNEXPECTED_PEER");class hC extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid crypto exchange"),Dr(this,"code",void 0),this.code=hC.code}}Dr(hC,"code","ERR_INVALID_CRYPTO_EXCHANGE");class fC{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;Dr(this,"n",void 0),Dr(this,"bytes",void 0),Dr(this,"view",void 0),this.n=e,this.bytes=Ur(12),this.view=new DataView(this.bytes.buffer,this.bytes.byteOffset,this.bytes.byteLength),this.view.setUint32(4,e,!0)}increment(){this.n++,this.view.setUint32(4,this.n,!0)}getBytes(){return this.bytes}getUint64(){return this.n}assertValue(){if(this.n>4294967295)throw new Error("Cipherstate has reached maximum n, a new handshake must be performed")}}const pC=Ur(0);class gC{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Dr(this,"k",void 0),Dr(this,"n",void 0),Dr(this,"crypto",void 0),this.crypto=e,this.k=t,this.n=new fC(n)}hasKey(){return Boolean(this.k)}encryptWithAd(e,t){if(!this.hasKey())return t;this.n.assertValue();const n=this.crypto.encrypt(t,this.n.getBytes(),e,this.k);return this.n.increment(),n}decryptWithAd(e,t,n){if(!this.hasKey())return t;this.n.assertValue();const r=this.crypto.decrypt(t,this.n.getBytes(),e,this.k,n);return this.n.increment(),r}}class mC{constructor(e,t){Dr(this,"cs",void 0),Dr(this,"ck",void 0),Dr(this,"h",void 0),Dr(this,"crypto",void 0),this.crypto=e;const n=Fs(t,"utf-8");this.h=function(e,t){if(t.length<=32){const e=Ur(32);return e.set(t),e}return e.hash(t)}(e,n),this.ck=this.h,this.cs=new gC(e)}mixKey(e){const[t,n]=this.crypto.hkdf(this.ck,e);this.ck=t,this.cs=new gC(this.crypto,n)}mixHash(e){this.h=this.crypto.hash(new Kr(this.h,e))}encryptAndHash(e){const t=this.cs.encryptWithAd(this.h,e);return this.mixHash(t),t}decryptAndHash(e){const t=this.cs.decryptWithAd(this.h,e);return this.mixHash(e),t}split(){const[e,t]=this.crypto.hkdf(this.ck,pC);return[new gC(this.crypto,e),new gC(this.crypto,t)]}}class vC{constructor(e){Dr(this,"ss",void 0),Dr(this,"s",void 0),Dr(this,"e",void 0),Dr(this,"rs",void 0),Dr(this,"re",void 0),Dr(this,"initiator",void 0),Dr(this,"crypto",void 0);const{crypto:t,protocolName:n,prologue:r,initiator:i,s:o,e:s,rs:a,re:c}=e;this.crypto=t,this.ss=new mC(t,n),this.ss.mixHash(r),this.initiator=i,this.s=o,this.e=s,this.rs=a,this.re=c}writeE(){if(this.e)throw new Error("ephemeral keypair is already set");const e=this.crypto.generateKeypair();return this.ss.mixHash(e.publicKey),this.e=e,e.publicKey}writeS(){if(!this.s)throw new Error("static keypair is not set");return this.ss.encryptAndHash(this.s.publicKey)}writeEE(){if(!this.e)throw new Error("ephemeral keypair is not set");if(!this.re)throw new Error("remote ephemeral public key is not set");this.ss.mixKey(this.crypto.dh(this.e,this.re))}writeES(){if(this.initiator){if(!this.e)throw new Error("ephemeral keypair is not set");if(!this.rs)throw new Error("remote static public key is not set");this.ss.mixKey(this.crypto.dh(this.e,this.rs))}else{if(!this.s)throw new Error("static keypair is not set");if(!this.re)throw new Error("remote ephemeral public key is not set");this.ss.mixKey(this.crypto.dh(this.s,this.re))}}writeSE(){if(this.initiator){if(!this.s)throw new Error("static keypair is not set");if(!this.re)throw new Error("remote ephemeral public key is not set");this.ss.mixKey(this.crypto.dh(this.s,this.re))}else{if(!this.e)throw new Error("ephemeral keypair is not set");if(!this.rs)throw new Error("remote static public key is not set");this.ss.mixKey(this.crypto.dh(this.e,this.rs))}}readE(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.re)throw new Error("remote ephemeral public key is already set");if(e.byteLength<t+32)throw new Error("message is not long enough");this.re=e.sublist(t,t+32),this.ss.mixHash(this.re)}readS(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.rs)throw new Error("remote static public key is already set");const n=32+(this.ss.cs.hasKey()?16:0);if(e.byteLength<t+n)throw new Error("message is not long enough");const r=e.sublist(t,t+n);return this.rs=this.ss.decryptAndHash(r),n}readEE(){this.writeEE()}readES(){this.writeES()}readSE(){this.writeSE()}}class yC extends vC{writeMessageA(e){return new Kr(this.writeE(),this.ss.encryptAndHash(e))}writeMessageB(e){const t=this.writeE();this.writeEE();const n=this.writeS();return this.writeES(),new Kr(t,n,this.ss.encryptAndHash(e))}writeMessageC(e){const t=this.writeS();return this.writeSE(),new Kr(t,this.ss.encryptAndHash(e))}readMessageA(e){try{return this.readE(e),this.ss.decryptAndHash(e.sublist(32))}catch(BJ){throw new hC("handshake stage 0 validation fail: ".concat(BJ.message))}}readMessageB(e){try{this.readE(e),this.readEE();const t=this.readS(e,32);return this.readES(),this.ss.decryptAndHash(e.sublist(32+t))}catch(BJ){throw new hC("handshake stage 1 validation fail: ".concat(BJ.message))}}readMessageC(e){try{const t=this.readS(e);return this.readSE(),this.ss.decryptAndHash(e.sublist(t))}catch(BJ){throw new hC("handshake stage 2 validation fail: ".concat(BJ.message))}}}var wC,bC;async function EC(e,t,n){const r=await e.sign(AC(t));return bC.encode({identityKey:e.public.bytes,identitySig:r,extensions:n})}async function kC(e,t,n){try{const r=bC.decode(e);if(n){const e=n.subarray();if(!zr(e,r.identityKey))throw new Error("Payload identity key ".concat(cp(r.identityKey,"hex")," does not match expected remote identity key ").concat(cp(e,"hex")))}if(!t)throw new Error("Remote static does not exist");const i=AC(t),o=XA(r.identityKey);if(!await o.verify(i,r.identitySig))throw new Error("Invalid payload signature");return r}catch(BJ){throw new dC(BJ.message)}}function AC(e){const t=Fs("noise-libp2p-static-key:");return e instanceof Uint8Array?Hr([t,e],t.length+e.length):(e.prepend(t),e)}async function SC(e){const{log:t,connection:n,crypto:r,privateKey:i,prologue:o,s:s,remoteIdentityKey:a,extensions:c}=e,l=await EC(i,s.publicKey,c),u=new yC({crypto:r,protocolName:"Noise_XX_25519_ChaChaPoly_SHA256",initiator:!0,prologue:o,s:s});aC(u.s,t),t.trace("Stage 0 - Initiator starting to send first message."),await n.write(u.writeMessageA(pC)),t.trace("Stage 0 - Initiator finished sending first message."),cC(u.e,t),t.trace("Stage 1 - Initiator waiting to receive first message from responder...");const d=u.readMessageB(await n.read());var h,f;t.trace("Stage 1 - Initiator received the message."),lC(u.re,t),h=u.rs,(f=t).enabled&&d_&&f(h?"REMOTE_STATIC_PUBLIC_KEY ".concat(cp(h.subarray(),"hex")):"Missing remote static public key."),t.trace("Initiator going to check remote's signature...");const p=await kC(d,u.rs,a);t.trace("All good with the signature!"),t.trace("Stage 2 - Initiator sending third handshake message."),await n.write(u.writeMessageC(l)),t.trace("Stage 2 - Initiator sent message with signed payload.");const[g,m]=u.ss.split();return uC(g,m,t),{payload:p,encrypt:e=>g.encryptWithAd(pC,e),decrypt:(e,t)=>m.decryptWithAd(pC,e,t)}}!function(e){let t;e.codec=()=>(null==t&&(t=oa((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==n.lengthDelimited&&t.fork(),null!=e.webtransportCerthashes)for(const r of e.webtransportCerthashes)t.uint32(10),t.bytes(r);!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={webtransportCerthashes:[]},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();if(t>>>3===1)n.webtransportCerthashes.push(e.bytes());else e.skipType(7&t)}return n}))),t),e.encode=t=>Xs(t,e.codec()),e.decode=t=>$o(t,e.codec())}(wC||(wC={})),function(e){let t;e.codec=()=>(null==t&&(t=oa((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.identityKey&&e.identityKey.byteLength>0&&(t.uint32(10),t.bytes(e.identityKey)),null!=e.identitySig&&e.identitySig.byteLength>0&&(t.uint32(18),t.bytes(e.identitySig)),null!=e.extensions&&(t.uint32(34),wC.codec().encode(e.extensions,t)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={identityKey:Ur(0),identitySig:Ur(0)},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.identityKey=e.bytes();break;case 2:n.identitySig=e.bytes();break;case 4:n.extensions=wC.codec().decode(e,e.uint32());break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>Xs(t,e.codec()),e.decode=t=>$o(t,e.codec())}(bC||(bC={}));class xC{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Dr(this,"protocol","/noise"),Dr(this,"crypto",void 0),Dr(this,"prologue",void 0),Dr(this,"staticKey",void 0),Dr(this,"extensions",void 0),Dr(this,"metrics",void 0),Dr(this,"components",void 0);const{staticNoiseKey:n,extensions:r,crypto:i,prologueBytes:o}=t,{metrics:s}=e;this.components=e;const a=null!==i&&void 0!==i?i:iC;this.crypto=function(e){return{generateKeypair:e.generateX25519KeyPair,dh:(t,n)=>e.generateX25519SharedKey(t.privateKey,n).subarray(0,32),encrypt:e.chaCha20Poly1305Encrypt,decrypt:e.chaCha20Poly1305Decrypt,hash:e.hashSHA256,hkdf:e.getHKDF}}(a),this.extensions=r,this.metrics=s?function(e){return{xxHandshakeSuccesses:e.registerCounter("libp2p_noise_xxhandshake_successes_total",{help:"Total count of noise xxHandshakes successes_"}),xxHandshakeErrors:e.registerCounter("libp2p_noise_xxhandshake_error_total",{help:"Total count of noise xxHandshakes errors"}),encryptedPackets:e.registerCounter("libp2p_noise_encrypted_packets_total",{help:"Total count of noise encrypted packets successfully"}),decryptedPackets:e.registerCounter("libp2p_noise_decrypted_packets_total",{help:"Total count of noise decrypted packets"}),decryptErrors:e.registerCounter("libp2p_noise_decrypt_errors_total",{help:"Total count of noise decrypt errors"})}}(s):void 0,this.staticKey=n?a.generateX25519KeyPairFromSeed(n):a.generateX25519KeyPair(),this.prologue=null!==o&&void 0!==o?o:Ur(0)}async secureOutbound(e,t,n){const r=qx(t,{lengthEncoder:oC,lengthDecoder:sC,maxDataLength:u_});if(!e.privateKey)throw new tf("local peerId does not contain private key","ERR_NO_PRIVATE_KEY");const i=await eS(e.privateKey),o=null===n||void 0===n?void 0:n.publicKey,s=await this.performHandshakeInitiator(r,i,o),a=await this.createSecureConnection(r,s);return t.source=a.source,t.sink=a.sink,{conn:t,remoteExtensions:s.payload.extensions,remotePeer:await rp(s.payload.identityKey)}}async secureInbound(e,t,n){const r=qx(t,{lengthEncoder:oC,lengthDecoder:sC,maxDataLength:u_});if(!e.privateKey)throw new tf("local peerId does not contain private key","ERR_NO_PRIVATE_KEY");const i=await eS(e.privateKey),o=null===n||void 0===n?void 0:n.publicKey,s=await this.performHandshakeResponder(r,i,o),a=await this.createSecureConnection(r,s);return t.source=a.source,t.sink=a.sink,{conn:t,remoteExtensions:s.payload.extensions,remotePeer:await rp(s.payload.identityKey)}}async performHandshakeInitiator(e,t,n){let r;try{var i;r=await SC({connection:e,privateKey:t,remoteIdentityKey:n,log:this.components.logger.forComponent("libp2p:noise:xxhandshake"),crypto:this.crypto,prologue:this.prologue,s:this.staticKey,extensions:this.extensions}),null===(i=this.metrics)||void 0===i||i.xxHandshakeSuccesses.increment()}catch(BJ){var o;throw null===(o=this.metrics)||void 0===o||o.xxHandshakeErrors.increment(),BJ}return r}async performHandshakeResponder(e,t,n){let r;try{var i;r=await async function(e){const{log:t,connection:n,crypto:r,privateKey:i,prologue:o,s:s,remoteIdentityKey:a,extensions:c}=e,l=await EC(i,s.publicKey,c),u=new yC({crypto:r,protocolName:"Noise_XX_25519_ChaChaPoly_SHA256",initiator:!1,prologue:o,s:s});aC(u.s,t),t.trace("Stage 0 - Responder waiting to receive first message."),u.readMessageA(await n.read()),t.trace("Stage 0 - Responder received first message."),lC(u.re,t),t.trace("Stage 1 - Responder sending out first message with signed payload and static key."),await n.write(u.writeMessageB(l)),t.trace("Stage 1 - Responder sent the second handshake message with signed payload."),cC(u.e,t),t.trace("Stage 2 - Responder waiting for third handshake message...");const d=u.readMessageC(await n.read());t.trace("Stage 2 - Responder received the message, finished handshake.");const h=await kC(d,u.rs,a),[f,p]=u.ss.split();return uC(f,p,t),{payload:h,encrypt:e=>p.encryptWithAd(pC,e),decrypt:(e,t)=>f.decryptWithAd(pC,e,t)}}({connection:e,privateKey:t,remoteIdentityKey:n,log:this.components.logger.forComponent("libp2p:noise:xxhandshake"),crypto:this.crypto,prologue:this.prologue,s:this.staticKey,extensions:this.extensions}),null===(i=this.metrics)||void 0===i||i.xxHandshakeSuccesses.increment()}catch(BJ){var o;throw null===(o=this.metrics)||void 0===o||o.xxHandshakeErrors.increment(),BJ}return r}async createSecureConnection(e,t){const[n,r]=function(){const e=l_(),t=l_();return[{source:e.source,sink:t.sink},{source:t.source,sink:e.sink}]}(),i=e.unwrap();return await gu(n,function(e,t){return async function*(n){for await(const r of n)for(let n=0;n<r.length;n+=65519){let i,o=n+65519;o>r.length&&(o=r.length),i=r instanceof Uint8Array?e.encrypt(r.subarray(n,o)):e.encrypt(r.sublist(n,o)),null===t||void 0===t||t.encryptedPackets.increment(),yield new Kr(oC(i.byteLength),i)}}}(t,this.metrics),i,(e=>Af(e,{lengthDecoder:sC})),function(e,t){return async function*(n){for await(const r of n)for(let n=0;n<r.length;n+=u_){let i=n+u_;if(i>r.length&&(i=r.length),i-16<n)throw new Error("Invalid chunk");const o=r.sublist(n,i),s=r.subarray(n,i-16);try{const n=e.decrypt(o,s);null===t||void 0===t||t.decryptedPackets.increment(),yield n}catch(BJ){throw null===t||void 0===t||t.decryptErrors.increment(),BJ}}}}(t,this.metrics),n),r}}function _C(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>new xC(t,e)}function IC(e){if(null!=e){if("function"===typeof e[Symbol.iterator])return e[Symbol.iterator]();if("function"===typeof e[Symbol.asyncIterator])return e[Symbol.asyncIterator]();if("function"===typeof e.next)return e}throw new Error("argument is not an iterator or iterable")}const RC="ERR_INVALID_FRAME",CC="ERR_UNREQUESTED_PING",TC="ERR_NOT_MATCHING_PING",PC="ERR_STREAM_ALREADY_EXISTS",NC="ERR_DECODE_INVALID_VERSION",BC="ERR_BOTH_CLIENTS",DC="ERR_RECV_WINDOW_EXCEEDED",OC=new Set([RC,CC,TC,PC,NC,BC,DC]),LC="ERR_INVALID_CONFIG",MC="ERR_MUXER_LOCAL_CLOSED",FC="ERR_MUXER_REMOTE_CLOSED",UC=262144,jC={enableKeepAlive:!0,keepAliveInterval:3e4,maxInboundStreams:1e3,maxOutboundStreams:1e3,initialStreamWindowSize:UC,maxStreamWindowSize:16777216,maxMessageSize:65536};var HC,zC;!function(e){e[e.Data=0]="Data",e[e.WindowUpdate=1]="WindowUpdate",e[e.Ping=2]="Ping",e[e.GoAway=3]="GoAway"}(HC||(HC={})),function(e){e[e.SYN=1]="SYN",e[e.ACK=2]="ACK",e[e.FIN=4]="FIN",e[e.RST=8]="RST"}(zC||(zC={}));Object.values(zC).filter((e=>"string"!==typeof e));var VC;!function(e){e[e.NormalTermination=0]="NormalTermination",e[e.ProtocolError=1]="ProtocolError",e[e.InternalError=2]="InternalError"}(VC||(VC={}));const qC=2**24;class GC{constructor(e){Dr(this,"source",void 0),Dr(this,"buffer",void 0),Dr(this,"frameInProgress",void 0),this.source=function(e){if(void 0!==e[Symbol.iterator]){const t=e[Symbol.iterator]();return t.return=void 0,{[Symbol.iterator]:()=>t}}if(void 0!==e[Symbol.asyncIterator]){const t=e[Symbol.asyncIterator]();return t.return=void 0,{[Symbol.asyncIterator]:()=>t}}throw new Error("a source must be either an iterable or an async iterable")}(e),this.buffer=new Kr,this.frameInProgress=!1}async*emitFrames(){for await(const e of this.source)for(this.buffer.append(e);;){const e=this.readHeader();if(void 0===e)break;const{type:t,length:n}=e;t===HC.Data?(this.frameInProgress=!0,yield{header:e,readData:this.readBytes.bind(this,n)}):yield{header:e}}}readHeader(){if(this.frameInProgress)throw new tf("decoding frame already in progress","ERR_DECODE_IN_PROGRESS");if(this.buffer.length<12)return;const e=function(e){if(0!==e[0])throw new tf("Invalid frame version",NC);return{type:e[1],flag:(e[2]<<8)+e[3],streamID:e[4]*qC+(e[5]<<16)+(e[6]<<8)+e[7],length:e[8]*qC+(e[9]<<16)+(e[10]<<8)+e[11]}}(this.buffer.subarray(0,12));return this.buffer.consume(12),e}async readBytes(e){if(this.buffer.length<e)for await(const n of this.source)if(this.buffer.append(n),this.buffer.length>=e)break;const t=this.buffer.sublist(0,e);return this.buffer.consume(e),this.frameInProgress=!1,t}}function KC(e){const t=new Uint8Array(12);return t[1]=e.type,t[2]=e.flag>>>8,t[3]=e.flag,t[4]=e.streamID>>>24,t[5]=e.streamID>>>16,t[6]=e.streamID>>>8,t[7]=e.streamID,t[8]=e.length>>>24,t[9]=e.length>>>16,t[10]=e.length>>>8,t[11]=e.length,t}function WC(e,t){var n,r;const i=null===(n=(r=IC(e)).return)||void 0===n?void 0:n.call(r);var o;null!=(o=i)&&"function"===typeof o.then&&"function"===typeof o.catch&&"function"===typeof o.finally&&i.catch((e=>{t.error("could not cause iterator to return",e)}))}function QC(e){return null!=e&&("function"===typeof e.then&&"function"===typeof e.catch&&"function"===typeof e.finally)}class YC{constructor(e){var t,n;Dr(this,"id",void 0),Dr(this,"direction",void 0),Dr(this,"timeline",void 0),Dr(this,"protocol",void 0),Dr(this,"metadata",void 0),Dr(this,"source",void 0),Dr(this,"status",void 0),Dr(this,"readStatus",void 0),Dr(this,"writeStatus",void 0),Dr(this,"log",void 0),Dr(this,"sinkController",void 0),Dr(this,"sinkEnd",void 0),Dr(this,"closed",void 0),Dr(this,"endErr",void 0),Dr(this,"streamSource",void 0),Dr(this,"onEnd",void 0),Dr(this,"onCloseRead",void 0),Dr(this,"onCloseWrite",void 0),Dr(this,"onReset",void 0),Dr(this,"onAbort",void 0),Dr(this,"sendCloseWriteTimeout",void 0),Dr(this,"sendingData",void 0),this.sinkController=new AbortController,this.sinkEnd=ou(),this.closed=ou(),this.log=e.log,this.status="open",this.readStatus="ready",this.writeStatus="ready",this.id=e.id,this.metadata=null!==(t=e.metadata)&&void 0!==t?t:{},this.direction=e.direction,this.timeline={open:Date.now()},this.sendCloseWriteTimeout=null!==(n=e.sendCloseWriteTimeout)&&void 0!==n?n:5e3,this.onEnd=e.onEnd,this.onCloseRead=null===e||void 0===e?void 0:e.onCloseRead,this.onCloseWrite=null===e||void 0===e?void 0:e.onCloseWrite,this.onReset=null===e||void 0===e?void 0:e.onReset,this.onAbort=null===e||void 0===e?void 0:e.onAbort,this.source=this.streamSource=hu({onEnd:e=>{null!=e?this.log.trace("source ended with error",e):this.log.trace("source ended"),this.onSourceEnd(e)}}),this.sink=this.sink.bind(this)}async sink(e){if("ready"!==this.writeStatus)throw new tf('writable end state is "'.concat(this.writeStatus,'" not "ready"'),"ERR_SINK_INVALID_STATE");try{this.writeStatus="writing";const t={signal:this.sinkController.signal};if("outbound"===this.direction){const e=this.sendNewStream(t);QC(e)&&await e}const n=()=>{WC(e,this.log)};try{this.sinkController.signal.addEventListener("abort",n),this.log.trace("sink reading from source");for await(let n of e){n=n instanceof Uint8Array?new Kr(n):n;const e=this.sendData(n,t);QC(e)&&(this.sendingData=ou(),await e,this.sendingData.resolve(),this.sendingData=void 0)}}finally{this.sinkController.signal.removeEventListener("abort",n)}this.log.trace('sink finished reading from source, write status is "%s"',this.writeStatus),"writing"===this.writeStatus&&(this.writeStatus="closing",this.log.trace("send close write to remote"),await this.sendCloseWrite({signal:AbortSignal.timeout(this.sendCloseWriteTimeout)}),this.writeStatus="closed"),this.onSinkEnd()}catch(t){throw this.log.trace("sink ended with error, calling abort with error",t),this.abort(t),t}finally{this.log.trace("resolve sink end"),this.sinkEnd.resolve()}}onSourceEnd(e){var t;null==this.timeline.closeRead&&(this.timeline.closeRead=Date.now(),this.readStatus="closed",null!=e&&null==this.endErr&&(this.endErr=e),null===(t=this.onCloseRead)||void 0===t||t.call(this),null!=this.timeline.closeWrite?(this.log.trace("source and sink ended"),this.timeline.close=Date.now(),"aborted"!==this.status&&"reset"!==this.status&&(this.status="closed"),null!=this.onEnd&&this.onEnd(this.endErr),this.closed.resolve()):this.log.trace("source ended, waiting for sink to end"))}onSinkEnd(e){var t;null==this.timeline.closeWrite&&(this.timeline.closeWrite=Date.now(),this.writeStatus="closed",null!=e&&null==this.endErr&&(this.endErr=e),null===(t=this.onCloseWrite)||void 0===t||t.call(this),null!=this.timeline.closeRead?(this.log.trace("sink and source ended"),this.timeline.close=Date.now(),"aborted"!==this.status&&"reset"!==this.status&&(this.status="closed"),null!=this.onEnd&&this.onEnd(this.endErr),this.closed.resolve()):this.log.trace("sink ended, waiting for source to end"))}async close(e){this.log.trace("closing gracefully"),this.status="closing",await hf(Promise.all([this.closeWrite(e),this.closeRead(e),this.closed.promise]),null===e||void 0===e?void 0:e.signal),this.status="closed",this.log.trace("closed gracefully")}async closeRead(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("closing"===this.readStatus||"closed"===this.readStatus)return;this.log.trace('closing readable end of stream with starting read status "%s"',this.readStatus);const t=this.readStatus;this.readStatus="closing","reset"!==this.status&&"aborted"!==this.status&&null==this.timeline.closeRead&&(this.log.trace("send close read to remote"),await this.sendCloseRead(e)),"ready"===t&&(this.log.trace("ending internal source queue with %d queued bytes",this.streamSource.readableLength),this.streamSource.end()),this.log.trace("closed readable end of stream")}async closeWrite(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"closing"!==this.writeStatus&&"closed"!==this.writeStatus&&(this.log.trace('closing writable end of stream with starting write status "%s"',this.writeStatus),"ready"===this.writeStatus&&(this.log.trace("sink was never sunk, sink an empty array"),await hf(this.sink([]),e.signal)),"writing"===this.writeStatus&&(null!=this.sendingData&&await hf(this.sendingData.promise,e.signal),this.log.trace("aborting source passed to .sink"),this.sinkController.abort(),await hf(this.sinkEnd.promise,e.signal)),this.writeStatus="closed",this.log.trace("closed writable end of stream"))}abort(e){var t;if("closed"===this.status||"aborted"===this.status||"reset"===this.status)return;this.log("abort with error",e),this.log("try to send reset to remote");const n=this.sendReset();QC(n)&&n.catch((e=>{this.log.error("error sending reset message",e)})),this.status="aborted",this.timeline.abort=Date.now(),this._closeSinkAndSource(e),null===(t=this.onAbort)||void 0===t||t.call(this,e)}reset(){var e;if("closed"===this.status||"aborted"===this.status||"reset"===this.status)return;const t=new tf("stream reset","ERR_STREAM_RESET");this.status="reset",this.timeline.reset=Date.now(),this._closeSinkAndSource(t),null===(e=this.onReset)||void 0===e||e.call(this)}_closeSinkAndSource(e){this._closeSink(e),this._closeSource(e)}_closeSink(e){"writing"===this.writeStatus&&(this.log.trace("end sink source"),this.sinkController.abort()),this.onSinkEnd(e)}_closeSource(e){"closing"!==this.readStatus&&"closed"!==this.readStatus&&(this.log.trace("ending source with %d bytes to be read by consumer",this.streamSource.readableLength),this.readStatus="closing",this.streamSource.end(e))}remoteCloseWrite(){"closing"!==this.readStatus&&"closed"!==this.readStatus?(this.log.trace("remote close write"),this._closeSource()):this.log("received remote close write but local source is already closed")}remoteCloseRead(){"closing"!==this.writeStatus&&"closed"!==this.writeStatus?(this.log.trace("remote close read"),this._closeSink()):this.log("received remote close read but local sink is already closed")}destroy(){"closed"!==this.status&&"aborted"!==this.status&&"reset"!==this.status?(this.log.trace("stream destroyed"),this._closeSinkAndSource()):this.log("received destroy but we are already closed")}sourcePush(e){this.streamSource.push(e)}sourceReadableLength(){return this.streamSource.readableLength}}var ZC;!function(e){e[e.Init=0]="Init",e[e.SYNSent=1]="SYNSent",e[e.SYNReceived=2]="SYNReceived",e[e.Established=3]="Established",e[e.Finished=4]="Finished"}(ZC||(ZC={}));class JC extends YC{constructor(e){super({...e,onEnd:t=>{var n;this.state=ZC.Finished,null===(n=e.onEnd)||void 0===n||n.call(e,t)}}),Dr(this,"name",void 0),Dr(this,"state",void 0),Dr(this,"config",void 0),Dr(this,"_id",void 0),Dr(this,"sendWindowCapacity",void 0),Dr(this,"sendWindowCapacityUpdate",void 0),Dr(this,"recvWindow",void 0),Dr(this,"recvWindowCapacity",void 0),Dr(this,"epochStart",void 0),Dr(this,"getRTT",void 0),Dr(this,"sendFrame",void 0),this.config=e.config,this._id=parseInt(e.id,10),this.name=e.name,this.state=e.state,this.sendWindowCapacity=UC,this.recvWindow=this.config.initialStreamWindowSize,this.recvWindowCapacity=this.recvWindow,this.epochStart=Date.now(),this.getRTT=e.getRTT,this.sendFrame=e.sendFrame,this.source=My(this.source,(()=>{this.sendWindowUpdate()}))}async sendNewStream(){}async sendData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for(e=e.sublist();0!==e.byteLength;){var n,r;if(0===this.sendWindowCapacity)if(null===(n=this.log)||void 0===n||n.trace("wait for send window capacity, status %s",this.status),await this.waitForSendWindowCapacity(t),"closed"===this.status||"aborted"===this.status||"reset"===this.status)return void(null===(r=this.log)||void 0===r||r.trace("%s while waiting for send window capacity",this.status));const i=Math.min(this.sendWindowCapacity,this.config.maxMessageSize-12,e.length),o=this.getSendFlags();this.sendFrame({type:HC.Data,flag:o,streamID:this._id,length:i},e.sublist(0,i)),this.sendWindowCapacity-=i,e.consume(i)}}async sendReset(){this.sendFrame({type:HC.WindowUpdate,flag:zC.RST,streamID:this._id,length:0})}async sendCloseWrite(){const e=this.getSendFlags()|zC.FIN;this.sendFrame({type:HC.WindowUpdate,flag:e,streamID:this._id,length:0})}async sendCloseRead(){}async waitForSendWindowCapacity(){var e;let t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.sendWindowCapacity>0)return;const i=()=>{"open"===this.status||"closing"===this.status?n(new tf("stream aborted","ERR_STREAM_ABORT")):t()};null===(e=r.signal)||void 0===e||e.addEventListener("abort",i);try{await new Promise(((e,r)=>{this.sendWindowCapacityUpdate=()=>{e()},n=r,t=e}))}finally{var o;null===(o=r.signal)||void 0===o||o.removeEventListener("abort",i)}}handleWindowUpdate(e){var t;null===(t=this.log)||void 0===t||t.trace("stream received window update id=%s",this._id),this.processFlags(e.flag);const n=this.sendWindowCapacity;var r;(this.sendWindowCapacity+=e.length,0===n&&e.length>0)&&(null===(r=this.sendWindowCapacityUpdate)||void 0===r||r.call(this))}async handleData(e,t){var n;if(null===(n=this.log)||void 0===n||n.trace("stream received data id=%s",this._id),this.processFlags(e.flag),this.recvWindowCapacity<e.length)throw new tf("receive window exceeded",DC,{available:this.recvWindowCapacity,recv:e.length});const r=await t();this.recvWindowCapacity-=e.length,this.sourcePush(r)}processFlags(e){(e&zC.ACK)===zC.ACK&&this.state===ZC.SYNSent&&(this.state=ZC.Established),(e&zC.FIN)===zC.FIN&&this.remoteCloseWrite(),(e&zC.RST)===zC.RST&&this.reset()}getSendFlags(){switch(this.state){case ZC.Init:return this.state=ZC.SYNSent,zC.SYN;case ZC.SYNReceived:return this.state=ZC.Established,zC.ACK;default:return 0}}sendWindowUpdate(){const e=this.getSendFlags(),t=Date.now(),n=this.getRTT();if(0===e&&n>-1&&t-this.epochStart<4*n&&(this.recvWindow=Math.min(2*this.recvWindow,this.config.maxStreamWindowSize)),this.recvWindowCapacity>=this.recvWindow&&0===e)return;const r=this.recvWindow-this.recvWindowCapacity;this.recvWindowCapacity=this.recvWindow,this.epochStart=t,this.sendFrame({type:HC.WindowUpdate,flag:e,streamID:this._id,length:r})}}const XC="/yamux/1.0.0";class $C{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Dr(this,"protocol",XC),Dr(this,"_components",void 0),Dr(this,"_init",void 0),this._components=e,this._init=t}createStreamMuxer(e){return new eT(this._components,{...this._init,...e})}}class eT{constructor(e,t){var n;Dr(this,"protocol",XC),Dr(this,"source",void 0),Dr(this,"sink",void 0),Dr(this,"config",void 0),Dr(this,"log",void 0),Dr(this,"logger",void 0),Dr(this,"closeController",void 0),Dr(this,"nextStreamID",void 0),Dr(this,"_streams",void 0),Dr(this,"nextPingID",void 0),Dr(this,"activePing",void 0),Dr(this,"rtt",void 0),Dr(this,"client",void 0),Dr(this,"localGoAway",void 0),Dr(this,"remoteGoAway",void 0),Dr(this,"numInboundStreams",void 0),Dr(this,"numOutboundStreams",void 0),Dr(this,"onIncomingStream",void 0),Dr(this,"onStreamEnd",void 0),this.client="outbound"===t.direction,this.config={...jC,...t},this.logger=e.logger,this.log=this.logger.forComponent("libp2p:yamux"),function(e){if(e.keepAliveInterval<=0)throw new tf("keep-alive interval must be positive",LC);if(e.maxInboundStreams<0)throw new tf("max inbound streams must be larger or equal 0",LC);if(e.maxOutboundStreams<0)throw new tf("max outbound streams must be larger or equal 0",LC);if(e.initialStreamWindowSize<UC)throw new tf("InitialStreamWindowSize must be larger or equal 256 kB",LC);if(e.maxStreamWindowSize<e.initialStreamWindowSize)throw new tf("MaxStreamWindowSize must be larger than the InitialStreamWindowSize",LC);if(e.maxStreamWindowSize>2**32-1)throw new tf("MaxStreamWindowSize must be less than equal MAX_UINT32",LC);if(e.maxMessageSize<1024)throw new tf("MaxMessageSize must be greater than a kilobyte",LC)}(this.config),this.closeController=new AbortController,Wh(1/0,this.closeController.signal),this.onIncomingStream=t.onIncomingStream,this.onStreamEnd=t.onStreamEnd,this._streams=new Map,this.source=hu({onEnd:()=>{var e;null===(e=this.log)||void 0===e||e.trace("muxer source ended"),this._streams.forEach((e=>{e.destroy()}))}}),this.sink=async e=>{var t;const n=()=>{const t=IC(e);if(null!=t.return){const e=t.return();null!=(n=e)&&"function"===typeof n.then&&e.catch((e=>{var t;null===(t=this.log)||void 0===t||t.call(this,"could not cause sink source to return",e)}))}var n};let r,i;try{const t=new GC(e);try{this.closeController.signal.addEventListener("abort",n);for await(const e of t.emitFrames())await this.handleFrame(e.header,e.readData)}finally{this.closeController.signal.removeEventListener("abort",n)}r=VC.NormalTermination}catch(a){const e=a.code;var o,s;if(OC.has(e))null===(o=this.log)||void 0===o||o.error("protocol error in sink",a),r=VC.ProtocolError;else null===(s=this.log)||void 0===s||s.error("internal error in sink",a),r=VC.InternalError;i=a}null===(t=this.log)||void 0===t||t.trace("muxer sink ended"),null!=i?this.abort(i,r):await this.close({reason:r})},this.numInboundStreams=0,this.numOutboundStreams=0,this.nextStreamID=this.client?1:2,this.nextPingID=0,this.rtt=-1,null===(n=this.log)||void 0===n||n.trace("muxer created"),this.config.enableKeepAlive&&this.keepAliveLoop().catch((e=>{var t;return null===(t=this.log)||void 0===t?void 0:t.error("keepalive error: %s",e)})),this.ping().catch((e=>{var t;return null===(t=this.log)||void 0===t?void 0:t.error("ping error: %s",e)}))}get streams(){return Array.from(this._streams.values())}newStream(e){var t;if(void 0!==this.remoteGoAway)throw new tf("muxer closed remotely",FC);if(void 0!==this.localGoAway)throw new tf("muxer closed locally",MC);const n=this.nextStreamID;if(this.nextStreamID+=2,this.numOutboundStreams>=this.config.maxOutboundStreams)throw new tf("max outbound streams exceeded","ERROR_MAX_OUTBOUND_STREAMS_EXCEEDED");null===(t=this.log)||void 0===t||t.trace("new outgoing stream id=%s",n);const r=this._newStream(n,e,ZC.Init,"outbound");return this._streams.set(n,r),this.numOutboundStreams++,r.sendWindowUpdate(),r}async ping(){if(void 0!==this.remoteGoAway)throw new tf("muxer closed remotely",FC);if(void 0!==this.localGoAway)throw new tf("muxer closed locally",MC);if(void 0===this.activePing){let e=()=>{};this.activePing={id:this.nextPingID++,promise:new Promise(((t,n)=>{const r=()=>{n(new tf("muxer closed locally",MC))};this.closeController.signal.addEventListener("abort",r,{once:!0}),e=()=>{this.closeController.signal.removeEventListener("abort",r),t()}})),resolve:e};const t=Date.now();this.sendPing(this.activePing.id);try{await this.activePing.promise}finally{delete this.activePing}const n=Date.now();this.rtt=n-t}else await this.activePing.promise;return this.rtt}getRTT(){return this.rtt}async close(){var e,t,n;let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.closeController.signal.aborted)return;const i=null!==(e=null===(t=r)||void 0===t?void 0:t.reason)&&void 0!==e?e:VC.NormalTermination;if(null===(n=this.log)||void 0===n||n.trace("muxer close reason=%s",i),null==r.signal){const e=AbortSignal.timeout(500);Wh(1/0,e),r={...r,signal:e}}try{await Promise.all([...this._streams.values()].map((async e=>e.close(r)))),this.sendGoAway(i),this._closeMuxer()}catch(o){this.abort(o)}}abort(e,t){var n,r;if(!this.closeController.signal.aborted){t=null!==(n=t)&&void 0!==n?n:VC.InternalError,null===(r=this.log)||void 0===r||r.error("muxer abort reason=%s error=%s",t,e);for(const t of this._streams.values())t.abort(e);this.sendGoAway(t),this._closeMuxer()}}isClosed(){return this.closeController.signal.aborted}_closeMuxer(){this.closeController.abort(),this.source.end()}_newStream(e,t,n,r){if(null!=this._streams.get(e))throw new tf("Stream already exists",PC,{id:e});const i=new JC({id:e.toString(),name:t,state:n,direction:r,sendFrame:this.sendFrame.bind(this),onEnd:()=>{var t;this.closeStream(e),null===(t=this.onStreamEnd)||void 0===t||t.call(this,i)},log:this.logger.forComponent("libp2p:yamux:".concat(r,":").concat(e)),config:this.config,getRTT:this.getRTT.bind(this)});return i}closeStream(e){this.client===(e%2===0)?this.numInboundStreams--:this.numOutboundStreams--,this._streams.delete(e)}async keepAliveLoop(){var e;const t=new Promise(((e,t)=>{this.closeController.signal.addEventListener("abort",t,{once:!0})}));for(null===(e=this.log)||void 0===e||e.trace("muxer keepalive enabled interval=%s",this.config.keepAliveInterval);;){let e;try{await Promise.race([t,new Promise((t=>{e=setTimeout(t,this.config.keepAliveInterval)}))]),this.ping().catch((e=>{var t;return null===(t=this.log)||void 0===t?void 0:t.error("ping error: %s",e)}))}catch(BJ){return void clearInterval(e)}}}async handleFrame(e,t){var n;const{streamID:r,type:i,length:o}=e;if(null===(n=this.log)||void 0===n||n.trace("received frame %o",e),0===r)switch(i){case HC.Ping:return void this.handlePing(e);case HC.GoAway:return void this.handleGoAway(o);default:throw new tf("Invalid frame type",RC,{header:e})}else switch(e.type){case HC.Data:case HC.WindowUpdate:return void await this.handleStreamMessage(e,t);default:throw new tf("Invalid frame type",RC,{header:e})}}handlePing(e){if(e.flag===zC.SYN){var t;null===(t=this.log)||void 0===t||t.trace("received ping request pingId=%s",e.length),this.sendPing(e.length,zC.ACK)}else{if(e.flag!==zC.ACK)throw new tf("Invalid frame flag",RC,{header:e});var n;null===(n=this.log)||void 0===n||n.trace("received ping response pingId=%s",e.length),this.handlePingResponse(e.length)}}handlePingResponse(e){if(void 0===this.activePing)throw new tf("ping not requested",CC);if(this.activePing.id!==e)throw new tf("ping doesn't match our id",TC);this.activePing.resolve()}handleGoAway(e){var t,n;null===(t=this.log)||void 0===t||t.trace("received GoAway reason=%s",null!==(n=VC[e])&&void 0!==n?n:"unknown"),this.remoteGoAway=e;for(const r of this._streams.values())r.reset();this._closeMuxer()}async handleStreamMessage(e,t){const{streamID:n,flag:r,type:i}=e;(r&zC.SYN)===zC.SYN&&this.incomingStream(n);const o=this._streams.get(n);if(void 0!==o)switch(i){case HC.WindowUpdate:return void o.handleWindowUpdate(e);case HC.Data:if(void 0===t)throw new Error("unreachable");return void await o.handleData(e,t);default:throw new Error("unreachable")}else if(i===HC.Data){var s;if(null===(s=this.log)||void 0===s||s.call(this,"discarding data for stream id=%s",n),void 0===t)throw new Error("unreachable");await t()}else{var a;null===(a=this.log)||void 0===a||a.call(this,"frame for missing stream id=%s",n)}}incomingStream(e){var t,n,r;if(this.client!==(e%2===0))throw new tf("both endpoints are clients",BC);if(this._streams.has(e))return;if(null===(t=this.log)||void 0===t||t.trace("new incoming stream id=%s",e),void 0!==this.localGoAway)return void this.sendFrame({type:HC.WindowUpdate,flag:zC.RST,streamID:e,length:0});if(this.numInboundStreams>=this.config.maxInboundStreams)return null===(r=this.log)||void 0===r||r.call(this,"maxIncomingStreams exceeded, forcing stream reset"),void this.sendFrame({type:HC.WindowUpdate,flag:zC.RST,streamID:e,length:0});const i=this._newStream(e,void 0,ZC.SYNReceived,"inbound");this.numInboundStreams++,this._streams.set(e,i),null===(n=this.onIncomingStream)||void 0===n||n.call(this,i)}sendFrame(e,t){var n;if(null===(n=this.log)||void 0===n||n.trace("sending frame %o",e),e.type===HC.Data){if(void 0===t)throw new tf("invalid frame",RC);this.source.push(new Kr(KC(e),t))}else this.source.push(KC(e))}sendPing(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:zC.SYN;var n,r;t===zC.SYN?null===(n=this.log)||void 0===n||n.trace("sending ping request pingId=%s",e):null===(r=this.log)||void 0===r||r.trace("sending ping response pingId=%s",e);this.sendFrame({type:HC.Ping,flag:t,streamID:0,length:e})}sendGoAway(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:VC.NormalTermination;null===(e=this.log)||void 0===e||e.call(this,"sending GoAway reason=%s",VC[t]),this.localGoAway=t,this.sendFrame({type:HC.GoAway,flag:0,streamID:0,length:t})}}function tT(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>new $C(t,e)}function nT(e){try{let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){const n=e.getReader();try{for(;;){const e=await n.read();if(e.done)return;yield e.value}}finally{!0!==t.preventCancel&&await n.cancel(),n.releaseLock()}}()}catch(BJ){return Promise.reject(BJ)}}const rT="ERR_UNRECOGNIZED_VALIDITY",iT="ERR_SIGNATURE_VERIFICATION",oT="ERR_UNDEFINED_PARAMETER",sT="ERR_RECORD_TOO_LARGE";var aT;!function(e){let t,n,r;!function(e){e.EOL="EOL"}(t=e.ValidityType||(e.ValidityType={})),function(e){e[e.EOL=0]="EOL"}(n||(n={})),function(e){e.codec=()=>ia(n)}(t=e.ValidityType||(e.ValidityType={})),e.codec=()=>(null==r&&(r=oa((function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==r.lengthDelimited&&n.fork(),null!=t.value&&(n.uint32(10),n.bytes(t.value)),null!=t.signatureV1&&(n.uint32(18),n.bytes(t.signatureV1)),null!=t.validityType&&(n.uint32(24),e.ValidityType.codec().encode(t.validityType,n)),null!=t.validity&&(n.uint32(34),n.bytes(t.validity)),null!=t.sequence&&(n.uint32(40),n.uint64(t.sequence)),null!=t.ttl&&(n.uint32(48),n.uint64(t.ttl)),null!=t.pubKey&&(n.uint32(58),n.bytes(t.pubKey)),null!=t.signatureV2&&(n.uint32(66),n.bytes(t.signatureV2)),null!=t.data&&(n.uint32(74),n.bytes(t.data)),!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.value=t.bytes();break;case 2:r.signatureV1=t.bytes();break;case 3:r.validityType=e.ValidityType.codec().decode(t);break;case 4:r.validity=t.bytes();break;case 5:r.sequence=t.uint64();break;case 6:r.ttl=t.uint64();break;case 7:r.pubKey=t.bytes();break;case 8:r.signatureV2=t.bytes();break;case 9:r.data=t.bytes();break;default:t.skipType(7&n)}}return r}))),r),e.encode=t=>Xs(t,e.codec()),e.decode=t=>$o(t,e.codec())}(aT||(aT={}));const cT=Ld("ipns:utils"),lT=Fs("/ipns/"),uT=async(e,t)=>{if(null==t||null==e){const e=new Error("one or more of the provided parameters are not defined");throw cT.error(e),Or(e,oT)}let n;if(null!=t.pubKey){try{n=XA(t.pubKey)}catch(r){throw cT.error(r),r}if(!(await rp(t.pubKey)).equals(e))throw Or(new Error("Embedded public key did not match PeerID"),"ERR_INVALID_EMBEDDED_KEY")}else null!=e.publicKey&&(n=XA(e.publicKey));if(null!=n)return n;throw Or(new Error("no public key is available"),oT)},dT=e=>"signatureV1"in e?aT.encode({value:Fs(e.value),signatureV1:e.signatureV1,validityType:e.validityType,validity:Fs(e.validity),sequence:e.sequence,ttl:e.ttl,pubKey:e.pubKey,signatureV2:e.signatureV2,data:e.data}):aT.encode({pubKey:e.pubKey,signatureV2:e.signatureV2,data:e.data});function hT(e){const t=aT.decode(e);if(null!=t.sequence&&(t.sequence=BigInt(t.sequence)),null!=t.ttl&&(t.ttl=BigInt(t.ttl)),null==t.signatureV2||null==t.data)throw Or(new Error("missing data or signatureV2"),iT);const n=pT(t.data),r=gT(n.Value),i=cp(n.Validity);if(null!=t.value&&null!=t.signatureV1)return mT(t),{value:r,validityType:aT.ValidityType.EOL,validity:i,sequence:n.Sequence,ttl:n.TTL,pubKey:t.pubKey,signatureV1:t.signatureV1,signatureV2:t.signatureV2,data:t.data};if(null!=t.signatureV2)return{value:r,validityType:aT.ValidityType.EOL,validity:i,sequence:n.Sequence,ttl:n.TTL,pubKey:t.pubKey,signatureV2:t.signatureV2,data:t.data};throw new Error("invalid record: does not include signatureV1 or signatureV2")}const fT=e=>np(e.slice(lT.length)),pT=e=>{const t=Bl(e);if(0!==t.ValidityType)throw Or(new Error("Unknown validity type"),rT);return t.ValidityType=aT.ValidityType.EOL,Number.isInteger(t.Sequence)&&(t.Sequence=BigInt(t.Sequence)),Number.isInteger(t.TTL)&&(t.TTL=BigInt(t.TTL)),t},gT=e=>{if(null!=e){if(Gf(e))return"/ipns/".concat(e.toCID().toString(cs));if(e instanceof Uint8Array){const t=cp(e);t.startsWith("/")&&(e=t)}const t=e.toString().trim();if(t.startsWith("/")&&t.length>1)return t;const n=qi.asCID(e);if(null!=n)return 114===n.code?"/ipns/".concat(n.toString(cs)):"/ipfs/".concat(n.toV1().toString());try{return e instanceof Uint8Array?"/ipfs/".concat(qi.decode(e).toV1().toString()):"/ipfs/".concat(qi.parse(t).toV1().toString())}catch{}}throw Or(new Error("Value must be a valid content path starting with /"),"ERR_INVALID_VALUE")},mT=e=>{var t,n;if(null==e.data)throw Or(new Error("Record data is missing"),"ERR_INVALID_RECORD_DATA");const r=pT(e.data);if(!zr(r.Value,null!==(t=e.value)&&void 0!==t?t:new Uint8Array(0)))throw Or(new Error('Field "value" did not match between protobuf and CBOR'),iT);if(!zr(r.Validity,null!==(n=e.validity)&&void 0!==n?n:new Uint8Array(0)))throw Or(new Error('Field "validity" did not match between protobuf and CBOR'),iT);if(r.ValidityType!==e.validityType)throw Or(new Error('Field "validityType" did not match between protobuf and CBOR'),iT);if(r.Sequence!==e.sequence)throw Or(new Error('Field "sequence" did not match between protobuf and CBOR'),iT);if(r.TTL!==e.ttl)throw Or(new Error('Field "ttl" did not match between protobuf and CBOR'),iT)};var vT=n(7353);const yT=Ld("ipns:validator"),wT=10240,bT=async(e,t)=>{const n=hT(t);let r;try{const t=(i=n.data,Hr([Fs("ipns-signature:"),i]));r=await e.verify(t,n.signatureV2)}catch(o){r=!1}var i;if(!r)throw yT.error("record signature verification failed"),Or(new Error("record signature verification failed"),iT);if(n.validityType===aT.ValidityType.EOL){if(vT.fromString(n.validity).toDate().getTime()<Date.now())throw yT.error("record has expired"),Or(new Error("record has expired"),"ERR_IPNS_EXPIRED_RECORD")}else if(null!=n.validityType)throw yT.error("unrecognized validity type"),Or(new Error("unrecognized validity type"),rT);yT("ipns record for %s is valid",n.value)};async function ET(e,t){if(t.byteLength>wT)throw Or(new Error("record too large"),sT);const n=fT(e),r=hT(t),i=await uT(n,r);await bT(i,t)}async function*kT(e){const t=/\r?\n/,n=new TextDecoder("utf8");let r="";for await(let o of e){var i;"string"===typeof o&&(o=(new TextEncoder).encode(o)),r+=n.decode(o,{stream:!0});const e=r.split(t);r=null!==(i=e.pop())&&void 0!==i?i:"";for(let t=0;t<e.length;t++)yield JSON.parse(e[t])}r+=n.decode(),""!==r&&(yield JSON.parse(r))}const AT=Fs("/ipns/");function ST(e){return zr(e.subarray(0,AT.byteLength),AT)}const xT=e=>np(e.slice(AT.length));class _T{constructor(e){Dr(this,"client",void 0),this.client=e}findProviders(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){yield*iu(t.client.getProviders(e,n),(e=>{var t;return{id:e.ID,multiaddrs:null!==(t=e.Addrs)&&void 0!==t?t:[]}}))}()}catch(BJ){return Promise.reject(BJ)}}async provide(){}async put(e,t,n){if(!ST(e))return;const r=xT(e),i=hT(t);await this.client.putIPNS(r,i,n)}async get(e,t){if(!ST(e))throw new tf("Not found","ERR_NOT_FOUND");const n=xT(e);try{const e=await this.client.getIPNS(n,t);return dT(e)}catch(r){if("ERR_BAD_RESPONSE"===r.code)throw new tf("Not found","ERR_NOT_FOUND");throw r}}}class IT{constructor(e){Dr(this,"client",void 0),this.client=e}async findPeer(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=await Lr(this.client.getPeers(e,t));var r;if(null!=n)return{id:n.ID,multiaddrs:null!==(r=n.Addrs)&&void 0!==r?r:[]};throw new tf("Not found","ERR_NOT_FOUND")}getClosestPeers(e){try{return async function*(){}()}catch(BJ){return Promise.reject(BJ)}}}const RT=Ld("delegated-routing-v1-http-api-client"),CT=4,TT=3e4;var PT=new WeakSet;class NT{constructor(e){var t,n;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Au(this,PT),Dr(this,"started",void 0),Dr(this,"httpQueue",void 0),Dr(this,"shutDownController",void 0),Dr(this,"clientUrl",void 0),Dr(this,"timeout",void 0),Dr(this,"contentRouting",void 0),Dr(this,"peerRouting",void 0),this.started=!1,this.shutDownController=new AbortController,Wh(1/0,this.shutDownController.signal),this.httpQueue=new Xu({concurrency:null!==(t=r.concurrentRequests)&&void 0!==t?t:CT}),this.clientUrl=e instanceof URL?e:new URL(e),this.timeout=null!==(n=r.timeout)&&void 0!==n?n:TT,this.contentRouting=new _T(this),this.peerRouting=new IT(this)}get[Uv](){return this.contentRouting}get[jv](){return this.peerRouting}isStarted(){return this.started}start(){this.started=!0}stop(){this.httpQueue.clear(),this.shutDownController.abort(),this.started=!1}getProviders(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){RT("getProviders starts: %c",e);const r=AbortSignal.timeout(t.timeout),i=Qh([t.shutDownController.signal,r,n.signal]);Wh(1/0,r,i);const o=ou(),s=ou();t.httpQueue.add((async()=>(o.resolve(),s.promise)));try{await o.promise;const n="".concat(t.clientUrl,"routing/v1/providers/").concat(e.toString()),r={headers:{Accept:"application/x-ndjson"},signal:i},s=await fetch(n,r);if(404===s.status)throw new tf("No matching records found.","ERR_NOT_FOUND");if(422===s.status)throw new tf("Request does not conform to schema or semantic constraints.","ERR_INVALID_REQUEST");if(null==s.body)throw new tf("Routing response had no body","ERR_BAD_RESPONSE");if("application/json"===s.headers.get("Content-Type")){const e=await s.json();for(const n of e.Providers){const e=xu(PT,t,BT).call(t,n);null!=e&&(yield e)}}else for await(const e of kT(nT(s.body))){const n=xu(PT,t,BT).call(t,e);null!=n&&(yield n)}}catch(a){RT.error("getProviders errored:",a)}finally{i.clear(),s.resolve(),RT("getProviders finished: %c",e)}}()}catch(BJ){return Promise.reject(BJ)}}getPeers(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){RT("getPeers starts: %c",e);const r=AbortSignal.timeout(t.timeout),i=Qh([t.shutDownController.signal,r,n.signal]);Wh(1/0,r,i);const o=ou(),s=ou();t.httpQueue.add((async()=>(o.resolve(),s.promise)));try{await o.promise;const n="".concat(t.clientUrl,"routing/v1/peers/").concat(e.toCID().toString()),r={headers:{Accept:"application/x-ndjson"},signal:i},s=await fetch(n,r);if(404===s.status)throw new tf("No matching records found.","ERR_NOT_FOUND");if(422===s.status)throw new tf("Request does not conform to schema or semantic constraints.","ERR_INVALID_REQUEST");if(null==s.body)throw new tf("Routing response had no body","ERR_BAD_RESPONSE");if("application/json"===s.headers.get("Content-Type")){const e=await s.json();for(const n of e.Peers){const e=xu(PT,t,BT).call(t,n);null!=e&&(yield e)}}else for await(const e of kT(nT(s.body))){const n=xu(PT,t,BT).call(t,e);null!=n&&(yield n)}}catch(a){RT.error("getPeers errored:",a)}finally{i.clear(),s.resolve(),RT("getPeers finished: %c",e)}}()}catch(BJ){return Promise.reject(BJ)}}async getIPNS(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};RT("getIPNS starts: %c",e);const n=AbortSignal.timeout(this.timeout),r=Qh([this.shutDownController.signal,n,t.signal]);Wh(1/0,n,r);const i=ou(),o=ou();this.httpQueue.add((async()=>(i.resolve(),o.promise)));const s="".concat(this.clientUrl,"routing/v1/ipns/").concat(e.toCID().toString());try{await i.promise;const n={headers:{Accept:"application/vnd.ipfs.ipns-record"},signal:r},o=await fetch(s,n);if(RT("getIPNS GET %s %d",s,o.status),404===o.status)throw new tf("No matching records found.","ERR_NOT_FOUND");if(422===o.status)throw new tf("Request does not conform to schema or semantic constraints.","ERR_INVALID_REQUEST");if(null==o.body)throw new tf("GET ipns response had no body","ERR_BAD_RESPONSE");const a=await o.arrayBuffer(),c=new Uint8Array(a,0,a.byteLength);return!1!==t.validate&&await ET((e=>Hr([lT,e.toBytes()]))(e),c),hT(c)}catch(a){throw RT.error("getIPNS GET %s error:",s,a),a}finally{r.clear(),o.resolve(),RT("getIPNS finished: %c",e)}}async putIPNS(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};RT("putIPNS starts: %c",e);const r=AbortSignal.timeout(this.timeout),i=Qh([this.shutDownController.signal,r,n.signal]);Wh(1/0,r,i);const o=ou(),s=ou();this.httpQueue.add((async()=>(o.resolve(),s.promise)));const a="".concat(this.clientUrl,"routing/v1/ipns/").concat(e.toCID().toString());try{await o.promise;const e={method:"PUT",headers:{"Content-Type":"application/vnd.ipfs.ipns-record"},body:dT(t),signal:i},n=await fetch(a,e);if(RT("putIPNS PUT %s %d",a,n.status),200!==n.status)throw new tf("PUT ipns response had status other than 200","ERR_BAD_RESPONSE")}catch(c){throw RT.error("putIPNS PUT %s error:",a,c.stack),c}finally{i.clear(),s.resolve(),RT("putIPNS finished: %c",e)}}}function BT(e){var t,n;const r=[],i=null!==(t=null===(n=e.Addrs)||void 0===n?void 0:n.map(Dg))&&void 0!==t?t:[];return null!=e.Protocols&&r.push(...e.Protocols),null!=e.Protocol&&(r.push(e.Protocol),delete e.Protocol),{...e,Schema:"peer",ID:tp(e.ID),Addrs:i,Protocols:r}}var DT;!function(e){let t,n,r,i,o,s,a,c;!function(e){e.DIAL="DIAL",e.DIAL_RESPONSE="DIAL_RESPONSE"}(t=e.MessageType||(e.MessageType={})),function(e){e[e.DIAL=0]="DIAL",e[e.DIAL_RESPONSE=1]="DIAL_RESPONSE"}(n||(n={})),function(e){e.codec=()=>ia(n)}(t=e.MessageType||(e.MessageType={})),function(e){e.OK="OK",e.E_DIAL_ERROR="E_DIAL_ERROR",e.E_DIAL_REFUSED="E_DIAL_REFUSED",e.E_BAD_REQUEST="E_BAD_REQUEST",e.E_INTERNAL_ERROR="E_INTERNAL_ERROR"}(r=e.ResponseStatus||(e.ResponseStatus={})),function(e){e[e.OK=0]="OK",e[e.E_DIAL_ERROR=100]="E_DIAL_ERROR",e[e.E_DIAL_REFUSED=101]="E_DIAL_REFUSED",e[e.E_BAD_REQUEST=200]="E_BAD_REQUEST",e[e.E_INTERNAL_ERROR=300]="E_INTERNAL_ERROR"}(i||(i={})),function(e){e.codec=()=>ia(i)}(r=e.ResponseStatus||(e.ResponseStatus={})),function(e){let t;e.codec=()=>(null==t&&(t=oa((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==n.lengthDelimited&&t.fork(),null!=e.id&&(t.uint32(10),t.bytes(e.id)),null!=e.addrs)for(const r of e.addrs)t.uint32(18),t.bytes(r);!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={addrs:[]},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.id=e.bytes();break;case 2:n.addrs.push(e.bytes());break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>Xs(t,e.codec()),e.decode=t=>$o(t,e.codec())}(o=e.PeerInfo||(e.PeerInfo={})),function(t){let n;t.codec=()=>(null==n&&(n=oa((function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==r.lengthDelimited&&n.fork(),null!=t.peer&&(n.uint32(10),e.PeerInfo.codec().encode(t.peer,n)),!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();if(n>>>3===1)r.peer=e.PeerInfo.codec().decode(t,t.uint32());else t.skipType(7&n)}return r}))),n),t.encode=e=>Xs(e,t.codec()),t.decode=e=>$o(e,t.codec())}(s=e.Dial||(e.Dial={})),function(t){let n;t.codec=()=>(null==n&&(n=oa((function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==r.lengthDelimited&&n.fork(),null!=t.status&&(n.uint32(8),e.ResponseStatus.codec().encode(t.status,n)),null!=t.statusText&&(n.uint32(18),n.string(t.statusText)),null!=t.addr&&(n.uint32(26),n.bytes(t.addr)),!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.status=e.ResponseStatus.codec().decode(t);break;case 2:r.statusText=t.string();break;case 3:r.addr=t.bytes();break;default:t.skipType(7&n)}}return r}))),n),t.encode=e=>Xs(e,t.codec()),t.decode=e=>$o(e,t.codec())}(a=e.DialResponse||(e.DialResponse={})),e.codec=()=>(null==c&&(c=oa((function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==r.lengthDelimited&&n.fork(),null!=t.type&&(n.uint32(8),e.MessageType.codec().encode(t.type,n)),null!=t.dial&&(n.uint32(18),e.Dial.codec().encode(t.dial,n)),null!=t.dialResponse&&(n.uint32(26),e.DialResponse.codec().encode(t.dialResponse,n)),!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.type=e.MessageType.codec().decode(t);break;case 2:r.dial=e.Dial.codec().decode(t,t.uint32());break;case 3:r.dialResponse=e.DialResponse.codec().decode(t,t.uint32());break;default:t.skipType(7&n)}}return r}))),c),e.encode=t=>Xs(t,e.codec()),e.decode=t=>$o(t,e.codec())}(DT||(DT={}));class OT{constructor(e,t){var n,r,i,o,s,a;Dr(this,"components",void 0),Dr(this,"startupDelay",void 0),Dr(this,"refreshInterval",void 0),Dr(this,"protocol",void 0),Dr(this,"timeout",void 0),Dr(this,"maxInboundStreams",void 0),Dr(this,"maxOutboundStreams",void 0),Dr(this,"verifyAddressTimeout",void 0),Dr(this,"started",void 0),Dr(this,"log",void 0),this.components=e,this.log=e.logger.forComponent("libp2p:autonat"),this.started=!1,this.protocol="/".concat(null!==(n=t.protocolPrefix)&&void 0!==n?n:"libp2p","/").concat("autonat","/").concat("1.0.0"),this.timeout=null!==(r=t.timeout)&&void 0!==r?r:3e4,this.maxInboundStreams=null!==(i=t.maxInboundStreams)&&void 0!==i?i:1,this.maxOutboundStreams=null!==(o=t.maxOutboundStreams)&&void 0!==o?o:1,this.startupDelay=null!==(s=t.startupDelay)&&void 0!==s?s:5e3,this.refreshInterval=null!==(a=t.refreshInterval)&&void 0!==a?a:6e4,this._verifyExternalAddresses=this._verifyExternalAddresses.bind(this)}isStarted(){return this.started}async start(){this.started||(await this.components.registrar.handle(this.protocol,(e=>{this.handleIncomingAutonatStream(e).catch((e=>{this.log.error("error handling incoming autonat stream",e)}))}),{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams}),this.verifyAddressTimeout=setTimeout(this._verifyExternalAddresses,this.startupDelay),this.started=!0)}async stop(){await this.components.registrar.unhandle(this.protocol),clearTimeout(this.verifyAddressTimeout),this.started=!1}async handleIncomingAutonatStream(e){const t=AbortSignal.timeout(this.timeout),n=()=>{e.stream.abort(new tf("handleIncomingAutonatStream timeout",af))};t.addEventListener("abort",n,{once:!0}),Wh(1/0,t);const r=this.components.addressManager.getAddresses().map((e=>e.toOptions().host));try{const n=this;await gu(e.stream,(e=>Af(e)),(async function*(i){const o=await Lr(i);if(null==o)return n.log("no message received"),void(yield DT.encode({type:DT.MessageType.DIAL_RESPONSE,dialResponse:{status:DT.ResponseStatus.E_BAD_REQUEST,statusText:"No message was sent"}}));let s;try{s=DT.decode(o)}catch(f){return n.log.error("could not decode message",f),void(yield DT.encode({type:DT.MessageType.DIAL_RESPONSE,dialResponse:{status:DT.ResponseStatus.E_BAD_REQUEST,statusText:"Could not decode message"}}))}const a=s.dial;if(null==a)return n.log.error("dial was missing from message"),void(yield DT.encode({type:DT.MessageType.DIAL_RESPONSE,dialResponse:{status:DT.ResponseStatus.E_BAD_REQUEST,statusText:"No Dial message found in message"}}));let c;const l=a.peer;if(null==l||null==l.id)return n.log.error("PeerId missing from message"),void(yield DT.encode({type:DT.MessageType.DIAL_RESPONSE,dialResponse:{status:DT.ResponseStatus.E_BAD_REQUEST,statusText:"missing peer info"}}));try{c=np(l.id)}catch(f){return n.log.error("invalid PeerId",f),void(yield DT.encode({type:DT.MessageType.DIAL_RESPONSE,dialResponse:{status:DT.ResponseStatus.E_BAD_REQUEST,statusText:"bad peer id"}}))}if(n.log("incoming request from %p",c),!e.connection.remotePeer.equals(c))return n.log("target peer %p did not equal sending peer %p",c,e.connection.remotePeer),void(yield DT.encode({type:DT.MessageType.DIAL_RESPONSE,dialResponse:{status:DT.ResponseStatus.E_BAD_REQUEST,statusText:"peer id mismatch"}}));const u=l.addrs.map((e=>Dg(e))).filter((t=>{const r=t.toOptions().host===e.connection.remoteAddr.toOptions().host;return n.log.trace("request to dial %a was sent from %a is same host %s",t,e.connection.remoteAddr,r),r})).filter((e=>{var t;const r=e.toOptions().host,i=!(null!==(t=$p(r))&&void 0!==t&&t);return n.log.trace("host %s was public %s",r,i),i})).filter((e=>{const t=e.toOptions().host,i=!r.includes(t);return n.log.trace("host %s was not our host %s",t,i),i})).filter((e=>{const t=Boolean(n.components.transportManager.dialTransportForMultiaddr(e));return n.log.trace("transport for %a is supported %s",e,t),t})).map((e=>(null==e.getPeerId()&&(e=e.encapsulate("/p2p/".concat(c.toString()))),e)));if(0===u.length)return n.log("no valid multiaddrs for %p in message",c),void(yield DT.encode({type:DT.MessageType.DIAL_RESPONSE,dialResponse:{status:DT.ResponseStatus.E_DIAL_REFUSED,statusText:"no dialable addresses"}}));n.log("dial multiaddrs %s for peer %p",u.map((e=>e.toString())).join(", "),c);let d="",h=u[0];for await(const e of u){let r;h=e;try{if(r=await n.components.connectionManager.openConnection(e,{signal:t}),!r.remoteAddr.equals(e))throw n.log.error("tried to dial %a but dialed %a",e,r.remoteAddr),new Error("Unexpected remote address");return n.log("Success %p",c),void(yield DT.encode({type:DT.MessageType.DIAL_RESPONSE,dialResponse:{status:DT.ResponseStatus.OK,addr:r.remoteAddr.decapsulateCode(ag("p2p").code).bytes}}))}catch(f){n.log("could not dial %p",c,f),d=f.message}finally{null!=r&&await r.close()}}yield DT.encode({type:DT.MessageType.DIAL_RESPONSE,dialResponse:{status:DT.ResponseStatus.E_DIAL_ERROR,statusText:d,addr:h.bytes}})}),(e=>bf(e)),e.stream)}catch(i){this.log.error("error handling incoming autonat stream",i)}finally{t.removeEventListener("abort",n)}}_verifyExternalAddresses(){this.verifyExternalAddresses().catch((e=>{this.log.error("error verifying external address",e)}))}async verifyExternalAddresses(){if(clearTimeout(this.verifyAddressTimeout),!this.isStarted())return;const e=this.components.addressManager,t=e.getObservedAddrs().filter((e=>{var t;return!(null!==(t=$p(e.toOptions().host))&&void 0!==t&&t)}));if(0===t.length)return this.log("no public addresses found, not requesting verification"),void(this.verifyAddressTimeout=setTimeout(this._verifyExternalAddresses,this.refreshInterval));const n=AbortSignal.timeout(this.timeout);Wh(1/0,n);const r=this;try{this.log("verify multiaddrs %s",t.map((e=>e.toString())).join(", "));const o=DT.encode({type:DT.MessageType.DIAL,dial:{peer:{id:this.components.peerId.toBytes(),addrs:t.map((e=>e.bytes))}}}),s=(await yS()).toBytes(),a={},c=[],l=async e=>{let t=()=>{};try{this.log("asking %p to verify multiaddr",e.id);const i=await r.components.connectionManager.openConnection(e.id,{signal:n}),s=await i.newStream(this.protocol,{signal:n});t=()=>{s.abort(new tf("verifyAddress timeout",af))},n.addEventListener("abort",t,{once:!0});const a=await gu([o],(e=>bf(e)),s,(e=>Af(e)),(async e=>Lr(e)));if(null==a)return void this.log("no response received from %p",i.remotePeer);const l=DT.decode(a);if(l.type!==DT.MessageType.DIAL_RESPONSE||null==l.dialResponse)return void this.log("invalid autonat response from %p",i.remotePeer);if(l.dialResponse.status===DT.ResponseStatus.OK){const e=i.remoteAddr.toOptions();let t;if(4===e.family){t=e.host.split(".")[0]}else{if(6!==e.family)return void this.log('remote address "%s" was not IP4 or IP6?',e.host);t=e.host.split(":")[0]}if(c.includes(t))return void this.log("already have response from network segment %d - %s",t,e.host);c.push(t)}return l.dialResponse}catch(i){this.log.error("error asking remote to verify multiaddr",i)}finally{n.removeEventListener("abort",t)}};for await(const r of cu(iu(this.components.peerRouting.getClosestPeers(s,{signal:n}),(e=>async()=>l(e))),{concurrency:4}))try{if(null==r)continue;const n=null==r.addr?t[0]:Dg(r.addr);if(this.log("autonat response for %a is %s",n,r.status),r.status===DT.ResponseStatus.E_BAD_REQUEST)continue;if(r.status===DT.ResponseStatus.E_DIAL_REFUSED)continue;if(null==r.addr&&t.length>1)continue;if(!t.some((e=>e.equals(n)))){this.log("peer reported %a as %s but it was not in our observed address list",n,r.status);continue}const i=n.toString();if(null==a[i]&&(a[i]={success:0,failure:0}),r.status===DT.ResponseStatus.OK?a[i].success++:r.status===DT.ResponseStatus.E_DIAL_ERROR&&a[i].failure++,4===a[i].success)return this.log("%a is externally dialable",n),void e.confirmObservedAddr(n);if(4===a[i].failure)return this.log("%a is not externally dialable",n),void e.removeObservedAddr(n)}catch(i){this.log.error("could not verify external address",i)}}finally{this.verifyAddressTimeout=setTimeout(this._verifyExternalAddresses,this.refreshInterval)}}}function LT(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>new OT(t,e)}const MT=pP("dns4"),FT=pP("dns6"),UT=pP("dnsaddr"),jT=fP(pP("dns"),UT,MT,FT),HT=fP(pP("ip4"),pP("ip6")),zT=fP(hP(HT,pP("tcp")),hP(jT,pP("tcp"))),VT=hP(HT,pP("udp")),qT=hP(VT,pP("utp")),GT=hP(VT,pP("quic")),KT=hP(VT,pP("quic-v1")),WT=fP(hP(zT,pP("ws")),hP(jT,pP("ws"))),QT=fP(hP(WT,pP("p2p")),WT),YT=fP(hP(zT,pP("wss")),hP(jT,pP("wss")),hP(zT,pP("tls"),pP("ws")),hP(jT,pP("tls"),pP("ws"))),ZT=fP(hP(YT,pP("p2p")),YT),JT=fP(hP(zT,pP("http")),hP(HT,pP("http")),hP(jT,pP("http"))),XT=fP(hP(zT,pP("https")),hP(HT,pP("https")),hP(jT,pP("https"))),$T=hP(VT,pP("webrtc-direct"),pP("certhash")),eP=fP(hP($T,pP("p2p")),$T),tP=hP(KT,pP("webtransport"),pP("certhash"),pP("certhash")),nP=fP(hP(tP,pP("p2p")),tP),rP=fP(hP(QT,pP("p2p-webrtc-star"),pP("p2p")),hP(ZT,pP("p2p-webrtc-star"),pP("p2p")),hP(QT,pP("p2p-webrtc-star")),hP(ZT,pP("p2p-webrtc-star"))),iP=(fP(hP(QT,pP("p2p-websocket-star"),pP("p2p")),hP(ZT,pP("p2p-websocket-star"),pP("p2p")),hP(QT,pP("p2p-websocket-star")),hP(ZT,pP("p2p-websocket-star"))),fP(hP(JT,pP("p2p-webrtc-direct"),pP("p2p")),hP(XT,pP("p2p-webrtc-direct"),pP("p2p")),hP(JT,pP("p2p-webrtc-direct")),hP(XT,pP("p2p-webrtc-direct")))),oP=fP(WT,YT,JT,XT,rP,iP,zT,qT,GT,jT,eP,nP),sP=(fP(hP(oP,pP("p2p-stardust"),pP("p2p")),hP(oP,pP("p2p-stardust"))),fP(hP(oP,pP("p2p")),rP,iP,eP,nP,pP("p2p"))),aP=fP(hP(sP,pP("p2p-circuit"),sP),hP(sP,pP("p2p-circuit")),hP(pP("p2p-circuit"),sP),hP(oP,pP("p2p-circuit")),hP(pP("p2p-circuit"),oP),pP("p2p-circuit")),cP=()=>fP(hP(aP,cP),aP),lP=cP(),uP=fP(hP(lP,sP,lP),hP(sP,lP),hP(lP,sP),lP,sP);fP(hP(lP,pP("webrtc"),pP("p2p")),hP(lP,pP("webrtc")),hP(oP,pP("webrtc"),pP("p2p")),hP(oP,pP("webrtc")),pP("webrtc"));function dP(e){return function(t){let n;try{n=Dg(t)}catch(i){return!1}const r=e(n.protoNames());return null!==r&&(!0===r||!1===r?r:0===r.length)}}function hP(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];function r(e){if(e.length<t.length)return null;let n=e;return t.some((t=>(n="function"===typeof t?t().partialMatch(e):t.partialMatch(e),Array.isArray(n)&&(e=n),null===n))),n}return{toString:function(){return"{ "+t.join(" ")+" }"},input:t,matches:dP(r),partialMatch:r}}function fP(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];function r(e){let n=null;return t.some((t=>{const r="function"===typeof t?t().partialMatch(e):t.partialMatch(e);return null!=r&&(n=r,!0)})),n}return{toString:function(){return"{ "+t.join(" ")+" }"},input:t,matches:dP(r),partialMatch:r}}function pP(e){const t=e;return{toString:function(){return t},matches:function(e){let n;try{n=Dg(e)}catch(i){return!1}const r=n.protoNames();return 1===r.length&&r[0]===t},partialMatch:function(e){return 0===e.length?null:e[0]===t?e.slice(1):null}}}class gP extends Jh{constructor(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{list:[]};if(null==n.list||0===n.list.length)throw new Error("Bootstrap requires a list of peer addresses");super(),Dr(this,"log",void 0),Dr(this,"timer",void 0),Dr(this,"list",void 0),Dr(this,"timeout",void 0),Dr(this,"components",void 0),Dr(this,"_init",void 0),Dr(this,mS,this),Dr(this,Symbol.toStringTag,"@libp2p/bootstrap"),this.components=e,this.log=e.logger.forComponent("libp2p:bootstrap"),this.timeout=null!==(t=n.timeout)&&void 0!==t?t:1e3,this.list=[];for(const r of n.list){if(!uP.matches(r)){this.log.error("Invalid multiaddr");continue}const e=Dg(r),t=e.getPeerId();if(null==t){this.log.error("Invalid bootstrap multiaddr without peer id");continue}const n={id:tp(t),multiaddrs:[e]};this.list.push(n)}this._init=n}isStarted(){return Boolean(this.timer)}start(){this.isStarted()||(this.log("Starting bootstrap node discovery, discovering peers after %s ms",this.timeout),this.timer=setTimeout((()=>{this._discoverBootstrapPeers().catch((e=>{this.log.error(e)}))}),this.timeout))}async _discoverBootstrapPeers(){if(null!=this.timer)for(const r of this.list){var e,t,n;if(await this.components.peerStore.merge(r.id,{tags:{[null!==(e=this._init.tagName)&&void 0!==e?e:"bootstrap"]:{value:null!==(t=this._init.tagValue)&&void 0!==t?t:50,ttl:null!==(n=this._init.tagTTL)&&void 0!==n?n:12e4}}}),null==this.timer)return;this.safeDispatchEvent("peer",{detail:r})}}stop(){null!=this.timer&&clearTimeout(this.timer),this.timer=void 0}}function mP(e){return t=>new gP(t,e)}function vP(e){const{stream:t,remoteAddr:n,logger:r}=e,i=r.forComponent("libp2p:stream:converter");let o=!1,s=!1;const a=t.close.bind(t);t.close=async e=>{await a(e),d(!0)};const c=t.abort.bind(t);t.abort=e=>{c(e),d(!0)};const l=t.sink.bind(t);t.sink=async e=>{try{await l(e)}catch(t){"aborted"!==t.type&&i.error("%s error in sink",n,t)}finally{s=!0,d()}};const u={log:i,sink:t.sink,source:async function*(){try{for await(const e of t.source)e instanceof Uint8Array?yield e:yield*e}finally{o=!0,d()}}(),remoteAddr:n,timeline:{open:Date.now(),close:void 0},close:t.close,abort:t.abort};function d(e){!0===e&&(o=!0,s=!0),o&&s&&null==u.timeline.close&&(u.timeline.close=Date.now())}return u}function yP(e,t){const n=qx(e,t),r={read:async(e,t)=>{const r=await n.read(t);return e.decode(r)},write:async(e,t,r)=>{await n.write(t.encode(e),r)},writeV:async(e,t,r)=>{await n.writeV(e.map((e=>t.encode(e))),r)},pb:e=>({read:async t=>r.read(e,t),write:async(t,n)=>r.write(t,e,n),writeV:async(t,n)=>r.writeV(t,e,n),unwrap:()=>r}),unwrap:()=>n.unwrap()};return r}Dr(gP,"tag","bootstrap");const wP="circuit-relay-relay",bP=(BigInt(1<<17),"/libp2p/circuit/relay/0.2.0/hop"),EP="/libp2p/circuit/relay/0.2.0/stop",kP="ERR_RELAYED_DIAL";var AP,SP,xP,_P,IP,RP,CP,TP;function PP(e){const t=e*BigInt(1e3),n=(new Date).getTime();return Number(t-BigInt(n))}!function(e){let t,n,r;!function(e){e.RESERVE="RESERVE",e.CONNECT="CONNECT",e.STATUS="STATUS"}(t=e.Type||(e.Type={})),function(e){e[e.RESERVE=0]="RESERVE",e[e.CONNECT=1]="CONNECT",e[e.STATUS=2]="STATUS"}(n||(n={})),function(e){e.codec=()=>ia(n)}(t=e.Type||(e.Type={})),e.codec=()=>(null==r&&(r=oa((function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==r.lengthDelimited&&n.fork(),null!=t.type&&(n.uint32(8),e.Type.codec().encode(t.type,n)),null!=t.peer&&(n.uint32(18),xP.codec().encode(t.peer,n)),null!=t.reservation&&(n.uint32(26),_P.codec().encode(t.reservation,n)),null!=t.limit&&(n.uint32(34),IP.codec().encode(t.limit,n)),null!=t.status&&(n.uint32(40),RP.codec().encode(t.status,n)),!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.type=e.Type.codec().decode(t);break;case 2:r.peer=xP.codec().decode(t,t.uint32());break;case 3:r.reservation=_P.codec().decode(t,t.uint32());break;case 4:r.limit=IP.codec().decode(t,t.uint32());break;case 5:r.status=RP.codec().decode(t);break;default:t.skipType(7&n)}}return r}))),r),e.encode=t=>Xs(t,e.codec()),e.decode=t=>$o(t,e.codec())}(AP||(AP={})),function(e){let t,n,r;!function(e){e.CONNECT="CONNECT",e.STATUS="STATUS"}(t=e.Type||(e.Type={})),function(e){e[e.CONNECT=0]="CONNECT",e[e.STATUS=1]="STATUS"}(n||(n={})),function(e){e.codec=()=>ia(n)}(t=e.Type||(e.Type={})),e.codec=()=>(null==r&&(r=oa((function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==r.lengthDelimited&&n.fork(),null!=t.type&&(n.uint32(8),e.Type.codec().encode(t.type,n)),null!=t.peer&&(n.uint32(18),xP.codec().encode(t.peer,n)),null!=t.limit&&(n.uint32(26),IP.codec().encode(t.limit,n)),null!=t.status&&(n.uint32(32),RP.codec().encode(t.status,n)),!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.type=e.Type.codec().decode(t);break;case 2:r.peer=xP.codec().decode(t,t.uint32());break;case 3:r.limit=IP.codec().decode(t,t.uint32());break;case 4:r.status=RP.codec().decode(t);break;default:t.skipType(7&n)}}return r}))),r),e.encode=t=>Xs(t,e.codec()),e.decode=t=>$o(t,e.codec())}(SP||(SP={})),function(e){let t;e.codec=()=>(null==t&&(t=oa((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==n.lengthDelimited&&t.fork(),null!=e.id&&e.id.byteLength>0&&(t.uint32(10),t.bytes(e.id)),null!=e.addrs)for(const r of e.addrs)t.uint32(18),t.bytes(r);!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={id:new Uint8Array(0),addrs:[]},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.id=e.bytes();break;case 2:n.addrs.push(e.bytes());break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>Xs(t,e.codec()),e.decode=t=>$o(t,e.codec())}(xP||(xP={})),function(e){let t;e.codec=()=>(null==t&&(t=oa((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==n.lengthDelimited&&t.fork(),null!=e.expire&&0n!==e.expire&&(t.uint32(8),t.uint64(e.expire)),null!=e.addrs)for(const r of e.addrs)t.uint32(18),t.bytes(r);null!=e.voucher&&(t.uint32(26),t.bytes(e.voucher)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={expire:0n,addrs:[]},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.expire=e.uint64();break;case 2:n.addrs.push(e.bytes());break;case 3:n.voucher=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>Xs(t,e.codec()),e.decode=t=>$o(t,e.codec())}(_P||(_P={})),function(e){let t;e.codec=()=>(null==t&&(t=oa((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.duration&&(t.uint32(8),t.uint32(e.duration)),null!=e.data&&(t.uint32(16),t.uint64(e.data)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.duration=e.uint32();break;case 2:n.data=e.uint64();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>Xs(t,e.codec()),e.decode=t=>$o(t,e.codec())}(IP||(IP={})),function(e){e.UNUSED="UNUSED",e.OK="OK",e.RESERVATION_REFUSED="RESERVATION_REFUSED",e.RESOURCE_LIMIT_EXCEEDED="RESOURCE_LIMIT_EXCEEDED",e.PERMISSION_DENIED="PERMISSION_DENIED",e.CONNECTION_FAILED="CONNECTION_FAILED",e.NO_RESERVATION="NO_RESERVATION",e.MALFORMED_MESSAGE="MALFORMED_MESSAGE",e.UNEXPECTED_MESSAGE="UNEXPECTED_MESSAGE"}(RP||(RP={})),function(e){e[e.UNUSED=0]="UNUSED",e[e.OK=100]="OK",e[e.RESERVATION_REFUSED=200]="RESERVATION_REFUSED",e[e.RESOURCE_LIMIT_EXCEEDED=201]="RESOURCE_LIMIT_EXCEEDED",e[e.PERMISSION_DENIED=202]="PERMISSION_DENIED",e[e.CONNECTION_FAILED=203]="CONNECTION_FAILED",e[e.NO_RESERVATION=204]="NO_RESERVATION",e[e.MALFORMED_MESSAGE=400]="MALFORMED_MESSAGE",e[e.UNEXPECTED_MESSAGE=401]="UNEXPECTED_MESSAGE"}(CP||(CP={})),function(e){e.codec=()=>ia(CP)}(RP||(RP={})),function(e){let t;e.codec=()=>(null==t&&(t=oa((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.relay&&e.relay.byteLength>0&&(t.uint32(10),t.bytes(e.relay)),null!=e.peer&&e.peer.byteLength>0&&(t.uint32(18),t.bytes(e.peer)),null!=e.expiration&&0n!==e.expiration&&(t.uint32(24),t.uint64(e.expiration)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={relay:new Uint8Array(0),peer:new Uint8Array(0),expiration:0n},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.relay=e.bytes();break;case 2:n.peer=e.bytes();break;case 3:n.expiration=e.uint64();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>Xs(t,e.codec()),e.decode=t=>$o(t,e.codec())}(TP||(TP={}));class NP extends Jh{constructor(e){super(),Dr(this,"peerId",void 0),Dr(this,"peerStore",void 0),Dr(this,"contentRouting",void 0),Dr(this,"registrar",void 0),Dr(this,"started",void 0),Dr(this,"topologyId",void 0),Dr(this,"log",void 0),this.log=e.logger.forComponent("libp2p:circuit-relay:discover-relays"),this.started=!1,this.peerId=e.peerId,this.peerStore=e.peerStore,this.contentRouting=e.contentRouting,this.registrar=e.registrar}isStarted(){return this.started}async start(){this.topologyId=await this.registrar.register(bP,{notifyOnTransient:!0,onConnect:e=>{this.safeDispatchEvent("relay:discover",{detail:e})}}),this.started=!0}afterStart(){this.discover().catch((e=>{this.log.error("error discovering relays",e)}))}stop(){null!=this.topologyId&&this.registrar.unregister(this.topologyId),this.started=!1}async discover(){this.log("searching peer store for relays");const e=await this.peerStore.all({filters:[e=>e.protocols.includes(bP)],orders:[()=>Math.random()<.5?1:-1]});for(const n of e)this.log("found relay peer %p in content peer store",n.id),this.safeDispatchEvent("relay:discover",{detail:n.id});this.log("found %d relay peers in peer store",e.length);try{this.log("searching content routing for relays");const e=await async function(e){const t=(new TextEncoder).encode(e),n=await Ps.digest(t);return qi.createV0(n)}("/libp2p/relay");let t=0;for await(const n of this.contentRouting.findProviders(e))if(n.multiaddrs.length>0&&!n.id.equals(this.peerId)){const e=n.id;t++,await this.peerStore.merge(e,{multiaddrs:n.multiaddrs}),this.log("found relay peer %p in content routing",e),this.safeDispatchEvent("relay:discover",{detail:e})}this.log("found %d relay peers in content routing",t)}catch(t){this.log.error("failed when finding relays on the network",t)}}}var BP=new WeakSet;class DP extends Jh{constructor(e){super(),Au(this,BP),Dr(this,"connectionManager",void 0),Dr(this,"relayStore",void 0),Dr(this,"listeningAddrs",void 0),Dr(this,"log",void 0),Dr(this,"_onRemoveRelayPeer",(e=>{xu(BP,this,OP).call(this,e.detail)})),this.log=e.logger.forComponent("libp2p:circuit-relay:transport:listener"),this.connectionManager=e.connectionManager,this.relayStore=e.relayStore,this.listeningAddrs=new op,this.relayStore.addEventListener("relay:removed",this._onRemoveRelayPeer)}async listen(e){this.log("listen on %a",e);const t=e.decapsulate("/p2p-circuit"),n=await this.connectionManager.openConnection(t);if(!this.relayStore.hasReservation(n.remotePeer))return this.log("making reservation on peer %p",n.remotePeer),void await this.relayStore.addRelay(n.remotePeer,"configured");const r=this.relayStore.getReservation(n.remotePeer);if(null==r)throw new tf("Did not have reservation after making reservation","ERR_NO_RESERVATION");this.listeningAddrs.has(n.remotePeer)?this.log("already listening on relay %p",n.remotePeer):(this.listeningAddrs.set(n.remotePeer,r.addrs.map((e=>Dg(e).encapsulate("/p2p-circuit")))),this.safeDispatchEvent("listening",{}))}getAddrs(){return[...this.listeningAddrs.values()].flat()}async close(){}}function OP(e){const t=this.listeningAddrs.has(e);this.log("relay peer removed %p - had reservation",e,t),this.listeningAddrs.delete(e),t&&(this.log.trace("removing relay event listener for peer %p",e),this.relayStore.removeEventListener("relay:removed",this._onRemoveRelayPeer),this.safeDispatchEvent("close",{}))}var LP=new WeakSet;class MP extends Jh{constructor(e,t){var n,r,i,o;super(),Au(this,LP),Dr(this,"peerId",void 0),Dr(this,"connectionManager",void 0),Dr(this,"transportManager",void 0),Dr(this,"peerStore",void 0),Dr(this,"events",void 0),Dr(this,"reserveQueue",void 0),Dr(this,"reservations",void 0),Dr(this,"maxDiscoveredRelays",void 0),Dr(this,"maxReservationQueueLength",void 0),Dr(this,"reservationCompletionTimeout",void 0),Dr(this,"started",void 0),Dr(this,"log",void 0),this.log=e.logger.forComponent("libp2p:circuit-relay:transport:reservation-store"),this.peerId=e.peerId,this.connectionManager=e.connectionManager,this.transportManager=e.transportManager,this.peerStore=e.peerStore,this.events=e.events,this.reservations=new op,this.maxDiscoveredRelays=null!==(n=null===t||void 0===t?void 0:t.discoverRelays)&&void 0!==n?n:0,this.maxReservationQueueLength=null!==(r=null===t||void 0===t?void 0:t.maxReservationQueueLength)&&void 0!==r?r:100,this.reservationCompletionTimeout=null!==(i=null===t||void 0===t?void 0:t.reservationCompletionTimeout)&&void 0!==i?i:1e4,this.started=!1,this.reserveQueue=new mf({concurrency:null!==(o=null===t||void 0===t?void 0:t.reservationConcurrency)&&void 0!==o?o:1,metricName:"libp2p_relay_reservation_queue",metrics:e.metrics}),this.events.addEventListener("peer:disconnect",(e=>{xu(LP,this,UP).call(this,e.detail)}))}isStarted(){return this.started}start(){this.started=!0}stop(){this.reserveQueue.clear(),this.reservations.forEach((e=>{let{timeout:t}=e;clearTimeout(t)})),this.reservations.clear(),this.started=!1}async addRelay(e,t){this.peerId.equals(e)?this.log("not trying to use self as relay"):this.reserveQueue.size>this.maxReservationQueueLength?this.log("not adding relay as the queue is full"):this.reserveQueue.has(e)?this.log("relay peer is already in the reservation queue"):(this.log("add relay %p",e),await this.reserveQueue.add((async()=>{try{const n=this.reservations.get(e);if(null!=n){if(PP(n.reservation.expire)>6e5)return void this.log("already have reservation on relay peer %p and it expires in more than 10 minutes",e);clearTimeout(n.timeout),this.reservations.delete(e)}if("discovered"===t&&[...this.reservations.values()].reduce(((e,t)=>("discovered"===t.type&&e++,e)),0)>=this.maxDiscoveredRelays)return void this.log("already have enough discovered relays");const r=AbortSignal.timeout(this.reservationCompletionTimeout),i=await this.connectionManager.openConnection(e,{signal:r});if(i.remoteAddr.protoNames().includes("p2p-circuit"))return void this.log("not creating reservation over relayed connection");const o=await xu(LP,this,FP).call(this,i,{signal:r});this.log("created reservation on relay peer %p",e);const s=PP(o.expire),a=Math.min(Math.max(s-3e5,3e4),Math.pow(2,31)-1),c=setTimeout((()=>{this.addRelay(e,t).catch((t=>{this.log.error("could not refresh reservation to relay %p",e,t)}))}),a);this.reservations.set(e,{timeout:c,reservation:o,type:t}),await this.peerStore.merge(e,{tags:{[wP]:{value:1,ttl:s}}}),await this.transportManager.listen([Dg("/p2p/".concat(e.toString(),"/p2p-circuit"))])}catch(n){this.log.error("could not reserve slot on %p",e,n);const t=this.reservations.get(e);null!=t&&clearTimeout(t.timeout),this.reservations.delete(e)}}),{peerId:e}))}hasReservation(e){return this.reservations.has(e)}getReservation(e){var t;return null===(t=this.reservations.get(e))||void 0===t?void 0:t.reservation}}async function FP(e,t){var n,r;null===(n=t.signal)||void 0===n||n.throwIfAborted(),this.log("requesting reservation from %p",e.remotePeer);const i=await e.newStream(bP,t),o=yP(i).pb(AP);let s;await o.write({type:AP.Type.RESERVE},t);try{s=await o.read(t)}catch(c){throw this.log.error("error parsing reserve message response from %p because",e.remotePeer,c),i.abort(c),c}finally{await i.close()}if(s.status===RP.OK&&null!=s.reservation){let t=!1;const n=e.remoteAddr.bytes;for(const e of s.reservation.addrs)if(zr(n,e)){t=!0;break}return t||s.reservation.addrs.push(n),s.reservation}const a="reservation failed with status ".concat(null!==(r=s.status)&&void 0!==r?r:"undefined");throw this.log.error(a),new Error(a)}function UP(e){const t=this.reservations.get(e);null!=t&&(this.log("connection to relay %p closed, removing reservation from local store",e),clearTimeout(t.timeout),this.reservations.delete(e),this.safeDispatchEvent("relay:removed",{detail:e}),this.reservations.size<this.maxDiscoveredRelays&&(this.log("not enough relays %d/%d",this.reservations.size,this.maxDiscoveredRelays),this.safeDispatchEvent("relay:not-enough-relays",{})))}const jP=300,HP=300,zP=3e4;class VP{constructor(e,t){var n,r,i;Dr(this,"discovery",void 0),Dr(this,"registrar",void 0),Dr(this,"peerStore",void 0),Dr(this,"connectionManager",void 0),Dr(this,"transportManager",void 0),Dr(this,"peerId",void 0),Dr(this,"upgrader",void 0),Dr(this,"addressManager",void 0),Dr(this,"connectionGater",void 0),Dr(this,"reservationStore",void 0),Dr(this,"logger",void 0),Dr(this,"maxInboundStopStreams",void 0),Dr(this,"maxOutboundStopStreams",void 0),Dr(this,"stopTimeout",void 0),Dr(this,"started",void 0),Dr(this,"log",void 0),Dr(this,rx,!0),Dr(this,Symbol.toStringTag,"libp2p/circuit-relay-v2"),this.log=e.logger.forComponent("libp2p:circuit-relay:transport"),this.registrar=e.registrar,this.peerStore=e.peerStore,this.connectionManager=e.connectionManager,this.transportManager=e.transportManager,this.logger=e.logger,this.peerId=e.peerId,this.upgrader=e.upgrader,this.addressManager=e.addressManager,this.connectionGater=e.connectionGater,this.maxInboundStopStreams=null!==(n=t.maxInboundStopStreams)&&void 0!==n?n:jP,this.maxOutboundStopStreams=null!==(r=t.maxOutboundStopStreams)&&void 0!==r?r:HP,this.stopTimeout=null!==(i=t.stopTimeout)&&void 0!==i?i:zP,null!=t.discoverRelays&&t.discoverRelays>0&&(this.discovery=new NP(e),this.discovery.addEventListener("relay:discover",(e=>{this.reservationStore.addRelay(e.detail,"discovered").catch((t=>{this.log.error("could not add discovered relay %p",e.detail,t)}))}))),this.reservationStore=new MP(e,t),this.reservationStore.addEventListener("relay:not-enough-relays",(()=>{var e;null===(e=this.discovery)||void 0===e||e.discover().catch((e=>{this.log.error("could not discover relays",e)}))})),this.started=!1}isStarted(){return this.started}async start(){var e;this.reservationStore.start(),await this.registrar.handle(EP,(e=>{this.onStop(e).catch((t=>{this.log.error("error while handling STOP protocol",t),e.stream.abort(t)}))}),{maxInboundStreams:this.maxInboundStopStreams,maxOutboundStreams:this.maxOutboundStopStreams,runOnTransientConnection:!0}),await(null===(e=this.discovery)||void 0===e?void 0:e.start()),this.started=!0}afterStart(){var e;null===(e=this.discovery)||void 0===e||e.afterStart()}async stop(){var e;null===(e=this.discovery)||void 0===e||e.stop(),this.reservationStore.stop(),await this.registrar.unhandle(EP),this.started=!1}async dial(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(1!==e.protoCodes().filter((e=>290===e)).length){const t="Invalid circuit relay address";throw this.log.error(t,e),new tf(t,kP)}const n=e.toString().split("/p2p-circuit"),r=Dg(n[0]),i=Dg(n[n.length-1]),o=r.getPeerId(),s=i.getPeerId();if(null==o||null==s){const t="Circuit relay dial to ".concat(e.toString()," failed as address did not have peer ids");throw this.log.error(t),new tf(t,kP)}const a=tp(o),c=tp(s);let l=!1;let u,d=this.connectionManager.getConnections(a)[0];null==d&&(await this.peerStore.merge(a,{multiaddrs:[r]}),d=await this.connectionManager.openConnection(a,t),l=!0);try{return u=await d.newStream(bP),await this.connectV2({stream:u,connection:d,destinationPeer:c,destinationAddr:i,relayAddr:r,ma:e,disconnectOnFailure:l})}catch(h){throw this.log.error("circuit relay dial to destination %p via relay %p failed",c,a,h),null!=u&&u.abort(h),l&&await d.close(),h}}async connectV2(e){let{stream:t,connection:n,destinationPeer:r,destinationAddr:i,relayAddr:o,ma:s,disconnectOnFailure:a}=e;try{const e=yP(t),n=e.pb(AP);await n.write({type:AP.Type.CONNECT,peer:{id:r.toBytes(),addrs:[Dg(i).bytes]}});const a=await n.read();var c,l;if(a.status!==RP.OK)throw new tf("failed to connect via relay with status ".concat(null!==(c=null===a||void 0===a||null===(l=a.status)||void 0===l?void 0:l.toString())&&void 0!==c?c:"undefined"),"ERR_HOP_REQUEST_FAILED");const u=vP({stream:e.unwrap(),remoteAddr:s,localAddr:o.encapsulate("/p2p-circuit/p2p/".concat(this.peerId.toString())),logger:this.logger});return this.log("new outbound transient connection %a",u.remoteAddr),await this.upgrader.upgradeOutbound(u,{transient:!0})}catch(u){throw this.log.error("Circuit relay dial to destination ".concat(r.toString()," via relay ").concat(n.remotePeer.toString()," failed"),u),a&&await n.close(),u}}createListener(e){return function(e){return new DP(e)}({connectionManager:this.connectionManager,relayStore:this.reservationStore,logger:this.logger})}listenFilter(e){return(e=Array.isArray(e)?e:[e]).filter((e=>lP.matches(e)))}dialFilter(e){return this.listenFilter(e)}async onStop(e){var t,n;let{connection:r,stream:i}=e;if(!this.reservationStore.hasReservation(r.remotePeer))try{this.log("dialed via relay we did not have a reservation on, start listening on that relay address"),await this.transportManager.listen([r.remoteAddr.encapsulate("/p2p-circuit")])}catch(h){this.log.error("failed to listen on a relay peer we were dialed via but did not have a reservation on",h)}const o=AbortSignal.timeout(this.stopTimeout),s=yP(i).pb(SP),a=await s.read({signal:o});if(this.log("new circuit relay v2 stop stream from %p with type %s",r.remotePeer,a.type),void 0===(null===a||void 0===a?void 0:a.type))return this.log.error("type was missing from circuit v2 stop protocol request from %s",r.remotePeer),await s.write({type:SP.Type.STATUS,status:RP.MALFORMED_MESSAGE},{signal:o}),void await i.close();if(a.type!==SP.Type.CONNECT)return this.log.error("invalid stop connect request via peer %p",r.remotePeer),await s.write({type:SP.Type.STATUS,status:RP.UNEXPECTED_MESSAGE},{signal:o}),void await i.close();if(!(e=>{if(null==e.peer)return!1;try{e.peer.addrs.forEach(Dg)}catch{return!1}return!0})(a))return this.log.error("invalid stop connect request via peer %p",r.remotePeer),await s.write({type:SP.Type.STATUS,status:RP.MALFORMED_MESSAGE},{signal:o}),void await i.close();const c=np(a.peer.id);if(!0===await(null===(t=(n=this.connectionGater).denyInboundRelayedConnection)||void 0===t?void 0:t.call(n,r.remotePeer,c)))return this.log.error("connection gater denied inbound relayed connection from %p",r.remotePeer),await s.write({type:SP.Type.STATUS,status:RP.PERMISSION_DENIED},{signal:o}),void await i.close();this.log.trace("sending success response to %p",r.remotePeer),await s.write({type:SP.Type.STATUS,status:RP.OK},{signal:o});const l=r.remoteAddr.encapsulate("/p2p-circuit/p2p/".concat(c.toString())),u=this.addressManager.getAddresses()[0],d=vP({stream:s.unwrap().unwrap(),remoteAddr:l,localAddr:u,logger:this.logger});this.log("new inbound transient connection %a",d.remoteAddr),await this.upgrader.upgradeInbound(d,{transient:!0}),this.log("%s connection %a upgraded","inbound",d.remoteAddr)}}function qP(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>new VP(t,e)}var GP;function KP(e,t){if(mm.matches(e))return!1;return null!=t.dialTransportForMultiaddr(e)&&(!!Yg.matches(e)||!!tm.matches(e)&&!1===$p(e.toOptions().host))}!function(e){let t,n,r;!function(e){e.UNUSED="UNUSED",e.CONNECT="CONNECT",e.SYNC="SYNC"}(t=e.Type||(e.Type={})),function(e){e[e.UNUSED=0]="UNUSED",e[e.CONNECT=100]="CONNECT",e[e.SYNC=300]="SYNC"}(n||(n={})),function(e){e.codec=()=>ia(n)}(t=e.Type||(e.Type={})),e.codec=()=>(null==r&&(r=oa((function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==r.lengthDelimited&&n.fork(),null!=t.type&&(n.uint32(8),e.Type.codec().encode(t.type,n)),null!=t.observedAddresses)for(const e of t.observedAddresses)n.uint32(18),n.bytes(e);!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={observedAddresses:[]},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.type=e.Type.codec().decode(t);break;case 2:r.observedAddresses.push(t.bytes());break;default:t.skipType(7&n)}}return r}))),r),e.encode=t=>Xs(t,e.codec()),e.decode=t=>$o(t,e.codec())}(GP||(GP={}));const WP=5e3,QP=3,YP=1,ZP=1;class JP{constructor(e,t){var n,r,i,o;Dr(this,"started",void 0),Dr(this,"timeout",void 0),Dr(this,"retries",void 0),Dr(this,"maxInboundStreams",void 0),Dr(this,"maxOutboundStreams",void 0),Dr(this,"peerStore",void 0),Dr(this,"registrar",void 0),Dr(this,"connectionManager",void 0),Dr(this,"addressManager",void 0),Dr(this,"transportManager",void 0),Dr(this,"topologyId",void 0),Dr(this,"log",void 0),this.log=e.logger.forComponent("libp2p:dcutr"),this.started=!1,this.peerStore=e.peerStore,this.registrar=e.registrar,this.addressManager=e.addressManager,this.connectionManager=e.connectionManager,this.transportManager=e.transportManager,this.timeout=null!==(n=t.timeout)&&void 0!==n?n:WP,this.retries=null!==(r=t.retries)&&void 0!==r?r:QP,this.maxInboundStreams=null!==(i=t.maxInboundStreams)&&void 0!==i?i:YP,this.maxOutboundStreams=null!==(o=t.maxOutboundStreams)&&void 0!==o?o:ZP}isStarted(){return this.started}async start(){this.started||(this.topologyId=await this.registrar.register(XP,{notifyOnTransient:!0,onConnect:(e,t)=>{t.transient&&"inbound"===t.direction&&this.upgradeInbound(t).catch((e=>{this.log.error("error during outgoing DCUtR attempt",e)}))}}),await this.registrar.handle(XP,(e=>{this.handleIncomingUpgrade(e.stream,e.connection).catch((t=>{this.log.error("error during incoming DCUtR attempt",t),e.stream.abort(t)}))}),{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams,runOnTransientConnection:!0}),this.started=!0)}async stop(){await this.registrar.unhandle(XP),null!=this.topologyId&&this.registrar.unregister(this.topologyId),this.started=!1}async upgradeInbound(e){if(await this.attemptUnilateralConnectionUpgrade(e))return;let t;for(let i=0;i<this.retries;i++){const o={signal:AbortSignal.timeout(this.timeout)};try{t=await e.newStream([XP],{signal:o.signal,runOnTransientConnection:!0});const n=yP(t,{maxDataLength:4096}).pb(GP);this.log("B sending connect to %p",e.remotePeer);const r=Date.now();await n.write({type:GP.Type.CONNECT,observedAddresses:this.addressManager.getAddresses().map((e=>e.bytes))},o),this.log("B receiving connect from %p",e.remotePeer);const i=await n.read(o);if(i.type!==GP.Type.CONNECT)throw this.log("A sent wrong message type"),new tf("DCUtR message type was incorrect",cf);const s=this.getDialableMultiaddrs(i.observedAddresses);if(0===s.length)throw this.log("A did not have any dialable multiaddrs"),new tf("DCUtR connect message had no multiaddrs",cf);const a=Date.now()-r;this.log("A sending sync, rtt %dms",a),await n.write({type:GP.Type.SYNC,observedAddresses:[]},o),this.log("A waiting for half RTT"),await gx(a/2),this.log("B dialing",s);const c=await this.connectionManager.openConnection(s,{signal:o.signal,priority:100});this.log("DCUtR to %p succeeded to address %a, closing relayed connection",e.remotePeer,c.remoteAddr),await e.close(o);break}catch(r){var n;if(this.log.error("error while attempting DCUtR on attempt %d of %d",i+1,this.retries,r),null===(n=t)||void 0===n||n.abort(r),i===this.retries)throw r}finally{null!=t&&await t.close(o)}}}async attemptUnilateralConnectionUpgrade(e){const t=(await this.peerStore.get(e.remotePeer)).addresses.map((t=>{const n=t.multiaddr;return null==n.getPeerId()?n.encapsulate("/p2p/".concat(e.remotePeer)):n})).filter((e=>KP(e,this.transportManager)));if(t.length>0){const r=AbortSignal.timeout(this.timeout);try{this.log("attempting unilateral connection upgrade to %a",t);const n=await this.connectionManager.openConnection(t,{signal:r,force:!0});if(n.transient)throw new Error("Could not open a new, non-transient, connection");return this.log("unilateral connection upgrade to %p succeeded via %a, closing relayed connection",e.remotePeer,n.remoteAddr),await e.close({signal:r}),!0}catch(n){this.log.error("unilateral connection upgrade to %p on addresses %a failed",e.remotePeer,t,n)}}else this.log("peer %p has no public addresses, not attempting unilateral connection upgrade",e.remotePeer);return!1}async handleIncomingUpgrade(e,t){const n={signal:AbortSignal.timeout(this.timeout)};try{const r=yP(e,{maxDataLength:4096}).pb(GP);this.log("A receiving connect");const i=await r.read(n);if(i.type!==GP.Type.CONNECT)throw this.log("B sent wrong message type"),new tf("DCUtR message type was incorrect",cf);if(0===i.observedAddresses.length)throw this.log("B sent no multiaddrs"),new tf("DCUtR connect message had no multiaddrs",cf);const o=this.getDialableMultiaddrs(i.observedAddresses);if(0===o.length)throw this.log("B had no dialable multiaddrs"),new tf("DCUtR connect message had no dialable multiaddrs",cf);this.log("A sending connect"),await r.write({type:GP.Type.CONNECT,observedAddresses:this.addressManager.getAddresses().map((e=>e.bytes))}),this.log("A receiving sync");if((await r.read(n)).type!==GP.Type.SYNC)throw new tf("DCUtR message type was incorrect",cf);this.log("A dialing",o);const s=await this.connectionManager.openConnection(o,{signal:n.signal,priority:100,force:!0});this.log("DCUtR to %p succeeded via %a, closing relayed connection",t.remotePeer,s.remoteAddr),await t.close(n)}catch(r){this.log.error("incoming DCUtR from %p failed",t.remotePeer,r),e.abort(r)}finally{await e.close(n)}}getDialableMultiaddrs(e){const t=[];for(const n of e)if(null!=n&&0!==n.length)try{const e=Dg(n);if(!KP(e,this.transportManager))continue;t.push(e)}catch{}return t}}const XP="/libp2p/dcutr";function $P(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>new JP(t,e)}var eN;!function(e){let t;e.codec=()=>(null==t&&(t=oa((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==n.lengthDelimited&&t.fork(),null!=e.protocolVersion&&(t.uint32(42),t.string(e.protocolVersion)),null!=e.agentVersion&&(t.uint32(50),t.string(e.agentVersion)),null!=e.publicKey&&(t.uint32(10),t.bytes(e.publicKey)),null!=e.listenAddrs)for(const r of e.listenAddrs)t.uint32(18),t.bytes(r);if(null!=e.observedAddr&&(t.uint32(34),t.bytes(e.observedAddr)),null!=e.protocols)for(const r of e.protocols)t.uint32(26),t.string(r);null!=e.signedPeerRecord&&(t.uint32(66),t.bytes(e.signedPeerRecord)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={listenAddrs:[],protocols:[]},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 5:n.protocolVersion=e.string();break;case 6:n.agentVersion=e.string();break;case 1:n.publicKey=e.bytes();break;case 2:n.listenAddrs.push(e.bytes());break;case 4:n.observedAddr=e.bytes();break;case 3:n.protocols.push(e.string());break;case 8:n.signedPeerRecord=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>Xs(t,e.codec()),e.decode=t=>$o(t,e.codec())}(eN||(eN={}));var tN=n(4053);const nN="object"===typeof window&&"object"===typeof document&&9===document.nodeType,rN=tN(),iN=nN&&!rN,oN=rN&&!nN,sN=rN&&nN,aN="undefined"!==typeof globalThis.process&&"undefined"!==typeof globalThis.process.release&&"node"===globalThis.process.release.name&&!rN,cN="function"===typeof importScripts&&"undefined"!==typeof self&&"undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope,lN=("undefined"!==typeof globalThis.process&&"undefined"!==typeof globalThis.process.env&&globalThis.process.env.NODE_ENV,"undefined"!==typeof navigator&&"ReactNative"===navigator.product),uN={protocolPrefix:"ipfs",timeout:5e3,maxInboundStreams:1,maxOutboundStreams:1,maxObservedAddresses:10,maxMessageSize:8192,runOnConnectionOpen:!0,runOnSelfUpdate:!0,runOnTransientConnection:!0,concurrency:32};async function dN(e,t,n,r,i){if(n("received identify from %p",r.remotePeer),null==i)throw new tf("message was null or undefined","ERR_INVALID_MESSAGE");const o={};if(i.listenAddrs.length>0&&(o.addresses=i.listenAddrs.map((e=>({isCertified:!1,multiaddr:Dg(e)})))),i.protocols.length>0&&(o.protocols=i.protocols),null!=i.publicKey){o.publicKey=i.publicKey;if(!(await rp(i.publicKey)).equals(r.remotePeer))throw new tf("public key did not match remote PeerId","ERR_INVALID_PUBLIC_KEY")}let s;if(null!=i.signedPeerRecord){n("received signedPeerRecord from %p",r.remotePeer);let t=i.signedPeerRecord;const a=await AS.openAndCertify(t,RS.DOMAIN);let l,u=RS.createFromProtobuf(a.payload);if(!u.peerId.equals(a.peerId))throw new tf("signing key does not match PeerId in the PeerRecord","ERR_INVALID_SIGNING_KEY");if(!r.remotePeer.equals(u.peerId))throw new tf("signing key does not match remote PeerId","ERR_INVALID_PEER_RECORD_KEY");try{l=await e.get(u.peerId)}catch(c){if("ERR_NOT_FOUND"!==c.code)throw c}if(null!=l&&(o.metadata=l.metadata,null!=l.peerRecordEnvelope)){const e=await AS.createFromProtobuf(l.peerRecordEnvelope),r=RS.createFromProtobuf(e.payload);r.seqNumber>=u.seqNumber&&(n("sequence number was lower or equal to existing sequence number - stored: %d received: %d",r.seqNumber,u.seqNumber),u=r,t=l.peerRecordEnvelope)}o.peerRecordEnvelope=t,o.addresses=u.multiaddrs.map((e=>({isCertified:!0,multiaddr:e}))),s={seq:u.seqNumber,addresses:u.multiaddrs}}else n("%p did not send a signed peer record",r.remotePeer);if(n("patching %p with",r.remotePeer,o),await e.patch(r.remotePeer,o),null!=i.agentVersion||null!=i.protocolVersion){const t={};null!=i.agentVersion&&(t.AgentVersion=Fs(i.agentVersion)),null!=i.protocolVersion&&(t.ProtocolVersion=Fs(i.protocolVersion)),n("merging %p metadata",r.remotePeer,t),await e.merge(r.remotePeer,{metadata:t})}const a={peerId:r.remotePeer,protocolVersion:i.protocolVersion,agentVersion:i.agentVersion,publicKey:i.publicKey,listenAddrs:i.listenAddrs.map((e=>Dg(e))),observedAddr:null==i.observedAddr?void 0:Dg(i.observedAddr),protocols:i.protocols,signedPeerRecord:s,connection:r};return t.safeDispatchEvent("peer:identify",{detail:a}),a}class hN{constructor(e,t){var n,r,i,o,s,a,c,l,u;Dr(this,"host",void 0),Dr(this,"protocol",void 0),Dr(this,"started",void 0),Dr(this,"timeout",void 0),Dr(this,"peerId",void 0),Dr(this,"peerStore",void 0),Dr(this,"registrar",void 0),Dr(this,"addressManager",void 0),Dr(this,"maxInboundStreams",void 0),Dr(this,"maxOutboundStreams",void 0),Dr(this,"maxMessageSize",void 0),Dr(this,"maxObservedAddresses",void 0),Dr(this,"events",void 0),Dr(this,"runOnTransientConnection",void 0),Dr(this,"log",void 0),this.protocol=t.protocol,this.started=!1,this.peerId=e.peerId,this.peerStore=e.peerStore,this.registrar=e.registrar,this.addressManager=e.addressManager,this.events=e.events,this.log=t.log,this.timeout=null!==(n=t.timeout)&&void 0!==n?n:uN.timeout,this.maxInboundStreams=null!==(r=t.maxInboundStreams)&&void 0!==r?r:uN.maxInboundStreams,this.maxOutboundStreams=null!==(i=t.maxOutboundStreams)&&void 0!==i?i:uN.maxOutboundStreams,this.maxMessageSize=null!==(o=t.maxMessageSize)&&void 0!==o?o:uN.maxMessageSize,this.maxObservedAddresses=null!==(s=t.maxObservedAddresses)&&void 0!==s?s:uN.maxObservedAddresses,this.runOnTransientConnection=null!==(a=t.runOnTransientConnection)&&void 0!==a?a:uN.runOnTransientConnection,this.host={protocolVersion:"".concat(null!==(c=t.protocolPrefix)&&void 0!==c?c:uN.protocolPrefix,"/").concat("0.1.0"),agentVersion:(l=e.nodeInfo,u=t.agentVersion,null!=u||(u="".concat(l.name,"/").concat(l.version),aN||oN?u+=" UserAgent=".concat(globalThis.process.version):(iN||cN||sN||lN)&&(u+=" UserAgent=".concat(globalThis.navigator.userAgent))),u)}}isStarted(){return this.started}async start(){this.started||(await this.peerStore.merge(this.peerId,{metadata:{AgentVersion:Fs(this.host.agentVersion),ProtocolVersion:Fs(this.host.protocolVersion)}}),await this.registrar.handle(this.protocol,(e=>{this.handleProtocol(e).catch((e=>{this.log.error(e)}))}),{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams,runOnTransientConnection:this.runOnTransientConnection}),this.started=!0)}async stop(){await this.registrar.unhandle(this.protocol),this.started=!1}}class fN extends hN{constructor(e){var t,n,r;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,{...i,protocol:"/".concat(null!==(t=i.protocolPrefix)&&void 0!==t?t:uN.protocolPrefix,"/").concat("id/push","/").concat("1.0.0"),log:e.logger.forComponent("libp2p:identify-push")}),Dr(this,"connectionManager",void 0),Dr(this,"concurrency",void 0),this.connectionManager=e.connectionManager,this.concurrency=null!==(n=i.concurrency)&&void 0!==n?n:uN.concurrency,(null!==(r=i.runOnSelfUpdate)&&void 0!==r?r:uN.runOnSelfUpdate)&&e.events.addEventListener("self:peer:update",(e=>{this.push().catch((e=>{this.log.error(e)}))}))}async push(){var e,t;if(!this.isStarted())return;const n=this.addressManager.getAddresses().map((e=>e.decapsulateCode(ag("p2p").code))),r=new RS({peerId:this.peerId,multiaddrs:n}),i=await AS.seal(r,this.peerId),o=this.registrar.getProtocols(),s=await this.peerStore.get(this.peerId),a=cp(null!==(e=s.metadata.get("AgentVersion"))&&void 0!==e?e:Fs(this.host.agentVersion)),c=cp(null!==(t=s.metadata.get("ProtocolVersion"))&&void 0!==t?t:Fs(this.host.protocolVersion)),l=this;await vf(cu(async function*(){for(const e of l.connectionManager.getConnections()){(await l.peerStore.get(e.remotePeer)).protocols.includes(l.protocol)&&(yield async()=>{let t;const r=AbortSignal.timeout(l.timeout);Wh(1/0,r);try{t=await e.newStream(l.protocol,{signal:r,runOnTransientConnection:l.runOnTransientConnection});const s=yP(t,{maxDataLength:l.maxMessageSize}).pb(eN);await s.write({listenAddrs:n.map((e=>e.bytes)),signedPeerRecord:i.marshal(),protocols:o,agentVersion:a,protocolVersion:c},{signal:r}),await t.close({signal:r})}catch(u){var s;l.log.error("could not push identify update to peer",u),null===(s=t)||void 0===s||s.abort(u)}})}}(),{concurrency:this.concurrency}))}async handleProtocol(e){const{connection:t,stream:n}=e;try{if(this.peerId.equals(t.remotePeer))throw new Error("received push from ourselves?");const e={signal:AbortSignal.timeout(this.timeout)},r=yP(n,{maxDataLength:this.maxMessageSize}).pb(eN),i=await r.read(e);await n.close(e),await dN(this.peerStore,this.events,this.log,t,i)}catch(r){return this.log.error("received invalid message",r),void n.abort(r)}this.log("handled push from %p",t.remotePeer)}}class pN extends hN{constructor(e){var t,n;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,{...r,protocol:"/".concat(null!==(t=r.protocolPrefix)&&void 0!==t?t:uN.protocolPrefix,"/").concat("id","/").concat("1.0.0"),log:e.logger.forComponent("libp2p:identify")}),(null!==(n=r.runOnConnectionOpen)&&void 0!==n?n:uN.runOnConnectionOpen)&&e.events.addEventListener("connection:open",(e=>{const t=e.detail;this.identify(t).catch((e=>{this.log.error("error during identify trigged by connection:open",e)}))}))}async _identify(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null==n.signal){const e=AbortSignal.timeout(this.timeout);Wh(1/0,e),n={...n,signal:e}}try{t=await e.newStream(this.protocol,{...n,runOnTransientConnection:this.runOnTransientConnection});const r=yP(t,{maxDataLength:this.maxMessageSize}).pb(eN),i=await r.read(n);return await t.close(n),i}catch(i){var r;throw this.log.error("error while reading identify message",i),null===(r=t)||void 0===r||r.abort(i),i}}async identify(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=await this._identify(e,n),{publicKey:i,protocols:o,observedAddr:s}=r;if(null==i)throw new tf("public key was missing from identify message","ERR_MISSING_PUBLIC_KEY");const a=await rp(i);if(!e.remotePeer.equals(a))throw new tf("identified peer does not match the expected peer","ERR_INVALID_PEER");if(this.peerId.equals(a))throw new tf("identified peer is our own peer id?","ERR_INVALID_PEER");const c=function(e){if(null!=e&&e.length>0)try{return Dg(e)}catch{}}(s);return this.log("identify completed for peer %p and protocols %o",a,o),this.log("our observed address is %a",c),null!=c&&this.addressManager.getObservedAddrs().length<(null!==(t=this.maxObservedAddresses)&&void 0!==t?t:1/0)&&(this.log("storing our observed address %a",c),this.addressManager.addObservedAddr(c)),dN(this.peerStore,this.events,this.log,e,r)}async handleProtocol(e){const{connection:t,stream:n}=e,r=AbortSignal.timeout(this.timeout);Wh(1/0,r);try{var i;const e=null!==(i=this.peerId.publicKey)&&void 0!==i?i:new Uint8Array(0),o=await this.peerStore.get(this.peerId),s=this.addressManager.getAddresses().map((e=>e.decapsulateCode(ag("p2p").code)));let a=o.peerRecordEnvelope;if(s.length>0&&null==a){const e=new RS({peerId:this.peerId,multiaddrs:s});a=(await AS.seal(e,this.peerId)).marshal().subarray()}let c=t.remoteAddr.bytes;em.matches(t.remoteAddr)||(c=void 0);const l=yP(n).pb(eN);await l.write({protocolVersion:this.host.protocolVersion,agentVersion:this.host.agentVersion,publicKey:e,listenAddrs:s.map((e=>e.bytes)),signedPeerRecord:a,observedAddr:c,protocols:o.protocols},{signal:r}),await n.close({signal:r})}catch(o){this.log.error("could not respond to identify request",o),n.abort(o)}}}function gN(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>new pN(t,e)}function mN(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>new fN(t,e)}const vN=36e5,yN=36*vN,wN="/dht/provider",bN=vN,EN=20,kN=3;var AN,SN,xN,_N,IN,RN,CN,TN;function PN(e){const t=e.getUTCFullYear(),n=String(e.getUTCMonth()+1).padStart(2,"0"),r=String(e.getUTCDate()).padStart(2,"0"),i=String(e.getUTCHours()).padStart(2,"0"),o=String(e.getUTCMinutes()).padStart(2,"0"),s=String(e.getUTCSeconds()).padStart(2,"0"),a=e.getUTCMilliseconds(),c=String(1e3*a*1e3).padStart(9,"0");return"".concat(t,"-").concat(n,"-").concat(r,"T").concat(i,":").concat(o,":").concat(s,".").concat(c,"Z")}!function(e){let t;e.codec=()=>(null==t&&(t=oa((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.key&&e.key.byteLength>0&&(t.uint32(10),t.bytes(e.key)),null!=e.value&&e.value.byteLength>0&&(t.uint32(18),t.bytes(e.value)),null!=e.timeReceived&&""!==e.timeReceived&&(t.uint32(42),t.string(e.timeReceived)),!1!==n.lengthDelimited&&t.ldelim()}),(function(e,t){const n={key:Ur(0),value:Ur(0),timeReceived:""},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.key=e.bytes();break;case 2:n.value=e.bytes();break;case 5:n.timeReceived=e.string();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>Xs(t,e.codec()),e.decode=(t,n)=>$o(t,e.codec(),n)}(AN||(AN={}));class NN{constructor(e,t,n){if(Dr(this,"key",void 0),Dr(this,"value",void 0),Dr(this,"timeReceived",void 0),!(e instanceof Uint8Array))throw new Error("key must be a Uint8Array");if(!(t instanceof Uint8Array))throw new Error("value must be a Uint8Array");this.key=e,this.value=t,this.timeReceived=n}serialize(){return AN.encode(this.prepareSerialize())}prepareSerialize(){return{key:this.key,value:this.value,timeReceived:PN(this.timeReceived)}}static deserialize(e){const t=AN.decode(e);return new NN(t.key,t.value,new Date(t.timeReceived))}static fromDeserialized(e){const t=function(e){const t=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),n=String(e).trim().match(t);if(null==n)throw new Error("Invalid format");const r=parseInt(n[1],10),i=parseInt(n[2],10)-1,o=parseInt(n[3],10),s=parseInt(n[4],10),a=parseInt(n[5],10),c=parseInt(n[6],10),l=parseInt(n[7].slice(0,-6),10);return new Date(Date.UTC(r,i,o,s,a,c,l))}(e.timeReceived);if(null==e.key)throw new Error("key missing from deserialized object");if(null==e.value)throw new Error("value missing from deserialized object");return new NN(e.key,e.value,t)}}function BN(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r={...e,name:"SEND_QUERY",type:0,messageName:e.type,messageType:e.type};return null===(t=n.onProgress)||void 0===t||t.call(n,new $h("kad-dht:query:send-query",{detail:r})),r}function DN(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r={...e,name:"PEER_RESPONSE",type:1,messageName:e.messageType,closer:null!=e.closer?e.closer:[],providers:null!=e.providers?e.providers:[]};return null===(t=n.onProgress)||void 0===t||t.call(n,new $h("kad-dht:query:peer-response",{detail:r})),r}function ON(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r={...e,name:"FINAL_PEER",type:2};return null===(t=n.onProgress)||void 0===t||t.call(n,new $h("kad-dht:query:final-peer",{detail:r})),r}function LN(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r={...e,name:"QUERY_ERROR",type:3};return null===(t=n.onProgress)||void 0===t||t.call(n,new $h("kad-dht:query:query-error",{detail:r})),r}function MN(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r={...e,name:"PROVIDER",type:4};return null===(t=n.onProgress)||void 0===t||t.call(n,new $h("kad-dht:query:provider",{detail:r})),r}function FN(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r={...e,name:"VALUE",type:5};return null===(t=n.onProgress)||void 0===t||t.call(n,new $h("kad-dht:query:value",{detail:r})),r}function UN(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r={...e,name:"DIAL_PEER",type:7};return null===(t=n.onProgress)||void 0===t||t.call(n,new $h("kad-dht:query:dial-peer",{detail:r})),r}!function(e){let t;e.codec=()=>(null==t&&(t=oa((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.key&&(t.uint32(10),t.bytes(e.key)),null!=e.value&&(t.uint32(18),t.bytes(e.value)),null!=e.author&&(t.uint32(26),t.bytes(e.author)),null!=e.signature&&(t.uint32(34),t.bytes(e.signature)),null!=e.timeReceived&&(t.uint32(42),t.string(e.timeReceived)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.key=e.bytes();break;case 2:n.value=e.bytes();break;case 3:n.author=e.bytes();break;case 4:n.signature=e.bytes();break;case 5:n.timeReceived=e.string();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>Xs(t,e.codec()),e.decode=t=>$o(t,e.codec())}(SN||(SN={})),function(e){e.PUT_VALUE="PUT_VALUE",e.GET_VALUE="GET_VALUE",e.ADD_PROVIDER="ADD_PROVIDER",e.GET_PROVIDERS="GET_PROVIDERS",e.FIND_NODE="FIND_NODE",e.PING="PING"}(xN||(xN={})),function(e){e[e.PUT_VALUE=0]="PUT_VALUE",e[e.GET_VALUE=1]="GET_VALUE",e[e.ADD_PROVIDER=2]="ADD_PROVIDER",e[e.GET_PROVIDERS=3]="GET_PROVIDERS",e[e.FIND_NODE=4]="FIND_NODE",e[e.PING=5]="PING"}(_N||(_N={})),function(e){e.codec=()=>ia(_N)}(xN||(xN={})),function(e){e.NOT_CONNECTED="NOT_CONNECTED",e.CONNECTED="CONNECTED",e.CAN_CONNECT="CAN_CONNECT",e.CANNOT_CONNECT="CANNOT_CONNECT"}(IN||(IN={})),function(e){e[e.NOT_CONNECTED=0]="NOT_CONNECTED",e[e.CONNECTED=1]="CONNECTED",e[e.CAN_CONNECT=2]="CAN_CONNECT",e[e.CANNOT_CONNECT=3]="CANNOT_CONNECT"}(RN||(RN={})),function(e){e.codec=()=>ia(RN)}(IN||(IN={})),function(e){let t;e.codec=()=>(null==t&&(t=oa((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==n.lengthDelimited&&t.fork(),null!=e.id&&e.id.byteLength>0&&(t.uint32(10),t.bytes(e.id)),null!=e.multiaddrs)for(const r of e.multiaddrs)t.uint32(18),t.bytes(r);null!=e.connection&&(t.uint32(24),IN.codec().encode(e.connection,t)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={id:Ur(0),multiaddrs:[]},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.id=e.bytes();break;case 2:n.multiaddrs.push(e.bytes());break;case 3:n.connection=IN.codec().decode(e);break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>Xs(t,e.codec()),e.decode=t=>$o(t,e.codec())}(CN||(CN={})),function(e){let t;e.codec=()=>(null==t&&(t=oa((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==n.lengthDelimited&&t.fork(),null!=e.type&&0!==_N[e.type]&&(t.uint32(8),xN.codec().encode(e.type,t)),null!=e.clusterLevel&&(t.uint32(80),t.int32(e.clusterLevel)),null!=e.key&&(t.uint32(18),t.bytes(e.key)),null!=e.record&&(t.uint32(26),t.bytes(e.record)),null!=e.closer)for(const r of e.closer)t.uint32(66),CN.codec().encode(r,t);if(null!=e.providers)for(const r of e.providers)t.uint32(74),CN.codec().encode(r,t);!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={type:xN.PUT_VALUE,closer:[],providers:[]},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.type=xN.codec().decode(e);break;case 10:n.clusterLevel=e.int32();break;case 2:n.key=e.bytes();break;case 3:n.record=e.bytes();break;case 8:n.closer.push(CN.codec().decode(e,e.uint32()));break;case 9:n.providers.push(CN.codec().decode(e,e.uint32()));break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>Xs(t,e.codec()),e.decode=t=>$o(t,e.codec())}(TN||(TN={}));const jN={pk:function(e,t){return 0}};async function HN(e,t){const n=t.key,r=cp(n).split("/");if(r.length<3)return;const i=e[r[1].toString()];if(null==i){const e='No validator available for key type "'.concat(r[1],'"');throw new tf(e,"ERR_INVALID_RECORD_KEY_TYPE")}await i(n,t.value)}const zN={pk:async(e,t)=>{if(!(e instanceof Uint8Array))throw new tf('"key" must be a Uint8Array',"ERR_INVALID_RECORD_KEY_NOT_BUFFER");if(e.byteLength<5)throw new tf("invalid public key record","ERR_INVALID_RECORD_KEY_TOO_SHORT");if("/pk/"!==cp(e.subarray(0,4)))throw new tf("key was not prefixed with /pk/","ERR_INVALID_RECORD_KEY_BAD_PREFIX");if(!zr(e.slice(4),(await Ps.digest(t)).bytes))throw new tf("public key does not match passed in key","ERR_INVALID_RECORD_HASH_MISMATCH")}},VN=Fs("/pk/");function qN(e){return{...e,multiaddrs:e.multiaddrs.filter((e=>{const[[t,n]]=e.stringTuples();if(53===t||54===t||55===t)return"localhost"!==n;if(4!==t&&6!==t)return!1;if(null==n)return!1;const r=$p(n);return null==r||!r}))}}async function GN(e){return(await Ps.digest(e)).digest}async function KN(e){return GN(e.toBytes())}function WN(e){return new Dv("".concat("/dht/record","/").concat(cp(e,"base32")),!1)}function QN(e,t){const n=new Date;return new NN(e,t,n).serialize()}class YN{constructor(e,t){Dr(this,"log",void 0),Dr(this,"components",void 0),Dr(this,"validators",void 0),Dr(this,"selectors",void 0),Dr(this,"peerRouting",void 0),Dr(this,"queryManager",void 0),Dr(this,"network",void 0);const{validators:n,selectors:r,peerRouting:i,queryManager:o,network:s,logPrefix:a}=t;this.components=e,this.log=e.logger.forComponent("".concat(a,":content-fetching")),this.validators=n,this.selectors=r,this.peerRouting=i,this.queryManager=o,this.network=s}async getLocal(e){this.log("getLocal %b",e);const t=WN(e);this.log("fetching record for key %k",t);const n=await this.components.datastore.get(t);this.log("found %k in local datastore",t);const r=NN.deserialize(n);return await HN(this.validators,r),r}sendCorrectionRecord(e,t,n){try{var r=this;let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return async function*(){r.log("sendCorrection for %b",e);const o=QN(e,n);for(const{value:a,from:c}of t){if(zr(a,n)){r.log("record was ok");continue}if(r.components.peerId.equals(c)){try{const t=WN(e);r.log("Storing corrected record for key ".concat(t.toString())),await r.components.datastore.put(t,o.subarray())}catch(s){r.log.error("Failed error correcting self",s)}continue}let t=!1;const l={type:xN.PUT_VALUE,key:e,record:o};for await(const e of r.network.sendRequest(c,l,i))"PEER_RESPONSE"===e.name&&null!=e.record&&zr(e.record.value,NN.deserialize(o).value)&&(t=!0),yield e;t||(yield LN({from:c,error:new tf("value not put correctly","ERR_PUT_VALUE_INVALID")},i)),r.log.error("Failed error correcting entry")}}()}catch(BJ){return Promise.reject(BJ)}}put(e,t){try{var n=this;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return async function*(){n.log("put key %b value %b",e,t);const i=QN(e,t),o=WN(e);n.log("storing record for key ".concat(o.toString())),await n.components.datastore.put(o,i.subarray()),yield*gu(n.peerRouting.getClosestPeers(e,{signal:r.signal}),(t=>iu(t,(t=>async()=>{if("FINAL_PEER"!==t.name)return[t];const o=[],s={type:xN.PUT_VALUE,key:e,record:i};n.log("send put to %p",t.peer.id);for await(const e of n.network.sendRequest(t.peer.id,s,r))o.push(e),"PEER_RESPONSE"===e.name&&(null!=e.record&&zr(e.record.value,NN.deserialize(i).value)||o.push(LN({from:t.peer.id,error:new tf("value not put correctly","ERR_PUT_VALUE_INVALID")},r)));return o}))),(e=>cu(e,{ordered:!1,concurrency:kN})),(async function*(e){for await(const t of e)yield*t}))}()}catch(BJ){return Promise.reject(BJ)}}get(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){t.log("get %b",e);const r=[];for await(const c of t.getMany(e,n))"VALUE"===c.name&&r.push(c),yield c;if(0===r.length)return;const i=r.map((e=>e.value));let o=0;try{o=function(e,t,n){if(0===n.length)throw new tf("No records given","ERR_NO_RECORDS_RECEIVED");const r=cp(t).split("/");if(r.length<3)throw new tf("Record key does not have a selector function","ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY");const i=e[r[1].toString()];if(null==i){const e='No selector function configured for key type "'.concat(r[1],'"');throw new tf(e,"ERR_UNRECOGNIZED_KEY_PREFIX")}return 1===n.length?0:i(t,n)}(t.selectors,e,i)}catch(a){if("ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY"!==a.code)throw a}const s=i[o];if(t.log("GetValue %b %b",e,s),null==s)throw new tf("best value was not found","ERR_NOT_FOUND");yield*t.sendCorrectionRecord(e,r,s,n),yield r[o]}()}catch(BJ){return Promise.reject(BJ)}}getMany(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){t.log("getMany values for %b",e);try{const r=await t.getLocal(e);yield FN({value:r.value,from:t.components.peerId},n)}catch(i){t.log("error getting local value for %b",e,i)}const r=t;yield*t.queryManager.run(e,(function(t){try{let{peer:i,signal:o}=t;return async function*(){for await(const t of r.peerRouting.getValueOrPeers(i,e,{signal:o}))yield t,"PEER_RESPONSE"===t.name&&null!=t.record&&(yield FN({from:i,value:t.record.value},n))}()}catch(BJ){return Promise.reject(BJ)}}),n)}()}catch(BJ){return Promise.reject(BJ)}}}function ZN(e,t){var n;return{id:e.id.toBytes(),multiaddrs:(null!==(n=e.multiaddrs)&&void 0!==n?n:[]).map((e=>e.bytes)),connection:t}}function JN(e){var t;if(null==e.id)throw new Error("Invalid peer in message");return{id:np(e.id),multiaddrs:(null!==(t=e.multiaddrs)&&void 0!==t?t:[]).map((e=>Dg(e)))}}class XN{constructor(e,t){Dr(this,"log",void 0),Dr(this,"components",void 0),Dr(this,"network",void 0),Dr(this,"peerRouting",void 0),Dr(this,"queryManager",void 0),Dr(this,"routingTable",void 0),Dr(this,"providers",void 0);const{network:n,peerRouting:r,queryManager:i,routingTable:o,providers:s,logPrefix:a}=t;this.components=e,this.log=e.logger.forComponent("".concat(a,":content-routing")),this.network=n,this.peerRouting=r,this.queryManager=i,this.routingTable=o,this.providers=s}provide(e,t){try{var n=this;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return async function*(){n.log("provide %s",e),await n.providers.addProvider(e,n.components.peerId);const i={type:xN.ADD_PROVIDER,key:e.multihash.bytes,providers:[ZN({id:n.components.peerId,multiaddrs:t})]};let o=0;yield*gu(n.peerRouting.getClosestPeers(e.multihash.bytes,r),(t=>iu(t,(t=>(t=>async()=>{if("FINAL_PEER"!==t.name)return[t];const s=[];n.log("putProvider %s to %p",e,t.peer.id);try{n.log("sending provider record for %s to %p",e,t.peer.id);for await(const a of n.network.sendMessage(t.peer.id,i,r))"PEER_RESPONSE"===a.name&&(n.log("sent provider record for %s to %p",e,t.peer.id),o++),s.push(a)}catch(a){n.log.error("error sending provide record to peer %p",t.peer.id,a),s.push(LN({from:t.peer.id,error:a},r))}return s})(t)))),(e=>cu(e,{ordered:!1,concurrency:kN})),(async function*(e){for await(const t of e)yield*t})),n.log("sent provider records to %d peers",o)}()}catch(BJ){return Promise.reject(BJ)}}async*findProviders(e,t){const n=this.routingTable.kBucketSize;let r=0;const i=e.multihash.bytes,o=this;this.log("findProviders %c",e);const s=await this.providers.getProviders(e);if(s.length>0){const e=[];for(const t of s.slice(0,n))try{const n=await this.components.peerStore.get(t);e.push({id:t,multiaddrs:n.addresses.map((e=>{let{multiaddr:t}=e;return t}))})}catch(l){if("ERR_NOT_FOUND"!==l.code)throw l;this.log("no peer store entry for %p",t)}if(yield DN({from:this.components.peerId,messageType:xN.GET_PROVIDERS,providers:e},t),yield MN({from:this.components.peerId,providers:e},t),r+=e.length,r>=n)return}const a=function(e){try{let{peer:n,signal:r}=e;return async function*(){const e={type:xN.GET_PROVIDERS,key:i};yield*o.network.sendRequest(n,e,{...t,signal:r})}()}catch(BJ){return Promise.reject(BJ)}},c=new vS(s);for await(const u of this.queryManager.run(i,a,t))if(yield u,"PEER_RESPONSE"===u.name){this.log("Found %d provider entries for %c and %d closer peers",u.providers.length,e,u.closer.length);const i=[];for(const e of u.providers)c.has(e.id)||(c.add(e.id),i.push(e));if(i.length>0&&(yield MN({from:u.from,providers:i},t),r+=i.length,r>=n))return}}}class $N extends Jh{constructor(e,t){super(),Dr(this,"log",void 0),Dr(this,"protocol",void 0),Dr(this,"running",void 0),Dr(this,"components",void 0);const{protocol:n}=t;this.components=e,this.log=e.logger.forComponent("".concat(t.logPrefix,":network")),this.running=!1,this.protocol=n}async start(){this.running||(this.running=!0)}async stop(){this.running=!1}isStarted(){return this.running}sendRequest(e,t){try{var n=this;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return async function*(){if(!n.running)return;const i=t.type;if(null==i)throw new sa("Message type was missing","ERR_INVALID_PARAMETERS");n.log("sending %s to %p",t.type,e),yield UN({peer:e},r),yield BN({to:e,type:i},r);try{const i=await n.components.connectionManager.openConnection(e,r),o=await i.newStream(n.protocol,r),s=await n._writeReadMessage(o,t,r);yield DN({from:e,messageType:s.type,closer:s.closer.map(JN),providers:s.providers.map(JN),record:null==s.record?void 0:NN.deserialize(s.record)},r)}catch(o){n.log.error("could not send %s to %p",t.type,e,o),yield LN({from:e,error:o},r)}finally{0}}()}catch(BJ){return Promise.reject(BJ)}}sendMessage(e,t){try{var n=this;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return async function*(){if(!n.running)return;const i=t.type;if(null==i)throw new sa("Message type was missing","ERR_INVALID_PARAMETERS");n.log("sending %s to %p",t.type,e),yield UN({peer:e},r),yield BN({to:e,type:i},r);try{const o=await n.components.connectionManager.openConnection(e,r),s=await o.newStream(n.protocol,r);await n._writeMessage(s,t,r),yield DN({from:e,messageType:i},r)}catch(o){yield LN({from:e,error:o},r)}finally{0}}()}catch(BJ){return Promise.reject(BJ)}}async _writeMessage(e,t,n){const r=yP(e);await r.write(t,TN,n),await r.unwrap().close(n)}async _writeReadMessage(e,t,n){const r=yP(e);await r.write(t,TN,n);const i=await r.read(TN,n);return await r.unwrap().close(n),i.closer.forEach((e=>{this.safeDispatchEvent("peer",{detail:JN(e)})})),i.providers.forEach((e=>{this.safeDispatchEvent("peer",{detail:JN(e)})})),i}}function eB(e,t){for(let n=0;n<e.byteLength;n++){if(e[n]<t[n])return-1;if(e[n]>t[n])return 1}return e.byteLength>t.byteLength?1:e.byteLength<t.byteLength?-1:0}function tB(e,t){if(e.length!==t.length)throw new Error("Inputs should have the same length");const n=jr(e.length);for(let r=0;r<e.length;r++)n[r]=e[r]^t[r];return n}class nB{constructor(e,t){Dr(this,"originDhtKey",void 0),Dr(this,"capacity",void 0),Dr(this,"peerDistances",void 0),this.originDhtKey=e,this.capacity=t,this.peerDistances=[]}get length(){return this.peerDistances.length}get peers(){return this.peerDistances.map((e=>e.peerId))}async add(e){if(null!=this.peerDistances.find((t=>t.peerId.equals(e))))return;const t=await KN(e),n={peerId:e,distance:tB(this.originDhtKey,t)};this.peerDistances.push(n),this.peerDistances.sort(((e,t)=>eB(e.distance,t.distance))),this.peerDistances=this.peerDistances.slice(0,this.capacity)}async anyCloser(e){if(0===e.length)return!1;if(0===this.length)return!0;const t=await Promise.all(e.map(KN)),n=this.peerDistances[this.peerDistances.length-1].distance;for(const r of t){if(eB(tB(this.originDhtKey,r),n)<0)return!0}return!1}}class rB{constructor(e,t){Dr(this,"log",void 0),Dr(this,"routingTable",void 0),Dr(this,"network",void 0),Dr(this,"validators",void 0),Dr(this,"queryManager",void 0),Dr(this,"peerStore",void 0),Dr(this,"peerId",void 0);const{routingTable:n,network:r,validators:i,queryManager:o,logPrefix:s}=t;this.routingTable=n,this.network=r,this.validators=i,this.queryManager=o,this.peerStore=e.peerStore,this.peerId=e.peerId,this.log=e.logger.forComponent("".concat(s,":peer-routing"))}async findPeerLocal(e){let t;const n=await this.routingTable.find(e);if(null!=n){this.log("findPeerLocal found %p in routing table",e);try{t=await this.peerStore.get(n)}catch(r){if("ERR_NOT_FOUND"!==r.code)throw r}}if(null==t)try{t=await this.peerStore.get(e)}catch(r){if("ERR_NOT_FOUND"!==r.code)throw r}if(null!=t)return this.log("findPeerLocal found %p in peer store",e),{id:t.id,multiaddrs:t.addresses.map((e=>e.multiaddr))}}_getValueSingle(e,t){try{var n=this;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return async function*(){const i={type:xN.GET_VALUE,key:t};yield*n.network.sendRequest(e,i,r)}()}catch(BJ){return Promise.reject(BJ)}}getPublicKeyFromNode(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){const r=function(e){return Hr([VN,e.toBytes()])}(e);for await(const i of t._getValueSingle(e,r,n))if(yield i,"PEER_RESPONSE"===i.name&&null!=i.record){const t=await rp($A({bytes:i.record.value}));if(!t.equals(e))throw new tf("public key does not match id","ERR_PUBLIC_KEY_DOES_NOT_MATCH_ID");if(null==t.publicKey)throw new tf("public key missing","ERR_PUBLIC_KEY_MISSING");yield FN({from:e,value:t.publicKey},n)}throw new tf("Node not responding with its public key: ".concat(e.toString()),"ERR_INVALID_RECORD")}()}catch(BJ){return Promise.reject(BJ)}}findPeer(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){if(t.log("findPeer %p",e),!1!==n.useCache){const r=await t.findPeerLocal(e);if(null!=r)return t.log("found local"),void(yield ON({from:t.peerId,peer:r},n))}let r=!1;if(!1!==n.useNetwork){const i=t,o=function(t){try{let{peer:r,signal:o}=t;return async function*(){const t={type:xN.FIND_NODE,key:e.toBytes()};for await(const s of i.network.sendRequest(r,t,{...n,signal:o}))if(yield s,"PEER_RESPONSE"===s.name){const t=s.closer.find((t=>t.id.equals(e)));null!=t&&(yield ON({from:s.from,peer:t},n))}}()}catch(BJ){return Promise.reject(BJ)}};for await(const s of t.queryManager.run(e.toBytes(),o,n))"FINAL_PEER"===s.name&&(r=!0),yield s}r||(yield LN({from:t.peerId,error:new tf("Not found","ERR_NOT_FOUND")},n))}()}catch(BJ){return Promise.reject(BJ)}}getClosestPeers(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){t.log("getClosestPeers to %b",e);const r=await GN(e),i=t.routingTable.closestPeers(r),o=t,s=new nB(r,t.routingTable.kBucketSize);await Promise.all(i.map((async e=>{await s.add(e)})));const a=function(t){try{let{peer:r,signal:i}=t;return async function*(){o.log("closerPeersSingle %s from %p",cp(e,"base32"),r);const t={type:xN.FIND_NODE,key:e};yield*o.network.sendRequest(r,t,{...n,signal:i})}()}catch(BJ){return Promise.reject(BJ)}};for await(const l of t.queryManager.run(e,a,n))yield l,"PEER_RESPONSE"===l.name&&await Promise.all(l.closer.map((async e=>{await s.add(e.id)})));t.log("found %d peers close to %b",s.length,e);for(const e of s.peers)try{const r=await t.peerStore.get(e);yield ON({from:t.peerId,peer:{id:e,multiaddrs:r.addresses.map((e=>{let{multiaddr:t}=e;return t}))}},n)}catch(c){if("ERR_NOT_FOUND"!==c.code)throw c}}()}catch(BJ){return Promise.reject(BJ)}}getValueOrPeers(e,t){try{var n=this;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return async function*(){for await(const o of n._getValueSingle(e,t,r)){if("PEER_RESPONSE"===o.name&&null!=o.record)try{await n._verifyRecordOnline(o.record)}catch(i){const e="invalid record received, discarded";n.log(e),yield LN({from:o.from,error:new tf(e,"ERR_INVALID_RECORD")},r);continue}yield o}}()}catch(BJ){return Promise.reject(BJ)}}async _verifyRecordOnline(e){if(null==e.timeReceived)throw new tf("invalid record received","ERR_INVALID_RECORD");await HN(this.validators,new NN(e.key,e.value,e.timeReceived))}async getCloserPeersOffline(e,t){const n=await GN(e),r=this.routingTable.closestPeers(n),i=[];for(const s of r)if(!s.equals(t))try{const e=await this.peerStore.get(s);i.push({id:s,multiaddrs:e.addresses.map((e=>{let{multiaddr:t}=e;return t}))})}catch(o){if("ERR_NOT_FOUND"!==o.code)throw o}return i.length>0?this.log("getCloserPeersOffline found %d peer(s) closer to %b than %p",i.length,e,t):this.log("getCloserPeersOffline could not find peer closer to %b than %p with %d peers in the routing table",e,t,this.routingTable.size),i}}class iB{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Dr(this,"log",void 0),Dr(this,"datastore",void 0),Dr(this,"cache",void 0),Dr(this,"cleanupInterval",void 0),Dr(this,"provideValidity",void 0),Dr(this,"syncQueue",void 0),Dr(this,"started",void 0),Dr(this,"cleaner",void 0);const{cacheSize:n,cleanupInterval:r,provideValidity:i}=t;this.log=e.logger.forComponent("libp2p:kad-dht:providers"),this.datastore=e.datastore,this.cleanupInterval=null!==r&&void 0!==r?r:bN,this.provideValidity=null!==i&&void 0!==i?i:864e5,this.cache=Yv(null!==n&&void 0!==n?n:256),this.syncQueue=new Xu({concurrency:1}),this.started=!1}isStarted(){return this.started}async start(){this.started||(this.started=!0,this.cleaner=setInterval((()=>{this._cleanup().catch((e=>{this.log.error(e)}))}),this.cleanupInterval))}async stop(){this.started=!1,null!=this.cleaner&&(clearInterval(this.cleaner),this.cleaner=void 0)}async _cleanup(){await this.syncQueue.add((async()=>{const e=Date.now();let t=0,n=0;const r=new Map,i=this.datastore.batch(),o=this.datastore.query({prefix:wN});for await(const c of o)try{const{cid:e,peerId:o}=sB(c.key),a=aB(c.value).getTime(),l=Date.now(),u=l-a,d=u>this.provideValidity;if(this.log("comparing: %d - %d = %d > %d %s",l,a,u,this.provideValidity,d?"(expired)":""),d){var s;n++,i.delete(c.key);const t=null!==(s=r.get(e))&&void 0!==s?s:new Set;t.add(o),r.set(e,t)}t++}catch(a){this.log.error(a.message)}r.size>0?(this.log("deleting %d / %d entries",n,t),await i.commit()):this.log("nothing to delete");for(const[c,l]of r){const e=oB(c),t=this.cache.get(e);if(null!=t){for(const e of l)t.delete(e);0===t.size?this.cache.remove(e):this.cache.set(e,t)}}this.log("Cleanup successful (%dms)",Date.now()-e)}))}async _getProvidersMap(e){const t=oB(e);let n=this.cache.get(t);return null==n&&(n=await async function(e,t){const n=new Map,r=e.query({prefix:oB(t)});for await(const i of r){const{peerId:e}=sB(i.key);n.set(e,aB(i.value))}return n}(this.datastore,e),this.cache.set(t,n)),n}async addProvider(e,t){await this.syncQueue.add((async()=>{this.log("%p provides %s",t,e);const n=await this._getProvidersMap(e);this.log("loaded %s provs",n.size);const r=new Date;n.set(t.toString(),r);const i=oB(e);this.cache.set(i,n),await async function(e,t,n,r){const i=[oB(t),"/",n.toString()].join(""),o=new Dv(i),s=Lo(r.getTime());await e.put(o,s)}(this.datastore,e,t,r)}))}async getProviders(e){return this.syncQueue.add((async()=>{this.log("get providers for %s",e);return[...(await this._getProvidersMap(e)).keys()].map((e=>tp(e)))}),{throwOnTimeout:!0})}}function oB(e){const t="string"===typeof e?e:cp(e.multihash.bytes,"base32");return"".concat(wN,"/").concat(t)}function sB(e){const t=e.toString().split("/");if(5!==t.length)throw new Error("incorrectly formatted provider entry key in datastore: ".concat(e.toString()));return{cid:t[3],peerId:t[4]}}function aB(e){return new Date(Mo(e))}const cB=BigInt("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF");async function*lB(e){const{key:t,startingPeer:n,ourPeerId:r,signal:i,query:o,alpha:s,pathIndex:a,numPaths:c,cleanUp:l,queryFuncTimeout:u,log:d,peersSeen:h}=e,f=new Xu({concurrency:s}),p=await GN(t);!function n(s,l){if(null==s)return;h.add(s);const g=BigInt("0x"+cp(tB(l,p),"base16"));f.add((async()=>{const l=[i];null!=u&&l.push(AbortSignal.timeout(u));const m=Qh(l);Wh(1/0,m);try{for await(const e of o({key:t,peer:s,signal:m,pathIndex:a,numPaths:c})){if(m.aborted)return;if("PEER_RESPONSE"===e.name)for(const i of e.closer){if(h.has(i.id)){d("already seen %p in query",i.id);continue}if(r.equals(i.id)){d("not querying ourselves");continue}const e=await KN(i.id);BigInt("0x"+cp(tB(e,p),"base16"))>g?d("skipping %p as they are not closer to %b than %p",i.id,t,s):(d("querying closer peer %p",i.id),n(i.id,e))}f.emit("completed",e)}}catch(v){if(!i.aborted)return LN({from:s,error:v},e)}finally{m.clear()}}),{priority:cB-g}).catch((e=>{d.error(e)}))}(n,await KN(n)),yield*async function*(e,t,n,r){const i=hu({objectMode:!0}),o=t=>{r("clean up queue, results %d, queue size %d, pending tasks %d",i.readableLength,e.size,e.pending),e.clear(),i.end(t)},s=e=>{null!=e&&i.push(e)},a=e=>{r("queue error",e),o(e)},c=()=>{r("queue idle"),o()},l=()=>{r("abort queue"),o(new tf("Query aborted","ERR_QUERY_ABORTED"))},u=()=>{o()};e.on("completed",s),e.on("error",a),e.on("idle",c),t.addEventListener("abort",l),n.addEventListener("cleanup",u);try{yield*i}finally{e.removeListener("completed",s),e.removeListener("error",a),e.removeListener("idle",c),t.removeEventListener("abort",l),n.removeEventListener("cleanup",u)}}(f,i,l,d)}class uB{constructor(e,t){Dr(this,"disjointPaths",void 0),Dr(this,"alpha",void 0),Dr(this,"shutDownController",void 0),Dr(this,"running",void 0),Dr(this,"queries",void 0),Dr(this,"logger",void 0),Dr(this,"peerId",void 0),Dr(this,"routingTable",void 0),Dr(this,"initialQuerySelfHasRun",void 0),Dr(this,"logPrefix",void 0),Dr(this,"metrics",void 0);const{disjointPaths:n=EN,alpha:r=kN,logPrefix:i}=t;this.logPrefix=i,this.disjointPaths=null!==n&&void 0!==n?n:EN,this.running=!1,this.alpha=null!==r&&void 0!==r?r:kN,this.queries=0,this.initialQuerySelfHasRun=t.initialQuerySelfHasRun,this.routingTable=t.routingTable,this.logger=e.logger,this.peerId=e.peerId,null!=e.metrics&&(this.metrics={runningQueries:e.metrics.registerMetric("".concat(i.replaceAll(":","_"),"_running_queries")),queryTime:e.metrics.registerMetric("".concat(i.replaceAll(":","_"),"_query_time_seconds"))}),this.shutDownController=new AbortController,Wh(1/0,this.shutDownController.signal)}isStarted(){return this.running}async start(){this.running=!0,this.shutDownController=new AbortController,Wh(1/0,this.shutDownController.signal)}async stop(){this.running=!1,this.shutDownController.abort()}run(e,t){try{var n=this;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return async function*(i){if(!n.running)throw new Error("QueryManager not started");const o=null===(i=n.metrics)||void 0===i?void 0:i.queryTime.timer();if(null==r.signal){const e=AbortSignal.timeout(3e4);Wh(1/0,e),r={...r,signal:e}}const s=new AbortController,a=Qh([n.shutDownController.signal,s.signal,r.signal]);Wh(1/0,a,s.signal);const c=n.logger.forComponent("".concat(n.logPrefix,":query:")+cp(e,"base58btc")),l=Date.now(),u=new Jh;let d=!1;try{var h;!0!==r.isSelfQuery&&null!=n.initialQuerySelfHasRun&&(c("waiting for initial query-self query before continuing"),await hf(n.initialQuerySelfHasRun.promise,a),n.initialQuerySelfHasRun=void 0),c("query:start"),n.queries++,null===(h=n.metrics)||void 0===h||h.runningQueries.update(n.queries);const i=await GN(e),o=n.routingTable.closestPeers(i),s=o.slice(0,Math.min(n.disjointPaths,o.length));if(0===o.length)return void c.error("Running query with no peers");const l=new vS,f=s.map(((i,o)=>lB({key:e,startingPeer:i,ourPeerId:n.peerId,signal:a,query:t,pathIndex:o,numPaths:s.length,alpha:n.alpha,cleanUp:u,queryFuncTimeout:r.queryFuncTimeout,log:c,peersSeen:l,onProgress:r.onProgress})));for await(const e of pu(...f))"QUERY_ERROR"===e.name&&c.error("query error",e.error),yield e;d=!0}catch(p){if(n.running||"ERR_QUERY_ABORTED"!==p.code)throw p}finally{var f;d||(c("query exited early"),s.abort()),a.clear(),n.queries--,null===(f=n.metrics)||void 0===f||f.runningQueries.update(n.queries),null!=o&&o(),u.dispatchEvent(new $h("cleanup")),c("query:done in %dms",Date.now()-l)}}()}catch(BJ){return Promise.reject(BJ)}}}const dB=function(e){if(null!=e[Symbol.asyncIterator])return(async()=>{let t=0;for await(const n of e)t++;return t})();{let t=0;for(const n of e)t++;return t}},hB=e=>{const t=e.addEventListener||e.on||e.addListener,n=e.removeEventListener||e.off||e.removeListener;if(!t||!n)throw new TypeError("Emitter is not compatible");return{addListener:t.bind(e),removeListener:n.bind(e)}};function fB(e,t,n){"function"===typeof n&&(n={filter:n});const r=function(e,t,n){let r;const i=new Promise(((i,o)=>{var s;if(!((n={rejectionEvents:["error"],multiArgs:!1,resolveImmediately:!1,...n}).count>=0)||n.count!==Number.POSITIVE_INFINITY&&!Number.isInteger(n.count))throw new TypeError("The `count` option should be at least 0 or more");null===(s=n.signal)||void 0===s||s.throwIfAborted();const a=[t].flat(),c=[],{addListener:l,removeListener:u}=hB(e),d=function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];const s=n.multiArgs?t:t[0];n.filter&&!n.filter(s)||(c.push(s),n.count===c.length&&(r(),i(c)))},h=e=>{r(),o(e)};r=()=>{for(const e of a)u(e,d);for(const e of n.rejectionEvents)u(e,h)};for(const e of a)l(e,d);for(const e of n.rejectionEvents)l(e,h);n.signal&&n.signal.addEventListener("abort",(()=>{h(n.signal.reason)}),{once:!0}),n.resolveImmediately&&i(c)}));if(i.cancel=r,"number"===typeof n.timeout){const e=Du(i,{milliseconds:n.timeout});return e.cancel=r,e}return i}(e,t,n={...n,count:1,resolveImmediately:!1}),i=r.then((e=>e[0]));return i.cancel=r.cancel,i}class pB{constructor(e,t){var n;Dr(this,"log",void 0),Dr(this,"peerId",void 0),Dr(this,"peerRouting",void 0),Dr(this,"routingTable",void 0),Dr(this,"count",void 0),Dr(this,"interval",void 0),Dr(this,"initialInterval",void 0),Dr(this,"queryTimeout",void 0),Dr(this,"started",void 0),Dr(this,"timeoutId",void 0),Dr(this,"controller",void 0),Dr(this,"initialQuerySelfHasRun",void 0),Dr(this,"querySelfPromise",void 0);const{peerRouting:r,logPrefix:i,count:o,interval:s,queryTimeout:a,routingTable:c}=t;this.peerId=e.peerId,this.log=e.logger.forComponent("".concat(i,":query-self")),this.started=!1,this.peerRouting=r,this.routingTable=c,this.count=null!==o&&void 0!==o?o:EN,this.interval=null!==s&&void 0!==s?s:3e5,this.initialInterval=null!==(n=t.initialInterval)&&void 0!==n?n:1e3,this.queryTimeout=null!==a&&void 0!==a?a:5e3,this.initialQuerySelfHasRun=t.initialQuerySelfHasRun}isStarted(){return this.started}start(){this.started||(this.started=!0,clearTimeout(this.timeoutId),this.timeoutId=setTimeout((()=>{this.querySelf().catch((e=>{this.log.error("error running self-query",e)}))}),this.initialInterval))}stop(){this.started=!1,null!=this.timeoutId&&clearTimeout(this.timeoutId),null!=this.controller&&this.controller.abort()}async querySelf(){if(this.started){if(null!=this.querySelfPromise)return this.log("joining existing self query"),this.querySelfPromise.promise;if(this.querySelfPromise=ou(),this.started){this.controller=new AbortController;const t=AbortSignal.timeout(this.queryTimeout),n=Qh([this.controller.signal,t]);Wh(1/0,n,this.controller.signal,t);try{0===this.routingTable.size&&(this.log("routing table was empty, waiting for some peers before running query"),await fB(this.routingTable,"peer:add",{signal:n})),this.log("run self-query, look for %d peers timing out after %dms",this.count,this.queryTimeout);const e=Date.now(),t=await gu(this.peerRouting.getClosestPeers(this.peerId.toBytes(),{signal:n,isSelfQuery:!0}),(e=>Sf(e,this.count)),(async e=>dB(e)));this.log("self-query found %d peers in %dms",t,Date.now()-e)}catch(e){this.log.error("self-query error",e)}finally{n.clear(),null!=this.initialQuerySelfHasRun&&(this.initialQuerySelfHasRun.resolve(),this.initialQuerySelfHasRun=void 0)}}this.querySelfPromise.resolve(),this.querySelfPromise=void 0,this.started&&(this.timeoutId=setTimeout((()=>{this.querySelf().catch((e=>{this.log.error("error running self-query",e)}))}),this.interval))}else this.log("skip self-query because we are not started")}}function gB(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0,r=e.length;n<r;++n)if(e[n]!==t[n])return!1;return!0}function mB(e,t){if(!(t instanceof Uint8Array))throw new TypeError(e+" is not a Uint8Array")}class vB extends Jh{constructor(e){var t,n,r,i;super(),Dr(this,"localNodeId",void 0),Dr(this,"root",void 0),Dr(this,"numberOfNodesPerKBucket",void 0),Dr(this,"numberOfNodesToPing",void 0),Dr(this,"distance",void 0),Dr(this,"arbiter",void 0),this.localNodeId=e.localNodeId,this.numberOfNodesPerKBucket=null!==(t=e.numberOfNodesPerKBucket)&&void 0!==t?t:20,this.numberOfNodesToPing=null!==(n=e.numberOfNodesToPing)&&void 0!==n?n:3,this.distance=null!==(r=e.distance)&&void 0!==r?r:vB.distance,this.arbiter=null!==(i=e.arbiter)&&void 0!==i?i:vB.arbiter,mB("option.localNodeId as parameter 1",this.localNodeId),this.root={contacts:[],dontSplit:!1,left:null,right:null}}static arbiter(e,t){var n,r;return(null!==(n=e.vectorClock)&&void 0!==n?n:0)>(null!==(r=t.vectorClock)&&void 0!==r?r:0)?e:t}static distance(e,t){let n=0,r=0;const i=Math.min(e.length,t.length),o=Math.max(e.length,t.length);for(;r<i;++r)n=256*n+(e[r]^t[r]);for(;r<o;++r)n=256*n+255;return n}add(e){mB("contact.id",null===e||void 0===e?void 0:e.id);let t=0,n=this.root;for(;null===n.contacts;)n=this._determineNode(n,e.id,t++);const r=this._indexOf(n,e.id);return r>=0?(this._update(n,r,e),this):n.contacts.length<this.numberOfNodesPerKBucket?(n.contacts.push(e),this.safeDispatchEvent("added",{detail:e}),this):n.dontSplit?(this.safeDispatchEvent("ping",{detail:{oldContacts:n.contacts.slice(0,this.numberOfNodesToPing),newContact:e}}),this):(this._split(n,t),this.add(e))}closest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;if(mB("id",e),!Number.isInteger(t)&&t!==1/0||t<=0)throw new TypeError("n is not positive number");let n=[];for(let r=[this.root],i=0;r.length>0&&n.length<t;){const t=r.pop();if(null!=t)if(null===t.contacts){const n=this._determineNode(t,e,i++);r.push(t.left===n?t.right:t.left),r.push(n)}else n=n.concat(t.contacts)}return n.map((t=>({distance:this.distance(t.id,e),contact:t}))).sort(((e,t)=>e.distance-t.distance)).slice(0,t).map((e=>e.contact))}count(){let e=0;for(const t=[this.root];t.length>0;){const n=t.pop();null!=n&&(null===n.contacts?t.push(n.right,n.left):e+=n.contacts.length)}return e}_determineNode(e,t,n){const r=n>>3,i=n%8;if(t.length<=r&&0!==i)return e.left;return 0!==(t[r]&1<<7-i)?e.right:e.left}get(e){mB("id",e);let t=0,n=this.root;for(;null===n.contacts;)n=this._determineNode(n,e,t++);const r=this._indexOf(n,e);return r>=0?n.contacts[r]:void 0}_indexOf(e,t){for(let n=0;n<e.contacts.length;++n)if(gB(e.contacts[n].id,t))return n;return-1}remove(e){mB("the id as parameter 1",e);let t=0,n=this.root;for(;null===n.contacts;)n=this._determineNode(n,e,t++);const r=this._indexOf(n,e);if(r>=0){const e=n.contacts.splice(r,1)[0];this.safeDispatchEvent("removed",{detail:e})}return this}_split(e,t){e.left={contacts:[],dontSplit:!1,left:null,right:null},e.right={contacts:[],dontSplit:!1,left:null,right:null};for(const r of e.contacts)this._determineNode(e,r.id,t).contacts.push(r);e.contacts=null;const n=this._determineNode(e,this.localNodeId,t);(e.left===n?e.right:e.left).dontSplit=!0}toArray(){let e=[];for(const t=[this.root];t.length>0;){const n=t.pop();null!=n&&(null===n.contacts?t.push(n.right,n.left):e=e.concat(n.contacts))}return e}*toIterable(){for(const e=[this.root];e.length>0;){const t=e.pop();null!=t&&(null===t.contacts?e.push(t.right,t.left):yield*t.contacts)}}_update(e,t,n){if(!gB(e.contacts[t].id,n.id))throw new Error("wrong index for _update");const r=e.contacts[t],i=this.arbiter(r,n);i===r&&r!==n||(e.contacts.splice(t,1),e.contacts.push(i),this.safeDispatchEvent("updated",{detail:{incumbent:r,selection:i}}))}}class yB extends Jh{constructor(e,t){super(),Dr(this,"kBucketSize",void 0),Dr(this,"kb",void 0),Dr(this,"pingQueue",void 0),Dr(this,"log",void 0),Dr(this,"components",void 0),Dr(this,"pingTimeout",void 0),Dr(this,"pingConcurrency",void 0),Dr(this,"running",void 0),Dr(this,"protocol",void 0),Dr(this,"tagName",void 0),Dr(this,"tagValue",void 0),Dr(this,"metrics",void 0);const{kBucketSize:n,pingTimeout:r,logPrefix:i,pingConcurrency:o,protocol:s,tagName:a,tagValue:c}=t;this.components=e,this.log=e.logger.forComponent("".concat(i,":routing-table")),this.kBucketSize=null!==n&&void 0!==n?n:20,this.pingTimeout=null!==r&&void 0!==r?r:1e4,this.pingConcurrency=null!==o&&void 0!==o?o:10,this.running=!1,this.protocol=s,this.tagName=null!==a&&void 0!==a?a:"kad-close",this.tagValue=null!==c&&void 0!==c?c:50,this.pingQueue=new mf({concurrency:this.pingConcurrency,metricName:"".concat(i.replaceAll(":","_"),"_ping_queue"),metrics:this.components.metrics}),this.pingQueue.addEventListener("error",(e=>{this.log.error("error pinging peer",e.detail)})),null!=this.components.metrics&&(this.metrics={routingTableSize:this.components.metrics.registerMetric("".concat(i.replaceAll(":","_"),"_routing_table_size"))})}isStarted(){return this.running}async start(){this.running=!0;const e=new vB({localNodeId:await KN(this.components.peerId),numberOfNodesPerKBucket:this.kBucketSize,numberOfNodesToPing:1});this.kb=e,e.addEventListener("ping",(e=>{this._onPing(e).catch((e=>{this.log.error("could not process k-bucket ping event",e)}))})),this._tagPeers(e)}async stop(){this.running=!1,this.pingQueue.clear(),this.kb=void 0}_tagPeers(e){let t=new vS;const n=function(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return()=>{clearTimeout(t),t=setTimeout((()=>{e()}),n)}}((()=>{const n=new vS(e.closest(e.localNodeId,20).map((e=>e.peer))),r=n.difference(t),i=t.difference(n);Promise.resolve().then((async()=>{for(const e of r)await this.components.peerStore.merge(e,{tags:{[this.tagName]:{value:this.tagValue}}});for(const e of i)await this.components.peerStore.merge(e,{tags:{[this.tagName]:void 0}})})).catch((e=>{this.log.error("Could not update peer tags",e)})),t=n}));e.addEventListener("added",(e=>{n(),this.safeDispatchEvent("peer:add",{detail:e.detail.peer})})),e.addEventListener("removed",(e=>{n(),this.safeDispatchEvent("peer:remove",{detail:e.detail.peer})}))}async _onPing(e){if(!this.running)return;const{oldContacts:t,newContact:n}=e.detail,r=await Promise.all(t.map((async e=>{const t=this.pingQueue.find(e.peer);return null!=t?t.join():this.pingQueue.add((async()=>{let t;try{const n={signal:AbortSignal.timeout(this.pingTimeout)};this.log("pinging old contact %p",e.peer);const r=await this.components.connectionManager.openConnection(e.peer,n);t=await r.newStream(this.protocol,n);const i=yP(t);await i.write({type:xN.PING},TN,n);const o=await i.read(TN,n);if(await i.unwrap().close(),o.type!==xN.PING)throw new tf("Incorrect message type received, expected PING got ".concat(o.type),"ERR_BAD_PING_RESPONSE");return!0}catch(i){var n;return this.running&&null!=this.kb&&(this.log.error("could not ping peer %p",e.peer,i),this.log("evicting old contact after ping failed %p",e.peer),this.kb.remove(e.id)),null===(n=t)||void 0===n||n.abort(i),!1}finally{var r;null===(r=this.metrics)||void 0===r||r.routingTableSize.update(this.size)}}),{peerId:e.peer})}))),i=r.filter((e=>e)).length;this.running&&i<t.length&&null!=this.kb&&(this.log("adding new contact %p",n.peer),this.kb.add(n))}get size(){return null==this.kb?0:this.kb.count()}async find(e){const t=await KN(e),n=this.closestPeer(t);if(null!=n&&e.equals(n))return n}closestPeer(e){const t=this.closestPeers(e,1);if(t.length>0)return t[0]}closestPeers(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.kBucketSize;if(null==this.kb)return[];return this.kb.closest(e,t).map((e=>e.peer))}async add(e){var t;if(null==this.kb)throw new Error("RoutingTable is not started");const n=await KN(e);this.kb.add({id:n,peer:e}),this.log("added %p with kad id %b",e,n),null===(t=this.metrics)||void 0===t||t.routingTableSize.update(this.size)}async remove(e){var t;if(null==this.kb)throw new Error("RoutingTable is not started");const n=await KN(e);this.kb.remove(n),null===(t=this.metrics)||void 0===t||t.routingTableSize.update(this.size)}}const wB=[77591,22417,43971,28421,740,29829,71467,228973,196661,78537,27689,36431,44415,14362,19456,106025,96308,2882,49509,21149,87173,131409,75844,23676,121838,30291,17492,2953,7564,110620,129477,127283,53113,72417,165166,109690,21200,102125,24049,71504,90342,25307,72039,26812,26715,32264,133800,71161,88956,171987,51779,24425,16671,30251,186294,247761,14202,2121,8465,35024,4876,85917,169730,3638,256836,96184,943,18678,6583,52907,35807,112254,214097,18796,11595,9243,23554,887,268203,382004,24590,111335,11625,16619,29039,102425,69006,97976,92362,32552,63717,41433,128974,137630,59943,10019,13986,35430,33665,108037,43799,43280,38195,29078,58629,18265,14425,46832,235538,40830,77881,110717,58937,3463,325358,51300,47623,117252,19007,10170,20540,91237,294813,4951,79841,56232,36270,128547,69209,66275,100156,32063,73531,34439,80937,28892,44466,88595,216307,32583,49620,16605,82127,45807,21630,78726,20235,40163,111007,96926,5567,72083,21665,58844,39419,179767,48328,42662,51550,5251,37811,49608,81056,50854,55513,20922,18891,197409,164656,32593,71449,220474,58919,85682,67854,13758,35066,3565,61905,214793,119572,141419,21504,10302,27354,67003,46131,32668,15165,64871,34450,17821,2757,11452,34189,5160,12257,85523,560,53385,65887,119549,135620,312353,115979,122356,10867,193231,124537,54783,90675,120791,4715,142253,50943,17271,43358,25331,4917,120566,34580,12878,33786,160528,32523,4869,301307,104817,81491,23276,8832,97911,31265,52065,7998,49622,9715,43998,34091,84587,20664,69041,29419,53205,10838,58288,116145,6185,5154,141795,35924,21307,144738,43730,12085,8279,10002,119,133779,199668,72938,31768,39176,67875,38453,9700,44144,4121,116048,41733,12868,82669,92308,128,34262,11332,7712,90764,36141,13553,71312,77470,117314,96549,49135,23602,54468,28605,6327,62308,17171,67531,21319,14105,894,107722,46157,8503,51069,100472,45138,15246,14577,35609,191464,1757,13364,161349,32067,91705,81144,52339,5408,91066,21983,14157,100545,4372,26630,129112,1423,29676,213626,4397,88436,99190,6877,49958,26122,114348,60661,29818,293118,50042,179738,16400,163423,89627,31040,43973,36638,45952,5153,1894,109322,1898,134021,12402,112077,68309,190269,69866,31938,107383,11522,105232,11248,14868,39852,71707,186525,16530,38162,106212,11700,5130,16608,26998,59586,108399,230033,43683,48135,82179,2073,5015,196684,189293,16378,23452,8301,35640,11632,214551,29240,57644,33137,91949,55157,52384,117313,5090,17717,89668,49363,82238,241035,66216,29066,184088,97206,62820,26595,4241,135635,173672,8202,459,71355,146294,29587,3008,135385,141203,14803,6634,45094,69362,50925,546,51884,62011,83296,234584,44515,56050,89476,87751,19373,12691,149923,19794,13833,35846,87557,58339,2884,19145,25647,12224,11024,77338,64608,122297,53025,7205,36189,36294,170779,21750,7739,173883,75192,35664,224240,113121,30181,26267,27036,117827,92015,106516,55628,203549,67949,60462,60844,35911,20457,1820,920,19773,8738,73173,181993,38521,98254,76257,46008,92796,5384,26868,151566,22124,2411,15919,186872,180021,28099,152961,78811,80237,62352,102653,74259,184890,16792,123702,224945,29940,19512,75283,14059,112691,92811,233329,20411,138569,53341,109802,50600,134528,66747,5529,166531,31578,64732,67189,1596,126357,967,167999,206598,109752,119431,207825,78791,91938,10301,27311,24233,252343,28831,32812,66002,112267,90895,8786,8095,16824,22866,21813,60507,174833,19549,130985,117051,52110,6938,81923,123864,38061,919,18680,53534,46739,112893,161529,85429,26761,11900,81121,91968,15390,217947,56524,1713,6654,37089,85630,138866,61850,16491,75577,16884,98296,73523,6140,44645,6062,36366,29844,57946,37932,42472,5266,20834,19309,33753,127182,134259,35810,41805,45878,312001,14881,47757,49251,120050,44252,3708,25856,107864,120347,1228,36550,41682,34496,47025,8393,173365,246526,12894,161607,35670,90785,126572,2095,124731,157033,58694,554,12786,9642,4817,16136,47864,174698,66992,4639,69284,10625,40710,27763,51738,30404,264105,137904,109882,52487,42824,57514,2740,10479,146799,107390,16586,88038,174951,9410,16185,44158,5568,40658,46108,12763,97385,26175,108859,664,230732,67470,46663,14395,50750,141320,93140,15361,47997,55784,6791,307840,118569,107326,18056,58281,260415,54691,8790,73332,45633,7511,45674,143373,14031,11799,94491,35646,96544,14560,26049,32983,25791,83814,42094,231370,63955,139212,2359,169908,3108,183486,105867,28197,32941,124968,26402,88267,149768,23053,3078,19091,52924,25383,19209,111548,97361,3959,24880,235061,9099,24921,161254,151405,20508,7159,34381,20133,11434,74036,19974,34769,36585,1076,22454,17354,38727,235160,111547,96454,117448,156940,91330,37299,7310,26915,117060,51369,22620,61861,322264,106850,111694,15091,2624,40345,300446,177064,1707,27389,54792,327783,132669,183543,59003,17744,20603,151134,106923,53084,71803,279424,319816,11579,21946,16728,38274,72711,5085,83391,88646,40159,25027,34680,10752,12988,54126,30365,18338,100445,230674,44874,84974,143877,123253,139372,28082,91477,144002,13096,219729,46016,50029,42377,14601,6660,58244,58978,23918,88206,113611,64452,17541,41032,10942,12021,49189,10978,40175,37156,10947,71709,106894,112538,57007,137486,150608,152719,40615,7746,279716,13101,19524,28708,40578,72320,1096,182051,94527,51275,22833,45164,81917,77519,48508,5421,140302,37845,149830,5587,27579,5357,428725,248187,6326,206760,39814,32585,89923,44341,288753,284443,96368,31201,94189,119504,20359,52073,103216,179,27934,32801,96035,34111,34309,101326,18198,20704,210266,37643,27880,141873,106e3,19414,56614,167714,66483,107885,86602,4379,20796,75467,4987,5017,118857,26003,34308,114428,29198,6686,29697,73632,3739,69795,16798,41504,7207,30722,21436,36735,28067,28545,3239,11221,36031,41889,100010,19247,317673,29495,174554,6424,129725,53845,94986,7955,59676,2604,191497,19735,102214,62954,23844,11872,179525,261436,34492,428,78404,142035,16747,17246,27578,37021,33672,57944,26056,135760,2369,61674,122066,31327,19374,157065,40553,130982,69619,71290,38855,72100,92903,95940,51422,165999,65713,57873,50726,7288,20272,2081,42326,22624,81120,57914,79352,19447,1684,72302,11774,302559,161481,96396,13692,414988,3721,79066,56627,46883,21150,11747,12184,5856,113458,176117,84416,52079,27933,3354,59765,141359,2212,216309,2555,23458,196722,142463,45701,44548,28798,19418,215,29916,9396,10574,114226,84475,13520,18694,34056,4524,90302,62930,13539,19407,77209,7728,38088,9535,2263,23875,183945,17750,26274,67172,10585,28042,22199,7478,51331,66030,26774,192929,31434,25850,50197,52926,178158,4679,181256,70184,229600,9959,105594,72158,73974,2726,35085,78087,23284,35568,51713,155676,5401,27254,11966,17569,223253,71993,103357,111477,55722,30504,26034,46774,35392,36285,214814,41143,163465,1051,16094,81044,6636,76489,179102,20712,39178,35683,125177,54219,30617,52994,25324,50123,2543,87529,58995,10688,125199,12388,60158,125481,131646,7642,133350,65874,3438,97277,101450,10075,56344,116821,50778,60547,98016,106135,13859,14255,16300,77373,173521,8285,45932,37426,4054,114295,55947,7703,39114,52,51119,128135,19714,60715,9554,50492,88180,2823,118271,52993,122625,97919,23859,37895,25040,33614,32102,20431,3577,9275,15686,43031,157741,110358,1884,40291,125391,13736,5008,64881,87336,77381,70711,43032,49155,118587,70494,4318,10168,30126,12580,10524,280104,104001,145413,2862,84140,6603,106005,13566,12780,11251,42830,571,179910,82443,13146,469,42714,32591,265217,424024,92553,54721,134100,6007,15242,114681,59030,16718,85465,200214,85982,55174,165013,23493,56964,82529,109150,32706,27568,82442,5350,14976,13165,44890,60021,21343,33978,17264,4655,22328,27819,75730,16567,55483,14510,17926,45827,150609,3704,7385,272531,161543,76904,122163,52405,2039,19165,41623,14423,228354,3369,176360,85491,7122,35789,303724,4465,13628,2233,55311,118771,20713,10006,221519,45115,71021,35650,29775,7337,10864,20665,21142,1746,15080,1624,32449,10905,105743,229797,7701,3940,22997,178467,57208,389057,39683,59403,63344,63125,54847,69691,18336,56448,3362,37202,18282,29648,138224,35867,10495,5911,28814,26653,31514,176702,26550,45621,11734,4525,40543,73944,121080,27858,155561,14887,44670,30742,8796,107455,113472,56369,75581,183777,240095,133699,153299,8768,160464,26058,49078,103971,21875,71486,44888,17156,9678,89541,123019,102337,3972,83930,21245,87852,109660,287918,183019,686,10100,39177,283941,11274,24736,26793,26214,25995,77011,141580,4070,23742,46285,46632,30700,26669,19056,35951,115575,174034,56097,35463,87425,24575,44245,38701,82317,85922,281616,100333,147697,61503,7730,84330,8530,59917,61597,17173,9092,32658,90288,193136,39023,20381,56654,31132,7779,1919,1375,117128,30819,11169,40938,23935,115201,101155,151034,4835,11231,74550,89388,59951,91704,107312,167882,115062,12732,72738,88703,464019,158267,57995,60496,737,14371,123867,4174,243339,159946,7568,16025,134556,110916,38103,191,80226,88794,29688,27230,10454,76308,57647,77409,113483,66864,14745,19808,12023,46583,84805,16015,17102,2231,20611,3547,95740,250131,34559,108894,8498,15853,159169,148920,20942,2813,93160,45188,210613,45531,52587,149062,39782,28194,57849,60965,84954,89766,84453,100927,16501,27658,165311,103841,54192,207341,19558,20084,319622,5672,205467,98462,61849,36279,13609,147177,24726,165015,209489,59591,31157,6551,117580,75060,141146,277310,21072,22023,106474,63041,137443,122965,68371,5383,42146,98961,113467,30863,23794,4843,99630,30392,82679,13699,241612,33601,93146,24319,18643,32155,95669,40440,15333,34089,67799,142144,58245,38633,114531,117400,77861,188726,5507,2568,8853,10987,107222,2663,2421,11530,13345,30075,41785,118661,104786,17459,12490,16281,71936,193555,17431,5944,71758,26485,77317,20803,367167,158,7362,93430,11735,172445,46002,11532,54482,930,62911,2235,23004,179236,4764,101859,208113,22477,55163,95579,14098,67320,162556,90709,156949,3826,57492,4025,34092,87442,104565,6718,186015,28214,14209,10039,107186,233912,58877,81637,55265,39828,6194,145813,50831,105849,4974,88319,122296,10272,197216,95714,51540,72418,23324,91555,8743,140452,250249,51666,34124,7229,38592,129641,78169,174242,22464,149964,51450,14034,10026,95376,26190,120062,14401,8700,265,31386,143573,7203,229889,61567,4227,140981,2466,72052,10787,10062,30958,6099,38471,30103,23202,208101,70847,467,58934,32271,32984,36637,24107,30771,17109,73353,13650,2098,157040,67366,66904,106018,265380,107238,18535,44025,32681,144983,62505,91295,56120,3082,77508,10322,63023,36700,81885,224127,16721,45023,239261,111272,13852,7866,149243,204199,32309,22084,42029,38316,126644,104973,14406,43454,67322,61310,15789,40285,24026,181047,6301,70927,23319,115823,27248,66693,115875,278566,63007,146844,56841,59007,87368,180001,22370,42114,80605,12022,10374,308,25079,14689,12618,63368,7936,264973,212291,136713,95999,105801,18965,32075,48700,52230,35119,96912,32992,8586,16606,101333,101812,14969,39930,759,193090,27387,42914,12937,5058,62646,64528,38624,25743,37502,3716,4435,30352,178687,26461,132611,42002,138442,35833,59582,16345,8048,60319,49349,309,47800,49739,90482,26405,34470,63786,32479,85028,39866,47846,11649,23934,29466,2816,42864,31828,7410,74885,49632,47629,111801,90749,19536,18767,105764,59606,21223,10746,76298,22220,39408,7190,79654,64856,11602,82156,272765,17079,70089,245473,51813,184407,384678,1576,122249,5064,27481,6188,25790,74361,27541,318284,45430,31488,620,93579,45723,192118,22670,51913,4162,70244,35966,26397,16199,50899,209613,121702,287507,2993,36101,132229,67345,33062,76295,118628,78705,52316,34375,107083,107454,44863,127561,33964,3073,154010,190914,55967,39074,6272,31047,5550,41123,26154,98638,47110,19998,148091,50229,31329,59900,195442,19106,61347,73497,70015,682,45850,25776,38022,148951,6288,37411,232526,109277,27286,32342,9262,5220,16651,23175,46740,129438,78614,121925,66914,88710,127952,5563,21500,34521,10739,14863,191006,62956,17359,16749,67027,56284,69134,43301,35039,58883,54466,60823,404451,75743,59856,86979,7923,34273,83785,32142,7693,268986,197428,282681,17049,22346,22990,92245,107180,3357,37104,96724,49153,7683,31197,43267,82231,164276,23696,20848,188364,22309,24821,158707,1018,22514,70922,27792,45589,59709,10765,736,35218,63479,51987,24275,63588,55361,92929,81964,4658,20122,12330,44058,13065,311456,72224,8337,211229,38979,22590,138478,52757,32595,133600,8838,31549,94412,43391,90056,1585,94802,127271,6223,31889,137038,132910,2165,57616,230152,6080,10748,36737,74579,134062,50525,180532,119270,34556,76155,82394,52595,29258,31435,87820,67996,26943,183878,38007,2410,13526,180297,69856,3503,187396,167700,7838,16701,9199,56267,3661,37407,65994,23767,5708,62508,221700,67088,86978,46776,84434,32088,5612,9149,88244,21685,95151,46750,189612,2979,506311,2594,3628,40074,105039,78243,28523,6651,38058,71999,30992,12764,68261,108991,6165,26450,61961,13400,22426,7490,60890,109623,2070,12958,50355,67979,257096,7213,42578,52121,35716,65461,7516,124758,39268,302,64712,14977,1467,219452,2840,34229,11121,21602,19270,63574,8024,1532,17331,79839,78885,52029,180767,57957,6069,91265,61380,55767,8927,32881,287603,22149,35029,68876,6428,199567,46926,13412,104132,21434,366616,45060,110046,81924,128910,45886,52821,130416,29416,77342,21762,67329,121432,79924,11724,38625,81006,102033,28338,13326,3250,82056,82526,38212,21112,12382,111495,3263,7414,86274,93490,40844,30224,45212,24019,48411,71367,24941,76729,57776,3769,38114,202019,197745,31953,237533,33270,201580,255648,100798,44741,32241,98468,106931,10085,15090,170358,33154,66787,18819,69760,25061,234005,82660,6295,131975,16874,9076,4094,25005,17740,40908,19533,220019,44330,99792,50040,19619,13950,55228,24423,31253,95308,103177,184795,28590,82285,5059,3210,75525,49894,70007,56178,10580,36051,139681,21617,98736,3555,106306,164189,37352,63915,47824,24883,145530,61904,28444,11483,19837,145446,30420,112972,85939,11835,191233,2262,20705,58630,1753,148334,1197,144714,6887,11223,107667,60879,77914,4151,57417,81594,96681,169430,1784,20444,95138,254041,27038,596,7117,72808,13759,3353,126776,21074,55322,27081,36942,39547,139830,179275,4453,713,8722,71399,19204,25785,22794,23923,104114,11291,25458,102309,88396,75288,230440,206396,104551,58447,130857,37247,94734,31548,176529,226077,65159,20104,10096,66881,94191,237909,27109,37404,1520,27421,25220,113003,23423,24884,50585,6286,231877,150800,11789,3226,90004,60642,5053,202400,61442,132531,175329,57138,30116,103847,9973,75367,16452,32360,59119,21246,10191,164804,23305,61051,37348,154530,13214,5468,50403,66754,130976,50559,80515,14436,155492,84017,5472,43107,41240,2890,90431,70188,382,76234,48040,50211,281038,237007,32115,142178,1536,22761,96429,1811,31243,1679,49143,55209,17402,235054,61494,7462,77030,34925,87609,78002,9499,9027,73289,201078,101379,63544,27666,5469,10642,30029,49816,132979,95620,58086,351930,116300,2110,2043,30845,6154,11279,16727,4122,2277,27281,4971,3650,39060,61970,65951,39674,75686,38151,11370,130809,177895,32665,63725,122267,7857,39618,118483,44792,157755,178624,136994,24260,41308,22471,12404,21707,12486,30473,52781,50246,20247,39065,909,56825,103158,128603,31542,1089,41935,32744,12428,37963,84420,33134,72921,208449,42622,168151,127335,147107,46699,38216,12591,94342,85814,31423,24944,2605,87542,67473,192551,4496,56321,91819,17630,6300,256183,114569,202090,33209,35289,34897,24967,40520,43470,5344,10199,34810,14283,10381,10017,62923,49924,23233,64539,13051,35686,19698,11570,135555,120868,44924,87065,52318,52335,47586,140906,245885,109834,78668,9065,46990,25258,72022,61243,40838,4545,146387,10537,11557,17470,36930,68104,46711,24264,79401,81043,18225,120488,24746,84338,81652,28266,13776,21878,46973,1047,230465,73357,95777,24973,210160,62210,58404,110633,169651,6937,41870,9909,26822,191062,76553,27519,96256,239070,2478,205678,67955,58532,20601,50120,19148,78501,195724,110740,8249,109665,27446,30568,57631,31425,49752,32820,65504,50079,3663,102256,219898,23849,211315,14645,4359,91767,9528,12449,49366,7941,49763,107848,8930,27086,50686,9744,10447,81935,39513,46514,1670,29229,6172,22312,137280,97759,9806,14445,22976,56458,73391,34983,93760,174219,52573,33149,59747,2429,136277,75123,165263,91040,7446,57632,48633,97140,246081,84766,151684,79918,93268,120346,54059,54875,77858,32996,103590,45276,11968,19600,25849,17159,132907,42828,16817,4913,99462,103303,27395,5737,74184,20749,21160,14377,77062,131403,158735,10999,27799,77785,9320,34366,51593,61070,33746,47048,29268,36675,30262,53297,9832,82e3,20188,122292,39917,7331,18160,68301,185935,134830,15031,4935,10004,165845,185534,46923,30109,44134,122631,18874,22903,112790,26561,18549,348902,82871,140345,255565,135390,63556,103747,145055,179600,145662,296111,61661,211987,23952,52342,126343,48450,32919,44277,82185,9591,62139,205363,376969,394874,108461,18040,120885,14798,39863,16571,16794,58271,81025,55206,14640,118656,6361,44092,85970,6262,153863,108244,180200,72264,79947,38044,10050,5735,61221,80712,5471,115689,11391,11661,184257,20010,60116,30320,19327,134598,45455,27542,18004,125092,452272,1549,91523,46567,180063,156026,2608,11174,58848,37788,65907,80194,30490,5786,40775,119519,106241,11323,156297,8425,61495,2617,29675,2425,59886,112582,49142,59618,4863,50597,86710,50650,168632,27693,85641,83643,18993,25768,84284,28090,93592,36627,312804,43381,9887,9402,100931,97165,3311,173330,66805,28935,4963,184460,3201,78102,19126,21607,37496,24938,22615,16153,32862,134792,153318,61120,6067,2812,12826,12792,23825,37559,64662,202250,102694,155488,85881,149193,46233,65383,15521,106982,11358,176786,25752,39717,34208,24510,32464,77742,39371,72028,138229,60688,71386,102834,132477,2208,11548,63670,271279,28351,30338,38620,32491,99845,143885,152266,13252,2825,178663,108097,1775,78201,14897,113573,163346,62292,171129,22183,96598,38733,64971,166776,117445,9968,146393,44677,74867,20908,97328,12761,25656,26785,9148,112344,26115,99176,110121,22437,49547,6180,79320,5835,31392,43328,33377,75870,119860,69497,80273,7325,155219,43167,111173,28347,20222,3763,71752,55041,47252,14618,28088,15012,97805,194698,54636,2036,41349,6173,96604,61530,51859,43782,13361,24334,22668,24792,7070,23441,16789,3209,36211,208475,26242,32880,122181,182407,21444,31060,88459,29929,77907,12716,10934,97005,20599,31690,8403,58445,30303,22700,10336,86731,103115,337709,72556,46788,112566,47684,67089,53548,36874,56487,41387,125985,26893,40071,106683,73712,18787,40105,72992,67246,137276,50802,36790,70328,138827,22466,39263,183295,29858,50975,9322,57397,10654,24364,30383,55799,41600,23584,127295,296610,129078,143558,244131,86397,36049,1085,80677,3820,108139,5476,34767,24683,7758,13060,7239,131671,250593,59556,103392,29810,4188,252323,39404,116877,7651,43600,40338,13554,157253,39196,25978,144387,61211,234,50104,6129,10449,93777,9240,356378,274148,4439,72970,3724,147770,78680,62570,115877,40027,40547,36817,224392,64609,34795,165027,67440,2477,37206,23431,50754,164797,46018,94995,170982,27051,7957,22767,3674,27900,56419,18930,60701,41302,2692,84749,339721,61996,111094,80221,50129,1045,8153,62945,19202,8250,37208,37418,32560,79477,41106,88569,33963,36693,5892,30570,1581,66471,49647,11922,160717,29442,5643,114865,82962,95982,132098,22633,22838,94726,54556,28566,205039,162340,33216,16849,35847,221339,94851,26533,71469,1805,3804,12935,45483,71020,36310,65381,192960,34240,35165,59773,1248,46954,155332,96864,4246,388800,16129,57133,74592,44807,442014,38203,42574,80818,91592,26377,36424,65760,977,77387,22628,147610,28018,30561,98454,6969,119628,63648,18170,36854,26601,64018,22027,37279,51395,152934,21153,9430,58760,194742,5330,55115,34158,28917,174111,13171,122326,1526,43896,66094,25325,4234,148354,11450,275,18999,112191,44365,22723,68409,8733,57746,96565,75007,14196,108844,29475,88599,177563,100792,106156,86323,93726,14248,135341,194131,40126,47099,14779,8272,39597,95983,171398,65882,28052,10393,47213,40689,22120,72212,106829,34964,109146,753,648,21660,30047,17527,181025,5619,145357,4085,216883,9359,186951,24779,53931,24545,36197,223296,62628,168101,4243,107313,30321,26642,13049,51059,31027,107912,807,73550,26551,84369,122422,165872,49754,74213,234264,33151,52014,33100,87183,22365,52500,40013,23302,5652,72723,21404,26107,48434,587,94049,168493,96418,32871,70860,31709,25128,443,71597,166253,15670,70994,26341,133675,28280,75491,54756,47955,56028,26182,11952,113272,472197,64640,110753,17919,337,50642,22576,142,87371,53391,93210,126694,15285,19642,85667,14148,1506,42092,52962,33243,11970,20734,135843,57044,58880,13002,219134,22876,64754,232519,4257,43120,321573,24799,64526,124728,52579,81472,70831,276848,17403,74359,23021,182101,74597,23744,148267,12055,7976,5349,11772,67540,167347,65318,18720,127832,108238,22828,90233,9987,259080,118185,73209,79270,13775,90100,137742,90799,70569,15699,19961,9087,67475,57872,39731,8810,134897,131868,146849,19898,3334,2281,167061,91073,60356,467742,74712,188,53179,137679,92769,29241,9537,132595,80119,1041,88962,5976,40171,44911,102859,139059,104558,98987,47761,19272,71472,113864,175377,73338,10857,23402,23758,1591,139864,5644,4076,118760,16427,134198,18853,20291,100849,37423,22038,36677,19071,195521,57445,11069,31869,55718,66882,148490,44,41296,75242,49704,166810,9906,20943,122258,49112,105667,15969,10344,6408,187694,21399,72742,58970,14867,14376,81889,41856,23225,15042,56993,16074,131389,74276,72407,53875,383108,53597,37363,68993,44854,122548,430927,198279,38430,80409,12245,2981,628,2818,17760,37437,238229,7968,46892,2200,3730,34190,65983,37959,112291,87850,70827,6522,20750,73913,111621,41652,19587,2780,58668,25916,85259,18200,168962,95781,42445,102050,7776,57662,103313,47742,96358,41964,66174,100396,29069,204735,19679,27978,7479,40264,22534,61183,36081,107436,58223,14680,23002,101311,24716,124108,12908,5646,31750,40380,14215,232799,102772,14122,96775,61398,50917,12096,149880,67833,598749,124194,155871,49216,790,14677,65319,56917,7440,145744,95701,12206,49405,129269,76199,45732,9767,11058,9047,210885,11051,7392,26307,2130,8132,147526,20802,232698,115660,50060,59789,57344,107623,80343,112676,23291,9866,160971,34032,118291,15719,59730,164911,28975,2659,58046,78480,21854,66209,53863,109085,116045,29021,46481,107552,22130,18764,70254,31272,11300,52460,43933,84738,20721,53869,190840,79673,105300,7561,321817,66924,13940,33281,101046,183181,32176,71878,5678,62924,79535,56646,40303,19559,27703,93042,73368,42187,3670,37376,46440,7023,36816,109628,20680,5940,276440,275233,170848,112093,136996,14984,20226,111441,77693,112960,48577,39370,55707,50314,123404,26570,54281,61372,123391,4857,35928,246740,132507,106646,44241,7196,92258,9825,37688,51197,303141,5590,15476,132986,10955,85782,34486,26696,7991,28813,18858,39546,11703,11365,38185,5716,93555,11925,40121,60002,6985,10976,171384,3887,43394,13337,56346,6381,252336,39573,75042,53711,1028,31781,44295,95925,131713,7214,68125,43571,70954,213234,1628,8760,13391,65485,17320,56038,1710,25248,60803,57399,19839,3870,326,281556,50945,72400,21460,316244,75619,56246,98775,481,13513,55765,50427,7388,123519,32929,57908,27124,61316,101097,57467,30228,48792,10788,20402,37318,50526,155730,34456,158065,145305,17832,43733,64052,4506,35072,205355,177028,184004,187081,68616,35938,83703,10367,36892,93186,260137,51934,89970,4985,23445,26755,21558,7948,78741,23376,124405,85594,68596,57536,49351,12619,56593,132668,99924,109728,71844,71935,196018,65464,17617,14987,89701,143773,33997,8687,22701,33258,2914,4436,72108,85610,9671,49067,2327,82988,1361,1672,44033,35777,30269,24057,10605,82236,616,15793,13919,47249,112086,116698,9484,80207,90574,33304,68624,93127,56101,42210,160929,4827,38995,38095,4701,125119,5027,33680,9236,231236,14135,87837,23318,70261,78893,30151,81482,14332,1084,74256,27532,46644,79185,3148,62615,6981,55672,31668,36825,1849,14536,37446,14738,23779,43058,162749,72199,1168,21346,5592,85932,85302,9668,18351,57135,150360,2080,228015,77953,34670,119302,151751,31009,106725,84265,45214,59289,74178,113071,263206,111009,4021,44449,188119,192629,123592,392506,292847,114487,12831,205858,9852,20780,79648,75767,357014,97721,18166,21005,67950,33226,204009,16536,2987,11335,66717,144910,47950,17262,55060,15063,2934,51038,26775,178497,66008,3427,49433,128592,20036,157553,63861,3089,23015,51210,28696,35933,49942,71135,231518,99620,17248,21835,176536,20676,16944,38700,165831,233253,295625,36723,13023,52745,10907,19423,67972,125868,95473,82875,1183,108455,52685,33417,64095,21433,52438,33191,127809,44505,211823,7810,2752,95548,162031,7185,91196,47563,61721,33359,17897,23682,42806,178101,22874,49707,199897,75419,82456,8618,11171,79712,116847,18783,44190,46564,5346,59046,95032,7893,14916,3214,26800,24172,121453,34362,10250,17408,18888,4840,68696,22831,13162,36005,32512,14800,62357,41723,45046,27247,37486,5372,2564,34261,298500,66509,133920,89138,31305,117697,19097,108304,81386,84106,23802,46411,63304,946,51417,41777,41041,19501,115864,60743,294354,37955,94165,18116,1156,17937,20645,57114,90804,58042,48643,92288,9861,2557,88546,61333,101008,12853,5148,87856,4152,144503,73841,18718,9789,147565,10846,42085,12789,30223,8993,56352,67203,2448,28215,6052,23540,126319,75933,36689,80235,23231,23561,21383,38800,77548,102798,21234,31468,158608,46188,63960,191679,8051,67014,11185,170078,42186,28827,34777,41930,212079,12421,34750,24111,110344,73918,45171,70826,141949,40063,23979,24254,37309,26724,27179,24718,83648,54938,14591,17425,29525,102675,48975,48654,12316,8929,60640,41709,50168,63264,89812,50716,48632,38755,138583,160123,55579,71829,24230,233277,46322,39650,166388,34718,24108,98252,7031,106695,62498,18258,35062,217827,78731,34824,33354,19520,60852,2432,60224,8587,2836,62955,702,20227,42285,40560,95592,62486,11094,53035,143291,18842,46177,77994,1770,9657,107422,172915,32655,128716,25886,25164,156740,119928,165875,85817,11007,89110,33956,12652,65156,180266,8494,36889,19958,20955,96,1264,118288,135769,44754,86671,5632,19026,168220,289120,33569,93821,66144,70635,7687,5642,2714,55445,56636,71545,184182,93133,7332,37389,12643,52315,22729,11014,158742,17050,152889,50178,34601,41945,52136,9948,26914,63548,95721,115951,40759,8960,158258,38938,49232,48325,42234,81523,253019,66128,40978,20048,238048,38760,62928,122560,118532,43687,137472,163689,26680,9878,17448,51035,16211,60834,36749,29178,14241,59868,150086,2305,26477,42422,34342,165341,83279,33894,14257,29928,12743,13957,125571,89134,66712,10952,16507,147839,30146,7249,16565,45399,39874,114565,215780,31990,230881,171477,102,196546,44538,10880,84948,281705,86651,10617,31395,2342,453658,43569,60561,132901,21845,17727,58556,258242,22262,58728,4008,77997,11806,37431,30599,81375,109137,185787,114085,217292,97453,169085,30593,60212,11544,102056,65580,2384,91655,4855,95725,7295,157994,16228,20669,53276,141590,105246,17334,25440,76067,17967,39321,38911,11362,28559,63807,21627,26468,85816,40120,1025,15234,58319,69516,66512,124548,75845,78873,22137,46681,51242,85683,32909,76747,35555,43396,101465,1765,73094,1077,2962,39028,66777,57831,42048,15828,13962,36041,63657,52412,5242,58846,2141,5506,219012,134451,3936,182230,17558,17153,152237,22621,49377,170216,35257,68233,65374,6510,11126,212151,7184,2480,22517,3437,33073,30156,16557,3768,55067,86829,91e3,12350,148650,66017,79424,70885,49066,28250,21369,51213,34533,11510,3258,18176,18465,84413,6315,36411,163765,4346,356,107618,598,13727,285026,162695,8749,14583,7132,63521,184253,32378,25991,5604,30961,53675,4874,84693,5086,34811,26978,56564,7904,33519,51221,113942,69253,6664,125563,22055,220680,102008,742,51930,19494,176108,44424,35123,13025,75685,11759,74335,22250,181453,131147,16984,132115,154311,11991,76452,52609,85351,196,30969,9198,74919,2529,56838,71779,29187,116304,3504,62330,41190,86153,28393,254926,104228,105189,13264,84359,3574,12415,8534,57147,10175,188174,59504,60932,66318,16407,107921,17638,99103,49278,28403,39786,145865,8462,3558,43406,142271,29139,21989,36552,93955,72365,7176,13556,106185,37957,321774,17782,129017,51154,27938,24952,1935,39366,2791,33489,41582,56078,24558,9311,5449,218786,27808,190429,68013,36020,86003,29735,3404,87348,119357,115714,2324,86796,81973,40992,43376,93621,28784,16808,36367,2517,2909,191926,24978,55303,53308,205724,60068,3098,21375,64784,23949,26579,63121,12319,80145,39967,97861,6757,70143,67642,37082,34698,69140,122883,46151,62187,80934,429,19437,135071,137885,222647,13331,154065,327,61778,74257,40116,37493,14855,85079,237641,42342,102164,199965,71204,4662,29368,5042,113914,122214,8955,13149,102503,43173,5659,163787,69003,307084,63392,171080,21390,81918,86666,36622,24126,28887,5736,28054,207170,163428,79891,346467,95363,38980,111806,80828,9200,19288,294896,114468,87405,111715,141705,7015,72754,68463,48738,243147,33397,101210,37051,98801,82847,20397,4940,185559,18716,54718,83491,11725,40803,1128,12128,23060,5174,7745,67007,46701,1571,27807,180186,256996,18975,16837,7877,212758,250379,15440,87954,57755,24719,124057,83461,258,50864,8874,29038,71289,31627,15429,9005,4061,113851,107716,82819,13651,79656,117851,17539,111446,12938,39724,190787,4352,15402,21070,62708,8539,23777,73853,13552,38810,86117,16285,56400,1718,75342,142863,29033,378,110113,180321,32586,23606,26393,160984,207987,23783,8406,16904,24596,47274,11693,46539,60524,78595,48423,31718,20170,9009,146268,15183,191060,172765,1349,138436,37365,10970,40509,225817,20021,70394,152138,21541,66559,66544,89352,2725,17258,91345,7313,3815,115868,8660,40362,4071,103524,39388,118275,21950,6549,38226,32754,209574,29201,43495,18028,20296,40597,18370,47520,202450,24134,2219,8195,69545,38041,136934,46374,19041,159811,84865,58620,846,98749,13569,30714,97246,32186,4479,27355,92973,35214,151491,75963,37631,1561,27200,238083,23182,60756,12291,25766,39355,102333,87362,65741,59906,19538,201575,48772,102938,24438,292580,39964,66366,9004,61379,50548,37622,38732,28379,68180,76622,17488,69849,5963,7219,48143,43413,55358,540,58691,29506,19245,52193,48621,5518,13048,118625,44755,191081,42061,89197,2259,60665,66994,71210,51232,3585,142096,55024,7892,8345,58653,463307,65658,64319,137941,136323,53499,12746,43492,6978,95163,29925,60175,5128,7352,41463,184756,121146,20473,18426,4598,5309,54580,14277,121151,10691,56711,43880,63409,76682,11830,172218,264898,32632,66536,81062,31649,25788,92774,60222,11100,63159,9432,224657,25240,53613,152,138620,163829,2397,85345,12501,37507,64932,38575,43522,65789,80198,78796,35226,3851,108891,73311,3060,28391,93671,39663,46142,30982,66041,37281,68157,26553,71872,81142,211527,39747,118119,22695,2859,11066,20232,168911,7933,197005,17066,111071,44434,133994,120798,12766,227798,45756,132852,29917,36076,55352,65281,129800,41958,18944,84678,18580,168093,132621,39997,54092,27740,32354,3770,114118,103242,43918,15899,18574,145944,3190,123469,219903,24169,100571,62403,16776,92779,14535,17168,16475,14304,37231,1712,28218,242754,61688,28980,1318,51359,222657,99200,67989,31772,23932,35351,201251,49041,27306,19128,40135,3986,77333,19649,120683,151927,21081,7076,78375,77501,101599,8011,89585,96715,58179,5378,102138,106793,26051,217276,4197,16297,27014,46721,13322,22806,5278,29629,70632,9647,71519,58818,40603,128530,8903,36770,56900,31483,26935,43845,34265,34920,87658,6114,84767,64250,47318,50720,19264,162514,33357,13117,6705,46696,75032,71054,87004,42035,69138,11903,99854,102328,19611,34525,69312,6431,49842,101600,133178,108751,41829,89939,225664,48916,99556,9195,130387,5960,36857,116724,53518,94002,39077,53996,6945,22261,64291,8314,152785,57588,16522,9091,5048,87671,35441,39509,1945,12423,158923,178413,37549,14095,1475,73188,62878,4819,24012,68534,42606,4010,120809,57497,59564,101758,103718,32701,80116,12345,95834,46918,21468,53213,15665,31200,3867,5140,96013,250744,21016,10069,13968,35449,180829,27683,39704,59956,22893,3115,26293,32785,75934,62445,141162,62720,2018,83638,19949,114012,95006,3330,99829,130935,309272,9565,55874,121727,37017,23586,319858,40970,27602,8625,112329,61060,100088,118525,25922,16232,1907,60671,51583,44553,80993,5262,94679,8676,940,20736,11823,3020,16476,12340,152600,97416,3703,25744,66826,16245,16876,46446,84798,74227,176020,45192,61955,75496,23946,23626,40372,26036,6149,11822,30582,16541,41914,82385,232823,40921,80773,14930,3631,7517,39619,4348,36180,126106,138939,62611,1477,113512,47321,25052,14546,118881,29060,23589,128322,36795,18401,137921,104699,267929,36194,172791,18113,4766,188215,30083,332586,94089,5805,77909,22194,68234,154976,43220,40660,70001,184893,138095,11128,103010,22663,5108,212615,8485,5565,49222,54614,26530,42639,16319,55062,152662,105595,21114,22216,10294,68158,10436,86950,7206,62115,3977,3657,59874,456,118617,18156,106663,112229,80992,17442,8217,55551,5133,34344,251927,51153,39364,201321,7816,66803,23057,156724,145664,14276,95705,979,2796,6875,13429,212525,50602,26276,28284,3424,19465,52397,46963,31420,51399,206476,92317,48851,637,100820,83349,10317,60227,21972,6908,282439,32857,224767,95629,83882,42106,87338,69757,29840,68709,37665,45244,114577,49188,175943,54009,186746,106158,70168,3358,234002,50555,9221,129338,9562,20118,32923,78479,118280,65752,4977,10474,102174,60947,129006,10570,83451,8598,8078,159367,123785,80438,16742,5905,5281,181513,42402,6977,163136,93179,42191,14968,50421,112401,105440,33456,57347,121611,4221,94954,36517,24046,27796,6255,33394,72990,135408,116627,1233,57874,25654,95419,68156,401399,313338,55208,45573,93124,119251,47200,38196,11909,130667,45391,73904,64964,167846,4137,115606,52036,62214,7969,160925,7187,1132,134835,40309,73195,64494,80472,444841,61111,26500,45323,40743,53625,52797,22659,15631,29739,36706,28841,39147,102836,26794,10536,14845,87305,45874,12241,127587,83833,57183,79722,30844,41304,84655,20825,92500,3722,25655,27811,10157,81634,31362,34088,92487,70123,22190,185100,72658,139035,192523,88241,2078,230490,44528,85638,100198,22088,29982,291233,241062,13865,4445,137791,37835,107218,31726,19718,38234,72528,23046,19177,66695,5109,17251,28077,5617,21554,47839,72425,133825,1486,73065,181275,141508,21768,62971,63082,2512,34200,9904,120309,6392,91243,68416,268253,41199,116757,138551,185526,41246,28986,4093,19057,17295,4148,245766,122360,35356,112075,20301,75441,10998,7977,19769,62922,937,63547,100196,26427,157820,20983,236696,22935,8140,90315,156004,47204,140973,7726,45097,52725,22636,23436,257282,105247,522,88389,216031,202204,46812,211666,19693,68828,81691,45925,11256,30292,372,5236,167826,88328,232776,151611,5360,82104,18841,80393,25465,18285,20320,72377,31730,33160,45803,38715,27705,37379,24163,18360,103586,4015,32305,269494,91252,20080,36567,54650,7797,57073,12650,31164,42209,6375,261663,105528,81661,106002,2800,5375,17247,43151,4442,15727,194619,100855,144898,62320,78465,39929,16454,1967,28311,61363,17219,9395,8745,121445,76939,80385,162380,22009,54191,44248,16299,122830,48151,74429,78291,64755,14238,44966,2511,17712,67954,93583,829,105899,49935,84750,11591,33185,85447,42717,27409,208542,28965,62052,52525,5597,25694,65594,16343,63224,276188,12475,9331,127507,38522,57287,24128,133161,79723,105548,133695,48917,27558,43278,46520,13778,141954,110785,83366,17715,46317,105763,66298,147013,41086,94180,16478,220447,44611,730,19722,78975,117889,125643,26254,16574,18480,65006,15806,38549,246418,46052,36056,8440,34984,30170,3163,59800,4458,115442,4283,41970,33507,104078,1653,22,121158,276486,3655,6338,24048,133421,23641,2161,24422,36006,8086,10675,181474,12307,29514,59143,14729,52509,87128,122470,19446,80852,33314,24573,119864,14237,9652,57779,6612,51851,15284,98871,90581,124466,156831,21190,22015,71380,161906,87247,69201,18392,17908,108470,72962,40719,14338,17911,95260,43339,20610,78916,20710,72451,11315,31448,17263,58853,178878,48111,116002,45497,80506,82605,85880,36300,121755,25215,36118,301929,88728,405223,276136,553,34704,212438,49970,78329,922,20711,25036,257130,38295,145369,18128,15385,30829,55656,48345,8012,3561,28004,122041,192900,58338,112508,41085,29976,87040,47117,23905,4336,92061,138880,97407,42083,172121,6256,25192,172671,5,93568,1420,12677,31605,56743,40620,6015,78415,231077,31298,80026,13902,19048,24924,170586,32955,176119,87859,36731,6773,27711,24658,26475,115216,133207,93250,95820,88522,8317,5714,124047,55219,86860,19677,23961,22928,162209,8904,225992,359835,56084,96201,29392,96558,86071,93643,55114,13347,8183,95129,82012,2017,123336,34219,115554,157159,47747,101684,41008,18735,193781,104151,226906,7552,179874,124113,31159,21162,44010,14771,51268,166128,31382,73124,77438,92830,205709,12113,1292,38937,13114,1334,2118,15597,69581,14449,21934,76618,48728,67038,14967,51495,24243,87736,147249,26720,11119,46063,43749,5843,44147,152629,133428,65703,14269,45604,57982,28672,55616,45957,8438,95433,37698,220862,132034,39456,61870,4161,26501,73560,56418,9845,4654,20916,10456,88920,119358,9015,65931,96507,48029,38534,21676,109081,43078,34943,25089,6131,28766,23665,5477,10255,16695,67,45778,42443,42770,29534,23733,100513,62617,42630,48746,14191,43753,50295,26007,8792,57243,43119,54725,164253,58250,112304,131796,25165,4651,3188,24831,47748,3705,19540,13211,102095,5593,18699,23666,32005,117571,33541,60584,74573,86311,99443,25172,27222,168938,7143,11853,53560,18834,19960,86522,28217,53266,117700,72989,34323,18721,66450,34346,74056,47217,202002,46269,9429,68582,75458,37823,82843,96652,32549,145144,27958,19820,158086,31955,201406,135379,31207,192545,12950,51704,9094,248263,76147,64028,110009,79407,89345,99284,223492,47966,26848,15359,201137,2861,110507,71231,72297,31851,118777,71039,151051,240855,16333,50766,14727,7939,4149,80908,418780,88378,59276,1327,7284,38576,79814,65820,42199,84860,49574,62596,12396,70598,40117,8648,7994,16836,7630,14047,359699,106878,525,29037,28064,13380,11675,50669,74216,103539,180314,27449,56299,172344,19274,7301,246099,32043,19422,36506,129317,6806,30140,4614,46639,66926,932,86600,6322,27847,233103,10541,39025,34887,3517,12972,26220,2031,66561,115015,48658,47596,12714,33845,3893,16165,35237,89983,14769,11962,147224,47018,29977,27979,5552,82338,86023,131368,1218,24853,237840,132193,15455,40873,3668,65351,53388,15229,59889,272245,47934,11858,34347,18038,90853,86981,300602,19343,114181,29362,84921,6095,106059,79472,38015,1206,48741,6208,8e4,21916,17423,6002,108083,24479,34931,56661,9511,26995,100694,163853,35997,81254,58321,18919,171890,86877,91341,74503,70477,53412,7027,59281,39892,131302,5864,15947,61301,67466,162369,47956,27874,35624,282324,21270,111847,102548,41482,30955,116737,28264,8592,55458,22301,75090,29821,30697,51709,3041,19208,8038,24634,30467,87509,126428,19389,18814,152686,20701,83474,45832,80891,105808,11378,153223,120770,98186,150633,49838,9141,12755,30962,5260,74490,21256,31678,65062,33326,289838,187831,20595,89768,2805,58535,10844,70085,12090,2451,138068,98544,24461,4511,6754,41684,28203,3383,65355,82833,30161,83924,234361,128424,28921,222594,33975,125491,34069,11508,67464,144226,41850,98703,34371,7901,21254,38398,65651,23549,53883,213340,123269,12028,71764,177701,28758,2623,68395,11549,15232,68603,9660,63116,36079,57093,31198,20475,48467,89984,35619,186847,107469,31389,43631,73867,41949,68841,114250,1605,30564,63403,17588,27680,99533,12641,70325,50428,73426,78379,11855,91651,72081,91720,60198,15743,12065,83398,140046,6761,46598,45900,5068,886,62448,148968,37347,19405,9680,15819,43496,63370,75667,163700,37639,3633,22774,34341,183131,134335,37200,23915,7054,14194,12970,26438,13350,285521,25594,8219,104410,91039,168804,138480,149734,15907,33818,61132,60082,4622,110187,56736,13551,73571,3945,73463,65498,17758,263266,17593,2710,27585,54469,38200,45367,63754,28881,3473,12791,98287,31895,65787,4463,94536,24951,36332,59901,28803,52130,86403,7668,181822,74831,18977,9850,177206,145485,109798,7292,31421,26280,77211,58511,12507,127004,11113,147,8729,56208,43066,79926,129937,31345,83947,39915,46146,98763,42566,1337,13192,18323,105163,80570,117753,16555,72883,11077,159438,40764,70933,83329,26066,12276,72059,21655,173836,126713,69454,153482,91585,70644,102558,110483,6764,127864,190133,3961,101798,20945,71138,82402,90884,69669,44753,923,16939,59700,164258,25969,27082,31399,43846,6306,246093,51342,6153,151581,202801,182731,56475,162188,89426,141356,14355,121815,27536,28023,65257,77523,106668,127314,24947,12790,38796,169698,23555,10725,44573,183083,42088,62716,43265,105958,32050,44067,50118,1668,3874,6243,318411,16599,1691,94999,52378,28671,216728,123258,2059,34969,69225,5913,136280,171443,141515,91662,22175,135282,80020,92270,1663,4808,4482,3495,34691,5226,109830,108512,17342,107488,11606,123190,100247,29666,146527,113014,15794,30894,13224,39585,243192,22351,9903,7836,47699,11078,25468,122291,48821,26780,122679,75521,81450,630,4895,92900,55074,74293,17441,3563,111657,103102,51613,12318,52370,36191,68245,34269,40445,41354,122901,168604,182500,62012,42557,11259,24428,115113,86345,12362,3909,78430,86852,134602,20459,47853,93879,22577,7659,3688,38555,13349,17381,56715,91639,12493,10895,92438,3142,37057,28928,2004,36427,32268,34222,209974,10432,67436,41989,173518,107930,27079,62729,30908,55558,5828,45031,14902,53546,8204,144263,60255,14520,88212,86582,109589,69356,8064,47449,8505,66558,16886,4844,52817,111260,215129,12941,91118,650,20770,6273,73089,40618,62790,2873,35002,14023,97208,19386,102646,36993,143736,135457,35385,113601,17893,32627,84439,100619,56016,6581,57264,172160,45452,111710,203627,70131,24100,322787,1996,35665,70078,22358,90922,83658,4097,63200,58499,14542,99153,52159,6615,12414,63415,31986,16823,1579,65405,137809,8841,16898,48082,259,33014,42375,12260,179850,73667,91389,98882,29532,17311,326251,41092,5928,20742,44964,48019,43505,9317,49265,6643,192712,48424,163487,19861,20113,70848,31928,105333,23685,78563,14638,54755,7158,24142,44018,20774,125255,20331,24280,10163,1285,2336,39851,4299,117269,46714,63816,87779,159624,11731,9971,990,137317,108831,50994,74554,162680,23640,131597,146962,170620,34829,91205,21184,1913,63616,18427,93136,156592,17519,67565,115882,138220,78622,88535,18115,2711,33554,109492,54298,971,24914,25863,36363,45715,27099,194995,14299,178181,111488,72395,322385,157719,130787,11897,81843,83999,11369,49280,118604,40922,61332,110343,53407,75639,40582,300440,54722,25637,13694,48248,48278,194521,56203,52779,48783,72627,10953,376,16733,280238,26351,230789,15132,25168,137270,3588,63704,73376,94031,74284,19443,159557,9697,39901,13351,119050,15406,146455,3460,29556,75195,37673,102524,92329,47289,98413,15311,100684,56345,7116,95480,11590,7200,167,23610,58426,17730,136656,27944,53151,2701,8824,103124,3017,90744,113588,53216,79736,65940,26931,498,29568,80540,143543,21292,1740,59268,16561,180816,42323,50174,40890,52866,10703,57169,4700,17191,4424,93511,49698,166650,26972,48631,165169,82879,69326,202970,4007,2376,231325,139592,22119,62851,37504,68816,58345,67398,186643,43331,277416,53749,15746,23102,17432,4793,151138,48822,54265,48203,198688,14305,54287,2291,18018,113378,123260,7180,97549,87027,120085,2920,76080,8190,102005,5641,64580,14955,59802,54028,58884,19367,81779,412567,85957,97053,103637,78871,29364,27637,141728,4767,30686,112738,130146,42745,12730,105040,14844,232,210944,36581,152317,135543,29744,3129,55647,58149,46319,27265,17499,28005,59948,7170,34138,5702,293047,110892,408,91760,218674,18469,46095,81403,14389,4610,35672,73060,11006,74848,104820,118143,190357,20043,105358,141735,5115,27093,45924,123073,52599,29433,9616,238350,78610,24851,58858,26769,31969,24613,18294,4982,32735,39639,143563,112073,202205,12567,4873,88601,44897,81503,101648,81362,34662,85277,17574,48173,21435,221188,40215,39576,80786,26544,64668,81841,10731,37733,247986,149188,127703,495,18382,54388,72446,43071,30974,198723,89608,41360,190,33045,8386,31658,19992,237838,119015,137622,50890,100913,6460,116233,267230,26621,104129,65114,14190,41542,14888,85962,23342,23041,26453,43725,71809,45186,4770,46452,53894,56616,221286,18973,9038,109299,55365,19366,26863,18808,60909,69353,41738,83463,12100,68561,72860,3980,13796,49340,12332,31311,27418,4255,53430,18976,45523,510,14224,30477,26581,4530,3651,101663,139840,22709,150861,31996,63923,120623,262522,3076,10528,2929,14672,130238,18087,9816,121894,100308,25085,55111,14565,18952,53293,2042,369988,23674,61789,133529,28783,108293,35477,47119,36448,71049,40015,33055,78598,198442,1833,159937,40654,77444,189245,113153,8621,18599,38553,35223,166072,2375,11659,21786,89523,6032,12116,63046,159398,18454,3678,32521,47626,11411,103527,38896,42946,15696,26370,10185,8413,37080,165583,4331,63555,14907,72220,50056,6623,62236,36565,49783,10049,17503,100581,55951,146244,24724,9626,17969,25524,109300,173965,99994,101056,46459,43647,53737,277968,8347,123521,74858,33829,44762,77574,877,81377,222525,123532,30602,43881,53145,2973,16284,81940,61281,127044,63620,9875,14756,114829,19032,9202,52759,119141,23928,120551,19607,3599,33401,76821,73233,117430,39968,36539,7071,5446,121735,194059,15206,45283,6706,15603,65615,1207,165723,92275,34773,104447,8396,32353,205240,164323,13600,60555,79205,25532,22907,33410,57480,107111,69630,32137,47832,70913,33161,20321,2371,117348,10714,86246,1625,11763,17900,268,78457,99175,97940,101092,86660,32221,14041,128504,125080,53744,124263,31017,13897,403,31859,21964,5633,111630,5547,77329,17961,18241,84995,25984,12983,67491,62168,47262,5241,297,51191,7351,8967,147212,82060,16821,782,11033,82431,62957,5026,43459,77963,203477,53528,6247,191852,87774,74164,215654,13467,1522,219964,28589,244104,16242,117821,67725,72570,156792,17186,15979,26990,44128,193014,35276,57125,16212,166451,68017,6905,77608,16364,53777,75921,76426,37975,26203,269296,64099,84122,12077,38533,830,4407,20139,963,43028,38902,42911,37503,83343,85045,16979,1165,60835,137387,58380,86990,110066,134540,56331,193845,81238,17922,163093,38744,110641,12502,56404,34862,26865,125964,12965,111648,25547,7771,27196,136980,9555,29551,107158,57885,18831,37705,35505,101742,13970,102109,62548,124657,23328,11124,89592,146376,248050,6241,22033,18337,80685,29898,11908,216623,67721,106162,146610,21377,15085,91552,42041,62560,122532,125336,102365,121537,142559,29693,223919,11515,110495,18776,22494,5895,185059,103592,229351,51220,100102,37027,257855,29359,54123,36066,106493,12244,79258,32002,432,56205,94836,90182,6726,14762,29391,48938,26864,38083,60364,3310,60192,14766,205567,57504,110760,22649,24666,46333,21517,3430,13135,28873,27052,158809,11597,20529,6695,23138,22960,37137,45574,6545,305877,43423,26153,24769,59844,14501,10430,134352,56169,13213,103432,49523,35181,13435,12408,129475,64620,230854,77390,51990,15653,83248,33466,44571,117828,51481,2187,10559,68019,18021,54895,48247,18354,33737,4554,108595,37288,39767,116707,9175,3726,108877,21616,83684,49862,1938,8543,276466,20134,108498,48770,102254,31914,131520,185291,100559,51890,209,19526,76471,50544,71814,99351,8172,198526,28816,20419,9109,98389,136777,76479,75596,30635,165417,48216,120220,25955,211071,39314,24308,32164,2559,146280,43403,9233,17947,90585,1786,86920,125662,2457,64741,32152,32918,122882,78538,44001,31723,56426,23375,103172,88177,145697,52506,49319,68016,31664,41488,18486,110400,7030,28241,986,109199,19900,42147,56864,65287,49183,7858,24e3,30453,840,16673,25907,68916,89927,6309,158335,36407,199737,130464,13137,59603,201778,195292,21015,42466,179062,172561,89492,11075,180407,31868,72493,20998,60217,9865,19530,39274,130266,54539,21623,12535,13505,40641,73375,4087,85633,2153,3117,70680,55788,92096,47509,98493,37490,271936,151475,3032,16171,96642,34106,78425,125761,19591,3366,19316,54508,24183,50786,194248,91528,33253,34622,108355,41741,705,3814,3883,108929,13203,67831,10142,59754,68208,29128,84820,56880,38794,24972,48571,40821,40476,18137,164254,24064,236309,79181,11282,395,39169,2013,51587,28551,9645,701,109513,115899,113566,12762,62045,58322,103726,41343,40866,244102,143816,2490,70346,40973,52618,15412,30720,104315,38917,42027,93676,17513,107418,20706,123890,13399,97727,24044,87962,65606,44250,98044,65276,74790,101473,19350,91570,1326,87790,172042,7577,100813,86896,85891,41512,108130,27794,14875,71431,12835,156250,58135,3759,22476,42176,115873,34686,56523,73643,108505,51491,20838,12721,32863,45700,29496,13700,34294,55360,29206,155942,123812,7706,163234,203,132720,49358,144431,8130,175788,35818,3270,76832,25710,54095,97274,28779,94621,74396,19092,128242,58067,20885,14670,93255,15107,63291,23654,126900,129421,59294,262659,9798,3251,67344,28600,44629,50672,29072,26999,31526,23183,49175,165843,175455,17282,175411,32022,45989,30298,90690,78118,83156,23749,35636,31317,7069,80381,94561,133756,14960,97404,6138,41065,78041,32843,16601,34123,9559,146529,123377,96395,54441,42012,84257,123541,10745,22139,106459,11720,150883,172651,154996,110538,4728,53447,25704,2009,71152,119354,21166,66604,1429,216162,8637,122250,63520,27180,29172,36124,276428,107787,77184,4680,14952,104903,24418,14793,51561,52931,8371,26342,48526,7118,92066,67280,40653,8847,34597,105438,14198,50163,61188,146286,50315,41205,170829,161496,585,197359,95056,1687,365794,91349,48507,5804,49263,5146,104902,96365,117343,132222,46084,96919,16875,8073,262381,79982,52663,13928,16056,153908,15145,109256,132308,18763,24904,167644,13618,40750,18686,147124,114709,150038,52849,2938,12568,48617,8778,5459,44202,44591,74914,17183,248689,13878,7822,80060,23116,194037,18487,2067,7798,43077,33678,244028,31320,74273,2794,19466,8218,36280,183997,48124,19416,29656,19280,98734,7715,18311,30701,133602,150307,126956,7378,2933,79903,13178,12593,86571,26604,92446,13574,44205,65699,427599,21118,8245,14407,27877,47936,33542,7916,26460,117762,21596,37818,2249,127359,209394,60044,47677,308089,36791,154971,31417,6998,150042,174360,12255,43009,29335,48739,3912,101398,53340,2580,146939,151295,45360,125275,15273,45383,27456,48761,23314,8750,60801,85823,104759,27894,123685,66968,39480,26917,55290,83305,2696,98390,57569,145853,340733,4919,20024,52268,30884,7413,203685,70989,112855,4129,50536,349518,68205,332641,159581,135361,236026,37563,176404,64899,6578,122033,63871,1850,85234,82089,66124,74145,121098,107351,12687,36881,117334,13136,14698,85933,93866,18047,32620,310,15094,46e3,88451,23632,36645,27940,87618,80520,58892,20976,27702,140090,96075,67841,103292,238964,87778,107338,17019,83427,67522,7302,8261,47570,116787,8730,80484,61772,174422,56005,131193,52875,14588,28471,59817,9586,15720,158155,51307,109734,15196,11025,59331,3884,52626,102602,84797,25158,27314,4437,20488,76214,189248,35023,114952,157376,2827,62439,102878,129749,36405,10329,109339,108633,36662,1254,13267,5470,87105,58004,15397,10434,159667,21864,52022,179464,3013,32147,31496,116832,18494,105502,129227,107267,50033,13481,9954,24267,22141,16257,116154,36185,950,115685,11305,176708,2048,178671,112573,287867,162328,497663,95170,50979,193861,50987,30368,136257,31830,46549,15119,169876,23788,17462,249887,57377,1949,35448,14791,43769,210091,3783,34612,282103,88380,245190,5457,20491,98908,11402,86899,117916,16028,162584,60644,320177,156096,31065,55876,22e3,77655,9992,23397,13757,317623,63978,215255,2443,17648,93231,27388,104529,93807,55505,140477,12046,112040,70887,40152,94365,112353,25063,114679,266061,71248,119555,15589,2244,617,14129,211431,70110,100652,7777,4383,85911,89221,21010,120615,58357,86405,37554,41647,18,15143,69662,60491,14714,186134,148344,42347,5410,168175,44535,42449,343894,129417,99682,20659,27272,140483,63455,222159,17536,13722,42637,62324,11976,114691,148109,2283,32057,182393,4295,147364,33705,2075,44303,30274,28331,63740,69740,29148,10346,44862,33716,73937,153333,12930,38784,247159,2515,41053,20256,83368,256189,54639,115240,5096,24661,175419,153552,26516,141,138176,63885,34115,47222,55709,2765,28479,38875,236608,12229,22921,77291,54426,45388,2860,57787,114579,295139,105782,17826,71066,19119,54364,69385,16568,12323,28057,33346,34919,124763,155533,101386,31644,8627,49001,303600,29868,63213,9103,77280,71333,9696,138789,37059,24823,5057,21352,32368,114208,56803,19424,10445,58514,8661,209508,26187,171838,10460,63454,14016,122504,41328,21329,46618,32493,38225,7855,31763,7945,29876,8734,6438,24205,97490,139977,130740,47323,33195,85390,57194,13813,60600,21313,96251,7699,27584,170521,139271,1363,4402,336738,129223,84983,69150,13147,3590,163929,207225,155260,55916,20288,4503,8398,98490,11773,27512,37113,84976,86558,28365,11756,116005,182148,13733,115313,47644,67208,85069,9347,14995,226141,14704,101835,41159,35314,13113,63526,214039,29978,50446,83339,17440,129441,72522,118641,97816,24907,73844,15717,118884,167255,96509,162793,30847,36849,51297,78974,77793,10427,1873,2972,9999,35074,28190,64297,146836,46298,60038,163007,108919,61219,2403,75022,127339,4233,110389,69022,9833,128097,88016,79390,222936,22570,94657,28462,56956,38803,81536,30474,152794,19566,16481,147408,74574,81895,20731,1918,1366,76367,187321,54494,24366,21690,61696,33283,107477,77499,31112,414383,74362,18463,218441,120929,59848,258629,201924,69269,454,19989,13054,59894,3623,58908,20681,35723,78523,102680,38988,184112,108087,50944,132704,52966,21699,18860,96349,201411,82697,85395,95658,5093,6427,177894,44191,32755,26961,155739,6249,31310,81030,26574,84311,120155,86730,113535,7424,48888,13516,45747,98098,20077,183995,81945,43210,26704,40420,75831,45648,11180,6855,57927,65528,124096,34851,2598,156633,107572,127352,38169,123845,60142,62722,105584,232364,23211,68120,1601,22169,89299,747,258039,80572,7258,152249,11862,101204,8834,121434,33761,19175,133142,46343,40178,48723,3589,41977,30210,38868,62257,10087,82658,87827,90646,16415,47552,351723,28298,72225,91146,272760,1701,11295,1652,109651,300747,51863,198800,29446,11794,32345,37538,22356,33102,37590,113544,37970,11478,179743,25454,103417,59905,221970,105196,145604,7817,164809,102360,16974,75840,255333,56902,6659,1954,645,59400,67769,7689,18675,5215,13793,20536,27852,3387,29523,259718,16860,94625,43143,29245,15848,233581,22685,63631,78557,22836,133302,84513,1348,51826,47129,98836,58284,1830,1749,94642,10933,6145,12506,10975,13879,103781,144434,10268,28409,32346,52968,121567,107374,77268,23686,35097,10501,155275,15303,47136,21102,168741,55332,90385,15996,84817,681,137803,25054,142275,6163,38175,8056,124296,240642,65621,4934,178205,16101,62803,60964,18230,100622,76465,44689,14545,9543,47514,16852,93380,28048,12047,107106,37575,101485,77047,57326,34819,96137,76916,6469,46264,115983,75768,87668,69942,13027,165,8373,114231,26434,52844,42799,182044,23580,146254,38081,43236,33883,146220,382894,14606,46035,36481,166621,35417,95382,2957,59384,60428,36358,66343,75378,22267,22950,83528,17577,56474,25285,4619,179691,75355,95836,53295,34588,171410,4487,14679,84208,44015,18562,109133,54101,11531,86052,174479,303157,28095,9953,35642,14564,39802,16145,77606,117406,53038,121117,53624,22062,1212,7632,127157,237292,189087,10478,127345,102515,181997,86752,87623,10966,121602,68783,68681,83042,114380,138349,191305,67176,50085,39016,1427,42384,1412,67118,122616,72389,25260,2237,13576,137346,19938,20304,2191,68759,5373,61364,238507,75814,23931,69565,38993,131741,38364,12528,87762,5679,129853,5310,186831,32653,90338,260176,389531,108118,26843,43985,50175,30563,25106,56965,18130,140428,4542,165503,117991,24219,229605,1819,129663,1240,3797,76093,18398,71339,51919,93043,27175,47060,216257,6483,35051,1217,16512,80798,129064,13225,69339,8548,237079,72298,2575,34280,51379,117910,55671,53345,247552,29486,39328,140821,34681,57045,60177,5004,90269,78522,2479,322607,48474,61296,13057,31558,4678,59271,6699,27044,31988,35944,12503,83480,4389,136508,3781,114121,70279,4488,155829,42214,2898,68191,75695,305850,45041,74344,106509,30087,17429,93292,12477,290,23080,114802,35714,18751,26554,105424,17775,2144,2412,100610,65192,113975,52975,180272,135050,129815,76238,106483,21440,63186,4260,46189,9711,28249,4169,23429,23390,8324,141585,63809,67668,38457,38063,39226,59972,1189,203916,62368,14403,16949,61767,85801,1739,40147,35049,76757,33124,62102,15780,103593,103009,53484,22952,67973,114645,6566,5245,50462,7601,8288,3513,194571,80276,1908,54592,5124,58571,2513,6800,273997,193904,1119,17991,117245,2508,129156,82366,26278,71465,63341,56943,39662,106116,94966,156875,9736,2204,122308,94418,27134,1280,24539,49022,45314,3764,50904,46424,30699,28087,293839,9400,33646,40165,822,147499,50263,116179,29085,11863,31314,5578,17797,5104,12454,1604,15342,219206,10232,67800,94261,25872,13565,90339,78971,75377,26649,41184,47695,11514,35369,20767,14227,41953,309396,148270,147938,33074,14453,27499,109019,39018,25738,240196,158931,52820,8612,95853,21524,137010,84901,70869,70021,116794,48404,38771,6732,1070,70990,187297,49140,5238,576,3564,253975,16027,16483,2811,37775,19034,25259,4053,2e3,70083,95774,19713,33431,92703,91314,42381,288770,48194,95985,3991,77418,13406,241328,245086,56533,35275,62725,9246,51924,70181,95331,16163,31410,79016,39312,120878,119371,275987,80124,27712,9186,220,23598,146167,85209,68238,282190,57048,31273,30555,80913,17594,75779,59160,135002,101219,189377,29225,96735,60126,62522,104e3,27620,86814,17240,147533,11001,5425,43682,410,49460,87270,69480,46315,59448,1816,76201,9431,11788,87960,29063,65539,47347,11678,33846,7008,196704,9895,6753,8633,120892,59970,572824,115934,6646,202559,892,48351,37611,251282,57823,67263,57750,26527,34485,90747,7685,88370,6144,64182,1709,41969,21458,62327,181657,49247,225330,122600,114574,107124,85361,111833,63243,71420,15655,191178,72430,18063,51425,54002,12364,53225,86557,18193,97580,41232,138398,67821,128724,8944,233212,101353,52099,42127,14006,120107,32789,32132,3498,18123,33758,56058,5779,128760,59888,98869,18445,84702,51911,13234,218379,20093,39031,8074,70195,20708,23462,24355,131384,60189,26390,10403,41060,7140,10781,49410,42261,87202,82566,41663,43105,60276,2768,5733,74176,28329,2297,145430,131632,83615,122915,105441,655,224102,5284,136426,67763,16294,188511,32538,61049,27893,3394,13951,159099,28542,17930,145360,9492,190122,32285,78855,26440,13570,58648,73908,4239,124561,2444,74172,53131,11468,10794,73566,11623,35343,64710,30481,4163,10328,38309,29901,10538,154377,76132,92405,24839,11679,3465,13449,11637,7824,2337,57754,1260,14458,41118,19878,38661,13416,159180,37074,163164,54137,28627,52134,184900,8520,40385,29546,30502,22386,66527,107458,6850,24022,47983,30603,35083,8934,304066,39500,9,28261,33026,77251,9374,44833,116312,34990,29236,63563,125639,135405,165398,159055,55690,88141,69643,236964,31983,25572,20436,36746,60896,31850,16179,11828,5888,3043,66368,9750,31167,7915,53111,36430,1333,64344,93659,20061,60596,180191,51630,6792,30244,43509,101058,22409,420,44210,109783,43223,27030,72477,72831,32679,29235,7675,47556,12258,39907,149412,84926,118247,24692,71717,105038,86009,45941,41189,89453,29856,52543,30627,226798,67303,59230,67415,34408,1367,99685,16867,128419,52147,4111,125381,117881,16173,44093,102224,31575,23234,24870,83790,127407,239098,3200,994,1255,100903,242275,117266,55116,38205,16140,29662,11307,40414,208793,123355,56470,4862,75600,30119,58218,70828,24075,26974,7802,192353,4851,5475,78720,66596,3409,28573,64396,30381,30690,59859,88256,5406,99945,103064,34463,37727,24238,86643,60088,4057,23741,5967,162904,38240,28356,93858,25510,122879,6897,3278,7057,11971,4400,35461,211413,21395,59615,39471,87233,55795,128426,3051,22470,41950,14705,3974,180108,80476,78442,204996,91987,15634,67610,139015,142373,35611,51134,10387,4353,153456,57749,181039,14183,68447,151532,21107,36452,20551,3186,46247,46383,129666,88736,140662,146243,2066,8360,7978,64818,106963,17896,47801,10723,114821,223295,74192,3293,3393,16987,74064,11277,91622,4270,29828,27951,387869,103235,1374,61988,120083,477,145892,128378,11779,211263,61354,18221,17869,46530,83061,108538,157981,90608,67199,95080,49064,195814,12302,66307,10348,231346,160732,112859,63633,146558,21271,31037,198802,47622,12862,95710,3910,77850,73961,85585,34752,61e3,4082,24595,103679,71107,8208,79568,150019,16615,24961,139857,32664,197366,4559,54735,32696,4126,162019,75698,13916,70108,159638,19834,9349,24675,175560,49643,18206,52459,27992,10809,88865,401975,133172,29e3,34558,30915,3658,25834,42430,36562,125265,18182,10155,40149,97082,208980,19575,60853,90529,66545,9600,789,46420,2317,88593,55595,98980,115302,5742,169155,1073,177901,3472,11189,63711,78643,65472,50459,127979,93,42202,67053,21720,157650,11145,141378,42033,22824,85705,79114,35584,15974,1510,54172,28562,12451,104226,19190,97151,73024,20948,5151,81741,21499,29006,84183,198074,54003,45120,170125,26240,35177,28389,64863,79974,60778,176915,232183,45342,2038,80253,41564,40703,32689,5430,100689,5366,23007,134279,14266,26712,73993,24934,64242,52113,102887,61801,46415,201049,54251,62133,122757,164883,30815,139966,2319,30842,766,13362,10287,134518,86111,81665,82440,28333,43019,18963,8804,161944,23439,102144,101145,80029,39052,248708,30350,117340,11878,128467,974,138625,63961,5237,74778,61834,67040,43814,13690,65947,33809,232476,115258,181745,28824,94013,9510,10246,93722,81976,7217,114383,3493,16014,69045,72692,12145,80981,9507,6692,1620,60820,330444,35474,33962,4797,7053,295463,46445,27026,12491,77988,49524,35675,90947,29114,166705,101385,133782,32704,6186,84595,176031,185623,45966,151302,63069,1699,107491,947,15458,74452,196212,6046,10498,12163,10239,35191,243951,9277,9090,29539,54460,22820,26514,112549,60372,51753,48756,21812,70861,260326,41,44222,10441,16961,48148,138771,216194,5914,52153,53400,212036,56519,26245,10117,45888,15294,138019,90913,26368,43842,42111,23348,6082,194845,161089,156206,51546,11647,30759,302912,262094,8635,78876,26535,35283,54183,31183,85484,147873,12989,5197,6356,72894,65347,20150,27370,73787,1493,45918,12366,190217,20724,13858,10981,67449,81213,7553,14115,72242,271517,11842,48310,88743,143726,22177,3290,243231,58452,62937,12592,1654,40066,33477,13751,9921,128442,15868,7106,75236,83773,10775,36938,10482,170465,17368,17469,161508,32752,98340,800,19824,264456,3901,87319,2867,26782,9630,113102,185815,24197,44584,86366,40224,3636,140916,31731,267731,9567,53678,72984,29389,27963,17106,50282,284911,60170,8322,12608,23374,89652,5268,39044,229766,8869,151350,31436,177342,12269,183212,120418,116270,2843,78888,69192,7865,184099,1086,129897,18383,70508,20242,18508,229924,124569,35749,50589,55626,9884,83115,40971,30671,18135,14452,38861,17844,201826,5549,26413,17189,13561,38539,10679,143331,3314,36785,171194,49685,187713,67506,4618,104039,17060,195080,50648,33159,19238,67559,134840,28599,157523,17130,38064,117398,94355,31918,13575,34538,40326,13997,3494,348283,62481,26862,3603,104426,244363,153709,112487,304612,199674,41239,35545,54869,293005,28223,26277,26899,4533,18518,15492,38587,80488,70485,160395,263,60162,11382,222152,4696,250751,51921,182609,10707,48463,46243,1227,49111,111564,46502,33342,56846,68541,63559,858,139927,16654,229375,76759,26478,33205,95828,23399,92945,2637,35630,28470,143992,50214,14174,21456,166191,65665,1711,21594,78019,97599,111701,36,147151,110246,189022,43021,30397,40757,131935,42065,73335,48039,26596,28984,15102,2361,7421,202167,69744,43766,52826,3642,83304,33873,75140,63169,192389,36551,92748,13039,123959,233220,21738,84447,77230,20228,187852,19095,25799,92136,108774,29237,53947,2299,118106,2687,8830,42331,202924,33667,2023,73763,30704,19363,19779,16737,35629,48081,24068,101013,162338,291912,13749,24745,328289,167679,70086,48299,23306,16732,17801,43322,54589,3586,63653,43624,53474,925,109177,251316,43805,13082,19511,86565,142182,92461,17117,101033,103319,64589,4022,4351,235897,5352,82705,107142,46391,156084,5860,61365,10558,13045,7717,18357,33922,12590,33065,6928,46993,783,46937,67846,8952,26295,6107,119656,18799,17458,50747,4229,179559,112727,118080,20683,41464,125468,51560,49749,44231,7359,35339,62988,136487,67015,5208,29150,24956,105186,48858,6143,18097,6972,16404,73489,58742,97196,36357,164616,5834,32267,13746,147733,15113,132091,34127,106298,39729,106426,22294,9780,15602,36213,71502,42808,66802,599,60755,5851,39120,67363,108623,126368,72770,91263,32486,30596,151717,7951,52002,43103,11768,68942,40901,39344,24037,127500,116890,48403,16926,86750,17745,48648,159545,34460,58419,5634,114317,67865,31462,23352,24010,98185,125708,69686,68337,13610,26271,70691,2980,4768,27225,102402,75453,28106,8104,6931,1176,6274,6475,112635,22498,6176,238686,26832,28893,90319,14441,15682,15087,39517,45270,109134,104440,45965,47645,81772,7876,52683,87720,12898,4505,185665,2769,113401,15664,57592,105229,137381,97059,119268,6876,43309,33886,128363,35476,144249,67013,143587,83367,25703,91436,59347,53236,2289,16519,19844,46309,58558,99834,23313,218816,231303,36388,51333,183535,109792,139277,54306,90139,18235,8275,32710,37677,82464,86025,92204,88842,117723,37570,128723,234242,76350,73795,34896,148247,58424,11105,11744,45746,63372,17118,49772,199520,81902,38004,22911,33752,3125,1995,53792,4689,26909,108150,146062,69674,41811,161444,84855,8999,28561,16731,93937,3189,21967,24890,22943,1356,145300,51569,28802,517,118679,31703,40607,48098,108854,25003,10233,73969,177495,5248,24516,215347,146192,48712,60626,69188,40735,5866,586,101541,6509,47590,52129,5969,222045,110933,25733,24223,65339,62812,2414,155418,35819,16022,78423,43138,20995,128255,240673,46745,236093,72176,57085,97841,61248,107,36068,193177,105427,55726,215229,20446,47228,100420,87091,14429,121708,23605,21157,187721,21880,2997,203976,99166,95068,25877,7724,98925,83401,4829,13182,18229,13718,239662,38653,116505,153497,30589,89029,38962,181302,43853,78872,180301,4786,248240,7401,106136,112590,77745,19731,60880,77789,125748,135487,5975,48627,34084,12419,215770,47557,254582,10364,106495,21856,67539,88981,38805,21428,48732,42316,12149,16078,52808,25327,51322,33850,51147,12253,122354,46077,56483,254553,115417,81834,150991,94662,86668,7381,12841,100650,18218,15741,22372,68294,50705,15535,84660,61887,22553,72299,31361,24824,17743,46820,64288,31582,77006,111674,116384,30760,80920,86149,77192,51979,79691,60342,122805,103800,240873,160744,233114,78962,54920,8608,3484,316104,72548,24337,5088,230040,21926,10172,36838,26,86221,83458,102176,12062,17571,41929,41170,28428,68239,41750,103930,2634,18313,53019,34825,97837,63115,24606,73157,152474,14715,91439,37033,109806,140259,30668,174760,380,135597,95673,136073,65073,134249,13829,17279,122305,4420,46444,10237,64848,203623,70728,10349,182885,65075,24519,25783,40318,34139,22222,63394,55266,102764,41422,20126,65100,90408,53640,35128,48932,11192,38935,96839,34782,39492,19396,41332,6250,5511,19492,51304,25936,104466,54099,73771,86115,5080,7669,30891,111700,13931,25276,72289,135447,14820,258641,25265,31005,281179,75286,393,95359,14623,13584,6680,101227,80173,44933,76666,54542,13244,39348,458,25379,109451,134348,81143,6959,65554,12027,51311,8716,57589,140731,28467,23316,17272,30458,25980,55229,77197,83798,28302,114784,7428,34548,26241,14712,39336,103304,18928,54080,12870,334,87722,15208,16895,142098,114262,39820,83913,57817,28682,7721,14900,108672,11250,62246,42849,415188,1724,26555,24549,25505,26443,107450,145899,61035,43528,6901,60726,65906,267741,21338,147590,42079,18924,73017,135236,15393,5206,4026,84185,1531,5988,113890,82647,303391,7386,69844,71611,189865,76523,31877,13315,19314,198575,32821,1928,67641,25913,104475,103489,3297,70391,18406,15446,113347,19295,93790,27856,1792,167471,116449,8541,4408,41757,63233,25765,86680,64501,27034,24816,34975,6079,4486,49693,36229,16917,21581,62426,27862,11612,54284,35702,194034,355,24277,48262,87411,70504,310164,118018,12516,47559,43502,57433,107139,9290,66533,80863,14634,34312,91725,28606,21342,67241,72355,43244,375789,37402,174015,105070,8342,44167,67494,1890,16365,11723,271002,1865,47918,8350,45564,27742,25110,125803,8553,49504,81925,62211,4534,15491,19011,80373,206920,667,102405,128623,245524,5553,113309,192739,65766,19567,22832,261958,29679,21293,71134,20962,105123,24721,860,21752,33448,18372,157167,94822,35770,173224,232737,75729,28937,46828,28062,25453,5207,140366,36665,30652,6169,67920,150458,92040,23186,184604,92330,20891,176492,49427,27828,38305,42495,143982,49560,25503,90043,29747,65328,47830,12932,11068,77721,9003,25213,94205,140426,46090,89945,138173,192691,33329,112232,129905,35709,27514,1841,19957,31411,127476,53572,17497,173549,55063,175135,19841,69314,5192,237921,117660,150697,4060,273045,50414,98940,65348,153665,164423,58804,156695,48994,213928,86036,28608,8355,39574,34540,16927,135680,18374,151587,10830,53805,16878,16623,4282,48030,8537,14986,46102,13062,72897,72,33050,108227,39451,45935,651,113320,40535,95176,57450,48843,5003,19019,10407,211163,3848,1068,4988,32091,30095,41692,15099,43602,107434,50744,7627,171349,16313,150832,352665,207750,33937,38256,51091,156e3,87889,90663,84175,24908,114900,50365,31494,83829,5398,169342,47521,54818,18935,8356,43094,41212,174536,10082,92550,6678,60614,23355,69721,14796,34149,128830,58187,3179,208,40325,28399,225029,401412,51150,31580,207268,6657,10993,69818,64282,289845,23308,12961,38447,6681,52944,31855,2572,47646,120728,179148,37240,45196,218274,4816,3695,21961,50084,35209,18073,51452,27004,6100,33941,1377,84831,171214,85,141510,9078,99227,32610,6417,11718,49868,65579,87902,73018,49062,46280,61742,21512,40862,107733,15941,29168,157765,144919,14487,5767,158014,140070,7241,573,71584,16921,223566,40331,179473,35081,47926,140885,41508,52104,59180,42310,32811,29048,123517,102413,80208,10104,14746,12649,153641,126022,37965,113017,4171,83,142592,2809,6362,50416,71323,116894,260776,16204,1524,5760,30351,12658,20703,54403,36083,45408,74772,4946,14485,50759,111222,10890,2195,167147,92962,130534,16283,177256,35016,15472,210156,151187,73922,117691,43250,52051,37392,24811,24358,30830,5775,818,21969,1476,127322,151783,58392,31021,106913,65215,89407,90802,28531,11690,20234,95249,44602,37256,18707,11928,5161,4410,26571,51903,49768,22008,25252,65780,209499,68769,203726,13249,137363,48845,86823,6658,5674,31881,1083,1823,108676,34518,166752,13791,14287,91576,91429,8665,11529,26401,16191,91972,30964,5254,28486,54697,79613,66520,18447,22870,45203,194466,22822,51703,12278,76716,44595,73455,33546,12235,144843,36154,51247,11116,33040,3180,225753,60864,1972,28469,12891,28879,10338,144157,56294,353058,38302,41447,87532,110616,27065,168438,6557,1213,50804,144643,24817,2390,136531,38174,247513,16190,4059,122791,131994,137430,39506,57650,16305,5188,54309,106128,20628,88071,67394,395446,250285,66176,91254,1399,114196,43915,60230,44853,27206,106353,43013,18733,345105,226453,51202,16607,57106,117175,35492,10476,89598,127439,15187,39624,13688,61570,10615,31111,59370,6238,175252,32143,224492,41388,95408,34384,148238,78307,38959,9340,160091,61443,15737,11216,41244,170,38299,102443,113097,26382,14027,33707,3957,76300,66160,19431,18900,6952,1717,108656,82206,188021,257335,27295,43999,41210,31777,46956,57457,12657,11489,15697,48060,204748,53583,82422,284790,30503,137341,8120,19615,220311,15991,10217,63424,9808,67431,70976,98221,4491,15177,28535,144789,751,13230,2394,1504,33977,132104,30316,22230,931,97193,185240,24826,22687,174322,15307,22988,1390,188745,180325,29580,59068,74903,18994,29195,79,15436,7622,38462,11566,138710,44828,45774,37768,99236,68137,84083,19282,22698,17134,74807,126662,173497,46248,16938,119735,3212,28292,213652,49013,9975,32180,45660,86250,4801,68788,95490,77482,113751,11994,44624,94452,46839,128497,100316,5798,58588,73184,202987,65417,37790,88524,1606,43156,97964,105717,34947,11203,100060,37742,130074,93653,107799,94311,196106,41347,8035,10780,16390,27883,118236,167395,1979,25006,19375,31628,18916,144723,78502,114047,103107,86492,107686,5844,20934,206963,23556,22591,16562,146333,20167,10471,117434,33085,2863,9740,36669,41849,37271,22790,18209,28979,8231,12952,54408,21731,25130,45208,55748,138120,75826,414,29593,9925,292865,25999,683,123149,7036,92159,86055,61827,103680,23176,54918,58466,57578,13305,5709,86479,16697,31064,17660,200919,10770,49793,33423,32370,52047,16488,62555,6459,8426,83493,7763,59725,82812,18628,67760,79405,68557,9612,7673,28102,56517,69620,171797,32458,29541,15870,81109,32080,207644,71495,21202,11039,91036,61230,2810,130800,32260,4613,60590,37112,75214,33979,126402,155062,30642,63875,12810,194463,82799,47664,16725,36685,43367,61099,449,172150,102867,21691,301838,36745,7130,18671,57316,34852,38034,54182,35578,65900,99486,19771,3456,2658,16914,99866,28390,28109,8262,21147,34353,20006,4228,137085,1675,203023,283196,198286,214375,163329,290603,152574,40471,83506,30068,14730,23177,131539,34759,27668,32178,71896,104799,116305,85430,119262,42860,25160,8911,23428,49437,105322,6519,16203,6349,74711,1230,38045,8540,75165,44736,25909,51026,317034,4984,32281,91312,27060,44431,17817,45363,155937,239085,35697,59784,91993,29531,126740,213757,76560,167776,285273,24262,8237,65030,41160,74437,48804,118916,13159,37842,1031,75349,1478,11655,108777,23435,277425,101734,67469,70231,124711,43532,28514,65526,54956,1e3,21882,17728,25302,40952,52214,149632,1999,2111,3259,63362,89961,220561,39777,26335,9063,10572,12416,34551,34623,38604,24723,5947,15588,69927,66252,119177,69173,46629,28714,70715,212408,20521,406913,74380,11716,50659,50862,37009,88460,130101,7210,53853,538,65120,151950,55806,163748,52837,13153,21100,16674,64536,6091,138201,44837,58547,3723,163,2177,32288,85454,34033,8497,14282,25742,10535,10741,79559,117493,243787,49337,100718,79495,40139,42956,7551,55433,15421,31509,23034,45081,547,61176,53434,328001,8470,36263,30145,4519,74173,53935,11845,73774,60211,78025,3,4102,73782,109293,315332,48412,26683,13714,6865,20128,18490,104141,325,39470,171970,115860,15707,7268,73301,74336,31370,2368,111827,107757,136231,142844,97138,96638,84053,38691,23801,1588,10573,122098,77039,240,186135,146101,11996,18143,112963,46171,155836,348769,47795,121213,116266,132515,3344,144804,31286,99187,255838,129694,35894,48779,55235,148582,71967,65282,15174,13920,47080,6147,108242,157593,125025,7136,1286,28957,127956,28402,98813,20805,7532,109417,40610,5041,32958,15142,18408,108596,33543,50517,27748,80114,233434,91447,487,37094,100048,30541,43477,10639,89862,155868,37667,8726,60684,237903,73408,99589,12190,38739,97348,3914,13594,2680,149016,13907,30171,28343,23530,115225,61104,35821,147679,14337,4297,244282,24085,326976,56428,7851,21303,131620,71446,83253,68692,111870,5224,15813,38197,49026,45057,13660,3306,76345,40671,27905,91072,996,68527,62085,91351,122634,55109,168209,2024,27560,112707,17352,8306,167115,169921,166958,5031,46020,11844,67284,19130,76185,6920,32849,5450,14610,22451,21002,17392,31872,66682,84796,13709,40210,59898,12029,8719,53564,21462,91884,21647,88379,194428,12754,37797,132826,160016,22567,54383,53186,77611,31107,8339,4694,19185,90355,23597,17222,140675,28442,23668,55977,9128,61555,28774,155229,17658,9390,24379,69357,15752,127381,239631,62460,93181,55913,45133,140155,18676,25249,33164,29581,82837,67223,22362,29975,7317,52813,1943,29613,20012,207130,49617,49651,5636,15334,36313,29226,28084,95247,72072,19e3,224932,15811,114,32127,38097,37508,88507,37225,27359,91626,12193,69279,20608,11055,88156,92808,2152,57259,55275,72789,24475,104414,1708,9882,3818,48661,66897,1631,34806,227930,85815,87753,18321,250664,72733,25107,206797,50891,8082,196411,92596,96764,152823,65514,22819,387277,62176,51225,40329,15563,189,3659,73670,64357,51793,275136,33482,86653,74615,67058,11318,125720,15388,22388,8267,1730,102663,170910,40784,7144,85373,13040,7088,94309,583,44224,140424,77439,18496,164026,36578,4722,9151,5824,63365,26510,35199,40500,79277,32495,44614,35233,9566,203293,152144,7097,2330,183480,98629,13423,330887,44130,68600,30939,97829,31012,345465,56747,94879,4939,160027,149761,99423,46099,32251,15332,8761,96094,128555,5763,235318,222223,55729,30241,55420,201746,3987,81382,8259,49325,23287,7719,24633,251100,92311,18591,110533,64759,170260,393860,7175,21144,132887,3593,75346,101277,91109,16387,259187,11627,57459,173829,44694,55780,49797,89192,120443,62622,3904,14814,23887,1027,112258,64955,99800,11132,66353,36202,48624,18158,88481,96882,43059,11040,2455,7077,21651,181159,99126,100434,61388,68186,19161,110468,120052,8819,55324,41494,7014,37689,3618,87729,92615,207943,9823,128657,12587,15857,6379,67628,51216,71775,157617,63244,1503,3864,218754,110864,5769,21492,7243,1192,87921,85529,31512,18537,42698,35350,73510,84474,34301,8991,21013,35034,566,38832,19838,35586,37216,39413,55006,12178,59742,856,84563,6900,25632,17437,49786,30723,13847,70845,4044,7843,23944,235976,55530,48942,6518,20939,73769,192653,52936,95207,23895,132542,142982,22632,87452,48042,54018,178468,10728,26230,23559,363,81269,142012,5718,346258,31456,84333,246476,51018,66692,101804,120570,39962,30373,70593,2864,60541,19425,54209,104092,7201,31545,48018,25865,15442,46257,40443,8328,6451,111782,47527,97754,33046,470,245116,31095,39,91934,87208,73470,36708,36521,12801,70624,36272,8892,79768,12427,55454,103756,5908,52390,62962,22720,141138,94634,41689,128402,126390,6628,106394,35527,134394,82727,254651,194502,148064,89549,3202,28359,957,21954,27906,49840,142747,8307,24206,48978,1186,71728,133038,71474,91306,6333,110959,74600,70387,18983,62609,56057,22970,1147,135850,1321,28834,3578,59715,102227,32827,81415,99952,55636,257598,390,22702,35701,85872,402916,39216,189795,14929,19467,10112,144422,61514,5279,63421,134686,41436,8424,51925,10598,132295,124416,4604,194739,210929,57866,31829,51626,50007,9976,91878,61906,56168,81906,60918,61859,40017,23059,16887,40927,62064,12785,32893,32913,21782,93965,20169,44387,79084,38463,11457,93950,27127,157050,2697,337088,5116,54128,48255,33279,8821,27352,25515,124022,65710,28906,38557,33390,1722,104435,72215,38551,12094,30978,25113,6671,37355,175109,42862,98024,65406,221276,59624,118012,64637,78760,86697,21426,1639,40350,12584,67193,84144,31396,7863,143011,69629,63112,9454,28666,65798,46372,134721,6314,51402,30837,151922,2847,38676,38008,92823,136245,17540,5504,109295,205242,37606,5211,214892,1586,20670,208711,137743,19328,40652,16995,20023,14657,154919,34422,12996,13918,38221,47690,16398,2959,37680,89122,6721,198469,91876,172043,83898,101992,26084,94570,3635,76958,22853,76497,38266,176590,168403,44464,142840,79180,184594,1984,41806,83147,11985,6546,366068,59732,24533,271505,8736,39084,222992,93429,28962,58985,86665,8432,30028,14548,32439,54424,165029,55175,27458,69046,121277,46168,33732,20661,24581,135574,123110,37556,79260,72611,16957,12939,46162,58238,44907,72936,253758,41324,32518,96480,11949,124438,65280,43256,34107,53533,43531,37037,28366,45970,32741,173438,6121,194202,62969,26355,30314,58370,28455,1848,50519,82830,90393,21761,295490,10936,256940,133568,44050,20269,4089,27457,21610,219460,36743,14821,101388,52005,13124,30979,140816,167362,26054,18458,60789,34917,40447,26606,33422,9066,3452,83614,5761,20263,137238,25038,91310,101,52322,74548,42572,38084,214054,186568,31802,17665,30620,141936,37730,14420,4265,187218,49640,188208,51441,55388,96452,66659,40869,42039,60967,221027,19234,178581,29105,96050,9165,196118,157335,3738,40354,117436,2965,34136,59659,15570,50843,230035,31444,71260,43886,18316,5387,38500,168508,17406,32174,8828,103373,143806,90367,3560,18719,122310,16508,26719,2541,105429,6645,37998,73190,10591,235916,49737,87112,233941,53188,32193,79154,4544,52905,126477,7580,63501,57314,3216,31337,6541,103083,60846,49,9756,15481,1355,43840,14319,13743,27486,10222,73114,230718,418644,16706,6674,279748,23058,45273,295831,86306,2743,5535,88773,21829,35253,120938,31153,3169,16839,42847,8751,80974,33942,36867,35514,16485,26474,77775,56877,5391,48346,3882,108713,31403,27804,55248,26235,43821,136104,40118,175507,28034,203908,18732,1788,34030,106427,36958,54359,7251,44936,15356,69139,455,157915,22173,140291,50348,43275,82066,49621,54952,15216,36226,96695,66855,6936,1987,8227,196087,4631,68827,99004,47541,110265,17953,147605,110242,58520,31312,38724,329975,642,3155,34497,75937,6207,73843,6120,17249,51429,117746,3218,910,68961,319671,14938,29555,34700,1649,66673,72268,9655,76800,153087,6941,210168,27130,35398,1780,73242,3135,56689,19556,165307,8765,35967,121458,13333,70453,17350,117253,22265,13340,44265,39869,441,3742,135025,23581,33309,16543,17731,13291,157637,283005,21408,101360,63887,52312,83873,5338,233779,23759,186949,34531,177320,38069,156465,91004,19353,59852,68160,14891,1338,1072,29823,1950,28901,81407,313445,73038,84807,162348,240257,37162,138934,16111,58013,41253,102951,16457,96056,19541,56402,67217,41638,94381,89674,29481,37456,80815,151579,13937,13683,132537,19699,134545,67020,29816,222341,141235,427578,48868,129557,233342,23077,87871,16213,18728,16184,9469,37913,19680,2798,171356,178328,13216,50049,72690,71904,124644,55455,7504,29052,41036,266546,19899,30391,188755,8659,59469,16,104298,112943,53865,76203,138226,68857,139953,14125,107625,119795,173133,4398,50273,48808,54390,16466,122086,31835,67035,50971,48859,7508,46427,66477,73021,84615,39985,83076,46779,201569,53336,36443,60865,168164,143810,51393,25548,169307,32896,24485,38424,21837,29087,275813,51674,6714,64883,46169,187369,55186,76192,12852,12018,62134,31067,118303,16542,12125,10579,4928,26291,43854,7091,10946,253716,109062,39283,17261,113012,258512,47764,125126,32646,55892,80279,201623,149872,3192,385,1208,48750,5376,58738,22335,5427,82416,47811,32435,143086,38930,94128,59975,156037,37977,38224,62485,7698,50405,71027,16462,21559,136153,34131,107506,162069,63703,3101,215029,40407,4178,3774,9187,80019,17880,97926,67579,2600,18405,8351,47924,86638,70820,92206,86453,29610,42241,119200,3198,15466,67813,57863,35454,4779,99518,4649,104641,144269,33730,38073,65864,6838,109456,193298,154007,5623,45741,30846,182578,25573,157224,1543,58575,138703,146140,44971,49356,18275,59064,20300,13122,11848,24453,11973,9797,86843,2919,25530,49210,1130,161220,76788,75373,85604,34926,36014,17777,17255,51533,11676,92226,51845,119859,21525,5936,18507,28050,1140,31418,14857,34207,47859,10750,36382,32079,106909,59426,87757,38393,110042,15965,97104,33757,35344,97993,53979,33651,45407,41884,82515,173089,7177,58371,35365,47543,51927,35587,10670,23544,29306,84233,39976,76076,62097,9007,8668,28119,78281,120790,19835,143020,54968,18670,64959,20649,34469,42570,33001,136570,87796,120044,1106,58700,63951,127623,12805,83057,40212,31773,49850,7361,54336,347524,101314,23751,19569,48791,29174,49369,20467,7465,75842,38281,623,112457,60210,28849,51003,94720,6426,90047,85560,43761,3579,85105,34607,90410,118528,7224,42907,111163,18168,6960,161135,191298,5247,100584,127552,171568,20121,91173,12636,54615,20199,63730,98105,2396,40387,14438,125012,4765,33235,12865,45299,37728,82098,77872,114037,59253,19675,24838,398016,102561,11446,17069,57508,178277,65836,99941,26114,2585,271882,136866,50126,11027,155648,118367,14585,8910,123015,335383,40434,41016,53021,14439,87098,176860,201543,121888,2358,9286,5739,22666,54270,37884,169381,33984,93859,16124,89364,72207,51639,76366,99029,65812,2198,12147,174891,194289,6986,30252,88822,21284,11445,288337,160821,33034,100869,43852,25761,52882,1144,103809,1924,84458,86079,43411,13542,139276,18141,34978,41298,7276,26481,173800,33210,17951,142652,33616,33677,2210,19941,98568,2486,192414,80136,12058,235883,50963,249638,29572,27221,47034,6124,72107,63346,97620,158513,299699,40388,23235,37176,224244,198386,121323,67992,23827,63170,17838,106622,158590,26807,5345,23489,91891,55474,74834,37981,13058,5977,72552,34706,26828,145172,19904,21367,34043,960,77092,91381,4733,47446,7680,41697,5170,16960,14741,46101,13656,473,51842,37433,11103,11551,121951,13191,97536,165932,50397,51628,129028,9069,44885,6590,59195,47045,32940,225472,90345,21833,13303,29407,96615,141951,5198,6028,18395,7181,3861,14966,156358,167182,36529,55253,25942,173153,30959,27261,50691,150176,162201,38467,48462,80602,42163,118482,168,108756,26011,17166,54149,456538,22512,91374,13816,90358,131615,18132,226707,1824,28139,26860,42253,93877,77351,65575,8980,80574,22020,27948,40422,91324,76376,13528,39281,91685,82215,122541,144066,1983,193851,17283,26320,2739,194978,4790,26845,42627,61300,65815,174612,55133,4200,191130,79771,158321,52280,166796,221620,62461,11278,4067,88152,83409,31717,121367,13522,47325,37945,10406,174348,249321,154101,64912,29938,51775,17220,15776,166138,78890,84425,54121,42861,16368,24572,291647,10197,32073,22651,11677,97509,26952,35787,18424,41910,71614,94977,72318,41594,70024,275419,37702,60199,7335,39107,61315,18271,18394,33768,87884,104277,123724,7277,56288,71981,189803,49320,3352,6798,14240,8954,69220,94433,57372,28620,68863,193727,85575,42309,41667,67689,42081,22543,44824,12719,28540,114236,101553,27638,27296,4300,5353,4663,19379,94098,3758,95888,95144,80344,87320,28447,259518,12718,71391,152731,37063,24132,31911,104896,15672,103782,1521,4945,72541,23717,122632,15619,87175,206120,29428,189780,61416,28350,44457,972,1175,47233,198738,95789,41907,21953,97034,59341,22864,53713,16873,32971,20693,20954,31336,21477,16169,38370,16412,9019,3841,24599,21938,17085,6484,81198,76413,5849,72514,12320,65247,276175,37234,59796,52642,16312,57349,198507,94148,46134,18958,125552,1747,18725,151873,14901,5490,68287,29470,3689,64794,40814,26018,25692,54450,2703,88278,124886,173087,174e3,24159,179477,24276,46004,201876,209202,445,52876,31948,30206,157610,39180,18439,44124,50469,5774,96278,222758,200216,50290,45486,20435,46986,46276,140133,142326,15569,13363,47522,92583,2182,7135,16853,22998,30272,4952,63263,35623,39096,53789,44864,20053,110392,124213,4630,16087,28221,127787,25839,77481,44693,13464,113146,6983,27069,55717,50102,4760,7107,26186,66507,59145,36032,104182,71328,29425,64317,50781,47465,94298,69706,74899,22754,120756,25108,93077,56834,73286,39928,16218,41699,176763,7555,70819,50083,26895,23315,26014,16773,123079,41712,5719,31516,90427,158540,85051,183128,40864,27505,55392,9058,45224,96857,30901,136622,96557,56304,120061,11501,151448,5773,89743,7769,86069,2935,18471,41628,10114,33660,110170,49479,26745,92846,33221,26731,18795,87076,8550,2100,29972,120289,3077,72490,33784,2630,208722,50861,63483,79029,6419,39467,14302,45286,64207,9686,67513,44170,1050,77246,59266,17055,53801,7150,11111,42432,4278,94579,362117,36175,42902,41933,39002,98489,22913,74161,84773,57036,17556,162288,74485,178760,93867,73635,128860,50362,261,67455,80001,46080,35662,4368,25247,19230,74393,22588,1822,27682,235324,13798,85998,13194,235067,23514,71669,147632,23191,134748,214683,105101,1518,25489,247114,7380,54842,26922,3971,26361,20844,68642,170517,77339,123255,8963,77818,150998,48466,36806,2732,23261,11741,236162,18243,126216,28690,50546,16385,92760,197383,246558,201295,88255,67588,71687,176076,172653,169058,33906,63747,24835,157621,43338,30050,46152,132741,2770,51371,94835,6614,15112,11749,56936,1250,19027,399017,58036,100215,23388,55815,308768,124152,94803,9521,64186,8971,28,30427,62163,7616,103838,35079,29203,131235,7743,17389,10882,37420,61460,228512,85363,41581,131077,62822,119647,10130,54445,26925,19968,29016,24446,74028,24176,61448,67185,9254,8563,119129,9771,99184,37716,39514,10532,221512,258753,218630,55980,23394,32141,61924,66749,32411,3741,36475,26678,77010,44946,91203,128749,116953,20476,49625,53116,13735,102335,29376,51946,83407,67892,59212,34685,21083,1546,112982,32972,74397,1078,190545,16082,86140,58591,89611,101531,10061,105104,76319,20035,17551,52611,169061,190842,100780,23907,90413,115619,9675,34710,193435,49443,129734,11183,258877,16318,136182,126808,44635,27304,192375,2599,125648,47051,12091,23814,721,58800,40137,66726,97930,60877,74487,7942,54326,9841,41428,13762,8211,85383,6950,99177,79806,201786,296464,124087,13144,29741,41721,47634,55088,254286,106408,17041,99064,12942,64086,45233,14005,2612,55827,255,7984,13980,38574,12776,46654,73499,249951,2101,26676,25996,132326,116415,119062,50449,31033,23038,11589,179252,20007,14860,129270,21143,17796,144715,60106,70758,69842,34674,282133,44014,16774,57268,38528,24053,46373,201667,28327,471023,51889,102667,21193,114909,84132,69317,96723,67969,16134,68145,15058,28765,32035,2524,101089,98664,25045,76571,14957,86040,118506,262428,154764,81573,39681,283900,73287,127825,544,80448,52347,38512,175971,15180,45467,33086,46552,48894,81107,43213,36672,54025,76703,8053,7608,13299,56619,20752,238099,54164,105133,1444,32942,953,37564,8e3,66316,119463,106817,404,13667,149108,128597,31267,10269,49836,106150,1484,52330,76965,160486,171648,38456,31263,22424,37738,66245,67467,143369,60471,75610,20895,115528,86070,60854,40796,49347,18989,15030,11371,37578,15779,79867,10187,86462,46402,155626,93200,40229,7090,57547,108053,99598,11088,47505,41218,206017,2173,20988,30219,22919,80563,57566,42369,93141,41675,2407,182519,120495,27154,16702,29456,14349,7958,16688,117177,140375,42467,261919,74916,153569,10836,34742,49526,7621,105997,12212,2270,392377,7755,17959,25086,232152,138791,33847,13860,35316,5811,1344,71259,50452,207539,92635,50359,5821,33674,30255,2086,2587,96264,17543,42,6029,9580,43007,139248,82831,12917,29607,25786,51467,42137,85161,100698,31561,88989,121990,278500,3602,109344,37982,15279,116442,28936,30880,87894,58079,128661,126731,67392,28051,146885,4861,16216,97344,42827,147561,153948,22684,21335,47685,1853,43349,15185,59642,10229,25520,187921,108972,5579,98037,24945,6697,19193,63734,137934,75056,89740,19767,224268,56138,63643,151661,39313,70618,84031,89723,84074,13703,85626,35460,8867,64845,3439,57906,99776,63968,49270,81130,34356,16210,23547,36446,34090,140028,72439,2221,22163,57058,363492,113754,18913,95451,48663,54464,54037,176097,68425,3023,34906,29482,117389,341780,80431,58330,16753,92616,60907,94846,147486,4498,48646,7773,46801,7778,18946,464978,47558,33223,177444,7328,15626,63337,94700,11743,9351,255024,39098,16447,42647,96230,39769,58840,10068,63439,35800,65843,58823,413844,9156,51258,7434,61791,85018,6872,3692,28096,7121,33024,6009,75532,31997,192535,9661,3304,9547,14753,31987,25314,55689,15896,20430,39472,31340,99744,25398,115569,54883,28719,205423,23071,57855,64638,149867,25671,82403,37616,20668,39989,77996,74948,140555,175248,64810,36515,46595,4958,248773,24045,28728,136673,168704,20804,114833,100325,27135,21205,96151,153134,45992,7093,13992,76047,1980,19432,145001,75159,87462,17710,1013,45556,34297,144882,20648,26061,11319,129567,108555,18872,464580,33386,22717,65948,167189,5603,135042,79542,8801,202632,18114,91882,5973,5239,67315,4431,60916,47819,71693,32597,32606,18183,45072,80329,76385,24749,51305,40314,156514,14693,130345,13168,66214,18029,12858,34801,27628,14544,10823,40522,40185,33739,148694,23548,9923,61012,28859,17933,19442,34364,99849,164107,141167,30629,21054,6744,36491,8096,42474,41706,155060,30650,10600,163442,1143,96655,61390,52359,7559,51568,64256,203854,4467,22453,14504,436398,7878,6980,8293,63610,293747,16167,35763,19627,147603,15419,18032,110744,51346,33681,54571,40472,48615,39073,21604,13754,173027,92560,11083,47299,63062,11813,52007,29883,9734,139722,15953,1550,20651,13616,49306,16113,90089,92326,7584,30712,72424,164858,6831,152871,55746,197721,34167,196442,6022,112107,55215,7538,123381,4920,43539,77165,8939,50392,34192,20225,79762,22505,58667,40770,29788,97180,82835,4568,8579,13273,363569,35898,49983,436,36598,3237,131691,62418,35591,8101,4073,379438,65218,76072,33887,2968,27573,212619,288680,68278,72851,150504,217896,6913,121339,22017,35340,51072,43616,75043,31437,10833,81487,4364,22968,41454,106687,85446,19863,109625,149241,524,141850,214404,54376,657,237023,9401,108137,53800,32474,49712,53334,126876,27337,45552,177696,8269,15036,12097,42240,2328,125374,119295,99715,2500,19624,39441,27220,102691,60957,94543,39101,18566,67362,13975,78230,25017,34017,239007,90027,39351,41681,35354,43822,1043,916,58587,141983,94818,38799,75459,41114,67432,16195,36606,59568,22272,126769,31424,68659,12287,134302,257977,5756,207285,95637,47248,117689,19583,77451,22373,12200,54993,117118,34244,29386,34562,53819,71267,64172,77665,49368,7716,59301,25749,45426,194789,17297,2650,1766,32501,45198,20403,20984,6600,14171,94604,19037,5402,29896,9938,59935,109708,88081,145182,44844,39167,352626,164173,35374,45982,6122,154,73419,220487,53834,53601,17992,8609,229321,5610,68098,66815,71012,95069,140968,27396,8957,134489,24656,86659,56598,134852,17316,123838,255436,6613,41610,138033,81452,32023,32396,123687,63398,8693,29712,30407,19296,121188,3551,36099,20032,111948,56624,16547,27453,35916,15378,52039,56849,13489,22214,73177,53097,277349,2157,14029,187886,10260,141743,246460,91880,50869,3788,49486,133566,54950,33120,129337,53768,18333,9525,26902,312251,10297,9020,70759,16647,112432,59260,84609,9818,82766,73569,468,46001,75780,55028,52106,11498,43645,108069,17150,17753,29417,16705,31799,9606,289,122254,115975,8620,6133,255357,56908,14456,133464,43554,79224,11247,29630,160,12756,25464,65960,350428,62521,321796,100359,67358,35169,46172,113128,48988,88868,31094,33266,6847,60887,98188,49659,69117,92977,220228,13947,80181,35103,62170,97351,13475,2440,199768,19498,36597,46971,25234,67806,62881,84717,73648,181966,10488,94149,21550,26655,63436,48375,14405,165650,9621,24439,28043,42735,4490,29963,56674,45373,1934,262446,50855,67098,26898,5261,52696,40644,33900,9440,180286,87162,22940,19704,26936,69769,10254,101759,27406,12243,48e3,73926,113215,54935,5726,192787,4312,106216,9366,11550,52949,23457,212271,277152,133895,108374,6191,96477,29980,218916,58024,54696,40853,91124,65894,91170,65908,252552,6793,29212,15389,44516,122515,52617,35058,9017,103536,39510,49136,19242,130652,662077,74699,47024,31422,8517,73351,24399,13867,128360,4810,4434,61779,111983,61036,17798,110240,59722,102960,39688,10001,23803,23039,176498,56659,44814,134295,17188,77577,74466,226175,102472,154333,63900,111747,18062,41171,79669,32773,408933,42562,28931,30907,107388,43487,2946,240310,23938,24354,319,184983,7927,6488,1422,10790,68809,68209,64775,4361,202,17123,59634,51200,44391,18188,17843,2619,74278,3230,9540,47187,21702,36274,56894,43907,16310,34790,16866,6150,5561,13587,107545,108873,126867,86986,28640,33427,19017,5762,80637,17430,46903,2047,131055,25958,13558,5444,47152,13900,44563,122857,45348,70863,39593,54332,38068,33637,318,40310,143467,18502,24520,11377,62013,28942,27246,28269,83545,17999,59015,90707,30065,15161,34720,1263,37008,2012,6060,98575,92933,5721,299,199555,24578,29223,2985,743,115825,109523,136657,47454,26378,53586,3733,174945,93340,244456,5693,37386,28782,89767,27545,23573,18798,136425,34320,84778,20041,48453,38215,7477,71958,40621,8773,5874,187927,105965,51100,43533,18083,8443,10180,43597,2003,183999,69689,12216,129696,146188,62389,34044,68410,12765,43273,26949,266807,3345,34477,79197,5688,47539,213110,21634,22257,50092,32222,42346,39530,63668,98,134978,74022,5152,59088,174145,37220,9934,9545,118937,5724,87240,19875,15784,40143,23263,87513,181654,285152,37881,263241,4966,43934,10433,186657,6470,74416,225854,25908,142677,246262,32280,6192,75890,45546,143264,135305,29742,47013,77787,11732,126658,8763,37950,21806,57557,113464,89465,108995,164574,23894,22996,23169,15369,23117,17642,130607,40503,36239,280990,44666,9981,40427,147487,26869,168452,32886,32991,46798,240839,15111,70502,65697,88548,44145,28701,48767,31139,206777,35659,181164,166262,14554,171445,31786,66523,76607,17956,6507,31279,90476,116611,167918,6560,1243,115324,80128,41867,55897,187323,37069,32596,189444,145931,13390,105530,65709,26805,6999,55714,41300,22915,68951,22138,21120,22264,10058,19945,33635,56123,99085,10032,5818,6016,46649,57476,35264,94413,112522,262288,93686,83038,14341,23204,28807,66084,77987,6101,126673,7133,38126,5923,122091,170240,97772,46874,215746,43948,41622,3272,55596,8332,146411,251315,13533,8561,81521,115449,48616,175175,2063,186556,3036,134537,75772,29728,82360,22973,186559,86348,89100,38388,82297,45610,2613,87082,9986,177812,57884,23591,47485,42543,33582,44713,74439,257444,252451,31825,35631,38540,33066,5147,13973,4343,51830,70378,22827,26448,95560,36896,241741,48067,203953,298860,61620,20450,3220,67272,6586,107662,100160,108684,6929,57226,4762,7457,1320,40404,77204,99309,62750,208653,59977,44e3,74315,34332,5819,172217,64904,114077,18147,84012,1791,98456,90930,21446,116669,103938,7422,85140,59713,5768,326211,16239,75411,13229,29398,10758,236107,1539,112472,95979,152154,151294,306,21196,38146,10700,6891,84282,109646,56492,40539,6589,119491,51354,30685,140209,136906,29622,73617,49553,70525,51671,166869,139616,74395,37439,49595,45678,11959,33211,86560,52434,9282,62690,112155,130810,5243,108261,99970,265613,72551,80049,6391,33365,90721,66737,69872,87011,1860,9032,112544,60905,37371,89015,140351,19076,850,373531,2802,36725,218795,72062,28990,16550,24614,7815,6187,26336,33373,32162,42791,73555,32062,23386,10244,56392,49442,27076,136262,12412,14883,1134,33675,97153,199281,15608,100152,74072,47942,254301,36451,16026,10687,65067,56708,254030,30290,50490,13864,57941,259331,35588,23485,43486,24869,21620,92971,22072,88645,1048,182050,13343,32452,14825,19509,3325,216938,45740,99716,189082,53740,78245,25609,24311,176777,47340,308354,40669,66085,14102,125339,9225,128709,97207,1271,200933,78439,113451,88975,18324,46521,11819,18570,141756,72512,170020,52754,63550,118515,103073,93330,32736,50499,14722,31600,68452,398867,29316,172786,18417,104924,2606,5670,84818,16288,67106,59580,82929,607401,291,85829,359,15897,35830,50696,65630,52672,22115,356968,29895,40837,231192,34024,38957,26722,406,23335,124952,72068,68804,13268,147101,164740,276569,162596,66943,11569,26654,66358,4777,23229,102127,5848,978,2921,59666,5371,28212,90108,42938,39320,2499,4271,108792,33510,125072,71653,65239,38250,66357,38577,13964,86251,35708,50755,36010,29448,12209,3844,38222,206337,100876,67827,137088,14167,252225,84163,195270,1306,5703,54198,779,46802,22028,51124,86759,70560,113164,35685,162145,45471,34561,422,2611,6464,47486,19223,38246,9191,18331,89942,243642,212364,15893,17518,22617,6409,30046,126182,59716,36560,104428,18846,26592,19458,50793,147333,30826,1388,27647,10922,14495,33545,19269,135828,39727,41601,46931,233379,49169,131130,182112,16276,82381,118209,142445,128310,19672,28740,82907,33436,3118,102206,28723,24819,41937,38854,5157,3881,111491,1142,9776,421673,152241,29309,14961,87854,6054,15424,3796,82656,54996,2108,55367,239450,154525,9643,118103,106041,64601,68549,48707,30266,25772,18740,9462,229669,91798,112152,191327,14493,72828,8175,66636,236474,25817,87351,129027,76653,20422,22983,71240,27846,44661,12399,46158,77704,53101,35032,11072,17300,109294,33638,24408,1895,11241,760,17584,82479,125877,63150,141075,34259,23274,81698,15732,43577,48340,91584,14688,16379,24481,150280,96420,262050,48635,43727,61819,56268,72003,88178,17281,79912,13218,122519,125295,166396,11811,2171,118930,67746,17636,178278,174656,95661,173039,83845,79689,17473,98555,127696,203415,54730,22925,232239,9309,12136,175026,20740,180188,10747,39816,314017,266131,10040,175732,112550,220651,31974,37393,888,23008,86799,4303,64905,148467,75337,251,3284,370102,50264,9835,5438,23655,4481,29851,329,12855,7162,64931,78141,12804,42372,296771,83547,18624,34874,86271,3360,48665,77735,88767,11463,63527,28889,22258,29140,194315,113924,25499,6406,31334,1845,4802,49184,43455,35469,127594,92970,61038,115005,38840,87761,106838,8811,20572,55637,11162,96721,132425,108925,2948,125457,36356,3502,75270,27622,127192,2561,123095,49394,61155,16897,110064,9699,89448,53356,19628,220310,21622,83036,9885,112214,6087,26713,17901,161912,91492,3440,68594,9266,92238,8087,6866,150194,72175,80701,13459,31836,43243,239700,95846,44749,50647,21945,230538,120612,132371,244604,5193,105637,34661,41341,68775,85393,1874,8771,33718,49672,77403,595452,99507,6490,58895,128742,7704,39239,73217,43816,62824,37804,199976,22361,80005,87514,94832,14089,4574,139975,59142,75523,100268,43906,53442,15152,2547,186002,17011,19513,204282,3343,60568,128318,119250,4298,51871,41336,71759,21921,45074,98169,145889,99427,11350,1237,5520,28799,7803,53702,21026,136352,38293,128690,12158,90132,44600,10184,26957,39459,126025,78904,82999,59373,39301,150198,120529,153042,20177,50089,14764,271571,30530,123161,38975,101562,22941,5648,124654,109243,69817,71675,49162,106884,21241,107795,30258,16572,188262,141456,7688,60718,8271,11044,32440,104608,103419,236109,93156,43293,128929,42107,67180,25201,115254,185488,130954,72813,167547,20537,39969,38432,22582,184022,1139,27199,5655,17767,97412,122606,209377,27070,35871,326617,188954,42680,73512,80911,22629,3011,95021,315242,157737,383,41821,41808,19335,27950,15674,25677,110950,35375,76835,59108,57370,35262,16569,160415,37706,78086,32041,49691,137143,9782,172080,50148,77917,6323,10110,69172,17711,21795,59511,76184,135114,31046,132319,59105,157578,20549,80778,57649,158421,65143,4575,72235,21899,10797,92745,34035,106079,80159,4508,78304,25350,75457,46458,32937,25623,47,8531,104751,84953,8138,36508,187199,66310,115274,13253,32461,38536,1916,42007,187160,35055,26325,84394,35963,94216,45590,97782];class bB{constructor(e,t){Dr(this,"log",void 0),Dr(this,"peerRouting",void 0),Dr(this,"routingTable",void 0),Dr(this,"refreshInterval",void 0),Dr(this,"refreshQueryTimeout",void 0),Dr(this,"commonPrefixLengthRefreshedAt",void 0),Dr(this,"refreshTimeoutId",void 0);const{peerRouting:n,routingTable:r,refreshInterval:i,refreshQueryTimeout:o,logPrefix:s}=t;this.log=e.logger.forComponent("".concat(s,":routing-table:refresh")),this.peerRouting=n,this.routingTable=r,this.refreshInterval=null!==i&&void 0!==i?i:3e5,this.refreshQueryTimeout=null!==o&&void 0!==o?o:3e4,this.commonPrefixLengthRefreshedAt=[],this.refreshTable=this.refreshTable.bind(this)}async afterStart(){this.log("refreshing routing table every ".concat(this.refreshInterval,"ms")),this.refreshTable(!0)}async stop(){null!=this.refreshTimeoutId&&clearTimeout(this.refreshTimeoutId)}refreshTable(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.log("refreshing routing table");const t=this._maxCommonPrefix(),n=this._getTrackedCommonPrefixLengthsForRefresh(t);this.log("max common prefix length ".concat(t)),this.log("tracked CPLs [ ".concat(n.map((e=>e.toISOString())).join(", ")," ]")),Promise.all(n.map((async(r,i)=>{try{if(await this._refreshCommonPrefixLength(i,r,e),0===this._numPeersForCpl(t)){const t=Math.min(2*(i+1),n.length-1);for(let n=i+1;n<t+1;n++)try{await this._refreshCommonPrefixLength(n,r,e)}catch(o){this.log.error(o)}}}catch(o){this.log.error(o)}}))).catch((e=>{this.log.error(e)})).then((()=>{this.refreshTimeoutId=setTimeout(this.refreshTable,this.refreshInterval),null!=this.refreshTimeoutId.unref&&this.refreshTimeoutId.unref()})).catch((e=>{this.log.error(e)}))}async _refreshCommonPrefixLength(e,t,n){if(!n&&t.getTime()>Date.now()-this.refreshInterval)return void this.log("not running refresh for cpl %s as time since last refresh not above interval",e);const r=await this._generateRandomPeerId(e);this.log("starting refreshing cpl %s with key %p (routing table size was %s)",e,r,this.routingTable.size);const i=await dB(this.peerRouting.getClosestPeers(r.toBytes(),{signal:AbortSignal.timeout(this.refreshQueryTimeout)}));this.log("found ".concat(i," peers that were close to imaginary peer %p"),r),this.log("finished refreshing cpl %s with key %p (routing table size is now %s)",e,r,this.routingTable.size)}_getTrackedCommonPrefixLengthsForRefresh(e){e>15&&(e=15);const t=[];for(let r=0;r<=e;r++){var n;t[r]=null!==(n=this.commonPrefixLengthRefreshedAt[r])&&void 0!==n?n:new Date}return t}async _generateRandomPeerId(e){if(null==this.routingTable.kb)throw new Error("Routing table not started");const t=Np(2),n=(t[1]<<8)+t[0];return np(await this._makePeerId(this.routingTable.kb.localNodeId,n,e))}async _makePeerId(e,t,n){if(n>15)throw new Error("Cannot generate peer ID for common prefix length greater than ".concat(15));const r=new DataView(e.buffer,e.byteOffset,e.byteLength).getUint16(0,!1),i=65535<<16-(n+1),o=wB[(r^32768>>n)&i|t&~i],s=new ArrayBuffer(34),a=new DataView(s,0,s.byteLength);return a.setUint8(0,Ps.code),a.setUint8(1,32),a.setUint32(2,o,!1),new Uint8Array(a.buffer,a.byteOffset,a.byteLength)}_maxCommonPrefix(){let e=0;for(const t of this._prefixLengths())t>e&&(e=t);return e}_numPeersForCpl(e){let t=0;for(const n of this._prefixLengths())n===e&&t++;return t}*_prefixLengths(){if(null!=this.routingTable.kb)for(const{id:e}of this.routingTable.kb.toIterable()){const t=tB(this.routingTable.kb.localNodeId,e);let n=0;for(const e of t){if(0!==e)break;n++}yield n}}}class EB{constructor(e,t){Dr(this,"providers",void 0),Dr(this,"log",void 0),this.log=e.logger.forComponent("".concat(t.logPrefix,":rpc:handlers:add-provider")),this.providers=t.providers}async handle(e,t){if(this.log("start"),null==t.key||0===t.key.length)throw new tf("Missing key","ERR_MISSING_KEY");let n;try{n=qi.decode(t.key)}catch(r){throw new tf("Invalid CID","ERR_INVALID_CID")}null!=t.providers&&0!==t.providers.length||this.log.error("no providers found in message"),await Promise.all(t.providers.map((async t=>{e.equals(t.id)?t.multiaddrs.length<1?this.log("no valid addresses for provider %p. Ignore",e):(this.log("received provider %p for %s (addrs %s)",e,n,t.multiaddrs.map((e=>Dg(e).toString()))),await this.providers.addProvider(n,np(t.id))):this.log("invalid provider peer %p from %p",t.id,e)})))}}class kB{constructor(e,t){Dr(this,"peerRouting",void 0),Dr(this,"peerInfoMapper",void 0),Dr(this,"peerId",void 0),Dr(this,"addressManager",void 0),Dr(this,"log",void 0);const{peerRouting:n,logPrefix:r}=t;this.log=e.logger.forComponent("".concat(r,":rpc:handlers:find-node")),this.peerId=e.peerId,this.addressManager=e.addressManager,this.peerRouting=n,this.peerInfoMapper=t.peerInfoMapper}async handle(e,t){if(this.log("incoming request from %p for peers closer to %b",e,t.key),null==t.key)throw new tf("Invalid FIND_NODE message received - key was missing","ERR_INVALID_MESSAGE");const n=await this.peerRouting.getCloserPeersOffline(t.key,e);zr(this.peerId.toBytes(),t.key)&&n.push({id:this.peerId,multiaddrs:this.addressManager.getAddresses().map((e=>e.decapsulateCode(ag("p2p").code)))});const r={type:xN.FIND_NODE,clusterLevel:t.clusterLevel,closer:n.map(this.peerInfoMapper).filter((e=>{let{multiaddrs:t}=e;return t.length})).map((e=>({id:e.id.toBytes(),multiaddrs:e.multiaddrs.map((e=>e.bytes))}))),providers:[]};return 0===r.closer.length&&this.log("could not find any peers closer to %b than %p",t.key,e),r}}class AB{constructor(e,t){Dr(this,"peerRouting",void 0),Dr(this,"providers",void 0),Dr(this,"peerStore",void 0),Dr(this,"peerInfoMapper",void 0),Dr(this,"log",void 0);const{peerRouting:n,providers:r,logPrefix:i}=t;this.log=e.logger.forComponent("".concat(i,":rpc:handlers:get-providers")),this.peerStore=e.peerStore,this.peerRouting=n,this.providers=r,this.peerInfoMapper=t.peerInfoMapper}async handle(e,t){if(null==t.key)throw new tf("Invalid GET_PROVIDERS message received - key was missing","ERR_INVALID_MESSAGE");let n;try{n=qi.decode(t.key)}catch(c){throw new tf("Invalid CID","ERR_INVALID_CID")}this.log("%p asking for providers for %s",e,n);const[r,i]=await Promise.all([this.providers.getProviders(n),this.peerRouting.getCloserPeersOffline(t.key,e)]),o=await this._getPeers(r),s=await this._getPeers(i.map((e=>{let{id:t}=e;return t}))),a={type:xN.GET_PROVIDERS,key:t.key,clusterLevel:t.clusterLevel,closer:s.map(this.peerInfoMapper).filter((e=>{let{multiaddrs:t}=e;return t.length})).map((e=>({id:e.id.toBytes(),multiaddrs:e.multiaddrs.map((e=>e.bytes))}))),providers:o.map(this.peerInfoMapper).filter((e=>{let{multiaddrs:t}=e;return t.length})).map((e=>({id:e.id.toBytes(),multiaddrs:e.multiaddrs.map((e=>e.bytes))})))};return this.log("got %s providers %s closerPeers",a.providers.length,a.closer.length),a}async _getAddresses(e){return[]}async _getPeers(e){const t=[];for(const r of e)try{const e=await this.peerStore.get(r),n=this.peerInfoMapper({id:r,multiaddrs:e.addresses.map((e=>{let{multiaddr:t}=e;return t}))});n.multiaddrs.length>0&&t.push(n)}catch(n){if("ERR_NOT_FOUND"!==n.code)throw n}return t}}class SB{constructor(e,t){Dr(this,"peerStore",void 0),Dr(this,"datastore",void 0),Dr(this,"peerRouting",void 0),Dr(this,"log",void 0),this.log=e.logger.forComponent("".concat(t.logPrefix,":rpc:handlers:get-value")),this.peerStore=e.peerStore,this.datastore=e.datastore,this.peerRouting=t.peerRouting}async handle(e,t){const n=t.key;if(this.log("%p asked for key %b",e,n),null==n||0===n.length)throw new tf("Invalid key","ERR_INVALID_KEY");const r={type:xN.GET_VALUE,key:n,clusterLevel:t.clusterLevel,closer:[],providers:[]};if(function(e){return"/pk/"===cp(e.subarray(0,4))}(n)){this.log("is public key");const e=function(e){return np(e.subarray(4))}(n);let t;try{const n=await this.peerStore.get(e);if(null==n.id.publicKey)throw new tf("No public key found in key book","ERR_NOT_FOUND");t=n.id.publicKey}catch(s){if("ERR_NOT_FOUND"!==s.code)throw s}if(null!=t)return this.log("returning found public key"),r.record=new NN(n,t,new Date).serialize(),r}const[i,o]=await Promise.all([this._checkLocalDatastore(n),this.peerRouting.getCloserPeersOffline(n,e)]);return null!=i&&(this.log("had record for %b in local datastore",n),r.record=i.serialize()),o.length>0&&(this.log("had %s closer peers in routing table",o.length),r.closer=o.map((e=>({id:e.id.toBytes(),multiaddrs:e.multiaddrs.map((e=>e.bytes))})))),r}async _checkLocalDatastore(e){this.log("checkLocalDatastore looking for %b",e);const t=WN(e);let n;try{n=await this.datastore.get(t)}catch(i){if("ERR_NOT_FOUND"===i.code)return;throw i}const r=NN.deserialize(n);if(null==r)throw new tf("Invalid record","ERR_INVALID_RECORD");if(!(null==r.timeReceived||Date.now()-r.timeReceived.getTime()>yN))return r;await this.datastore.delete(t)}}class xB{constructor(e,t){Dr(this,"log",void 0),this.log=e.logger.forComponent("".concat(t.logPrefix,":rpc:handlers:ping"))}async handle(e,t){return this.log("ping from %p",e),t}}class _B{constructor(e,t){Dr(this,"components",void 0),Dr(this,"validators",void 0),Dr(this,"log",void 0);const{validators:n}=t;this.components=e,this.log=e.logger.forComponent("".concat(t.logPrefix,":rpc:handlers:put-value")),this.validators=n}async handle(e,t){const n=t.key;if(this.log("%p asked us to store value for key %b",e,n),null==t.record){const t="Empty record from: ".concat(e.toString());throw this.log.error(t),new tf(t,"ERR_EMPTY_RECORD")}try{const e=NN.deserialize(t.record);await HN(this.validators,e),e.timeReceived=new Date;const r=WN(e.key);await this.components.datastore.put(r,e.serialize().subarray()),this.log("put record for %b into datastore under key %k",n,r)}catch(r){this.log("did not put record for key %b into datastore %o",n,r)}return t}}class IB{constructor(e,t){Dr(this,"handlers",void 0),Dr(this,"routingTable",void 0),Dr(this,"log",void 0);const{providers:n,peerRouting:r,validators:i,logPrefix:o,peerInfoMapper:s}=t;this.log=e.logger.forComponent("".concat(o,":rpc")),this.routingTable=t.routingTable,this.handlers={[xN.GET_VALUE.toString()]:new SB(e,{peerRouting:r,logPrefix:o}),[xN.PUT_VALUE.toString()]:new _B(e,{validators:i,logPrefix:o}),[xN.FIND_NODE.toString()]:new kB(e,{peerRouting:r,logPrefix:o,peerInfoMapper:s}),[xN.ADD_PROVIDER.toString()]:new EB(e,{providers:n,logPrefix:o}),[xN.GET_PROVIDERS.toString()]:new AB(e,{peerRouting:r,providers:n,logPrefix:o,peerInfoMapper:s}),[xN.PING.toString()]:new xB(e,{logPrefix:o})}}async handleMessage(e,t){try{await this.routingTable.add(e)}catch(r){this.log.error("Failed to update the kbucket store",r)}const n=this.handlers[t.type];if(null!=n)return n.handle(e,t);this.log.error("no handler found for message type: ".concat(t.type))}onIncomingStream(e){Promise.resolve().then((async()=>{const{stream:t,connection:n}=e,r=n.remotePeer;try{await this.routingTable.add(r)}catch(o){this.log.error(o)}const i=this;await gu(t,(e=>Af(e)),(async function*(e){for await(const t of e){const e=TN.decode(t);i.log("incoming %s from %p",e.type,r);const n=await i.handleMessage(r,e);null!=n&&(yield TN.encode(n))}}),(e=>bf(e)),t)})).catch((e=>{this.log.error(e)}))}}class RB extends Jh{constructor(e,t){super(),Dr(this,"log",void 0),Dr(this,"components",void 0),Dr(this,"protocol",void 0),Dr(this,"running",void 0),Dr(this,"registrarId",void 0);const{protocol:n,logPrefix:r}=t;this.components=e,this.log=e.logger.forComponent("".concat(r,":topology-listener")),this.running=!1,this.protocol=n}isStarted(){return this.running}async start(){this.running||(this.running=!0,this.registrarId=await this.components.registrar.register(this.protocol,{onConnect:e=>{this.log("observed peer %p with protocol %s",e,this.protocol),this.dispatchEvent(new $h("peer",{detail:e}))}}))}async stop(){this.running=!1,null!=this.registrarId&&(this.components.registrar.unregister(this.registrarId),this.registrarId=void 0)}}class CB{constructor(e){Dr(this,"dht",void 0),this.dht=e}async provide(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};await vf(this.dht.provide(e,t))}findProviders(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){for await(const r of t.dht.findProviders(e,n))"PROVIDER"===r.name&&(yield*r.providers)}()}catch(BJ){return Promise.reject(BJ)}}async put(e,t,n){await vf(this.dht.put(e,t,n))}async get(e,t){for await(const n of this.dht.get(e,t))if("VALUE"===n.name)return n.value;throw new tf("Not found","ERR_NOT_FOUND")}}class TB{constructor(e){Dr(this,"dht",void 0),this.dht=e}async findPeer(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for await(const n of this.dht.findPeer(e,t))if("FINAL_PEER"===n.name)return n.peer;throw new tf("Not found","ERR_NOT_FOUND")}getClosestPeers(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){for await(const r of t.dht.getClosestPeers(e,n))"FINAL_PEER"===r.name&&(yield r.peer)}()}catch(BJ){return Promise.reject(BJ)}}}class PB extends Jh{constructor(e,t){var n;super(),Dr(this,"protocol",void 0),Dr(this,"routingTable",void 0),Dr(this,"providers",void 0),Dr(this,"network",void 0),Dr(this,"peerRouting",void 0),Dr(this,"components",void 0),Dr(this,"log",void 0),Dr(this,"running",void 0),Dr(this,"kBucketSize",void 0),Dr(this,"clientMode",void 0),Dr(this,"validators",void 0),Dr(this,"selectors",void 0),Dr(this,"queryManager",void 0),Dr(this,"contentFetching",void 0),Dr(this,"contentRouting",void 0),Dr(this,"routingTableRefresh",void 0),Dr(this,"rpc",void 0),Dr(this,"topologyListener",void 0),Dr(this,"querySelf",void 0),Dr(this,"maxInboundStreams",void 0),Dr(this,"maxOutboundStreams",void 0),Dr(this,"dhtContentRouting",void 0),Dr(this,"dhtPeerRouting",void 0),Dr(this,"peerInfoMapper",void 0);const{kBucketSize:r,clientMode:i,validators:o,selectors:s,querySelfInterval:a,protocol:c,logPrefix:l,pingTimeout:u,pingConcurrency:d,maxInboundStreams:h,maxOutboundStreams:f,providers:p}=t,g=null!==l&&void 0!==l?l:"libp2p:kad-dht";this.running=!1,this.components=e,this.log=e.logger.forComponent(g),this.protocol=null!==c&&void 0!==c?c:"/ipfs/kad/1.0.0",this.kBucketSize=null!==r&&void 0!==r?r:20,this.clientMode=null===i||void 0===i||i,this.maxInboundStreams=null!==h&&void 0!==h?h:32,this.maxOutboundStreams=null!==f&&void 0!==f?f:64,this.peerInfoMapper=null!==(n=t.peerInfoMapper)&&void 0!==n?n:qN,this.routingTable=new yB(e,{kBucketSize:r,pingTimeout:u,pingConcurrency:d,protocol:this.protocol,logPrefix:g}),this.providers=new iB(e,null!==p&&void 0!==p?p:{}),this.validators={...zN,...o},this.selectors={...jN,...s},this.network=new $N(e,{protocol:this.protocol,logPrefix:g});const m=ou();!0===t.allowQueryWithZeroPeers&&m.resolve(),this.queryManager=new uB(e,{disjointPaths:Math.ceil(this.kBucketSize/2),logPrefix:g,initialQuerySelfHasRun:m,routingTable:this.routingTable}),this.peerRouting=new rB(e,{routingTable:this.routingTable,network:this.network,validators:this.validators,queryManager:this.queryManager,logPrefix:g}),this.contentFetching=new YN(e,{validators:this.validators,selectors:this.selectors,peerRouting:this.peerRouting,queryManager:this.queryManager,network:this.network,logPrefix:g}),this.contentRouting=new XN(e,{network:this.network,peerRouting:this.peerRouting,queryManager:this.queryManager,routingTable:this.routingTable,providers:this.providers,logPrefix:g}),this.routingTableRefresh=new bB(e,{peerRouting:this.peerRouting,routingTable:this.routingTable,logPrefix:g}),this.rpc=new IB(e,{routingTable:this.routingTable,providers:this.providers,peerRouting:this.peerRouting,validators:this.validators,logPrefix:g,peerInfoMapper:this.peerInfoMapper}),this.topologyListener=new RB(e,{protocol:this.protocol,logPrefix:g}),this.querySelf=new pB(e,{peerRouting:this.peerRouting,interval:a,initialInterval:t.initialQuerySelfInterval,logPrefix:g,initialQuerySelfHasRun:m,routingTable:this.routingTable}),this.network.addEventListener("peer",(e=>{const t=e.detail;this.onPeerConnect(t).catch((e=>{this.log.error("could not add %p to routing table",t.id,e)})),this.dispatchEvent(new $h("peer",{detail:t}))})),this.topologyListener.addEventListener("peer",(e=>{const t=e.detail;Promise.resolve().then((async()=>{const e=await this.components.peerStore.get(t),n={id:t,multiaddrs:e.addresses.map((e=>{let{multiaddr:t}=e;return t})),protocols:e.protocols};await this.onPeerConnect(n)})).catch((e=>{this.log.error("could not add %p to routing table",t,e)}))})),this.dhtPeerRouting=new TB(this),this.dhtContentRouting=new CB(this),null==t.clientMode&&e.events.addEventListener("self:peer:update",(e=>{this.log("received update of self-peer info"),Promise.resolve().then((async()=>{const t=e.detail.peer.addresses.some((e=>{let{multiaddr:t}=e;return function(e){const t=e.stringTuples();for(const n of t)if(290===n[0])return!1;if(54===t[0][0]||55===t[0][0]||56===t[0][0])return!0;if(4===t[0][0]||41===t[0][0]){const e=$p("".concat(t[0][1]));return null==e||!e}return!1}(t)})),n=this.getMode();t&&"client"===n?await this.setMode("server"):"server"!==n||t||await this.setMode("client")})).catch((e=>{this.log.error("error setting dht server mode",e)}))}))}get[Uv](){return this.dhtContentRouting}get[jv](){return this.dhtPeerRouting}get[mS](){return this}async onPeerConnect(e){if(this.log("peer %p connected",e.id),0!==(e=this.peerInfoMapper(e)).multiaddrs.length)try{await this.routingTable.add(e.id)}catch(t){this.log.error("could not add %p to routing table",e.id,t)}else this.log("ignoring %p as there were no valid addresses in %s after filtering",e.id,e.multiaddrs.map((e=>e.toString())))}isStarted(){return this.running}getMode(){return this.clientMode?"client":"server"}async setMode(e){await this.components.registrar.unhandle(this.protocol),"client"===e?(this.log("enabling client mode"),this.clientMode=!0):(this.log("enabling server mode"),this.clientMode=!1,await this.components.registrar.handle(this.protocol,this.rpc.onIncomingStream.bind(this.rpc),{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams}))}async start(){this.running=!0,await this.setMode(this.clientMode?"client":"server"),await zv(this.querySelf,this.providers,this.queryManager,this.network,this.routingTable,this.topologyListener,this.routingTableRefresh)}async stop(){this.running=!1,await Vv(this.querySelf,this.providers,this.queryManager,this.network,this.routingTable,this.routingTableRefresh,this.topologyListener)}put(e,t){try{var n=this;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return async function*(){yield*n.contentFetching.put(e,t,r)}()}catch(BJ){return Promise.reject(BJ)}}get(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){yield*t.contentFetching.get(e,n)}()}catch(BJ){return Promise.reject(BJ)}}provide(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){yield*t.contentRouting.provide(e,t.components.addressManager.getAddresses(),n)}()}catch(BJ){return Promise.reject(BJ)}}findProviders(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){yield*t.contentRouting.findProviders(e,n)}()}catch(BJ){return Promise.reject(BJ)}}findPeer(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){yield*t.peerRouting.findPeer(e,n)}()}catch(BJ){return Promise.reject(BJ)}}getClosestPeers(e){try{var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){yield*t.peerRouting.getClosestPeers(e,n)}()}catch(BJ){return Promise.reject(BJ)}}async refreshRoutingTable(){this.routingTableRefresh.refreshTable(!0)}}var NB,BB;function DB(e){return t=>new PB(t,e)}!function(e){e[e.SEND_QUERY=0]="SEND_QUERY",e[e.PEER_RESPONSE=1]="PEER_RESPONSE",e[e.FINAL_PEER=2]="FINAL_PEER",e[e.QUERY_ERROR=3]="QUERY_ERROR",e[e.PROVIDER=4]="PROVIDER",e[e.VALUE=5]="VALUE",e[e.ADD_PEER=6]="ADD_PEER",e[e.DIAL_PEER=7]="DIAL_PEER"}(NB||(NB={})),function(e){e[e.NEW_STREAM=0]="NEW_STREAM",e[e.MESSAGE_RECEIVER=1]="MESSAGE_RECEIVER",e[e.MESSAGE_INITIATOR=2]="MESSAGE_INITIATOR",e[e.CLOSE_RECEIVER=3]="CLOSE_RECEIVER",e[e.CLOSE_INITIATOR=4]="CLOSE_INITIATOR",e[e.RESET_RECEIVER=5]="RESET_RECEIVER",e[e.RESET_INITIATOR=6]="RESET_INITIATOR"}(BB||(BB={}));const OB=Object.freeze({0:"NEW_STREAM",1:"MESSAGE_RECEIVER",2:"MESSAGE_INITIATOR",3:"CLOSE_RECEIVER",4:"CLOSE_INITIATOR",5:"RESET_RECEIVER",6:"RESET_INITIATOR"}),LB=Object.freeze({NEW_STREAM:BB.NEW_STREAM,MESSAGE:BB.MESSAGE_INITIATOR,CLOSE:BB.CLOSE_INITIATOR,RESET:BB.RESET_INITIATOR}),MB=Object.freeze({MESSAGE:BB.MESSAGE_RECEIVER,CLOSE:BB.CLOSE_RECEIVER,RESET:BB.RESET_RECEIVER}),FB=1<<20;class UB{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:FB,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4194304;Dr(this,"_buffer",void 0),Dr(this,"_headerInfo",void 0),Dr(this,"_maxMessageSize",void 0),Dr(this,"_maxUnprocessedMessageQueueSize",void 0),this._buffer=new Kr,this._headerInfo=null,this._maxMessageSize=e,this._maxUnprocessedMessageQueueSize=t}write(e){if(null==e||0===e.length)return[];if(this._buffer.append(e),this._buffer.byteLength>this._maxUnprocessedMessageQueueSize)throw Object.assign(new Error("unprocessed message queue size too large!"),{code:"ERR_MSG_QUEUE_TOO_BIG"});const t=[];for(;0!==this._buffer.length;){if(null==this._headerInfo)try{this._headerInfo=this._decodeHeader(this._buffer)}catch(n){if("ERR_MSG_TOO_BIG"===n.code)throw n;break}const{id:e,type:r,length:i,offset:o}=this._headerInfo;if(this._buffer.length-o<i)break;const s={id:e,type:r};r!==BB.NEW_STREAM&&r!==BB.MESSAGE_INITIATOR&&r!==BB.MESSAGE_RECEIVER||(s.data=this._buffer.sublist(o,o+i)),t.push(s),this._buffer.consume(o+i),this._headerInfo=null}return t}_decodeHeader(e){const{value:t,offset:n}=zB(e),{value:r,offset:i}=zB(e,n),o=7&t;if(null==OB[o])throw new Error("Invalid type received: ".concat(o));if(r>this._maxMessageSize)throw Object.assign(new Error("message size too large!"),{code:"ERR_MSG_TOO_BIG"});return{id:t>>3,type:o,offset:n+i,length:r}}}const jB=128,HB=127;function zB(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=0,i=0,o=n;const s=e.length;do{if(o>=s||i>49)throw n=0,new RangeError("Could not decode varint");t=e.get(o++),r+=i<28?(t&HB)<<i:(t&HB)*Math.pow(2,i),i+=7}while(t>=jB);return n=o-n,{value:r,offset:n}}const VB=10240;const qB=new class{constructor(){Dr(this,"_pool",void 0),Dr(this,"_poolOffset",void 0),this._pool=jr(VB),this._poolOffset=0}write(e,t){const n=this._pool;let r=this._poolOffset;Lo(e.id<<3|e.type,n,r),r+=Bo(e.id<<3|e.type),e.type!==BB.NEW_STREAM&&e.type!==BB.MESSAGE_INITIATOR&&e.type!==BB.MESSAGE_RECEIVER||null==e.data?(Lo(0,n,r),r+=Bo(0)):(Lo(e.data.length,n,r),r+=Bo(e.data.length));const i=n.subarray(this._poolOffset,r);VB-r<100?(this._pool=jr(VB),this._poolOffset=0):this._poolOffset=r,t.append(i),e.type!==BB.NEW_STREAM&&e.type!==BB.MESSAGE_INITIATOR&&e.type!==BB.MESSAGE_RECEIVER||null==e.data||t.append(e.data)}};class GB extends YC{constructor(e){super(e),Dr(this,"name",void 0),Dr(this,"streamId",void 0),Dr(this,"send",void 0),Dr(this,"types",void 0),Dr(this,"maxDataSize",void 0),this.types="outbound"===e.direction?LB:MB,this.send=e.send,this.name=e.name,this.streamId=e.streamId,this.maxDataSize=e.maxDataSize}async sendNewStream(){await this.send({id:this.streamId,type:LB.NEW_STREAM,data:new Kr(Fs(this.name))})}async sendData(e){for(e=e.sublist();e.byteLength>0;){const t=Math.min(e.byteLength,this.maxDataSize);await this.send({id:this.streamId,type:this.types.MESSAGE,data:e.sublist(0,t)}),e.consume(t)}}async sendReset(){await this.send({id:this.streamId,type:this.types.RESET})}async sendCloseWrite(){await this.send({id:this.streamId,type:this.types.CLOSE})}async sendCloseRead(){}}function KB(e){const t={...e,type:"".concat(OB[e.type]," (").concat(e.type,")")};return e.type===BB.NEW_STREAM&&(t.data=cp(e.data instanceof Uint8Array?e.data:e.data.subarray())),e.type!==BB.MESSAGE_INITIATOR&&e.type!==BB.MESSAGE_RECEIVER||(t.data=cp(e.data instanceof Uint8Array?e.data:e.data.subarray(),"base16")),t}class WB{constructor(e,t){var n,r,i;Dr(this,"protocol","/mplex/6.7.0"),Dr(this,"sink",void 0),Dr(this,"source",void 0),Dr(this,"log",void 0),Dr(this,"_streamId",void 0),Dr(this,"_streams",void 0),Dr(this,"_init",void 0),Dr(this,"_source",void 0),Dr(this,"closeController",void 0),Dr(this,"rateLimiter",void 0),Dr(this,"closeTimeout",void 0),Dr(this,"logger",void 0),t=null!==(n=t)&&void 0!==n?n:{},this.log=e.logger.forComponent("libp2p:mplex"),this.logger=e.logger,this._streamId=0,this._streams={initiators:new Map,receivers:new Map},this._init=t,this.closeTimeout=null!==(r=t.closeTimeout)&&void 0!==r?r:500,this.sink=this._createSink(),this._source=hu({objectMode:!0,onEnd:()=>{for(const e of this._streams.initiators.values())e.destroy();for(const e of this._streams.receivers.values())e.destroy()}}),this.source=gu(this._source,(e=>async function*(e){for await(const t of e){const e=new Kr;qB.write(t,e),yield e}}(e))),this.closeController=new AbortController,this.rateLimiter=new mx({points:null!==(i=t.disconnectThreshold)&&void 0!==i?i:5,duration:1})}get streams(){const e=[];for(const t of this._streams.initiators.values())e.push(t);for(const t of this._streams.receivers.values())e.push(t);return e}newStream(e){if(this.closeController.signal.aborted)throw new Error("Muxer already closed");const t=this._streamId++;e=null==e?t.toString():e.toString();const n=this._streams.initiators;return this._newStream({id:t,name:e,type:"initiator",registry:n})}async close(e){var t;if(this.closeController.signal.aborted)return;const n=null!==(t=null===e||void 0===e?void 0:e.signal)&&void 0!==t?t:AbortSignal.timeout(this.closeTimeout);try{await Promise.all(this.streams.map((async e=>e.close({signal:n})))),this._source.end(),await this._source.onEmpty({signal:n}),this.closeController.abort()}catch(r){this.abort(r)}}abort(e){this.closeController.signal.aborted||(this.streams.forEach((t=>{t.abort(e)})),this.closeController.abort(e))}_newReceiverStream(e){const{id:t,name:n}=e,r=this._streams.receivers;return this._newStream({id:t,name:n,type:"receiver",registry:r})}_newStream(e){var t;const{id:n,name:r,type:i,registry:o}=e;if(this.log("new %s stream %s",i,n),"initiator"===i&&this._streams.initiators.size===(null!==(t=this._init.maxOutboundStreams)&&void 0!==t?t:1024))throw new tf("Too many outbound streams open","ERR_TOO_MANY_OUTBOUND_STREAMS");if(o.has(n))throw new Error("".concat(i," stream ").concat(n," already exists!"));const s=function(e){const{id:t,name:n,send:r,onEnd:i,type:o="initiator",maxMsgSize:s=FB}=e;return new GB({id:"initiator"===o?"i".concat(t):"r".concat(t),streamId:t,name:"".concat(null==n?t:n),direction:"initiator"===o?"outbound":"inbound",maxDataSize:s,onEnd:i,send:r,log:e.logger.forComponent("libp2p:mplex:stream:".concat(o,":").concat(t))})}({id:n,name:r,send:async e=>{this.log.enabled&&this.log.trace("%s stream %s send",i,n,KB(e)),this._source.push(e)},type:i,onEnd:()=>{this.log("%s stream with id %s and protocol %s ended",i,n,s.protocol),o.delete(n),null!=this._init.onStreamEnd&&this._init.onStreamEnd(s)},maxMsgSize:this._init.maxMsgSize,logger:this.logger});return o.set(n,s),s}_createSink(){return async e=>{const t=()=>{WC(e,this.log)};this.closeController.signal.addEventListener("abort",t);try{const t=new UB(this._init.maxMsgSize,this._init.maxUnprocessedMessageQueueSize);for await(const n of e)for(const e of t.write(n))await this._handleIncoming(e);this._source.end()}catch(n){this.log("error in sink",n),this._source.end(n)}finally{this.closeController.signal.removeEventListener("abort",t)}}}async _handleIncoming(e){var t;const{id:n,type:r}=e;if(this.log.enabled&&this.log.trace("incoming message",KB(e)),e.type===BB.NEW_STREAM){var i;if(this._streams.receivers.size===(null!==(i=this._init.maxInboundStreams)&&void 0!==i?i:1024)){this.log("too many inbound streams open"),this._source.push({id:n,type:BB.RESET_RECEIVER});try{await this.rateLimiter.consume("new-stream",1)}catch{return this.log("rate limit hit when opening too many new streams over the inbound stream limit - closing remote connection"),void this.abort(new Error("Too many open streams"))}return}const t=this._newReceiverStream({id:n,name:cp(e.data instanceof Uint8Array?e.data:e.data.subarray())});return void(null!=this._init.onIncomingStream&&this._init.onIncomingStream(t))}const o=(1===(1&r)?this._streams.initiators:this._streams.receivers).get(n);if(null==o){this.log("missing stream %s for message type %s",n,OB[r]);try{await this.rateLimiter.consume("missing-stream",1)}catch{return this.log("rate limit hit when receiving messages for streams that do not exist - closing remote connection"),void this.abort(new Error("Too many messages for missing streams"))}return}const s=null!==(t=this._init.maxStreamBufferSize)&&void 0!==t?t:4194304;try{switch(r){case BB.MESSAGE_INITIATOR:case BB.MESSAGE_RECEIVER:if(o.sourceReadableLength()>s)throw this._source.push({id:e.id,type:r===BB.MESSAGE_INITIATOR?BB.RESET_RECEIVER:BB.RESET_INITIATOR}),new tf("Input buffer full - increase Mplex maxBufferSize to accommodate slow consumers","ERR_STREAM_INPUT_BUFFER_FULL");o.sourcePush(e.data);break;case BB.CLOSE_INITIATOR:case BB.CLOSE_RECEIVER:o.remoteCloseWrite();break;case BB.RESET_INITIATOR:case BB.RESET_RECEIVER:o.reset();break;default:this.log("unknown message type %s",r)}}catch(a){this.log.error("error while processing message",a),o.abort(a)}}}class QB{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Dr(this,"protocol","/mplex/6.7.0"),Dr(this,"_init",void 0),Dr(this,"components",void 0),this.components=e,this._init=t}createStreamMuxer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new WB(this.components,{...e,...this._init})}}function YB(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>new QB(t,e)}const ZB="ERR_WRONG_PING_ACK";class JB{constructor(e){var t,n,r,i,o;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Dr(this,"protocol",void 0),Dr(this,"components",void 0),Dr(this,"started",void 0),Dr(this,"timeout",void 0),Dr(this,"maxInboundStreams",void 0),Dr(this,"maxOutboundStreams",void 0),Dr(this,"runOnTransientConnection",void 0),Dr(this,"log",void 0),this.components=e,this.log=e.logger.forComponent("libp2p:ping"),this.started=!1,this.protocol="/".concat(null!==(t=s.protocolPrefix)&&void 0!==t?t:"ipfs","/").concat("ping","/").concat("1.0.0"),this.timeout=null!==(n=s.timeout)&&void 0!==n?n:1e4,this.maxInboundStreams=null!==(r=s.maxInboundStreams)&&void 0!==r?r:2,this.maxOutboundStreams=null!==(i=s.maxOutboundStreams)&&void 0!==i?i:1,this.runOnTransientConnection=null===(o=s.runOnTransientConnection)||void 0===o||o,this.handleMessage=this.handleMessage.bind(this)}async start(){await this.components.registrar.handle(this.protocol,this.handleMessage,{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams,runOnTransientConnection:this.runOnTransientConnection}),this.started=!0}async stop(){await this.components.registrar.unhandle(this.protocol),this.started=!1}isStarted(){return this.started}handleMessage(e){this.log("incoming ping from %p",e.connection.remotePeer);const{stream:t}=e,n=Date.now();gu(t,t).catch((t=>{this.log.error("incoming ping from %p failed with error",e.connection.remotePeer,t)})).finally((()=>{const t=Date.now()-n;this.log("incoming ping from %p complete in %dms",e.connection.remotePeer,t)}))}async ping(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.log("pinging %p",e);const n=Date.now(),r=Np(32),i=await this.components.connectionManager.openConnection(e,t);let o,s=()=>{};if(null==t.signal){const e=AbortSignal.timeout(this.timeout);t={...t,signal:e}}try{var a;o=await i.newStream(this.protocol,{...t,runOnTransientConnection:this.runOnTransientConnection}),s=()=>{var e;null===(e=o)||void 0===e||e.abort(new tf("ping timeout",af))},null===(a=t.signal)||void 0===a||a.addEventListener("abort",s,{once:!0});const e=await gu([r],o,(async e=>Lr(e))),c=Date.now()-n;if(null==e)throw new tf("Did not receive a ping ack after ".concat(c,"ms"),ZB);if(!zr(r,e.subarray()))throw new tf("Received wrong ping ack after ".concat(c,"ms"),ZB);return this.log("ping %p complete in %dms",i.remotePeer,c),c}catch(u){var c;throw this.log.error("error while pinging %p",i.remotePeer,u),null===(c=o)||void 0===c||c.abort(u),u}finally{var l;null===(l=t.signal)||void 0===l||l.removeEventListener("abort",s),null!=o&&await o.close()}}}function XB(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>new JB(t,e)}var $B;!function(e){e.ERR_ALREADY_ABORTED="ERR_ALREADY_ABORTED",e.ERR_DATA_CHANNEL="ERR_DATA_CHANNEL",e.ERR_CONNECTION_CLOSED="ERR_CONNECTION_CLOSED",e.ERR_HASH_NOT_SUPPORTED="ERR_HASH_NOT_SUPPORTED",e.ERR_INVALID_MULTIADDR="ERR_INVALID_MULTIADDR",e.ERR_INVALID_FINGERPRINT="ERR_INVALID_FINGERPRINT",e.ERR_INVALID_PARAMETERS="ERR_INVALID_PARAMETERS",e.ERR_NOT_IMPLEMENTED="ERR_NOT_IMPLEMENTED",e.ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS="ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS",e.ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS="ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS"}($B||($B={}));class eD extends tf{constructor(e,t){super("WebRTC transport error: ".concat(e),null!==t&&void 0!==t?t:""),this.name="WebRTCTransportError"}}class tD extends eD{constructor(e,t){super("[stream: ".concat(e,"] data channel error: ").concat(t),$B.ERR_DATA_CHANNEL),this.name="WebRTC/DataChannelError"}}function nD(e,t){return new tD(e,t)}class rD extends eD{constructor(e){super("There was a problem with the Multiaddr which was passed in: ".concat(e),$B.ERR_INVALID_MULTIADDR),this.name="WebRTC/InappropriateMultiaddrError"}}function iD(e){return new rD(e)}class oD extends eD{constructor(e){super("There was a problem with a provided argument: ".concat(e),$B.ERR_INVALID_PARAMETERS),this.name="WebRTC/InvalidArgumentError"}}function sD(e){return new oD(e)}class aD extends eD{constructor(e,t){super('Invalid fingerprint "'.concat(e,'" within ').concat(t),$B.ERR_INVALID_FINGERPRINT),this.name="WebRTC/InvalidFingerprintError"}}function cD(e,t){return new aD(e,t)}class lD extends eD{constructor(e){super("A method (".concat(e,") was called though it has been intentionally left unimplemented."),$B.ERR_NOT_IMPLEMENTED),this.name="WebRTC/UnimplementedError"}}class uD extends eD{constructor(e){super("unsupported hash algorithm: ".concat(e),$B.ERR_HASH_NOT_SUPPORTED),this.name="WebRTC/UnsupportedHashAlgorithmError"}}var dD=function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},hD=function(e,t,n){this.name=e,this.version=t,this.os=n,this.type="browser"},fD=function(e){this.version=e,this.type="node",this.name="node",this.os=process.platform},pD=function(e,t,n,r){this.name=e,this.version=t,this.os=n,this.bot=r,this.type="bot-device"},gD=function(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null},mD=function(){this.type="react-native",this.name="react-native",this.version=null,this.os=null},vD=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,yD=3,wD=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],bD=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function ED(e){return""!==e&&wD.reduce((function(t,n){var r=n[0],i=n[1];if(t)return t;var o=i.exec(e);return!!o&&[r,o]}),!1)}function kD(e){var t=ED(e);if(!t)return null;var n=t[0],r=t[1];if("searchbot"===n)return new gD;var i=r[1]&&r[1].split(".").join("_").split("_").slice(0,3);i?i.length<yD&&(i=dD(dD([],i,!0),function(e){for(var t=[],n=0;n<e;n++)t.push("0");return t}(yD-i.length),!0)):i=[];var o=i.join("."),s=function(e){for(var t=0,n=bD.length;t<n;t++){var r=bD[t],i=r[0];if(r[1].exec(e))return i}return null}(e),a=vD.exec(e);return a&&a[1]?new pD(n,o,s,a[1]):new hD(n,o,s)}const AD=SD?kD(SD):"undefined"===typeof document&&"undefined"!==typeof navigator&&"ReactNative"===navigator.product?new mD:"undefined"!==typeof navigator?kD(navigator.userAgent):function(){var e="undefined"!==typeof process&&process.version;return e?new fD(process.version.slice(1)):null}();var SD;const xD=null!=AD&&"firefox"===AD.name,_D=async function*(){},ID=async e=>{},RD=3e4;class CD{constructor(e,t){Dr(this,"log",void 0),Dr(this,"peerConnection",void 0),Dr(this,"remoteAddr",void 0),Dr(this,"timeline",void 0),Dr(this,"metrics",void 0),Dr(this,"source",_D()),Dr(this,"sink",ID),this.log=e.logger.forComponent("libp2p:webrtc:maconn"),this.remoteAddr=t.remoteAddr,this.timeline=t.timeline,this.peerConnection=t.peerConnection;const n=this.peerConnection.connectionState;this.peerConnection.onconnectionstatechange=()=>{this.log.trace("peer connection state change",this.peerConnection.connectionState,"initial state",n),"disconnected"!==this.peerConnection.connectionState&&"failed"!==this.peerConnection.connectionState&&"closed"!==this.peerConnection.connectionState||(this.timeline.close=Date.now())}}async close(e){var t;this.log.trace("closing connection"),this.peerConnection.close(),this.timeline.close=Date.now(),null===(t=this.metrics)||void 0===t||t.increment({close:!0})}abort(e){var t;this.log.error("closing connection due to error",e),this.peerConnection.close(),this.timeline.close=Date.now(),null===(t=this.metrics)||void 0===t||t.increment({abort:!0})}}var TD;!function(e){let t,n,r;!function(e){e.FIN="FIN",e.STOP_SENDING="STOP_SENDING",e.RESET="RESET",e.FIN_ACK="FIN_ACK"}(t=e.Flag||(e.Flag={})),function(e){e[e.FIN=0]="FIN",e[e.STOP_SENDING=1]="STOP_SENDING",e[e.RESET=2]="RESET",e[e.FIN_ACK=3]="FIN_ACK"}(n||(n={})),function(e){e.codec=()=>ia(n)}(t=e.Flag||(e.Flag={})),e.codec=()=>(null==r&&(r=oa((function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==r.lengthDelimited&&n.fork(),null!=t.flag&&(n.uint32(8),e.Flag.codec().encode(t.flag,n)),null!=t.message&&(n.uint32(18),n.bytes(t.message)),!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.flag=e.Flag.codec().decode(t);break;case 2:r.message=t.bytes();break;default:t.skipType(7&n)}}return r}))),r),e.encode=t=>Xs(t,e.codec()),e.decode=t=>$o(t,e.codec())}(TD||(TD={}));class PD extends YC{constructor(e){var t,n,r,i,o;const s=e.onEnd;switch(e.onEnd=e=>{this.log.trace("readable and writeable ends closed",this.status),Promise.resolve((async()=>{if(null==this.timeline.abort&&null===this.timeline.reset)try{await Du(this.receiveFinAck.promise,{milliseconds:this.finAckTimeout})}catch(e){this.log.error("error receiving FIN_ACK",e)}})).then((()=>{this.incomingData.end(),null===s||void 0===s||s(e)})).catch((e=>{this.log.error("error ending stream",e)}))},super(e),Dr(this,"channel",void 0),Dr(this,"incomingData",void 0),Dr(this,"maxBufferedAmount",void 0),Dr(this,"bufferedAmountLowEventTimeout",void 0),Dr(this,"maxMessageSize",void 0),Dr(this,"receiveFinAck",void 0),Dr(this,"finAckTimeout",void 0),Dr(this,"openTimeout",void 0),this.channel=e.channel,this.channel.binaryType="arraybuffer",this.incomingData=hu(),this.bufferedAmountLowEventTimeout=null!==(t=e.bufferedAmountLowEventTimeout)&&void 0!==t?t:3e4,this.maxBufferedAmount=null!==(n=e.maxBufferedAmount)&&void 0!==n?n:16777216,this.maxMessageSize=(null!==(r=e.maxMessageSize)&&void 0!==r?r:16384)-5-2,this.receiveFinAck=ou(),this.finAckTimeout=null!==(i=e.closeTimeout)&&void 0!==i?i:5e3,this.openTimeout=null!==(o=e.openTimeout)&&void 0!==o?o:5e3,this.channel.readyState){case"open":this.timeline.open=(new Date).getTime();break;case"closed":case"closing":void 0!==this.timeline.close&&0!==this.timeline.close||(this.timeline.close=Date.now());break;case"connecting":break;default:throw this.log.error("unknown datachannel state %s",this.channel.readyState),new tf("Unknown datachannel state","ERR_INVALID_STATE")}this.channel.onopen=e=>{this.timeline.open=(new Date).getTime()},this.channel.onclose=e=>{this.receiveFinAck.resolve(),this.close().catch((e=>{this.log.error("error closing stream after channel closed",e)}))},this.channel.onerror=e=>{const t=e.error;this.abort(t)},this.channel.onmessage=async e=>{const{data:t}=e;null!==t&&0!==t.byteLength&&this.incomingData.push(new Uint8Array(t,0,t.byteLength))};const a=this;Promise.resolve().then((async()=>{for await(const e of Af(this.incomingData)){const t=a.processIncomingProtobuf(e);null!=t&&a.sourcePush(new Kr(t))}})).catch((e=>{this.log.error("error processing incoming data channel messages",e)}))}sendNewStream(){}async _sendMessage(e){if((!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.channel.bufferedAmount>this.maxBufferedAmount)try{this.log('channel buffer is %d, wait for "bufferedamountlow" event',this.channel.bufferedAmount),await fB(this.channel,"bufferedamountlow",{timeout:this.bufferedAmountLowEventTimeout})}catch(t){if(t instanceof Tu)throw new tf("Timed out waiting for DataChannel buffer to clear after ".concat(this.bufferedAmountLowEventTimeout,"ms"),"ERR_BUFFER_CLEAR_TIMEOUT");throw t}if("closed"===this.channel.readyState||"closing"===this.channel.readyState)throw new tf("Invalid datachannel state - ".concat(this.channel.readyState),"ERR_INVALID_STATE");"open"!==this.channel.readyState&&(this.log('channel state is "%s" and not "open", waiting for "open" event before sending data',this.channel.readyState),await fB(this.channel,"open",{timeout:this.openTimeout}),this.log('channel state is now "%s", sending data',this.channel.readyState)),this.channel.send(e.subarray())}async sendData(e){for(e=e.sublist();e.byteLength>0;){const t=Math.min(e.byteLength,this.maxMessageSize),n=e.subarray(0,t),r=TD.encode({message:n}),i=bf.single(r);await this._sendMessage(i),e.consume(t)}}async sendReset(){await this._sendFlag(TD.Flag.RESET)}async sendCloseWrite(e){if(await this._sendFlag(TD.Flag.FIN)){this.log.trace("awaiting FIN_ACK");try{await hf(this.receiveFinAck.promise,null===e||void 0===e?void 0:e.signal,{errorMessage:"sending close-write was aborted before FIN_ACK was received",errorCode:"ERR_FIN_ACK_NOT_RECEIVED"})}catch(t){this.log.error("failed to await FIN_ACK",t)}}else this.log.trace("sending FIN failed, not awaiting FIN_ACK");this.receiveFinAck.resolve()}async sendCloseRead(){await this._sendFlag(TD.Flag.STOP_SENDING)}processIncomingProtobuf(e){const t=TD.decode(e);if(void 0!==t.flag&&(this.log.trace('incoming flag %s, write status "%s", read status "%s"',t.flag,this.writeStatus,this.readStatus),t.flag===TD.Flag.FIN&&(this.remoteCloseWrite(),this.log.trace("sending FIN_ACK"),this._sendFlag(TD.Flag.FIN_ACK).catch((e=>{this.log.error("error sending FIN_ACK immediately",e)}))),t.flag===TD.Flag.RESET&&this.reset(),t.flag===TD.Flag.STOP_SENDING&&this.remoteCloseRead(),t.flag===TD.Flag.FIN_ACK&&(this.log.trace("received FIN_ACK"),this.receiveFinAck.resolve())),"ready"===this.readStatus)return t.message}async _sendFlag(e){if("open"!==this.channel.readyState)return this.log.trace('not sending flag %s because channel is "%s" and not "open"',this.channel.readyState,e.toString()),!1;this.log.trace("sending flag %s",e.toString());const t=TD.encode({flag:e}),n=bf.single(t);try{return await this._sendMessage(n,!1),!0}catch(r){this.log.error("could not send flag %s",e.toString(),r)}return!1}}function ND(e){const{channel:t,direction:n}=e;return new PD({id:"inbound"===n?"i".concat(t.id):"r".concat(t.id),log:e.logger.forComponent("libp2p:webrtc:stream:".concat(n,":").concat(t.id)),...e})}const BD="/webrtc";class DD{constructor(e,t){var n,r;Dr(this,"protocol",void 0),Dr(this,"peerConnection",void 0),Dr(this,"bufferedStreams",[]),Dr(this,"metrics",void 0),Dr(this,"dataChannelOptions",void 0),Dr(this,"components",void 0),Dr(this,"log",void 0),this.components=e,this.peerConnection=t.peerConnection,this.metrics=t.metrics,this.protocol=null!==(n=t.protocol)&&void 0!==n?n:BD,this.dataChannelOptions=null!==(r=t.dataChannelOptions)&&void 0!==r?r:{},this.log=e.logger.forComponent("libp2p:webrtc:datachannelmuxerfactory"),this.peerConnection.ondatachannel=t=>{let{channel:n}=t;if(this.log.trace('incoming early datachannel with channel id %d and label "%s"',n.id),"init"===n.label)return this.log.trace("closing early init channel"),void n.close();const r={},i=ND({channel:n,direction:"inbound",onEnd:e=>{r.onEnd(e)},logger:e.logger,...this.dataChannelOptions});r.stream=i,r.channel=n,r.onEnd=()=>{this.bufferedStreams=this.bufferedStreams.filter((e=>e.stream.id!==i.id))},this.bufferedStreams.push(r)}}createStreamMuxer(e){return new LD(this.components,{...e,peerConnection:this.peerConnection,dataChannelOptions:this.dataChannelOptions,metrics:this.metrics,streams:this.bufferedStreams,protocol:this.protocol})}}var OD=new WeakSet;class LD{constructor(e,t){var n,r;Au(this,OD),Dr(this,"init",void 0),Dr(this,"streams",void 0),Dr(this,"protocol",void 0),Dr(this,"log",void 0),Dr(this,"peerConnection",void 0),Dr(this,"dataChannelOptions",void 0),Dr(this,"metrics",void 0),Dr(this,"logger",void 0),Dr(this,"source",_D()),Dr(this,"sink",ID),this.init=t,this.log=e.logger.forComponent("libp2p:webrtc:muxer"),this.logger=e.logger,this.streams=t.streams.map((e=>e.stream)),this.peerConnection=t.peerConnection,this.protocol=null!==(n=t.protocol)&&void 0!==n?n:BD,this.metrics=t.metrics,this.dataChannelOptions=null!==(r=t.dataChannelOptions)&&void 0!==r?r:{},this.peerConnection.ondatachannel=e=>{var n,r;let{channel:i}=e;if(this.log.trace("incoming datachannel with channel id %d",i.id),"init"===i.label)return this.log.trace("closing init channel"),void i.close();const o=ND({channel:i,direction:"inbound",onEnd:()=>{this.log("incoming channel %s ended with state %s",i.id,i.readyState),xu(OD,this,MD).call(this,o,i)},logger:this.logger,...this.dataChannelOptions});this.streams.push(o),null===(n=this.metrics)||void 0===n||n.increment({incoming_stream:!0}),null===t||void 0===t||null===(r=t.onIncomingStream)||void 0===r||r.call(t,o)},this.init.streams.length>0&&queueMicrotask((()=>{this.init.streams.forEach((e=>{var t,n,r;e.onEnd=()=>{this.log("incoming early channel %s ended with state %s",e.channel.id,e.channel.readyState),xu(OD,this,MD).call(this,e.stream,e.channel)},null===(t=this.metrics)||void 0===t||t.increment({incoming_stream:!0}),null===(n=this.init)||void 0===n||null===(r=n.onIncomingStream)||void 0===r||r.call(n,e.stream)}))}))}async close(e){try{await Promise.all(this.streams.map((async t=>t.close(e))))}catch(t){this.abort(t)}}abort(e){for(const t of this.streams)t.abort(e)}newStream(){var e;const t=this.peerConnection.createDataChannel("");this.log.trace("opened outgoing datachannel with channel id %s",t.id);const n=ND({channel:t,direction:"outbound",onEnd:()=>{this.log("outgoing channel %s ended with state %s",t.id,t.readyState),xu(OD,this,MD).call(this,n,t)},logger:this.logger,...this.dataChannelOptions});return this.streams.push(n),null===(e=this.metrics)||void 0===e||e.increment({outgoing_stream:!0}),n}}function MD(e,t){var n,r,i;this.log.trace("stream %s %s %s onEnd",e.direction,e.id,e.protocol),function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:RD,r=arguments.length>3?arguments[3]:void 0;"open"===e.readyState&&Promise.resolve().then((async()=>{if(e.bufferedAmount>0){r.log("%s drain channel with %d buffered bytes",t,e.bufferedAmount);const i=ou();let o=!1;e.bufferedAmountLowThreshold=0;const s=()=>{o||(r.log("%s drain channel closed before drain",t),i.resolve())};e.addEventListener("close",s,{once:!0}),e.addEventListener("bufferedamountlow",(()=>{o=!0,e.removeEventListener("close",s),i.resolve()})),await Du(i.promise,{milliseconds:n})}})).then((async()=>{"open"===e.readyState&&e.close()})).catch((e=>{r.log.error("error closing outbound stream",e)}))}(t,"".concat(e.direction," ").concat(e.id," ").concat(e.protocol),this.dataChannelOptions.drainTimeout,{log:this.log}),this.streams=this.streams.filter((t=>t.id!==e.id)),null===(n=this.metrics)||void 0===n||n.increment({stream_end:!0}),null===(r=this.init)||void 0===r||null===(i=r.onStreamEnd)||void 0===i||i.call(r,e)}const FD=globalThis.RTCPeerConnection,UD=globalThis.RTCSessionDescription,jD=globalThis.RTCIceCandidate;var HD;!function(e){let t,n,r;!function(e){e.SDP_OFFER="SDP_OFFER",e.SDP_ANSWER="SDP_ANSWER",e.ICE_CANDIDATE="ICE_CANDIDATE"}(t=e.Type||(e.Type={})),function(e){e[e.SDP_OFFER=0]="SDP_OFFER",e[e.SDP_ANSWER=1]="SDP_ANSWER",e[e.ICE_CANDIDATE=2]="ICE_CANDIDATE"}(n||(n={})),function(e){e.codec=()=>ia(n)}(t=e.Type||(e.Type={})),e.codec=()=>(null==r&&(r=oa((function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==r.lengthDelimited&&n.fork(),null!=t.type&&(n.uint32(8),e.Type.codec().encode(t.type,n)),null!=t.data&&(n.uint32(18),n.string(t.data)),!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={},i=null==n?t.len:t.pos+n;for(;t.pos<i;){const n=t.uint32();switch(n>>>3){case 1:r.type=e.Type.codec().decode(t);break;case 2:r.data=t.string();break;default:t.skipType(7&n)}}return r}))),r),e.encode=t=>Xs(t,e.codec()),e.decode=t=>$o(t,e.codec())}(HD||(HD={}));const zD=async(e,t,n)=>{try{const i=ou();for(!function(e,t){e[xD?"oniceconnectionstatechange":"onconnectionstatechange"]=n=>{switch(function(e){return xD?e.iceConnectionState:e.connectionState}(e)){case"connected":t.resolve();break;case"failed":case"disconnected":case"closed":t.reject(new tf("RTCPeerConnection was closed","ERR_CONNECTION_CLOSED_BEFORE_CONNECTED"))}}}(e,i);;){var r;const s=await Promise.race([i.promise,t.read({signal:n.signal})]);if(null==s)break;if(s.type!==HD.Type.ICE_CANDIDATE)throw new tf("ICE candidate message expected","ERR_NOT_ICE_CANDIDATE");const a=JSON.parse(null!==(r=s.data)&&void 0!==r?r:"null");if(""===a||null===a){n.log.trace("end-of-candidates received");continue}const c=new jD(a);n.log.trace("%s received new ICE candidate",n.direction,c);try{await e.addIceCandidate(c)}catch(o){n.log.error("%s bad candidate received",n.direction,a,o)}}}catch(o){var i;if(n.log.error("%s error parsing ICE candidate",n.direction,o),!0===(null===(i=n.signal)||void 0===i?void 0:i.aborted))throw o}};async function VD(e){let{peerConnection:t,signal:n,metrics:r,multiaddr:i,connectionManager:o,transportManager:s,log:a}=e;const{baseAddr:c}=function(e){const t=e.toString().split(GD+"/");if(2!==t.length)throw new tf("webrtc protocol was not present in multiaddr",$B.ERR_INVALID_MULTIADDR);if(!t[0].includes(KD))throw new tf("p2p-circuit protocol was not present in multiaddr",$B.ERR_INVALID_MULTIADDR);let n=Dg(t[0]);const r=Dg("/"+t[1]).getPeerId();if(null==r)throw new tf("destination peer id was missing",$B.ERR_INVALID_MULTIADDR);const i=n.protos().pop();if(void 0===i)throw new tf("invalid multiaddr",$B.ERR_INVALID_MULTIADDR);"p2p"!==i.name&&(n=n.encapsulate("/p2p/".concat(r)));return{baseAddr:n,peerId:tp(r)}}(i);null===r||void 0===r||r.dialerEvents.increment({open:!0}),a.trace("dialing base address: %a",c);const l=c.getPeerId();if(null==l)throw new tf("Relay peer was missing","ERR_INVALID_ADDRESS");const u=o.getConnections(tp(l));let d,h=!1;0===u.length?(d=await s.dial(c,{signal:n}),h=!0):d=u[0];try{const e=await d.newStream(WD,{signal:n,runOnTransientConnection:!0}),r=yP(e).pb(HD);try{const e=t.createDataChannel("init");t.onicecandidate=e=>{var t;let{candidate:i}=e;const o=JSON.stringify(null!==(t=null===i||void 0===i?void 0:i.toJSON())&&void 0!==t?t:null);a.trace("initiator sending ICE candidate %s",o),r.write({type:HD.Type.ICE_CANDIDATE,data:o},{signal:n}).catch((e=>{a.error("error sending ICE candidate",e)}))},t.onicecandidateerror=e=>{a.error("initiator ICE candidate error",e)};const o=await t.createOffer().catch((e=>{throw a.error("could not execute createOffer",e),new tf("Failed to set createOffer","ERR_SDP_HANDSHAKE_FAILED")}));a.trace("initiator send SDP offer %s",o.sdp),await r.write({type:HD.Type.SDP_OFFER,data:o.sdp},{signal:n}),await t.setLocalDescription(o).catch((e=>{throw a.error("could not execute setLocalDescription",e),new tf("Failed to set localDescription","ERR_SDP_HANDSHAKE_FAILED")}));const s=await r.read({signal:n});if(s.type!==HD.Type.SDP_ANSWER)throw new tf("Remote should send an SDP answer","ERR_SDP_HANDSHAKE_FAILED");a.trace("initiator receive SDP answer %s",s.data);const c=new UD({type:"answer",sdp:s.data});return await t.setRemoteDescription(c).catch((e=>{throw a.error("could not execute setRemoteDescription",e),new tf("Failed to set remoteDescription","ERR_SDP_HANDSHAKE_FAILED")})),a.trace("initiator read candidates until connected"),await zD(t,r,{direction:"initiator",signal:n,log:a}),a.trace("initiator connected, closing init channel"),e.close(),a.trace("initiator closing signalling stream"),await r.unwrap().unwrap().close({signal:n}),a.trace("initiator connected to remote address %s",i),{remoteAddress:i}}catch(f){throw t.close(),e.abort(f),f}finally{t.onicecandidate=null,t.onicecandidateerror=null}}finally{if(h)try{await d.close({signal:n})}catch(f){d.abort(f)}}}class qD extends Jh{constructor(e,t){super(),Dr(this,"peerId",void 0),Dr(this,"transportManager",void 0),Dr(this,"shutdownController",void 0),this.peerId=e.peerId,this.transportManager=e.transportManager,this.shutdownController=t.shutdownController}async listen(){this.safeDispatchEvent("listening",{})}getAddrs(){return this.transportManager.getListeners().filter((e=>e!==this)).map((e=>e.getAddrs().filter((e=>lP.matches(e))).map((e=>e.encapsulate("/webrtc/p2p/".concat(this.peerId)))))).flat()}async close(){this.shutdownController.abort(),this.safeDispatchEvent("close",{})}}const GD="/webrtc",KD="/p2p-circuit",WD="/webrtc-signaling/0.0.1";class QD{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Dr(this,"components",void 0),Dr(this,"init",void 0),Dr(this,"log",void 0),Dr(this,"_started",!1),Dr(this,"metrics",void 0),Dr(this,"shutdownController",void 0),Dr(this,Symbol.toStringTag,"@libp2p/webrtc"),Dr(this,rx,!0),this.components=e,this.init=t,this.log=e.logger.forComponent("libp2p:webrtc"),this.shutdownController=new AbortController,Wh(1/0,this.shutdownController.signal),null!=e.metrics&&(this.metrics={dialerEvents:e.metrics.registerCounterGroup("libp2p_webrtc_dialer_events_total",{label:"event",help:"Total count of WebRTC dialer events by type"}),listenerEvents:e.metrics.registerCounterGroup("libp2p_webrtc_listener_events_total",{label:"event",help:"Total count of WebRTC listener events by type"})})}isStarted(){return this._started}async start(){await this.components.registrar.handle(WD,(e=>{this._onProtocol(e).catch((t=>{this.log.error("failed to handle incoming connect from %p",e.connection.remotePeer,t)}))}),{runOnTransientConnection:!0}),this._started=!0}async stop(){await this.components.registrar.unhandle(WD),this._started=!1}createListener(e){return new qD(this.components,{shutdownController:this.shutdownController})}listenFilter(e){return e.filter(vm.exactMatch)}dialFilter(e){return this.listenFilter(e)}async dial(e,t){var n;this.log.trace("dialing address: %a",e);const r=new FD(this.init.rtcConfiguration),i=new DD(this.components,{peerConnection:r,dataChannelOptions:this.init.dataChannel}),{remoteAddress:o}=await VD({peerConnection:r,multiaddr:e,dataChannelOptions:this.init.dataChannel,signal:t.signal,connectionManager:this.components.connectionManager,transportManager:this.components.transportManager,log:this.log}),s=new CD(this.components,{peerConnection:r,timeline:{open:Date.now()},remoteAddr:o,metrics:null===(n=this.metrics)||void 0===n?void 0:n.dialerEvents}),a=await t.upgrader.upgradeOutbound(s,{skipProtection:!0,skipEncryption:!0,muxerFactory:i});return this._closeOnShutdown(r,s),a}async _onProtocol(e){var t;let{connection:n,stream:r}=e;const i=AbortSignal.timeout(null!==(t=this.init.inboundConnectionTimeout)&&void 0!==t?t:3e4),o=new FD(this.init.rtcConfiguration),s=new DD(this.components,{peerConnection:o,dataChannelOptions:this.init.dataChannel});try{var a;const{remoteAddress:e}=await async function(e){let{peerConnection:t,stream:n,signal:r,connection:i,log:o}=e;o.trace("new inbound signaling stream");const s=yP(n).pb(HD);try{t.onicecandidate=e=>{var t;let{candidate:n}=e;const i=JSON.stringify(null!==(t=null===n||void 0===n?void 0:n.toJSON())&&void 0!==t?t:null);o.trace("recipient sending ICE candidate %s",i),s.write({type:HD.Type.ICE_CANDIDATE,data:i},{signal:r}).catch((e=>{o.error("error sending ICE candidate",e)}))};const e=await s.read({signal:r});var a;if(e.type!==HD.Type.SDP_OFFER)throw new tf("expected message type SDP_OFFER, received: ".concat(null!==(a=e.type)&&void 0!==a?a:"undefined"," "),"ERR_SDP_HANDSHAKE_FAILED");o.trace("recipient receive SDP offer %s",e.data);const n=new UD({type:"offer",sdp:e.data});await t.setRemoteDescription(n).catch((e=>{throw o.error("could not execute setRemoteDescription",e),new tf("Failed to set remoteDescription","ERR_SDP_HANDSHAKE_FAILED")}));const i=await t.createAnswer().catch((e=>{throw o.error("could not execute createAnswer",e),new tf("Failed to create answer","ERR_SDP_HANDSHAKE_FAILED")}));o.trace("recipient send SDP answer %s",i.sdp),await s.write({type:HD.Type.SDP_ANSWER,data:i.sdp},{signal:r}),await t.setLocalDescription(i).catch((e=>{throw o.error("could not execute setLocalDescription",e),new tf("Failed to set localDescription","ERR_SDP_HANDSHAKE_FAILED")})),o.trace("recipient read candidates until connected"),await zD(t,s,{direction:"recipient",signal:r,log:o})}catch(l){if("connected"!==t.connectionState)throw o.error("error while handling signaling stream from peer %a",i.remoteAddr,l),t.close(),l;o("error while handling signaling stream from peer %a, ignoring as the RTCPeerConnection is already connected",i.remoteAddr,l)}const c=Dg("/webrtc/p2p/".concat(i.remoteAddr.getPeerId()));return o.trace("recipient connected to remote address %s",c),{remoteAddress:c}}({peerConnection:o,connection:n,stream:r,signal:i,log:this.log}),t=new CD(this.components,{peerConnection:o,timeline:{open:(new Date).getTime()},remoteAddr:e,metrics:null===(a=this.metrics)||void 0===a?void 0:a.listenerEvents});this._closeOnShutdown(o,t),await this.components.upgrader.upgradeInbound(t,{skipEncryption:!0,skipProtection:!0,muxerFactory:s}),await r.close({signal:i})}catch(c){throw r.abort(c),c}}_closeOnShutdown(e,t){const n=()=>{t.close().catch((e=>{this.log.error("could not close WebRTCMultiaddrConnection",e)}))};this.shutdownController.signal.addEventListener("abort",n),e.addEventListener("close",(()=>{this.shutdownController.signal.removeEventListener("abort",n)}))}}var YD=n(3180);const ZD=Object.values(Bs).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)));function JD(e,t){var n;const r=null===(n=e.getConfiguration().certificates)||void 0===n?void 0:n.at(0);if(null==r||null==r.getFingerprints){t.log.trace("fetching fingerprint from local SDP");const n=e.localDescription;if(null==n)return;return function(e){var t;const n=e.match(XD);return null===n||void 0===n||null===(t=n.groups)||void 0===t?void 0:t.fingerprint}(n.sdp)}if(t.log.trace("fetching fingerprint from local certificate"),0===r.getFingerprints().length)return;const i=r.getFingerprints()[0].value;if(null==i)throw cD("","no fingerprint on local certificate");return i}const XD=/^a=fingerprint:(?:\w+-[0-9]+)\s(?<fingerprint>(:?[0-9a-fA-F]{2})+)$/m;function $D(e){const t=e.stringTuples().filter((e=>e[0]===iO)).map((e=>e[1]))[0];if(void 0===t||""===t)throw iD("Couldn't find a certhash component of multiaddr: ".concat(e.toString()));return t}function eO(e){const t=ZD.decode(e);return YD.decode(t)}function tO(e){switch(e){case"sha1":return"sha-1";case"sha2-256":return"sha-256";case"sha2-512":return"sha-512";default:throw new uD(e)}}function nO(e,t){const{host:n,port:r}=e.toOptions(),i=function(e){for(const t of e.protoNames())if(t.startsWith("ip"))return t.toUpperCase();return"IP6"}(e),[o]=function(e){const t=eO($D(e)),n=tO(t.name),r=t.digest.reduce(((e,t)=>e+t.toString(16).padStart(2,"0")),""),i=r.match(/.{1,2}/g);if(null==i)throw cD(r,e.toString());return["".concat(n.toUpperCase()," ").concat(i.join(":").toUpperCase()),r]}(e);return"v=0\no=- 0 0 IN ".concat(i," ").concat(n,"\ns=-\nc=IN ").concat(i," ").concat(n,"\nt=0 0\na=ice-lite\nm=application ").concat(r," UDP/DTLS/SCTP webrtc-datachannel\na=mid:0\na=setup:passive\na=ice-ufrag:").concat(t,"\na=ice-pwd:").concat(t,"\na=fingerprint:").concat(o,"\na=sctp-port:5000\na=max-message-size:16384\na=candidate:1467250027 1 UDP 1467250027 ").concat(n," ").concat(r," typ host\r\n")}const rO=Array.from("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),iO=(ag("webrtc-direct").code,ag("certhash").code);class oO{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Dr(this,"log",void 0),Dr(this,"metrics",void 0),Dr(this,"components",void 0),Dr(this,"init",void 0),Dr(this,Symbol.toStringTag,"@libp2p/webrtc-direct"),Dr(this,rx,!0),this.log=e.logger.forComponent("libp2p:webrtc-direct"),this.components=e,this.init=t,null!=e.metrics&&(this.metrics={dialerEvents:e.metrics.registerCounterGroup("libp2p_webrtc-direct_dialer_events_total",{label:"event",help:"Total count of WebRTC-direct dial events by type"})})}async dial(e,t){const n=await this._connect(e,t);return this.log("dialing address: %a",e),n}createListener(e){throw new lD("WebRTCTransport.createListener")}listenFilter(e){return e.filter(hm.exactMatch)}dialFilter(e){return this.listenFilter(e)}async _connect(e,t){const n=new AbortController,r=n.signal,i=e.getPeerId();if(null===i)throw iD("we need to have the remote's PeerId");const o=tp(i),s=eO($D(e)),a=await FD.generateCertificate({name:"ECDSA",namedCurve:"P-256",hash:tO(s.name)}),c=new FD({certificates:[a]});try{var l,u,d,h;const i=new Promise(((e,t)=>{const n=c.createDataChannel("",{negotiated:!0,id:0}),r=setTimeout((()=>{var e;const r="Data channel was never opened: state: ".concat(n.readyState);this.log.error(r),null===(e=this.metrics)||void 0===e||e.dialerEvents.increment({open_error:!0}),t(nD("data",r))}),1e4);n.onopen=t=>{clearTimeout(r),e(n)},n.onerror=e=>{var n,i,o;clearTimeout(r);const s=null!==(n=null===(i=e.target)||void 0===i?void 0:i.toString())&&void 0!==n?n:"not specified",a="Error opening a data channel for handshaking: ".concat(s);this.log.error(a),null===(o=this.metrics)||void 0===o||o.dialerEvents.increment({unknown_error:!0}),t(nD("data",a))}})),a="libp2p+webrtc+v1/"+[...Array(32)].map((()=>rO.at(Math.floor(Math.random()*rO.length)))).join(""),f=function(e,t){if(void 0===e.sdp)throw sD("Can't munge a missing SDP");return e.sdp=e.sdp.replace(/\na=ice-ufrag:[^\n]*\n/,"\na=ice-ufrag:"+t+"\n").replace(/\na=ice-pwd:[^\n]*\n/,"\na=ice-pwd:"+t+"\n"),e}(await c.createOffer(),a);await c.setLocalDescription(f);const p=function(e,t){return{type:"answer",sdp:nO(e,t)}}(e,a);await c.setRemoteDescription(p);const g=await i,m=this.components.peerId,v=_C({prologueBytes:this.generateNoisePrologue(c,s.code,e)})(this.components),y=ND({channel:g,direction:"inbound",logger:this.components.logger,...null!==(l=this.init.dataChannel)&&void 0!==l?l:{}}),w={...y,sink:y.sink.bind(y),source:async function*(){for await(const e of y.source)for(const t of e)yield t}()},b=new CD(this.components,{peerConnection:c,remoteAddr:e,timeline:{open:Date.now()},metrics:null===(u=this.metrics)||void 0===u?void 0:u.dialerEvents}),E=xD?"iceconnectionstatechange":"connectionstatechange";c.addEventListener(E,(()=>{switch(c.connectionState){case"failed":case"disconnected":case"closed":b.close().catch((e=>{this.log.error("error closing connection",e)})).finally((()=>{n.abort()}))}}),{signal:r}),null===(d=this.metrics)||void 0===d||d.dialerEvents.increment({peer_connection:!0});const k=new DD(this.components,{peerConnection:c,metrics:null===(h=this.metrics)||void 0===h?void 0:h.dialerEvents,dataChannelOptions:this.init.dataChannel});return await v.secureInbound(m,w,o),await t.upgrader.upgradeOutbound(b,{skipProtection:!0,skipEncryption:!0,muxerFactory:k})}catch(f){throw c.close(),f}}generateNoisePrologue(e,t,n){var r;if(0===(null===(r=e.getConfiguration().certificates)||void 0===r?void 0:r.length))throw sD("no local certificate");const i=JD(e,{log:this.log});if(null==i)throw sD("no local fingerprint found");const o=Fs(i.trim().toLowerCase().replaceAll(":",""),"hex"),s=YD.encode(o,t),a=ZD.decode($D(n));return Hr([Fs("libp2p-webrtc-noise:"),s,a])}}function sO(e){return t=>new oO(t,e)}function aO(e){return t=>new QD(t,e)}const cO=async e=>{if(e.readyState>=2)throw new Error("socket closed");1!==e.readyState&&await new Promise(((t,n)=>{function r(){e.removeEventListener("open",i),e.removeEventListener("error",o)}function i(){r(),t()}function o(t){var i;r(),n(null!==(i=t.error)&&void 0!==i?i:new Error("connect ECONNREFUSED ".concat(e.url)))}e.addEventListener("open",i),e.addEventListener("error",o)}))},lO=(e,t)=>{var n;(t=null!==(n=t)&&void 0!==n?n:{}).closeOnEnd=!1!==t.closeOnEnd;return async n=>{for await(const t of n){try{await cO(e)}catch(r){if("socket closed"===r.message)break;throw r}if(e.readyState===e.CLOSING||e.readyState===e.CLOSED)break;e.send(t)}null!=t.closeOnEnd&&e.readyState<=1&&await new Promise(((t,n)=>{e.addEventListener("close",(e=>{if(e.wasClean||1006===e.code)t();else{const t=Object.assign(new Error("ws error"),{event:e});n(t)}})),setTimeout((()=>{e.close()}))}))}};var uO=n(2605);function dO(e){var t;return e instanceof ArrayBuffer||"ArrayBuffer"===(null===e||void 0===e||null===(t=e.constructor)||void 0===t?void 0:t.name)&&"number"===typeof(null===e||void 0===e?void 0:e.byteLength)}const hO=(e,t)=>{var n;t=null!==(n=t)&&void 0!==n?n:{};const r=(e=>{e.binaryType="arraybuffer";const t=async()=>{await new Promise(((t,n)=>{if(i)return void t();if(null!=r)return void n(r);const o=t=>{e.removeEventListener("open",s),e.removeEventListener("error",a),t()},s=()=>{o(t)},a=t=>{o((()=>{var r;n(null!==(r=t.error)&&void 0!==r?r:new Error("connect ECONNREFUSED ".concat(e.url)))}))};e.addEventListener("open",s),e.addEventListener("error",a)}))},n=async function*(){const n=new uO.PP((t=>{let{push:n,stop:r,fail:i}=t;const o=e=>{let t=null;"string"===typeof e.data&&(t=Fs(e.data)),dO(e.data)&&(t=new Uint8Array(e.data)),e.data instanceof Uint8Array&&(t=e.data),null!=t&&n(t)},s=e=>{var t;i(null!==(t=e.error)&&void 0!==t?t:new Error("Socket error"))};return e.addEventListener("message",o),e.addEventListener("error",s),e.addEventListener("close",r),()=>{e.removeEventListener("message",o),e.removeEventListener("error",s),e.removeEventListener("close",r)}}),{highWaterMark:1/0});await t();for await(const e of n)yield dO(e)?new Uint8Array(e):e}();let r,i=1===e.readyState;return e.addEventListener("open",(()=>{i=!0,r=null})),e.addEventListener("close",(()=>{i=!1,r=null})),e.addEventListener("error",(t=>{var n;i||(r=null!==(n=t.error)&&void 0!==n?n:new Error("connect ECONNREFUSED ".concat(e.url)))})),Object.assign(n,{connected:t})})(e);let i=t.remoteAddress,o=t.remotePort;if(null!=e.url)try{const t=new URL(e.url);i=t.hostname,o=parseInt(t.port,10)}catch{}if(null==i||null==o)throw new Error("Remote connection did not have address and/or port");const s={sink:lO(e,t),source:r,connected:async()=>{await r.connected()},close:async()=>{e.readyState!==e.CONNECTING&&e.readyState!==e.OPEN||await new Promise((t=>{e.addEventListener("close",(()=>{t()})),e.close()}))},destroy:()=>{null!=e.terminate?e.terminate():e.close()},remoteAddress:i,remotePort:o,socket:e};return s},fO=WebSocket,pO={"http:":"ws:","https:":"wss:"};function gO(e,t){var n;t=null!==(n=t)&&void 0!==n?n:{};const r=((e,t)=>{var n;if(e.startsWith("//")&&(e="".concat(null!==(n=null===t||void 0===t?void 0:t.protocol)&&void 0!==n?n:"ws:").concat(e)),e.startsWith("/")&&null!=t){var r;const n=null!==(r=t.protocol)&&void 0!==r?r:"ws:",i=t.host,o=null!=t.port&&!0!==(null===i||void 0===i?void 0:i.endsWith(":".concat(t.port)))?":".concat(t.port):"";e="".concat(n,"//").concat(i).concat(o).concat(e)}const i=new URL(e);for(const[o,s]of Object.entries(pO))i.protocol===o&&(i.protocol=s);return i})(e,"undefined"===typeof window?void 0:window.location),i=new fO(r.toString(),t.websocket);return hO(i,t)}class mO{constructor(e,t){Dr(this,"log",void 0),Dr(this,"init",void 0),Dr(this,"logger",void 0),Dr(this,Symbol.toStringTag,"@libp2p/websockets"),Dr(this,rx,!0),this.log=e.logger.forComponent("libp2p:websockets"),this.logger=e.logger,this.init=t}async dial(e,t){var n;this.log("dialing %s",e),t=null!==(n=t)&&void 0!==n?n:{};const r=function(e,t,n){const r=n.logger.forComponent("libp2p:websockets:maconn"),i={log:r,async sink(t){try{await e.sink(async function*(){for await(const e of t)e instanceof Uint8Array?yield e:yield e.subarray()}())}catch(n){"aborted"!==n.type&&r.error(n)}},source:e.source,remoteAddr:t,timeline:{open:Date.now()},async close(){var t;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const o=Date.now();if(null==n.signal){const e=AbortSignal.timeout(500);n={...n,signal:e}}const s=()=>{const{host:e,port:t}=i.remoteAddr.toOptions();r("timeout closing stream to %s:%s after %dms, destroying it manually",e,t,Date.now()-o),this.abort(new tf("Socket close timeout","ERR_SOCKET_CLOSE_TIMEOUT"))};null===(t=n.signal)||void 0===t||t.addEventListener("abort",s);try{await e.close()}catch(c){r.error("error closing WebSocket gracefully",c),this.abort(c)}finally{var a;null===(a=n.signal)||void 0===a||a.removeEventListener("abort",s),i.timeline.close=Date.now()}},abort(t){const{host:n,port:o}=i.remoteAddr.toOptions();r("timeout closing stream to %s:%s due to error",n,o,t),e.destroy(),i.timeline.close=Date.now()}};return e.socket.addEventListener("close",(()=>{null==i.timeline.close&&(i.timeline.close=Date.now())}),{once:!0}),i}(await this._connect(e,t),e,{logger:this.logger});this.log("new outbound connection %s",r.remoteAddr);const i=await t.upgrader.upgradeOutbound(r);return this.log("outbound connection %s upgraded",r.remoteAddr),i}async _connect(e,t){var n;if(!0===(null===t||void 0===t||null===(n=t.signal)||void 0===n?void 0:n.aborted))throw new ef;const r=e.toOptions();this.log("dialing %s:%s",r.host,r.port);const i=ou(),o=gO(xm(e),this.init);if(o.socket.addEventListener("error",(()=>{const t=new tf("Could not connect to ".concat(e.toString()),"ERR_CONNECTION_FAILED");this.log.error("connection error:",t),i.reject(t)})),null==t.signal)return await Promise.race([o.connected(),i.promise]),this.log("connected %s",e),o;let s;const a=new Promise(((e,n)=>{var r,i;s=()=>{n(new ef),o.close().catch((e=>{this.log.error("error closing raw socket",e)}))},!0!==(null===t||void 0===t||null===(r=t.signal)||void 0===r?void 0:r.aborted)?null===t||void 0===t||null===(i=t.signal)||void 0===i||i.addEventListener("abort",s):s()}));try{await Promise.race([a,i.promise,o.connected()])}finally{var c;if(null!=s)null===t||void 0===t||null===(c=t.signal)||void 0===c||c.removeEventListener("abort",s)}return this.log("connected %s",e),o}createListener(e){return function(){throw new Error("WebSocket Servers can not be created in the browser!")}(this.logger,this.init)}listenFilter(e){var t,n;return e=Array.isArray(e)?e:[e],null!=(null===(t=this.init)||void 0===t?void 0:t.filter)?null===(n=this.init)||void 0===n?void 0:n.filter(e):iN||cN?function(e){return e.filter((e=>{if(e.protoCodes().includes(290))return!1;const t=e.decapsulateCode(421);return ZT.matches(t)}))}(e):function(e){return e.filter((e=>{if(e.protoCodes().includes(290))return!1;const t=e.decapsulateCode(421);return QT.matches(t)||ZT.matches(t)}))}(e)}dialFilter(e){return this.listenFilter(e)}}function vO(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>new mO(t,e)}class yO extends YC{constructor(e){super(e),Dr(this,"writer",void 0),Dr(this,"reader",void 0),this.writer=e.bidiStream.writable.getWriter(),this.reader=e.bidiStream.readable.getReader(),Promise.resolve().then((async()=>{for(;;){const t=await this.reader.read();if(t.done)return void e.log("remote closed write");null!=t.value&&this.sourcePush(new Kr(t.value))}})).catch((t=>{e.log.error("error reading from stream",t),this.abort(t)})).finally((()=>{this.remoteCloseWrite()})),this.writer.closed.then((()=>{e.log("writer closed")})).catch((t=>{e.log("writer close promise rejected",t)})).finally((()=>{this.remoteCloseRead()}))}sendNewStream(e){}async sendData(e,t){for await(const n of e)this.log("sendData waiting for writer to be ready"),await hf(this.writer.ready,null===t||void 0===t?void 0:t.signal),this.writer.write(n).catch((e=>{this.log.error("error sending stream data",e)}))}async sendReset(e){this.log("sendReset aborting writer"),await hf(this.writer.abort(),null===e||void 0===e?void 0:e.signal),this.log("sendReset aborted writer")}async sendCloseWrite(e){this.log("sendCloseWrite closing writer"),await hf(this.writer.close(),null===e||void 0===e?void 0:e.signal),this.log("sendCloseWrite closed writer")}async sendCloseRead(e){this.log("sendCloseRead cancelling reader"),await hf(this.reader.cancel(),null===e||void 0===e?void 0:e.signal),this.log("sendCloseRead cancelled reader")}}async function wO(e,t,n,r,i,o){const s=o.forComponent("libp2p:webtransport:stream:".concat(n,":").concat(t)),a=new yO({bidiStream:e,id:t,direction:n,log:s,onEnd:()=>{const e=r.findIndex((e=>e===a));-1!==e&&r.splice(e,1),null===i||void 0===i||i(a)}});return a}function bO(){return{source:{[Symbol.asyncIterator]:()=>({next:async()=>new Promise((()=>{}))})},sink:async e=>new Promise((()=>{}))}}function EO(e,t,n,r){let i=0;const o=n.forComponent("libp2p:webtransport:muxer");return{protocol:"webtransport",createStreamMuxer:s=>{"function"===typeof s&&(s={onIncomingStream:s});const a=[];Promise.resolve().then((async()=>{for(;;){const{done:d,value:h}=await t.read();if(d)break;if(a.length>=r.maxInboundStreams)o("too many inbound streams open - ".concat(a.length,"/").concat(r.maxInboundStreams,", closing new incoming stream")),h.writable.close().catch((e=>{o.error("failed to close inbound stream that crossed our maxInboundStream limit: ".concat(e.message))})),h.readable.cancel().catch((e=>{o.error("failed to close inbound stream that crossed our maxInboundStream limit: ".concat(e.message))}));else{var e,c,l,u;const t=await wO(h,String(i++),"inbound",a,null===(e=s)||void 0===e?void 0:e.onStreamEnd,n);a.push(t),null===(c=s)||void 0===c||null===(l=(u=c).onIncomingStream)||void 0===l||l.call(u,t)}}}));return{protocol:"webtransport",streams:a,newStream:async t=>{var r,c,l;o("new outgoing stream",t);const u=await e.createBidirectionalStream(),d=await wO(u,String(i++),null!==(r=null===(c=s)||void 0===c?void 0:c.direction)&&void 0!==r?r:"outbound",a,null===(l=s)||void 0===l?void 0:l.onStreamEnd,n);return a.push(d),d},close:async()=>{o("closing webtransport muxer gracefully"),e.close()},abort:t=>{o("closing webtransport muxer with err:",t),e.close()},...bO()}}}}const kO=Object.values(Bs).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)));function AO(e){var t;if(!pm.matches(e))throw new tf("Invalid multiaddr, was not a WebTransport address","ERR_INVALID_MULTIADDR");const n=e.stringTuples(),r=n.filter((e=>{let[t,n]=e;return t===ag("certhash").code})).map((e=>{let[t,n]=e;return r=null!==n&&void 0!==n?n:"",Ui(kO.decode(r));var r})),i=n.filter((e=>{let[t,n]=e;return t===ag("p2p").code})).map((e=>{let[t,n]=e;return tp(null!==n&&void 0!==n?n:"")}))[0],o=e.toOptions();let s=o.host;return 6===o.family&&null!==(t=s)&&void 0!==t&&t.includes(":")&&(s="[".concat(s,"]")),{url:"https://".concat(s,":").concat(o.port),certhashes:r,remotePeer:i}}const SO=WebTransport;class xO{constructor(e){var t,n;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Dr(this,"log",void 0),Dr(this,"components",void 0),Dr(this,"config",void 0),Dr(this,"metrics",void 0),Dr(this,Symbol.toStringTag,"@libp2p/webtransport"),Dr(this,rx,!0),this.log=e.logger.forComponent("libp2p:webtransport"),this.components=e,this.config={...r,maxInboundStreams:null!==(t=r.maxInboundStreams)&&void 0!==t?t:1e3,certificates:null!==(n=r.certificates)&&void 0!==n?n:[]},null!=e.metrics&&(this.metrics={dialerEvents:e.metrics.registerCounterGroup("libp2p_webtransport_dialer_events_total",{label:"event",help:"Total count of WebTransport dialer events by type"})})}async dial(e,t){var n,r;if(!0===(null===(n=t)||void 0===n||null===(n=n.signal)||void 0===n?void 0:n.aborted))throw new ef;this.log("dialing %s",e);const i=this.components.peerId;if(void 0===i)throw new tf("Need a local peerid","ERR_INVALID_PARAMETERS");t=null!==(r=t)&&void 0!==r?r:{};const{url:o,certhashes:s,remotePeer:a}=AO(e);if(null==a)throw new tf("Need a target peerid","ERR_INVALID_PARAMETERS");if(0===s.length)throw new tf("Expected multiaddr to contain certhashes","ERR_INVALID_PARAMETERS");let c,l,u=()=>{},d=!1,h=!1,f=!1;try{var p,g,m,v;null===(p=this.metrics)||void 0===p||p.dialerEvents.increment({pending:!0});const n=new SO("".concat(o,"/.well-known/libp2p-webtransport?type=noise"),{serverCertificateHashes:s.map((e=>({algorithm:"sha-256",value:e.digest})))});if(u=e=>{if(!d)try{var t;null===(t=this.metrics)||void 0===t||t.dialerEvents.increment({[e]:!0}),n.close()}catch(r){this.log.error("error closing wt session",r)}finally{null!=l&&(l.timeline.close=Date.now()),d=!0}},c=()=>{u(h?"noise_timeout":"ready_timeout")},null===(g=t.signal)||void 0===g||g.addEventListener("abort",c,{once:!0}),this.log("wait for session to be ready"),await Promise.race([n.closed,n.ready]),this.log("session became ready"),h=!0,null===(m=this.metrics)||void 0===m||m.dialerEvents.increment({ready:!0}),n.closed.catch((e=>{this.log.error("error on remote wt session close",e)})).finally((()=>{u("remote_close")})),f=await hf(this.authenticateWebTransport(n,i,a,s),t.signal),!f)throw new tf("Failed to authenticate webtransport","ERR_AUTHENTICATION_FAILED");return null===(v=this.metrics)||void 0===v||v.dialerEvents.increment({open:!0}),l={close:async()=>{this.log("closing webtransport"),u("close")},abort:e=>{this.log("aborting webtransport due to passed err",e),u("abort")},remoteAddr:e,timeline:{open:Date.now()},log:this.components.logger.forComponent("libp2p:webtransport:maconn"),...bO()},await t.upgrader.upgradeOutbound(l,{skipEncryption:!0,muxerFactory:EO(n,n.incomingBidirectionalStreams.getReader(),this.components.logger,this.config),skipProtection:!0})}catch(w){throw this.log.error("caught wt session err",w),u(f?"upgrade_error":h?"noise_error":"ready_error"),w}finally{var y;if(null!=c)null===(y=t.signal)||void 0===y||y.removeEventListener("abort",c)}}async authenticateWebTransport(e,t,n,r,i){var o;if(!0===(null===i||void 0===i?void 0:i.aborted))throw new ef;const s=await e.createBidirectionalStream(),a=s.writable.getWriter(),c=s.readable.getReader(),l={source:async function*(){for(;;){const e=await c.read();if(null!=e.value&&(yield e.value),e.done)break}}(),sink:async e=>{for await(const t of e){await hf(a.ready,i);const e=t instanceof Uint8Array?t:t.subarray();a.write(e).catch((e=>{this.log.error("could not write chunk during authentication of WebTransport stream",e)}))}}},u=_C()(this.components),{remoteExtensions:d}=await u.secureOutbound(t,l,n);if(a.close().catch((e=>{this.log.error("Failed to close authentication stream writer: ".concat(e.message))})),c.cancel().catch((e=>{this.log.error("Failed to close authentication stream reader: ".concat(e.message))})),h=null!==(o=null===d||void 0===d?void 0:d.webtransportCerthashes)&&void 0!==o?o:[],(f=r.map((e=>e.bytes))).filter((e=>Boolean(h.find((t=>zr(e,t)))))).length!==f.length)throw new Error("Our certhashes are not a subset of the remote's reported certhashes");var h,f;return!0}createListener(e){return function(e){throw new Error("Not implemented")}(this.components,(this.config.certificates,this.config.maxInboundStreams))}listenFilter(){return[]}dialFilter(e){return e.filter((e=>{if(!pm.exactMatch(e))return!1;const{url:t,certhashes:n,remotePeer:r}=AO(e);return null!=t&&null!=r&&n.length>0}))}}function _O(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>new xO(t,e)}function IO(e,t){const n=t.map(((e,t)=>({record:hT(e),index:t})));return n.sort(((e,t)=>{const n=e.record.sequence,r=t.record.sequence;if(n>r)return-1;if(n<r)return 1;if(e.record.validityType===aT.ValidityType.EOL&&t.record.validityType===aT.ValidityType.EOL){const n=vT.fromString(e.record.validity).toDate(),r=vT.fromString(t.record.validity).toDate();if(n.getTime()>r.getTime())return-1;if(n.getTime()<r.getTime())return 1}return 0})),n[0].index}const RO="4.2.1",CO="helia",TO={list:["/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN","/dnsaddr/bootstrap.libp2p.io/p2p/QmbLHAnMoJPWSCR5Zhtx6BHJX9KiKNN6tpvbUcqanj75Nb","/dnsaddr/bootstrap.libp2p.io/p2p/QmcZf59bWwK5XFi76CZX8cbJ4BhTzzA3gU1ZjYZcYW3dwt","/ip4/104.131.131.82/tcp/4001/p2p/QmaCpDMGvV2BGHeYERUEnRQAwe3N8SzbUtfsmvsqQLuvuJ"]};function PO(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t="".concat(CO,"/").concat(RO," ").concat(r_,"/").concat(n_," UserAgent=").concat(globalThis.navigator.userAgent);return{peerId:e.peerId,dns:e.dns,addresses:{listen:["/webrtc"]},transports:[qP({discoverRelays:1}),aO(),sO(),_O(),vO()],connectionEncryption:[_C()],streamMuxers:[tT(),YB()],peerDiscovery:[mP(TO)],services:{autoNAT:LT(),dcutr:$P(),delegatedRouting:()=>function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new NT(new URL(e),t)}("https://delegated-ipfs.dev"),dht:DB({clientMode:!0,validators:{ipns:ET},selectors:{ipns:IO}}),identify:gN({agentVersion:t}),identifyPush:mN({agentVersion:t}),keychain:gS(e.keychain),ping:XB()}}}async function NO(e){var t,n,r,i;const o=null===(t=e.libp2p)||void 0===t?void 0:t.peerId,s=null!==(n=e.logger)&&void 0!==n?n:Od(),a=new Dv("/pkcs8/self");let c;var l;null==o&&null!=e.datastore&&(c=gS(e.keychain)({datastore:e.datastore,logger:s}),await e.datastore.has(a)&&(e.libp2p=null!==(l=e.libp2p)&&void 0!==l?l:{},e.libp2p.peerId=await c.exportPeerId("self")));const u=PO(e);u.datastore=null!==(r=u.datastore)&&void 0!==r?r:e.datastore,e=null!==(i=e)&&void 0!==i?i:{};const d=await async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=await c_(e);return!1!==e.start&&await t.start(),t}({...u,...e.libp2p,start:!1});return null!=o||null==c||await e.datastore.has(a)||await c.importPeer("self",d.peerId),d}const BO=4001,DO=4100,OO=4200,LO=4900,MO=4901,FO=-32700,UO=-32600,jO=-32601,HO=-32602,zO=-32603,VO=-32e3,qO=-32001,GO=-32002,KO=-32003,WO=-32004,QO=-32005,YO=-32006;class ZO extends Error{constructor(e,t){super(e),this.innerError=t,this.name=this.constructor.name,"function"===typeof Error.captureStackTrace?Error.captureStackTrace(new.target.constructor):this.stack=(new Error).stack}static convertToString(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(null===e||void 0===e)return"undefined";const n=JSON.stringify(e,((e,t)=>"bigint"===typeof t?t.toString():t));return t&&["bigint","string"].includes(typeof e)?n.replace(/['\\"]+/g,""):n}toJSON(){return{name:this.name,code:this.code,message:this.message,innerError:this.innerError}}}class JO extends ZO{constructor(e,t){super('Invalid value given "'.concat(ZO.convertToString(e,!0),'". Error: ').concat(t,".")),this.name=this.constructor.name}}class XO extends ZO{constructor(){super("Private key must be 32 bytes."),this.code=701}}class $O extends ZO{constructor(){super("Invalid Private Key, Not a valid string or uint8Array"),this.code=702}}class eL extends ZO{constructor(e){super('"'.concat(e,'"')),this.code=802}}class tL extends ZO{constructor(){super("Invalid key derivation function"),this.code=703}}class nL extends ZO{constructor(){super("Key derivation failed - possibly wrong password"),this.code=704}}class rL extends ZO{constructor(){super("Unsupported key store version"),this.code=705}}class iL extends ZO{constructor(){super("Password cannot be empty"),this.code=706}}class oL extends ZO{constructor(){super("Initialization vector must be 16 bytes"),this.code=707}}class sL extends ZO{constructor(){super("c > 1000, pbkdf2 is less secure with less iterations"),this.code=709}}class aL extends ZO{constructor(e,t){super(e),this.code=500,t&&(this.errorCode=t.code,this.errorReason=t.reason)}toJSON(){return Object.assign(Object.assign({},super.toJSON()),{errorCode:this.errorCode,errorReason:this.errorReason})}}class cL extends aL{constructor(e){super("Connection not open",e),this.code=503}}class lL extends aL{constructor(e){super("Maximum number of reconnect attempts reached! (".concat(e,")")),this.code=505}}class uL extends aL{constructor(){super("CONNECTION ERROR: Provider started to reconnect before the response got received!"),this.code=506}}class dL extends aL{constructor(e){super("Request already sent with following id: ".concat(e)),this.code=507}}class hL extends ZO{constructor(e,t){super(e),this.code=300,this.receipt=t}}class fL extends ZO{constructor(e,t){super("The resolver at ".concat(e,' does not implement requested method: "').concat(t,'".')),this.address=e,this.name=t,this.code=301}toJSON(){return Object.assign(Object.assign({},super.toJSON()),{address:this.address,name:this.name})}}class pL extends hL{constructor(e){if(super(e.message||"Error"),this.name="name"in e&&e.name||this.constructor.name,this.stack="stack"in e&&e.stack||void 0,this.code=e.code,"object"===typeof e.data){let t;t="originalError"in e.data?e.data.originalError:e.data,this.data=t.data,this.innerError=new pL(t)}else this.data=e.data}setDecodedProperties(e,t,n){this.errorName=e,this.errorSignature=t,this.errorArgs=n}toJSON(){let e=Object.assign(Object.assign({},super.toJSON()),{data:this.data});return this.errorName&&(e=Object.assign(Object.assign({},e),{errorName:this.errorName,errorSignature:this.errorSignature,errorArgs:this.errorArgs})),e}}class gL extends hL{constructor(e){super("Error happened while trying to execute a function inside a smart contract"),this.code=310,this.innerError=new pL(e)}}class mL extends JO{constructor(e){var t,n;super("data: ".concat(null!==(t=e.data)&&void 0!==t?t:"undefined",", input: ").concat(null!==(n=e.input)&&void 0!==n?n:"undefined"),'You can\'t have "data" and "input" as properties of a contract at the same time, please use either "data" or "input" instead.'),this.code=311}}class vL extends ZO{constructor(e){super("ENS is not supported on network ".concat(e)),this.code=902}}class yL extends ZO{constructor(){super("Network not synced"),this.code=903}}class wL extends ZO{constructor(e){super('Invalid parameters passed. "'.concat("undefined"!==typeof e?e:"",'"')),this.hint=e,this.code=207}toJSON(){return Object.assign(Object.assign({},super.toJSON()),{hint:this.hint})}}class bL extends ZO{constructor(){super(...arguments),this.code=201}}class EL extends ZO{constructor(){super("The method you're trying to call is not implemented."),this.code=202}}class kL extends ZO{constructor(){super(...arguments),this.code=203}}class AL extends ZO{constructor(){super(...arguments),this.code=204}}class SL extends ZO{constructor(e,t){super(e),this.code=205,this.props=null!==t&&void 0!==t?t:{}}}class xL extends ZO{constructor(e){super("A plugin with the namespace: ".concat(e," has already been registered.")),this.code=206}}class _L extends ZO{constructor(){super(...arguments),this.code=600}}class IL extends ZO{constructor(e){super('Client URL "'.concat(e,'" is invalid.')),this.code=602}}class RL extends ZO{constructor(){super(...arguments),this.code=603}}class CL extends ZO{constructor(){super(...arguments),this.code=604}}class TL extends JO{constructor(){super(...arguments),this.code=801}}class PL extends ZO{constructor(e,t){super(e),this.receipt=t,this.code=400}toJSON(){return Object.assign(Object.assign({},super.toJSON()),{receipt:this.receipt})}}class NL extends ZO{constructor(e,t,n,r){super("Transaction has been reverted by the EVM".concat(void 0===n?"":":\n ".concat(ZO.convertToString(n)))),this.reason=e,this.signature=t,this.receipt=n,this.data=r,this.code=402}toJSON(){return Object.assign(Object.assign({},super.toJSON()),{reason:this.reason,signature:this.signature,receipt:this.receipt,data:this.data})}}class BL extends NL{constructor(e,t,n,r,i,o,s){super(e),this.reason=e,this.customErrorName=t,this.customErrorDecodedSignature=n,this.customErrorArguments=r,this.signature=i,this.receipt=o,this.data=s,this.code=438}toJSON(){return Object.assign(Object.assign({},super.toJSON()),{reason:this.reason,customErrorName:this.customErrorName,customErrorDecodedSignature:this.customErrorDecodedSignature,customErrorArguments:this.customErrorArguments,signature:this.signature,receipt:this.receipt,data:this.data})}}class DL extends PL{constructor(e){super("Transaction has been reverted by the EVM".concat(void 0===e?"":":\n ".concat(ZO.convertToString(e))),e),this.code=405}}class OL extends PL{constructor(){super("Raw transaction undefined"),this.code=407}}class LL extends PL{constructor(){super("Transaction not found"),this.code=430}}class ML extends JO{constructor(e){super(e,"invalid transaction with invalid sender"),this.code=408}}class FL extends JO{constructor(e){super(e,"invalid transaction with invalid receiver"),this.code=437}}class UL extends JO{constructor(){super("MissingCustomChainError","If tx.common is provided it must have tx.common.customChain"),this.code=410}}class jL extends JO{constructor(){super("MissingCustomChainIdError","If tx.common is provided it must have tx.common.customChain and tx.common.customChain.chainId"),this.code=411}}class HL extends JO{constructor(e){super(JSON.stringify(e),"Chain Id doesnt match in tx.chainId tx.common.customChain.chainId"),this.code=412}}class zL extends JO{constructor(e){super(JSON.stringify(e),"Chain doesnt match in tx.chain tx.common.basechain"),this.code=435}}class VL extends JO{constructor(e){super(JSON.stringify(e),"hardfork doesnt match in tx.hardfork tx.common.hardfork"),this.code=436}}class qL extends JO{constructor(){super("CommonOrChainAndHardforkError","Please provide the common object or the chain and hardfork property but not all together."),this.code=413}}class GL extends JO{constructor(e){var t,n;super("MissingChainOrHardforkError",'When specifying chain and hardfork, both values must be defined. Received "chain": '.concat(null!==(t=e.chain)&&void 0!==t?t:"undefined",', "hardfork": ').concat(null!==(n=e.hardfork)&&void 0!==n?n:"undefined")),this.code=414}}class KL extends ZO{constructor(){super('Missing properties in transaction, either define "gas" and "gasPrice" for type 0 transactions or "gas", "maxPriorityFeePerGas" and "maxFeePerGas" for type 2 transactions'),this.code=440}}class WL extends JO{constructor(e){var t,n,r,i;super("gas: ".concat(null!==(t=e.gas)&&void 0!==t?t:"undefined",", gasPrice: ").concat(null!==(n=e.gasPrice)&&void 0!==n?n:"undefined",", maxPriorityFeePerGas: ").concat(null!==(r=e.maxPriorityFeePerGas)&&void 0!==r?r:"undefined",", maxFeePerGas: ").concat(null!==(i=e.maxFeePerGas)&&void 0!==i?i:"undefined"),'"gas" is missing'),this.code=415,this.innerError=new KL}}class QL extends ZO{constructor(){super('Missing properties in transaction, either define "gas" and "gasPrice" for type 0 transactions or "gas", "maxPriorityFeePerGas" and "maxFeePerGas" for type 2 transactions, not both'),this.code=441}}class YL extends JO{constructor(e){var t,n,r,i;super("gas: ".concat(null!==(t=e.gas)&&void 0!==t?t:"undefined",", gasPrice: ").concat(null!==(n=e.gasPrice)&&void 0!==n?n:"undefined",", maxPriorityFeePerGas: ").concat(null!==(r=e.maxPriorityFeePerGas)&&void 0!==r?r:"undefined",", maxFeePerGas: ").concat(null!==(i=e.maxFeePerGas)&&void 0!==i?i:"undefined"),"transaction must specify legacy or fee market gas properties, not both"),this.code=434,this.innerError=new QL}}class ZL extends JO{constructor(e){var t,n;super("gas: ".concat(null!==(t=e.gas)&&void 0!==t?t:"undefined",", gasPrice: ").concat(null!==(n=e.gasPrice)&&void 0!==n?n:"undefined"),"Gas or gasPrice is lower than 0"),this.code=416}}class JL extends JO{constructor(e){var t,n;super("maxPriorityFeePerGas: ".concat(null!==(t=e.maxPriorityFeePerGas)&&void 0!==t?t:"undefined",", maxFeePerGas: ").concat(null!==(n=e.maxFeePerGas)&&void 0!==n?n:"undefined"),"maxPriorityFeePerGas or maxFeePerGas is lower than 0"),this.code=417}}class XL extends JO{constructor(e){super(e,"eip-1559 transactions don't support gasPrice"),this.code=418}}class $L extends JO{constructor(e){var t,n;super("maxPriorityFeePerGas: ".concat(null!==(t=e.maxPriorityFeePerGas)&&void 0!==t?t:"undefined",", maxFeePerGas: ").concat(null!==(n=e.maxFeePerGas)&&void 0!==n?n:"undefined"),"pre-eip-1559 transaction don't support maxFeePerGas/maxPriorityFeePerGas"),this.code=419}}class eM extends JO{constructor(e){super(e,"invalid transaction object"),this.code=420}}class tM extends JO{constructor(e){var t,n;super("nonce: ".concat(null!==(t=e.nonce)&&void 0!==t?t:"undefined",", chainId: ").concat(null!==(n=e.chainId)&&void 0!==n?n:"undefined"),"Nonce or chainId is lower than 0"),this.code=421}}class nM extends JO{constructor(){super("UnableToPopulateNonceError","unable to populate nonce, no from address available"),this.code=422}}class rM extends JO{constructor(){super("Eip1559NotSupportedError","Network doesn't support eip-1559"),this.code=423}}class iM extends JO{constructor(e){super(e,"unsupported transaction type"),this.code=424}}class oM extends JO{constructor(e){var t,n;super("data: ".concat(null!==(t=e.data)&&void 0!==t?t:"undefined",", input: ").concat(null!==(n=e.input)&&void 0!==n?n:"undefined"),'You can\'t have "data" and "input" as properties of transactions at the same time, please use either "data" or "input" instead.'),this.code=425}}class sM extends ZO{constructor(e){super("The connected Ethereum Node did not respond within ".concat(e.numberOfSeconds," seconds, please make sure your transaction was properly sent and you are connected to a healthy Node. Be aware that transaction might still be pending or mined!\n\tTransaction Hash: ").concat(e.transactionHash?e.transactionHash.toString():"not available")),this.code=431}}function aM(e){return"Please make sure your transaction was properly sent and there are no previous pending transaction for the same account. However, be aware that it might still be mined!\n\tTransaction Hash: ".concat(e?e.toString():"not available")}class cM extends ZO{constructor(e){super("Transaction was not mined within ".concat(e.numberOfSeconds," seconds. ").concat(aM(e.transactionHash))),this.code=426}}class lM extends ZO{constructor(e){super("Transaction started at ".concat(e.starterBlockNumber," but was not mined within ").concat(e.numberOfBlocks," blocks. ").concat(aM(e.transactionHash))),this.code=432}}class uM extends JO{constructor(e){var t,n;super("receipt: ".concat(JSON.stringify(e.receipt),", blockHash: ").concat(null===(t=e.blockHash)||void 0===t?void 0:t.toString(),", transactionHash: ").concat(null===(n=e.transactionHash)||void 0===n?void 0:n.toString()),"Receipt missing or blockHash null"),this.code=427}}class dM extends JO{constructor(e){super("receipt: ".concat(JSON.stringify(e.receipt)),"Receipt missing block number"),this.code=428}}class hM extends ZO{constructor(e){super('Invalid signature. "'.concat(e,'"')),this.code=433}}class fM extends JO{constructor(){super("LocalWalletNotAvailableError","Attempted to index account in local wallet, but no wallet is available"),this.code=429}}class pM extends ZO{constructor(e,t){const n=[];e.forEach((e=>n.push(e.keyword))),super("The following properties are invalid for the transaction type ".concat(t,": ").concat(n.join(", "))),this.code=439}}class gM extends JO{constructor(e){super(e,"can not parse as byte data"),this.code=1002}}class mM extends JO{constructor(e){super(e,"can not parse as number data"),this.code=1003}}class vM extends JO{constructor(e){super(e,"invalid ethereum address"),this.code=1005}}class yM extends JO{constructor(e){super(e,"not a valid string"),this.code=1001}}class wM extends JO{constructor(e){super(e,"invalid unit"),this.code=1004}}class bM extends JO{constructor(e){super(e,"can not be converted to hex"),this.code=1006}}class EM extends JO{constructor(e){super(e,"value greater than the nibble width"),this.code=1014}}class kM extends JO{constructor(e){super(e,"not a valid boolean."),this.code=1008}}class AM extends JO{constructor(e){super(e,"not a valid unsigned integer."),this.code=1009}}class SM extends JO{constructor(e){super(e,"invalid size given."),this.code=1010}}class xM extends JO{constructor(e){super(e,"value is larger than size."),this.code=1011}}class _M extends JO{constructor(e){super(e,"invalid string given"),this.code=1012}}const IM=e=>(e=>!Array.isArray(e)&&"2.0"===e.jsonrpc&&!!e&&(void 0===e.result||null===e.result)&&"error"in e&&("number"===typeof e.id||"string"===typeof e.id))(e)?e.error.message:"";class RM extends ZO{constructor(e,t,n){var r;let i;super(null!==t&&void 0!==t?t:"Returned error: ".concat(Array.isArray(e)?e.map((e=>IM(e))).join(","):IM(e))),this.code=100,t||(this.data=Array.isArray(e)?e.map((e=>{var t;return null===(t=e.error)||void 0===t?void 0:t.data})):null===(r=null===e||void 0===e?void 0:e.error)||void 0===r?void 0:r.data),this.request=n,"error"in e?i=e.error:e instanceof Array&&(i=e.map((e=>e.error))),this.innerError=i}toJSON(){return Object.assign(Object.assign({},super.toJSON()),{data:this.data,request:this.request})}}class CM extends RM{constructor(e,t){let n;super(e,void 0,t),this.code=101,"error"in e?n=e.error:e instanceof Array&&(n=e.map((e=>e.error))),this.innerError=n}}class TM extends ZO{constructor(e,t){super("Web3Config hardfork doesnt match in defaultHardfork ".concat(e," and common.hardfork ").concat(t)),this.code=1101}}class PM extends ZO{constructor(e,t){super("Web3Config chain doesnt match in defaultHardfork ".concat(e," and common.hardfork ").concat(t)),this.code=1101}}const NM="An Rpc error has occured with a code of *code*",BM={[FO]:{message:"Parse error",description:"Invalid JSON"},[UO]:{message:"Invalid request",description:"JSON is not a valid request object\t"},[jO]:{message:"Method not found",description:"Method does not exist\t"},[HO]:{message:"Invalid params",description:"Invalid method parameters"},[zO]:{message:"Internal error",description:"Internal JSON-RPC error"},[VO]:{message:"Invalid input",description:"Missing or invalid parameters"},[qO]:{message:"Resource not found",description:"Requested resource not found"},[GO]:{message:"Resource unavailable",description:"Requested resource not available"},[KO]:{message:"Transaction rejected",description:"Transaction creation failed"},[WO]:{message:"Method not supported",description:"Method is not implemented"},[QO]:{message:"Limit exceeded",description:"Request exceeds defined limit"},[YO]:{message:"JSON-RPC version not supported",description:"Version of JSON-RPC protocol is not supported"},[BO]:{name:"User Rejected Request",message:"The user rejected the request."},[DO]:{name:"Unauthorized",message:"The requested method and/or account has not been authorized by the user."},[OO]:{name:"Unsupported Method",message:"The Provider does not support the requested method."},[LO]:{name:"Disconnected",message:"The Provider is disconnected from all chains."},[MO]:{name:"Chain Disconnected",message:"The Provider is not connected to the requested chain."},"0-999":{name:"",message:"Not used."},1e3:{name:"Normal Closure",message:"The connection successfully completed the purpose for which it was created."},1001:{name:"Going Away",message:"The endpoint is going away, either because of a server failure or because the browser is navigating away from the page that opened the connection."},1002:{name:"Protocol error",message:"The endpoint is terminating the connection due to a protocol error."},1003:{name:"Unsupported Data",message:"The connection is being terminated because the endpoint received data of a type it cannot accept. (For example, a text-only endpoint received binary data.)"},1004:{name:"Reserved",message:"Reserved. A meaning might be defined in the future."},1005:{name:"No Status Rcvd",message:"Reserved. Indicates that no status code was provided even though one was expected."},1006:{name:"Abnormal Closure",message:"Reserved. Indicates that a connection was closed abnormally (that is, with no close frame being sent) when a status code is expected."},1007:{name:"Invalid frame payload data",message:"The endpoint is terminating the connection because a message was received that contained inconsistent data (e.g., non-UTF-8 data within a text message)."},1008:{name:"Policy Violation",message:"The endpoint is terminating the connection because it received a message that violates its policy. This is a generic status code, used when codes 1003 and 1009 are not suitable."},1009:{name:"Message Too Big",message:"The endpoint is terminating the connection because a data frame was received that is too large."},1010:{name:"Mandatory Ext.",message:"The client is terminating the connection because it expected the server to negotiate one or more extension, but the server didn't."},1011:{name:"Internal Error",message:"The server is terminating the connection because it encountered an unexpected condition that prevented it from fulfilling the request."},1012:{name:"Service Restart",message:"The server is terminating the connection because it is restarting."},1013:{name:"Try Again Later",message:"The server is terminating the connection due to a temporary condition, e.g. it is overloaded and is casting off some of its clients."},1014:{name:"Bad Gateway",message:"The server was acting as a gateway or proxy and received an invalid response from the upstream server. This is similar to 502 HTTP Status Code."},1015:{name:"TLS handshake",message:"Reserved. Indicates that the connection was closed due to a failure to perform a TLS handshake (e.g., the server certificate can't be verified)."},"1016-2999":{name:"",message:"For definition by future revisions of the WebSocket Protocol specification, and for definition by extension specifications."},"3000-3999":{name:"",message:"For use by libraries, frameworks, and applications. These status codes are registered directly with IANA. The interpretation of these codes is undefined by the WebSocket protocol."},"4000-4999":{name:"",message:"For private use, and thus can't be registered. Such codes can be used by prior agreements between WebSocket applications. The interpretation of these codes is undefined by the WebSocket protocol."}};class DM extends ZO{constructor(e,t){super(null!==t&&void 0!==t?t:NM.replace("*code*",e.error.code.toString())),this.code=e.error.code,this.id=e.id,this.jsonrpc=e.jsonrpc,this.jsonRpcError=e.error}toJSON(){return Object.assign(Object.assign({},super.toJSON()),{error:this.jsonRpcError,id:this.id,jsonRpc:this.jsonrpc})}}class OM extends ZO{constructor(e,t){var n,r,i,o;if(e)if(null===(n=BM[e])||void 0===n?void 0:n.message)super(BM[e].message);else{const t=Object.keys(BM).find((t=>"string"===typeof t&&e>=parseInt(t.split("-")[0],10)&&e<=parseInt(t.split("-")[1],10)));super(null!==(i=null===(r=BM[null!==t&&void 0!==t?t:""])||void 0===r?void 0:r.message)&&void 0!==i?i:NM.replace("*code*",null!==(o=null===e||void 0===e?void 0:e.toString())&&void 0!==o?o:'""'))}else super();this.code=e,this.data=t}}const LM=new Map;LM.set(FO,{error:class extends DM{constructor(e){super(e,BM[-32700].message),this.code=FO}}}),LM.set(UO,{error:class extends DM{constructor(e){super(e,BM[-32600].message),this.code=UO}}}),LM.set(jO,{error:class extends DM{constructor(e){super(e,BM[-32601].message),this.code=jO}}}),LM.set(HO,{error:class extends DM{constructor(e){super(e,BM[-32602].message),this.code=HO}}}),LM.set(zO,{error:class extends DM{constructor(e){super(e,BM[-32603].message),this.code=zO}}}),LM.set(VO,{error:class extends DM{constructor(e){super(e,BM[-32e3].message),this.code=VO}}}),LM.set(WO,{error:class extends DM{constructor(e){super(e,BM[-32004].message),this.code=WO}}}),LM.set(GO,{error:class extends DM{constructor(e){super(e,BM[-32002].message),this.code=GO}}}),LM.set(KO,{error:class extends DM{constructor(e){super(e,BM[-32003].message),this.code=KO}}}),LM.set(qO,{error:class extends DM{constructor(e){super(e,BM[-32001].message),this.code=qO}}}),LM.set(YO,{error:class extends DM{constructor(e){super(e,BM[-32006].message),this.code=YO}}}),LM.set(QO,{error:class extends DM{constructor(e){super(e,BM[-32005].message),this.code=QO}}});class MM extends ZO{constructor(e){super("Format for the type ".concat(e," is unsupported")),this.type=e,this.code=1200}toJSON(){return Object.assign(Object.assign({},super.toJSON()),{type:this.type})}}const[FM,UM,jM]=[[],[],[]],HM=BigInt(0),zM=BigInt(1),VM=BigInt(2),qM=BigInt(7),GM=BigInt(256),KM=BigInt(113);for(let n=0,DJ=zM,OJ=1,LJ=0;n<24;n++){[OJ,LJ]=[LJ,(2*OJ+3*LJ)%5],FM.push(2*(5*LJ+OJ)),UM.push((n+1)*(n+2)/2%64);let e=HM;for(let t=0;t<7;t++)DJ=(DJ<<zM^(DJ>>qM)*KM)%GM,DJ&VM&&(e^=zM<<(zM<<BigInt(t))-zM);jM.push(e)}const[WM,QM]=yI(jM,!0),YM=(e,t,n)=>n>32?EI(e,t,n):wI(e,t,n),ZM=(e,t,n)=>n>32?kI(e,t,n):bI(e,t,n);class JM extends lI{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:24;if(super(),this.blockLen=e,this.suffix=t,this.outputLen=n,this.enableXOF=r,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,Y_(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=nI(this.state)}keccak(){!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:24;const n=new Uint32Array(10);for(let r=24-t;r<24;r++){for(let r=0;r<10;r++)n[r]=e[r]^e[r+10]^e[r+20]^e[r+30]^e[r+40];for(let r=0;r<10;r+=2){const t=(r+8)%10,i=(r+2)%10,o=n[i],s=n[i+1],a=YM(o,s,1)^n[t],c=ZM(o,s,1)^n[t+1];for(let n=0;n<50;n+=10)e[r+n]^=a,e[r+n+1]^=c}let t=e[2],i=e[3];for(let n=0;n<24;n++){const r=UM[n],o=YM(t,i,r),s=ZM(t,i,r),a=FM[n];t=e[a],i=e[a+1],e[a]=o,e[a+1]=s}for(let r=0;r<50;r+=10){for(let t=0;t<10;t++)n[t]=e[r+t];for(let t=0;t<10;t++)e[r+t]^=~n[(t+2)%10]&n[(t+4)%10]}e[0]^=WM[r],e[1]^=QM[r]}n.fill(0)}(this.state32,this.rounds),this.posOut=0,this.pos=0}update(e){X_(this);const{blockLen:t,state:n}=this,r=(e=aI(e)).length;for(let i=0;i<r;){const o=Math.min(t-this.pos,r-i);for(let t=0;t<o;t++)n[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:n,blockLen:r}=this;e[n]^=t,0!==(128&t)&&n===r-1&&this.keccak(),e[r-1]^=128,this.keccak()}writeInto(e){X_(this,!1),Z_(e),this.finish();const t=this.state,{blockLen:n}=this;for(let r=0,i=e.length;r<i;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,i-r);e.set(t.subarray(this.posOut,this.posOut+o),r),this.posOut+=o,r+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Y_(e),this.xofInto(new Uint8Array(e))}digestInto(e){if($_(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:n,outputLen:r,rounds:i,enableXOF:o}=this;return e||(e=new JM(t,n,r,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=n,e.outputLen=r,e.enableXOF=o,e.destroyed=this.destroyed,e}}const XM=(e,t,n)=>hI((()=>new JM(t,e,n))),$M=XM(1,144,28),eF=XM(1,136,32),tF=XM(1,104,48),nF=XM(1,72,64),rF=(eI.bool,eI.bytes);function iF(e){if(!(e instanceof Uint8Array))throw new TypeError("bytesToUtf8 expected Uint8Array, got ".concat(typeof e));return(new TextDecoder).decode(e)}function oF(e){return t=>(eI.bytes(t),e(t))}(()=>{const e="object"===typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,t="undefined"!==typeof module&&"function"===typeof module.require&&module.require.bind(module);t&&!e&&t("crypto")})(),oF($M);const sF=(()=>{const e=oF(eF);return e.create=eF.create,e})();oF(tF),oF(nF);var aF,cF;!function(e){e.assertEqual=e=>e,e.assertIs=function(e){},e.assertNever=function(e){throw new Error},e.arrayToEnum=e=>{const t={};for(const n of e)t[n]=n;return t},e.getValidEnumValues=t=>{const n=e.objectKeys(t).filter((e=>"number"!==typeof t[t[e]])),r={};for(const e of n)r[e]=t[e];return e.objectValues(r)},e.objectValues=t=>e.objectKeys(t).map((function(e){return t[e]})),e.objectKeys="function"===typeof Object.keys?e=>Object.keys(e):e=>{const t=[];for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t},e.find=(e,t)=>{for(const n of e)if(t(n))return n},e.isInteger="function"===typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"===typeof e&&isFinite(e)&&Math.floor(e)===e,e.joinValues=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" | ";return e.map((e=>"string"===typeof e?"'".concat(e,"'"):e)).join(t)},e.jsonStringifyReplacer=(e,t)=>"bigint"===typeof t?t.toString():t}(aF||(aF={})),function(e){e.mergeShapes=(e,t)=>({...e,...t})}(cF||(cF={}));const lF=aF.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),uF=e=>{switch(typeof e){case"undefined":return lF.undefined;case"string":return lF.string;case"number":return isNaN(e)?lF.nan:lF.number;case"boolean":return lF.boolean;case"function":return lF.function;case"bigint":return lF.bigint;case"symbol":return lF.symbol;case"object":return Array.isArray(e)?lF.array:null===e?lF.null:e.then&&"function"===typeof e.then&&e.catch&&"function"===typeof e.catch?lF.promise:"undefined"!==typeof Map&&e instanceof Map?lF.map:"undefined"!==typeof Set&&e instanceof Set?lF.set:"undefined"!==typeof Date&&e instanceof Date?lF.date:lF.object;default:return lF.unknown}},dF=aF.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class hF extends Error{constructor(e){var t;super(),t=this,this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.issues=[...t.issues,...e]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const t=e||function(e){return e.message},n={_errors:[]},r=e=>{for(const i of e.issues)if("invalid_union"===i.code)i.unionErrors.map(r);else if("invalid_return_type"===i.code)r(i.returnTypeError);else if("invalid_arguments"===i.code)r(i.argumentsError);else if(0===i.path.length)n._errors.push(t(i));else{let e=n,r=0;for(;r<i.path.length;){const n=i.path[r];r===i.path.length-1?(e[n]=e[n]||{_errors:[]},e[n]._errors.push(t(i))):e[n]=e[n]||{_errors:[]},e=e[n],r++}}};return r(this),n}static assert(e){if(!(e instanceof hF))throw new Error("Not a ZodError: ".concat(e))}toString(){return this.message}get message(){return JSON.stringify(this.issues,aF.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e=>e.message;const t={},n=[];for(const r of this.issues)r.path.length>0?(t[r.path[0]]=t[r.path[0]]||[],t[r.path[0]].push(e(r))):n.push(e(r));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}}hF.create=e=>new hF(e);const fF=(e,t)=>{let n;switch(e.code){case dF.invalid_type:n=e.received===lF.undefined?"Required":"Expected ".concat(e.expected,", received ").concat(e.received);break;case dF.invalid_literal:n="Invalid literal value, expected ".concat(JSON.stringify(e.expected,aF.jsonStringifyReplacer));break;case dF.unrecognized_keys:n="Unrecognized key(s) in object: ".concat(aF.joinValues(e.keys,", "));break;case dF.invalid_union:n="Invalid input";break;case dF.invalid_union_discriminator:n="Invalid discriminator value. Expected ".concat(aF.joinValues(e.options));break;case dF.invalid_enum_value:n="Invalid enum value. Expected ".concat(aF.joinValues(e.options),", received '").concat(e.received,"'");break;case dF.invalid_arguments:n="Invalid function arguments";break;case dF.invalid_return_type:n="Invalid function return type";break;case dF.invalid_date:n="Invalid date";break;case dF.invalid_string:"object"===typeof e.validation?"includes"in e.validation?(n='Invalid input: must include "'.concat(e.validation.includes,'"'),"number"===typeof e.validation.position&&(n="".concat(n," at one or more positions greater than or equal to ").concat(e.validation.position))):"startsWith"in e.validation?n='Invalid input: must start with "'.concat(e.validation.startsWith,'"'):"endsWith"in e.validation?n='Invalid input: must end with "'.concat(e.validation.endsWith,'"'):aF.assertNever(e.validation):n="regex"!==e.validation?"Invalid ".concat(e.validation):"Invalid";break;case dF.too_small:n="array"===e.type?"Array must contain ".concat(e.exact?"exactly":e.inclusive?"at least":"more than"," ").concat(e.minimum," element(s)"):"string"===e.type?"String must contain ".concat(e.exact?"exactly":e.inclusive?"at least":"over"," ").concat(e.minimum," character(s)"):"number"===e.type?"Number must be ".concat(e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than ").concat(e.minimum):"date"===e.type?"Date must be ".concat(e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than ").concat(new Date(Number(e.minimum))):"Invalid input";break;case dF.too_big:n="array"===e.type?"Array must contain ".concat(e.exact?"exactly":e.inclusive?"at most":"less than"," ").concat(e.maximum," element(s)"):"string"===e.type?"String must contain ".concat(e.exact?"exactly":e.inclusive?"at most":"under"," ").concat(e.maximum," character(s)"):"number"===e.type?"Number must be ".concat(e.exact?"exactly":e.inclusive?"less than or equal to":"less than"," ").concat(e.maximum):"bigint"===e.type?"BigInt must be ".concat(e.exact?"exactly":e.inclusive?"less than or equal to":"less than"," ").concat(e.maximum):"date"===e.type?"Date must be ".concat(e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"," ").concat(new Date(Number(e.maximum))):"Invalid input";break;case dF.custom:n="Invalid input";break;case dF.invalid_intersection_types:n="Intersection results could not be merged";break;case dF.not_multiple_of:n="Number must be a multiple of ".concat(e.multipleOf);break;case dF.not_finite:n="Number must be finite";break;default:n=t.defaultError,aF.assertNever(e)}return{message:n}};let pF=fF;function gF(){return pF}const mF=e=>{const{data:t,path:n,errorMaps:r,issueData:i}=e,o=[...n,...i.path||[]],s={...i,path:o};if(void 0!==i.message)return{...i,path:o,message:i.message};let a="";const c=r.filter((e=>!!e)).slice().reverse();for(const l of c)a=l(s,{data:t,defaultError:a}).message;return{...i,path:o,message:a}};function vF(e,t){const n=gF(),r=mF({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===fF?void 0:fF].filter((e=>!!e))});e.common.issues.push(r)}class yF{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){const n=[];for(const r of t){if("aborted"===r.status)return wF;"dirty"===r.status&&e.dirty(),n.push(r.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){const n=[];for(const r of t){const e=await r.key,t=await r.value;n.push({key:e,value:t})}return yF.mergeObjectSync(e,n)}static mergeObjectSync(e,t){const n={};for(const r of t){const{key:t,value:i}=r;if("aborted"===t.status)return wF;if("aborted"===i.status)return wF;"dirty"===t.status&&e.dirty(),"dirty"===i.status&&e.dirty(),"__proto__"===t.value||"undefined"===typeof i.value&&!r.alwaysSet||(n[t.value]=i.value)}return{status:e.value,value:n}}}const wF=Object.freeze({status:"aborted"}),bF=e=>({status:"dirty",value:e}),EF=e=>({status:"valid",value:e}),kF=e=>"aborted"===e.status,AF=e=>"dirty"===e.status,SF=e=>"valid"===e.status,xF=e=>"undefined"!==typeof Promise&&e instanceof Promise;function _F(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}function IF(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n}var RF,CF,TF;"function"===typeof SuppressedError&&SuppressedError,function(e){e.errToObj=e=>"string"===typeof e?{message:e}:e||{},e.toString=e=>"string"===typeof e?e:null===e||void 0===e?void 0:e.message}(RF||(RF={}));class PF{constructor(e,t,n,r){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=r}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const NF=(e,t)=>{if(SF(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new hF(e.common.issues);return this._error=t,this._error}}};function BF(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:r,description:i}=e;if(t&&(n||r))throw new Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');if(t)return{errorMap:t,description:i};return{errorMap:(t,i)=>{var o,s;const{message:a}=e;return"invalid_enum_value"===t.code?{message:null!==a&&void 0!==a?a:i.defaultError}:"undefined"===typeof i.data?{message:null!==(o=null!==a&&void 0!==a?a:r)&&void 0!==o?o:i.defaultError}:"invalid_type"!==t.code?{message:i.defaultError}:{message:null!==(s=null!==a&&void 0!==a?a:n)&&void 0!==s?s:i.defaultError}},description:i}}class DF{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return uF(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:uF(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new yF,ctx:{common:e.parent.common,data:e.data,parsedType:uF(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(xF(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){var n;const r={common:{issues:[],async:null!==(n=null===t||void 0===t?void 0:t.async)&&void 0!==n&&n,contextualErrorMap:null===t||void 0===t?void 0:t.errorMap},path:(null===t||void 0===t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:uF(e)},i=this._parseSync({data:e,path:r.path,parent:r});return NF(r,i)}async parseAsync(e,t){const n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){const n={common:{issues:[],contextualErrorMap:null===t||void 0===t?void 0:t.errorMap,async:!0},path:(null===t||void 0===t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:uF(e)},r=this._parse({data:e,path:n.path,parent:n}),i=await(xF(r)?r:Promise.resolve(r));return NF(n,i)}refine(e,t){const n=e=>"string"===typeof t||"undefined"===typeof t?{message:t}:"function"===typeof t?t(e):t;return this._refinement(((t,r)=>{const i=e(t),o=()=>r.addIssue({code:dF.custom,...n(t)});return"undefined"!==typeof Promise&&i instanceof Promise?i.then((e=>!!e||(o(),!1))):!!i||(o(),!1)}))}refinement(e,t){return this._refinement(((n,r)=>!!e(n)||(r.addIssue("function"===typeof t?t(n,r):t),!1)))}_refinement(e){return new CU({schema:this,typeName:HU.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return TU.create(this,this._def)}nullable(){return PU.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return uU.create(this,this._def)}promise(){return RU.create(this,this._def)}or(e){return fU.create([this,e],this._def)}and(e){return vU.create(this,e,this._def)}transform(e){return new CU({...BF(this._def),schema:this,typeName:HU.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t="function"===typeof e?e:()=>e;return new NU({...BF(this._def),innerType:this,defaultValue:t,typeName:HU.ZodDefault})}brand(){return new LU({typeName:HU.ZodBranded,type:this,...BF(this._def)})}catch(e){const t="function"===typeof e?e:()=>e;return new BU({...BF(this._def),innerType:this,catchValue:t,typeName:HU.ZodCatch})}describe(e){return new(0,this.constructor)({...this._def,description:e})}pipe(e){return MU.create(this,e)}readonly(){return FU.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const OF=/^c[^\s-]{8,}$/i,LF=/^[0-9a-z]+$/,MF=/^[0-9A-HJKMNP-TV-Z]{26}$/,FF=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,UF=/^[a-z0-9_-]{21}$/i,jF=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,HF=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i;let zF;const VF=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,qF=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,GF=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,KF="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",WF=new RegExp("^".concat(KF,"$"));function QF(e){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return e.precision?t="".concat(t,"\\.\\d{").concat(e.precision,"}"):null==e.precision&&(t="".concat(t,"(\\.\\d+)?")),t}function YF(e){let t="".concat(KF,"T").concat(QF(e));const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t="".concat(t,"(").concat(n.join("|"),")"),new RegExp("^".concat(t,"$"))}function ZF(e,t){return!("v4"!==t&&t||!VF.test(e))||!("v6"!==t&&t||!qF.test(e))}class JF extends DF{_parse(e){this._def.coerce&&(e.data=String(e.data));if(this._getType(e)!==lF.string){const t=this._getOrReturnCtx(e);return vF(t,{code:dF.invalid_type,expected:lF.string,received:t.parsedType}),wF}const t=new yF;let n;for(const r of this._def.checks)if("min"===r.kind)e.data.length<r.value&&(n=this._getOrReturnCtx(e,n),vF(n,{code:dF.too_small,minimum:r.value,type:"string",inclusive:!0,exact:!1,message:r.message}),t.dirty());else if("max"===r.kind)e.data.length>r.value&&(n=this._getOrReturnCtx(e,n),vF(n,{code:dF.too_big,maximum:r.value,type:"string",inclusive:!0,exact:!1,message:r.message}),t.dirty());else if("length"===r.kind){const i=e.data.length>r.value,o=e.data.length<r.value;(i||o)&&(n=this._getOrReturnCtx(e,n),i?vF(n,{code:dF.too_big,maximum:r.value,type:"string",inclusive:!0,exact:!0,message:r.message}):o&&vF(n,{code:dF.too_small,minimum:r.value,type:"string",inclusive:!0,exact:!0,message:r.message}),t.dirty())}else if("email"===r.kind)HF.test(e.data)||(n=this._getOrReturnCtx(e,n),vF(n,{validation:"email",code:dF.invalid_string,message:r.message}),t.dirty());else if("emoji"===r.kind)zF||(zF=new RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),zF.test(e.data)||(n=this._getOrReturnCtx(e,n),vF(n,{validation:"emoji",code:dF.invalid_string,message:r.message}),t.dirty());else if("uuid"===r.kind)FF.test(e.data)||(n=this._getOrReturnCtx(e,n),vF(n,{validation:"uuid",code:dF.invalid_string,message:r.message}),t.dirty());else if("nanoid"===r.kind)UF.test(e.data)||(n=this._getOrReturnCtx(e,n),vF(n,{validation:"nanoid",code:dF.invalid_string,message:r.message}),t.dirty());else if("cuid"===r.kind)OF.test(e.data)||(n=this._getOrReturnCtx(e,n),vF(n,{validation:"cuid",code:dF.invalid_string,message:r.message}),t.dirty());else if("cuid2"===r.kind)LF.test(e.data)||(n=this._getOrReturnCtx(e,n),vF(n,{validation:"cuid2",code:dF.invalid_string,message:r.message}),t.dirty());else if("ulid"===r.kind)MF.test(e.data)||(n=this._getOrReturnCtx(e,n),vF(n,{validation:"ulid",code:dF.invalid_string,message:r.message}),t.dirty());else if("url"===r.kind)try{new URL(e.data)}catch(dk){n=this._getOrReturnCtx(e,n),vF(n,{validation:"url",code:dF.invalid_string,message:r.message}),t.dirty()}else if("regex"===r.kind){r.regex.lastIndex=0;r.regex.test(e.data)||(n=this._getOrReturnCtx(e,n),vF(n,{validation:"regex",code:dF.invalid_string,message:r.message}),t.dirty())}else if("trim"===r.kind)e.data=e.data.trim();else if("includes"===r.kind)e.data.includes(r.value,r.position)||(n=this._getOrReturnCtx(e,n),vF(n,{code:dF.invalid_string,validation:{includes:r.value,position:r.position},message:r.message}),t.dirty());else if("toLowerCase"===r.kind)e.data=e.data.toLowerCase();else if("toUpperCase"===r.kind)e.data=e.data.toUpperCase();else if("startsWith"===r.kind)e.data.startsWith(r.value)||(n=this._getOrReturnCtx(e,n),vF(n,{code:dF.invalid_string,validation:{startsWith:r.value},message:r.message}),t.dirty());else if("endsWith"===r.kind)e.data.endsWith(r.value)||(n=this._getOrReturnCtx(e,n),vF(n,{code:dF.invalid_string,validation:{endsWith:r.value},message:r.message}),t.dirty());else if("datetime"===r.kind){YF(r).test(e.data)||(n=this._getOrReturnCtx(e,n),vF(n,{code:dF.invalid_string,validation:"datetime",message:r.message}),t.dirty())}else if("date"===r.kind){WF.test(e.data)||(n=this._getOrReturnCtx(e,n),vF(n,{code:dF.invalid_string,validation:"date",message:r.message}),t.dirty())}else if("time"===r.kind){new RegExp("^".concat(QF(r),"$")).test(e.data)||(n=this._getOrReturnCtx(e,n),vF(n,{code:dF.invalid_string,validation:"time",message:r.message}),t.dirty())}else"duration"===r.kind?jF.test(e.data)||(n=this._getOrReturnCtx(e,n),vF(n,{validation:"duration",code:dF.invalid_string,message:r.message}),t.dirty()):"ip"===r.kind?ZF(e.data,r.version)||(n=this._getOrReturnCtx(e,n),vF(n,{validation:"ip",code:dF.invalid_string,message:r.message}),t.dirty()):"base64"===r.kind?GF.test(e.data)||(n=this._getOrReturnCtx(e,n),vF(n,{validation:"base64",code:dF.invalid_string,message:r.message}),t.dirty()):aF.assertNever(r);return{status:t.value,value:e.data}}_regex(e,t,n){return this.refinement((t=>e.test(t)),{validation:t,code:dF.invalid_string,...RF.errToObj(n)})}_addCheck(e){return new JF({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...RF.errToObj(e)})}url(e){return this._addCheck({kind:"url",...RF.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...RF.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...RF.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...RF.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...RF.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...RF.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...RF.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...RF.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...RF.errToObj(e)})}datetime(e){var t,n;return"string"===typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:"undefined"===typeof(null===e||void 0===e?void 0:e.precision)?null:null===e||void 0===e?void 0:e.precision,offset:null!==(t=null===e||void 0===e?void 0:e.offset)&&void 0!==t&&t,local:null!==(n=null===e||void 0===e?void 0:e.local)&&void 0!==n&&n,...RF.errToObj(null===e||void 0===e?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return"string"===typeof e?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:"undefined"===typeof(null===e||void 0===e?void 0:e.precision)?null:null===e||void 0===e?void 0:e.precision,...RF.errToObj(null===e||void 0===e?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...RF.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...RF.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:null===t||void 0===t?void 0:t.position,...RF.errToObj(null===t||void 0===t?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...RF.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...RF.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...RF.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...RF.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...RF.errToObj(t)})}nonempty(e){return this.min(1,RF.errToObj(e))}trim(){return new JF({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new JF({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new JF({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find((e=>"datetime"===e.kind))}get isDate(){return!!this._def.checks.find((e=>"date"===e.kind))}get isTime(){return!!this._def.checks.find((e=>"time"===e.kind))}get isDuration(){return!!this._def.checks.find((e=>"duration"===e.kind))}get isEmail(){return!!this._def.checks.find((e=>"email"===e.kind))}get isURL(){return!!this._def.checks.find((e=>"url"===e.kind))}get isEmoji(){return!!this._def.checks.find((e=>"emoji"===e.kind))}get isUUID(){return!!this._def.checks.find((e=>"uuid"===e.kind))}get isNANOID(){return!!this._def.checks.find((e=>"nanoid"===e.kind))}get isCUID(){return!!this._def.checks.find((e=>"cuid"===e.kind))}get isCUID2(){return!!this._def.checks.find((e=>"cuid2"===e.kind))}get isULID(){return!!this._def.checks.find((e=>"ulid"===e.kind))}get isIP(){return!!this._def.checks.find((e=>"ip"===e.kind))}get isBase64(){return!!this._def.checks.find((e=>"base64"===e.kind))}get minLength(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}function XF(e,t){const n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,i=n>r?n:r;return parseInt(e.toFixed(i).replace(".",""))%parseInt(t.toFixed(i).replace(".",""))/Math.pow(10,i)}JF.create=e=>{var t;return new JF({checks:[],typeName:HU.ZodString,coerce:null!==(t=null===e||void 0===e?void 0:e.coerce)&&void 0!==t&&t,...BF(e)})};class $F extends DF{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){this._def.coerce&&(e.data=Number(e.data));if(this._getType(e)!==lF.number){const t=this._getOrReturnCtx(e);return vF(t,{code:dF.invalid_type,expected:lF.number,received:t.parsedType}),wF}let t;const n=new yF;for(const r of this._def.checks)if("int"===r.kind)aF.isInteger(e.data)||(t=this._getOrReturnCtx(e,t),vF(t,{code:dF.invalid_type,expected:"integer",received:"float",message:r.message}),n.dirty());else if("min"===r.kind){(r.inclusive?e.data<r.value:e.data<=r.value)&&(t=this._getOrReturnCtx(e,t),vF(t,{code:dF.too_small,minimum:r.value,type:"number",inclusive:r.inclusive,exact:!1,message:r.message}),n.dirty())}else if("max"===r.kind){(r.inclusive?e.data>r.value:e.data>=r.value)&&(t=this._getOrReturnCtx(e,t),vF(t,{code:dF.too_big,maximum:r.value,type:"number",inclusive:r.inclusive,exact:!1,message:r.message}),n.dirty())}else"multipleOf"===r.kind?0!==XF(e.data,r.value)&&(t=this._getOrReturnCtx(e,t),vF(t,{code:dF.not_multiple_of,multipleOf:r.value,message:r.message}),n.dirty()):"finite"===r.kind?Number.isFinite(e.data)||(t=this._getOrReturnCtx(e,t),vF(t,{code:dF.not_finite,message:r.message}),n.dirty()):aF.assertNever(r);return{status:n.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,RF.toString(t))}gt(e,t){return this.setLimit("min",e,!1,RF.toString(t))}lte(e,t){return this.setLimit("max",e,!0,RF.toString(t))}lt(e,t){return this.setLimit("max",e,!1,RF.toString(t))}setLimit(e,t,n,r){return new $F({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:RF.toString(r)}]})}_addCheck(e){return new $F({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:RF.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:RF.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:RF.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:RF.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:RF.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:RF.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:RF.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:RF.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:RF.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find((e=>"int"===e.kind||"multipleOf"===e.kind&&aF.isInteger(e.value)))}get isFinite(){let e=null,t=null;for(const n of this._def.checks){if("finite"===n.kind||"int"===n.kind||"multipleOf"===n.kind)return!0;"min"===n.kind?(null===t||n.value>t)&&(t=n.value):"max"===n.kind&&(null===e||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}}$F.create=e=>new $F({checks:[],typeName:HU.ZodNumber,coerce:(null===e||void 0===e?void 0:e.coerce)||!1,...BF(e)});class eU extends DF{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){this._def.coerce&&(e.data=BigInt(e.data));if(this._getType(e)!==lF.bigint){const t=this._getOrReturnCtx(e);return vF(t,{code:dF.invalid_type,expected:lF.bigint,received:t.parsedType}),wF}let t;const n=new yF;for(const r of this._def.checks)if("min"===r.kind){(r.inclusive?e.data<r.value:e.data<=r.value)&&(t=this._getOrReturnCtx(e,t),vF(t,{code:dF.too_small,type:"bigint",minimum:r.value,inclusive:r.inclusive,message:r.message}),n.dirty())}else if("max"===r.kind){(r.inclusive?e.data>r.value:e.data>=r.value)&&(t=this._getOrReturnCtx(e,t),vF(t,{code:dF.too_big,type:"bigint",maximum:r.value,inclusive:r.inclusive,message:r.message}),n.dirty())}else"multipleOf"===r.kind?e.data%r.value!==BigInt(0)&&(t=this._getOrReturnCtx(e,t),vF(t,{code:dF.not_multiple_of,multipleOf:r.value,message:r.message}),n.dirty()):aF.assertNever(r);return{status:n.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,RF.toString(t))}gt(e,t){return this.setLimit("min",e,!1,RF.toString(t))}lte(e,t){return this.setLimit("max",e,!0,RF.toString(t))}lt(e,t){return this.setLimit("max",e,!1,RF.toString(t))}setLimit(e,t,n,r){return new eU({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:RF.toString(r)}]})}_addCheck(e){return new eU({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:RF.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:RF.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:RF.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:RF.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:RF.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}eU.create=e=>{var t;return new eU({checks:[],typeName:HU.ZodBigInt,coerce:null!==(t=null===e||void 0===e?void 0:e.coerce)&&void 0!==t&&t,...BF(e)})};class tU extends DF{_parse(e){this._def.coerce&&(e.data=Boolean(e.data));if(this._getType(e)!==lF.boolean){const t=this._getOrReturnCtx(e);return vF(t,{code:dF.invalid_type,expected:lF.boolean,received:t.parsedType}),wF}return EF(e.data)}}tU.create=e=>new tU({typeName:HU.ZodBoolean,coerce:(null===e||void 0===e?void 0:e.coerce)||!1,...BF(e)});class nU extends DF{_parse(e){this._def.coerce&&(e.data=new Date(e.data));if(this._getType(e)!==lF.date){const t=this._getOrReturnCtx(e);return vF(t,{code:dF.invalid_type,expected:lF.date,received:t.parsedType}),wF}if(isNaN(e.data.getTime())){return vF(this._getOrReturnCtx(e),{code:dF.invalid_date}),wF}const t=new yF;let n;for(const r of this._def.checks)"min"===r.kind?e.data.getTime()<r.value&&(n=this._getOrReturnCtx(e,n),vF(n,{code:dF.too_small,message:r.message,inclusive:!0,exact:!1,minimum:r.value,type:"date"}),t.dirty()):"max"===r.kind?e.data.getTime()>r.value&&(n=this._getOrReturnCtx(e,n),vF(n,{code:dF.too_big,message:r.message,inclusive:!0,exact:!1,maximum:r.value,type:"date"}),t.dirty()):aF.assertNever(r);return{status:t.value,value:new Date(e.data.getTime())}}_addCheck(e){return new nU({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:RF.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:RF.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}nU.create=e=>new nU({checks:[],coerce:(null===e||void 0===e?void 0:e.coerce)||!1,typeName:HU.ZodDate,...BF(e)});class rU extends DF{_parse(e){if(this._getType(e)!==lF.symbol){const t=this._getOrReturnCtx(e);return vF(t,{code:dF.invalid_type,expected:lF.symbol,received:t.parsedType}),wF}return EF(e.data)}}rU.create=e=>new rU({typeName:HU.ZodSymbol,...BF(e)});class iU extends DF{_parse(e){if(this._getType(e)!==lF.undefined){const t=this._getOrReturnCtx(e);return vF(t,{code:dF.invalid_type,expected:lF.undefined,received:t.parsedType}),wF}return EF(e.data)}}iU.create=e=>new iU({typeName:HU.ZodUndefined,...BF(e)});class oU extends DF{_parse(e){if(this._getType(e)!==lF.null){const t=this._getOrReturnCtx(e);return vF(t,{code:dF.invalid_type,expected:lF.null,received:t.parsedType}),wF}return EF(e.data)}}oU.create=e=>new oU({typeName:HU.ZodNull,...BF(e)});class sU extends DF{constructor(){super(...arguments),this._any=!0}_parse(e){return EF(e.data)}}sU.create=e=>new sU({typeName:HU.ZodAny,...BF(e)});class aU extends DF{constructor(){super(...arguments),this._unknown=!0}_parse(e){return EF(e.data)}}aU.create=e=>new aU({typeName:HU.ZodUnknown,...BF(e)});class cU extends DF{_parse(e){const t=this._getOrReturnCtx(e);return vF(t,{code:dF.invalid_type,expected:lF.never,received:t.parsedType}),wF}}cU.create=e=>new cU({typeName:HU.ZodNever,...BF(e)});class lU extends DF{_parse(e){if(this._getType(e)!==lF.undefined){const t=this._getOrReturnCtx(e);return vF(t,{code:dF.invalid_type,expected:lF.void,received:t.parsedType}),wF}return EF(e.data)}}lU.create=e=>new lU({typeName:HU.ZodVoid,...BF(e)});class uU extends DF{_parse(e){const{ctx:t,status:n}=this._processInputParams(e),r=this._def;if(t.parsedType!==lF.array)return vF(t,{code:dF.invalid_type,expected:lF.array,received:t.parsedType}),wF;if(null!==r.exactLength){const e=t.data.length>r.exactLength.value,i=t.data.length<r.exactLength.value;(e||i)&&(vF(t,{code:e?dF.too_big:dF.too_small,minimum:i?r.exactLength.value:void 0,maximum:e?r.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:r.exactLength.message}),n.dirty())}if(null!==r.minLength&&t.data.length<r.minLength.value&&(vF(t,{code:dF.too_small,minimum:r.minLength.value,type:"array",inclusive:!0,exact:!1,message:r.minLength.message}),n.dirty()),null!==r.maxLength&&t.data.length>r.maxLength.value&&(vF(t,{code:dF.too_big,maximum:r.maxLength.value,type:"array",inclusive:!0,exact:!1,message:r.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map(((e,n)=>r.type._parseAsync(new PF(t,e,t.path,n))))).then((e=>yF.mergeArray(n,e)));const i=[...t.data].map(((e,n)=>r.type._parseSync(new PF(t,e,t.path,n))));return yF.mergeArray(n,i)}get element(){return this._def.type}min(e,t){return new uU({...this._def,minLength:{value:e,message:RF.toString(t)}})}max(e,t){return new uU({...this._def,maxLength:{value:e,message:RF.toString(t)}})}length(e,t){return new uU({...this._def,exactLength:{value:e,message:RF.toString(t)}})}nonempty(e){return this.min(1,e)}}function dU(e){if(e instanceof hU){const t={};for(const n in e.shape){const r=e.shape[n];t[n]=TU.create(dU(r))}return new hU({...e._def,shape:()=>t})}return e instanceof uU?new uU({...e._def,type:dU(e.element)}):e instanceof TU?TU.create(dU(e.unwrap())):e instanceof PU?PU.create(dU(e.unwrap())):e instanceof yU?yU.create(e.items.map((e=>dU(e)))):e}uU.create=(e,t)=>new uU({type:e,minLength:null,maxLength:null,exactLength:null,typeName:HU.ZodArray,...BF(t)});class hU extends DF{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;const e=this._def.shape(),t=aF.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==lF.object){const t=this._getOrReturnCtx(e);return vF(t,{code:dF.invalid_type,expected:lF.object,received:t.parsedType}),wF}const{status:t,ctx:n}=this._processInputParams(e),{shape:r,keys:i}=this._getCached(),o=[];if(!(this._def.catchall instanceof cU&&"strip"===this._def.unknownKeys))for(const a in n.data)i.includes(a)||o.push(a);const s=[];for(const a of i){const e=r[a],t=n.data[a];s.push({key:{status:"valid",value:a},value:e._parse(new PF(n,t,n.path,a)),alwaysSet:a in n.data})}if(this._def.catchall instanceof cU){const e=this._def.unknownKeys;if("passthrough"===e)for(const t of o)s.push({key:{status:"valid",value:t},value:{status:"valid",value:n.data[t]}});else if("strict"===e)o.length>0&&(vF(n,{code:dF.unrecognized_keys,keys:o}),t.dirty());else if("strip"!==e)throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const e=this._def.catchall;for(const t of o){const r=n.data[t];s.push({key:{status:"valid",value:t},value:e._parse(new PF(n,r,n.path,t)),alwaysSet:t in n.data})}}return n.common.async?Promise.resolve().then((async()=>{const e=[];for(const t of s){const n=await t.key,r=await t.value;e.push({key:n,value:r,alwaysSet:t.alwaysSet})}return e})).then((e=>yF.mergeObjectSync(t,e))):yF.mergeObjectSync(t,s)}get shape(){return this._def.shape()}strict(e){return RF.errToObj,new hU({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,n)=>{var r,i,o,s;const a=null!==(o=null===(i=(r=this._def).errorMap)||void 0===i?void 0:i.call(r,t,n).message)&&void 0!==o?o:n.defaultError;return"unrecognized_keys"===t.code?{message:null!==(s=RF.errToObj(e).message)&&void 0!==s?s:a}:{message:a}}}:{}})}strip(){return new hU({...this._def,unknownKeys:"strip"})}passthrough(){return new hU({...this._def,unknownKeys:"passthrough"})}extend(e){return new hU({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new hU({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:HU.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new hU({...this._def,catchall:e})}pick(e){const t={};return aF.objectKeys(e).forEach((n=>{e[n]&&this.shape[n]&&(t[n]=this.shape[n])})),new hU({...this._def,shape:()=>t})}omit(e){const t={};return aF.objectKeys(this.shape).forEach((n=>{e[n]||(t[n]=this.shape[n])})),new hU({...this._def,shape:()=>t})}deepPartial(){return dU(this)}partial(e){const t={};return aF.objectKeys(this.shape).forEach((n=>{const r=this.shape[n];e&&!e[n]?t[n]=r:t[n]=r.optional()})),new hU({...this._def,shape:()=>t})}required(e){const t={};return aF.objectKeys(this.shape).forEach((n=>{if(e&&!e[n])t[n]=this.shape[n];else{let e=this.shape[n];for(;e instanceof TU;)e=e._def.innerType;t[n]=e}})),new hU({...this._def,shape:()=>t})}keyof(){return xU(aF.objectKeys(this.shape))}}hU.create=(e,t)=>new hU({shape:()=>e,unknownKeys:"strip",catchall:cU.create(),typeName:HU.ZodObject,...BF(t)}),hU.strictCreate=(e,t)=>new hU({shape:()=>e,unknownKeys:"strict",catchall:cU.create(),typeName:HU.ZodObject,...BF(t)}),hU.lazycreate=(e,t)=>new hU({shape:e,unknownKeys:"strip",catchall:cU.create(),typeName:HU.ZodObject,...BF(t)});class fU extends DF{_parse(e){const{ctx:t}=this._processInputParams(e),n=this._def.options;if(t.common.async)return Promise.all(n.map((async e=>{const n={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:n}),ctx:n}}))).then((function(e){for(const t of e)if("valid"===t.result.status)return t.result;for(const r of e)if("dirty"===r.result.status)return t.common.issues.push(...r.ctx.common.issues),r.result;const n=e.map((e=>new hF(e.ctx.common.issues)));return vF(t,{code:dF.invalid_union,unionErrors:n}),wF}));{let e;const r=[];for(const o of n){const n={...t,common:{...t.common,issues:[]},parent:null},i=o._parseSync({data:t.data,path:t.path,parent:n});if("valid"===i.status)return i;"dirty"!==i.status||e||(e={result:i,ctx:n}),n.common.issues.length&&r.push(n.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;const i=r.map((e=>new hF(e)));return vF(t,{code:dF.invalid_union,unionErrors:i}),wF}}get options(){return this._def.options}}fU.create=(e,t)=>new fU({options:e,typeName:HU.ZodUnion,...BF(t)});const pU=e=>e instanceof AU?pU(e.schema):e instanceof CU?pU(e.innerType()):e instanceof SU?[e.value]:e instanceof _U?e.options:e instanceof IU?aF.objectValues(e.enum):e instanceof NU?pU(e._def.innerType):e instanceof iU?[void 0]:e instanceof oU?[null]:e instanceof TU?[void 0,...pU(e.unwrap())]:e instanceof PU?[null,...pU(e.unwrap())]:e instanceof LU||e instanceof FU?pU(e.unwrap()):e instanceof BU?pU(e._def.innerType):[];class gU extends DF{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==lF.object)return vF(t,{code:dF.invalid_type,expected:lF.object,received:t.parsedType}),wF;const n=this.discriminator,r=t.data[n],i=this.optionsMap.get(r);return i?t.common.async?i._parseAsync({data:t.data,path:t.path,parent:t}):i._parseSync({data:t.data,path:t.path,parent:t}):(vF(t,{code:dF.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),wF)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,n){const r=new Map;for(const i of t){const t=pU(i.shape[e]);if(!t.length)throw new Error("A discriminator value for key `".concat(e,"` could not be extracted from all schema options"));for(const n of t){if(r.has(n))throw new Error("Discriminator property ".concat(String(e)," has duplicate value ").concat(String(n)));r.set(n,i)}}return new gU({typeName:HU.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:r,...BF(n)})}}function mU(e,t){const n=uF(e),r=uF(t);if(e===t)return{valid:!0,data:e};if(n===lF.object&&r===lF.object){const n=aF.objectKeys(t),r=aF.objectKeys(e).filter((e=>-1!==n.indexOf(e))),i={...e,...t};for(const o of r){const n=mU(e[o],t[o]);if(!n.valid)return{valid:!1};i[o]=n.data}return{valid:!0,data:i}}if(n===lF.array&&r===lF.array){if(e.length!==t.length)return{valid:!1};const n=[];for(let r=0;r<e.length;r++){const i=mU(e[r],t[r]);if(!i.valid)return{valid:!1};n.push(i.data)}return{valid:!0,data:n}}return n===lF.date&&r===lF.date&&+e===+t?{valid:!0,data:e}:{valid:!1}}class vU extends DF{_parse(e){const{status:t,ctx:n}=this._processInputParams(e),r=(e,r)=>{if(kF(e)||kF(r))return wF;const i=mU(e.value,r.value);return i.valid?((AF(e)||AF(r))&&t.dirty(),{status:t.value,value:i.data}):(vF(n,{code:dF.invalid_intersection_types}),wF)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then((e=>{let[t,n]=e;return r(t,n)})):r(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}vU.create=(e,t,n)=>new vU({left:e,right:t,typeName:HU.ZodIntersection,...BF(n)});class yU extends DF{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==lF.array)return vF(n,{code:dF.invalid_type,expected:lF.array,received:n.parsedType}),wF;if(n.data.length<this._def.items.length)return vF(n,{code:dF.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),wF;!this._def.rest&&n.data.length>this._def.items.length&&(vF(n,{code:dF.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const r=[...n.data].map(((e,t)=>{const r=this._def.items[t]||this._def.rest;return r?r._parse(new PF(n,e,n.path,t)):null})).filter((e=>!!e));return n.common.async?Promise.all(r).then((e=>yF.mergeArray(t,e))):yF.mergeArray(t,r)}get items(){return this._def.items}rest(e){return new yU({...this._def,rest:e})}}yU.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new yU({items:e,typeName:HU.ZodTuple,rest:null,...BF(t)})};class wU extends DF{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==lF.object)return vF(n,{code:dF.invalid_type,expected:lF.object,received:n.parsedType}),wF;const r=[],i=this._def.keyType,o=this._def.valueType;for(const s in n.data)r.push({key:i._parse(new PF(n,s,n.path,s)),value:o._parse(new PF(n,n.data[s],n.path,s)),alwaysSet:s in n.data});return n.common.async?yF.mergeObjectAsync(t,r):yF.mergeObjectSync(t,r)}get element(){return this._def.valueType}static create(e,t,n){return new wU(t instanceof DF?{keyType:e,valueType:t,typeName:HU.ZodRecord,...BF(n)}:{keyType:JF.create(),valueType:e,typeName:HU.ZodRecord,...BF(t)})}}class bU extends DF{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==lF.map)return vF(n,{code:dF.invalid_type,expected:lF.map,received:n.parsedType}),wF;const r=this._def.keyType,i=this._def.valueType,o=[...n.data.entries()].map(((e,t)=>{let[o,s]=e;return{key:r._parse(new PF(n,o,n.path,[t,"key"])),value:i._parse(new PF(n,s,n.path,[t,"value"]))}}));if(n.common.async){const e=new Map;return Promise.resolve().then((async()=>{for(const n of o){const r=await n.key,i=await n.value;if("aborted"===r.status||"aborted"===i.status)return wF;"dirty"!==r.status&&"dirty"!==i.status||t.dirty(),e.set(r.value,i.value)}return{status:t.value,value:e}}))}{const e=new Map;for(const n of o){const r=n.key,i=n.value;if("aborted"===r.status||"aborted"===i.status)return wF;"dirty"!==r.status&&"dirty"!==i.status||t.dirty(),e.set(r.value,i.value)}return{status:t.value,value:e}}}}bU.create=(e,t,n)=>new bU({valueType:t,keyType:e,typeName:HU.ZodMap,...BF(n)});class EU extends DF{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==lF.set)return vF(n,{code:dF.invalid_type,expected:lF.set,received:n.parsedType}),wF;const r=this._def;null!==r.minSize&&n.data.size<r.minSize.value&&(vF(n,{code:dF.too_small,minimum:r.minSize.value,type:"set",inclusive:!0,exact:!1,message:r.minSize.message}),t.dirty()),null!==r.maxSize&&n.data.size>r.maxSize.value&&(vF(n,{code:dF.too_big,maximum:r.maxSize.value,type:"set",inclusive:!0,exact:!1,message:r.maxSize.message}),t.dirty());const i=this._def.valueType;function o(e){const n=new Set;for(const r of e){if("aborted"===r.status)return wF;"dirty"===r.status&&t.dirty(),n.add(r.value)}return{status:t.value,value:n}}const s=[...n.data.values()].map(((e,t)=>i._parse(new PF(n,e,n.path,t))));return n.common.async?Promise.all(s).then((e=>o(e))):o(s)}min(e,t){return new EU({...this._def,minSize:{value:e,message:RF.toString(t)}})}max(e,t){return new EU({...this._def,maxSize:{value:e,message:RF.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}EU.create=(e,t)=>new EU({valueType:e,minSize:null,maxSize:null,typeName:HU.ZodSet,...BF(t)});class kU extends DF{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==lF.function)return vF(t,{code:dF.invalid_type,expected:lF.function,received:t.parsedType}),wF;function n(e,n){return mF({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,gF(),fF].filter((e=>!!e)),issueData:{code:dF.invalid_arguments,argumentsError:n}})}function r(e,n){return mF({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,gF(),fF].filter((e=>!!e)),issueData:{code:dF.invalid_return_type,returnTypeError:n}})}const i={errorMap:t.common.contextualErrorMap},o=t.data;if(this._def.returns instanceof RU){const e=this;return EF((async function(){for(var t=arguments.length,s=new Array(t),a=0;a<t;a++)s[a]=arguments[a];const c=new hF([]),l=await e._def.args.parseAsync(s,i).catch((e=>{throw c.addIssue(n(s,e)),c})),u=await Reflect.apply(o,this,l);return await e._def.returns._def.type.parseAsync(u,i).catch((e=>{throw c.addIssue(r(u,e)),c}))}))}{const e=this;return EF((function(){for(var t=arguments.length,s=new Array(t),a=0;a<t;a++)s[a]=arguments[a];const c=e._def.args.safeParse(s,i);if(!c.success)throw new hF([n(s,c.error)]);const l=Reflect.apply(o,this,c.data),u=e._def.returns.safeParse(l,i);if(!u.success)throw new hF([r(l,u.error)]);return u.data}))}}parameters(){return this._def.args}returnType(){return this._def.returns}args(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new kU({...this._def,args:yU.create(t).rest(aU.create())})}returns(e){return new kU({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,n){return new kU({args:e||yU.create([]).rest(aU.create()),returns:t||aU.create(),typeName:HU.ZodFunction,...BF(n)})}}class AU extends DF{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}AU.create=(e,t)=>new AU({getter:e,typeName:HU.ZodLazy,...BF(t)});class SU extends DF{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return vF(t,{received:t.data,code:dF.invalid_literal,expected:this._def.value}),wF}return{status:"valid",value:e.data}}get value(){return this._def.value}}function xU(e,t){return new _U({values:e,typeName:HU.ZodEnum,...BF(t)})}SU.create=(e,t)=>new SU({value:e,typeName:HU.ZodLiteral,...BF(t)});class _U extends DF{constructor(){super(...arguments),CF.set(this,void 0)}_parse(e){if("string"!==typeof e.data){const t=this._getOrReturnCtx(e),n=this._def.values;return vF(t,{expected:aF.joinValues(n),received:t.parsedType,code:dF.invalid_type}),wF}if(_F(this,CF,"f")||IF(this,CF,new Set(this._def.values),"f"),!_F(this,CF,"f").has(e.data)){const t=this._getOrReturnCtx(e),n=this._def.values;return vF(t,{received:t.data,code:dF.invalid_enum_value,options:n}),wF}return EF(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._def;return _U.create(e,{...this._def,...t})}exclude(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._def;return _U.create(this.options.filter((t=>!e.includes(t))),{...this._def,...t})}}CF=new WeakMap,_U.create=xU;class IU extends DF{constructor(){super(...arguments),TF.set(this,void 0)}_parse(e){const t=aF.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==lF.string&&n.parsedType!==lF.number){const e=aF.objectValues(t);return vF(n,{expected:aF.joinValues(e),received:n.parsedType,code:dF.invalid_type}),wF}if(_F(this,TF,"f")||IF(this,TF,new Set(aF.getValidEnumValues(this._def.values)),"f"),!_F(this,TF,"f").has(e.data)){const e=aF.objectValues(t);return vF(n,{received:n.data,code:dF.invalid_enum_value,options:e}),wF}return EF(e.data)}get enum(){return this._def.values}}TF=new WeakMap,IU.create=(e,t)=>new IU({values:e,typeName:HU.ZodNativeEnum,...BF(t)});class RU extends DF{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==lF.promise&&!1===t.common.async)return vF(t,{code:dF.invalid_type,expected:lF.promise,received:t.parsedType}),wF;const n=t.parsedType===lF.promise?t.data:Promise.resolve(t.data);return EF(n.then((e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap}))))}}RU.create=(e,t)=>new RU({type:e,typeName:HU.ZodPromise,...BF(t)});class CU extends DF{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===HU.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:n}=this._processInputParams(e),r=this._def.effect||null,i={addIssue:e=>{vF(n,e),e.fatal?t.abort():t.dirty()},get path(){return n.path}};if(i.addIssue=i.addIssue.bind(i),"preprocess"===r.type){const e=r.transform(n.data,i);if(n.common.async)return Promise.resolve(e).then((async e=>{if("aborted"===t.value)return wF;const r=await this._def.schema._parseAsync({data:e,path:n.path,parent:n});return"aborted"===r.status?wF:"dirty"===r.status||"dirty"===t.value?bF(r.value):r}));{if("aborted"===t.value)return wF;const r=this._def.schema._parseSync({data:e,path:n.path,parent:n});return"aborted"===r.status?wF:"dirty"===r.status||"dirty"===t.value?bF(r.value):r}}if("refinement"===r.type){const e=e=>{const t=r.refinement(e,i);if(n.common.async)return Promise.resolve(t);if(t instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1===n.common.async){const r=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return"aborted"===r.status?wF:("dirty"===r.status&&t.dirty(),e(r.value),{status:t.value,value:r.value})}return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then((n=>"aborted"===n.status?wF:("dirty"===n.status&&t.dirty(),e(n.value).then((()=>({status:t.value,value:n.value}))))))}if("transform"===r.type){if(!1===n.common.async){const e=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!SF(e))return e;const o=r.transform(e.value,i);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:o}}return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then((e=>SF(e)?Promise.resolve(r.transform(e.value,i)).then((e=>({status:t.value,value:e}))):e))}aF.assertNever(r)}}CU.create=(e,t,n)=>new CU({schema:e,typeName:HU.ZodEffects,effect:t,...BF(n)}),CU.createWithPreprocess=(e,t,n)=>new CU({schema:t,effect:{type:"preprocess",transform:e},typeName:HU.ZodEffects,...BF(n)});class TU extends DF{_parse(e){return this._getType(e)===lF.undefined?EF(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}TU.create=(e,t)=>new TU({innerType:e,typeName:HU.ZodOptional,...BF(t)});class PU extends DF{_parse(e){return this._getType(e)===lF.null?EF(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}PU.create=(e,t)=>new PU({innerType:e,typeName:HU.ZodNullable,...BF(t)});class NU extends DF{_parse(e){const{ctx:t}=this._processInputParams(e);let n=t.data;return t.parsedType===lF.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}NU.create=(e,t)=>new NU({innerType:e,typeName:HU.ZodDefault,defaultValue:"function"===typeof t.default?t.default:()=>t.default,...BF(t)});class BU extends DF{_parse(e){const{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},r=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return xF(r)?r.then((e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new hF(n.common.issues)},input:n.data})}))):{status:"valid",value:"valid"===r.status?r.value:this._def.catchValue({get error(){return new hF(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}BU.create=(e,t)=>new BU({innerType:e,typeName:HU.ZodCatch,catchValue:"function"===typeof t.catch?t.catch:()=>t.catch,...BF(t)});class DU extends DF{_parse(e){if(this._getType(e)!==lF.nan){const t=this._getOrReturnCtx(e);return vF(t,{code:dF.invalid_type,expected:lF.nan,received:t.parsedType}),wF}return{status:"valid",value:e.data}}}DU.create=e=>new DU({typeName:HU.ZodNaN,...BF(e)});const OU=Symbol("zod_brand");class LU extends DF{_parse(e){const{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}}class MU extends DF{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.common.async){return(async()=>{const e=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return"aborted"===e.status?wF:"dirty"===e.status?(t.dirty(),bF(e.value)):this._def.out._parseAsync({data:e.value,path:n.path,parent:n})})()}{const e=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return"aborted"===e.status?wF:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:n.path,parent:n})}}static create(e,t){return new MU({in:e,out:t,typeName:HU.ZodPipeline})}}class FU extends DF{_parse(e){const t=this._def.innerType._parse(e),n=e=>(SF(e)&&(e.value=Object.freeze(e.value)),e);return xF(t)?t.then((e=>n(e))):n(t)}unwrap(){return this._def.innerType}}function UU(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return e?sU.create().superRefine(((r,i)=>{var o,s;if(!e(r)){const e="function"===typeof t?t(r):"string"===typeof t?{message:t}:t,a=null===(s=null!==(o=e.fatal)&&void 0!==o?o:n)||void 0===s||s,c="string"===typeof e?{message:e}:e;i.addIssue({code:"custom",...c,fatal:a})}})):sU.create()}FU.create=(e,t)=>new FU({innerType:e,typeName:HU.ZodReadonly,...BF(t)});const jU={object:hU.lazycreate};var HU;!function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"}(HU||(HU={}));const zU=JF.create,VU=$F.create,qU=DU.create,GU=eU.create,KU=tU.create,WU=nU.create,QU=rU.create,YU=iU.create,ZU=oU.create,JU=sU.create,XU=aU.create,$U=cU.create,ej=lU.create,tj=uU.create,nj=hU.create,rj=hU.strictCreate,ij=fU.create,oj=gU.create,sj=vU.create,aj=yU.create,cj=wU.create,lj=bU.create,uj=EU.create,dj=kU.create,hj=AU.create,fj=SU.create,pj=_U.create,gj=IU.create,mj=RU.create,vj=CU.create,yj=TU.create,wj=PU.create,bj=CU.createWithPreprocess,Ej=MU.create,kj={string:e=>JF.create({...e,coerce:!0}),number:e=>$F.create({...e,coerce:!0}),boolean:e=>tU.create({...e,coerce:!0}),bigint:e=>eU.create({...e,coerce:!0}),date:e=>nU.create({...e,coerce:!0})},Aj=wF;var Sj=Object.freeze({__proto__:null,defaultErrorMap:fF,setErrorMap:function(e){pF=e},getErrorMap:gF,makeIssue:mF,EMPTY_PATH:[],addIssueToContext:vF,ParseStatus:yF,INVALID:wF,DIRTY:bF,OK:EF,isAborted:kF,isDirty:AF,isValid:SF,isAsync:xF,get util(){return aF},get objectUtil(){return cF},ZodParsedType:lF,getParsedType:uF,ZodType:DF,datetimeRegex:YF,ZodString:JF,ZodNumber:$F,ZodBigInt:eU,ZodBoolean:tU,ZodDate:nU,ZodSymbol:rU,ZodUndefined:iU,ZodNull:oU,ZodAny:sU,ZodUnknown:aU,ZodNever:cU,ZodVoid:lU,ZodArray:uU,ZodObject:hU,ZodUnion:fU,ZodDiscriminatedUnion:gU,ZodIntersection:vU,ZodTuple:yU,ZodRecord:wU,ZodMap:bU,ZodSet:EU,ZodFunction:kU,ZodLazy:AU,ZodLiteral:SU,ZodEnum:_U,ZodNativeEnum:IU,ZodPromise:RU,ZodEffects:CU,ZodTransformer:CU,ZodOptional:TU,ZodNullable:PU,ZodDefault:NU,ZodCatch:BU,ZodNaN:DU,BRAND:OU,ZodBranded:LU,ZodPipeline:MU,ZodReadonly:FU,custom:UU,Schema:DF,ZodSchema:DF,late:jU,get ZodFirstPartyTypeKind(){return HU},coerce:kj,any:JU,array:tj,bigint:GU,boolean:KU,date:WU,discriminatedUnion:oj,effect:vj,enum:pj,function:dj,instanceof:function(e){return UU((t=>t instanceof e),arguments.length>1&&void 0!==arguments[1]?arguments[1]:{message:"Input not instance of ".concat(e.name)})},intersection:sj,lazy:hj,literal:fj,map:lj,nan:qU,nativeEnum:gj,never:$U,null:ZU,nullable:wj,number:VU,object:nj,oboolean:()=>KU().optional(),onumber:()=>VU().optional(),optional:yj,ostring:()=>zU().optional(),pipeline:Ej,preprocess:bj,promise:mj,record:cj,set:uj,strictObject:rj,string:zU,symbol:QU,transformer:vj,tuple:aj,undefined:YU,union:ij,unknown:XU,void:ej,NEVER:Aj,ZodIssueCode:dF,quotelessJson:e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:"),ZodError:hF});const xj=e=>e.message?e.message:"unspecified error";class _j extends ZO{constructor(e){super(),this.code=1100,this.errors=e,super.message="Web3 validator found ".concat(e.length," error[s]:\n").concat(this._compileErrors().join("\n"))}_compileErrors(){return this.errors.map(xj)}}const Ij=["bool","int","uint","bytes","string","address","tuple"],Rj=e=>"object"===typeof e&&"type"in e&&"name"in e,Cj=e=>"string"===typeof e,Tj=e=>"string"===typeof e&&/^((-)?0x[0-9a-f]+|(0x))$/i.test(e);function Pj(e,t){return!("string"!==typeof e||!e.match(/^0x[0-9A-Fa-f]*$/))&&!("undefined"!==typeof t&&t>0&&e.length!==2+2*t)}const Nj=e=>"number"===typeof e||"bigint"===typeof e||"string"===typeof e&&/^((-0x|0x|-)?[0-9a-f]+|(0x))$/i.test(e);function Bj(e){if("string"!==typeof e)throw new Error("[isHexPrefixed] input must be type 'string', received type ".concat(typeof e));return e.startsWith("0x")}const Dj=function(e){for(const[t,n]of Object.entries(e))if(void 0!==n&&n.length>0&&0===n[0])throw new Error("".concat(t," cannot have leading zeroes, received: ").concat(n.toString()))},Oj=["hex","number","blockNumber","blockNumberOrTag","filter","bloom"],Lj=e=>{let t,n=e.replace(/ /,""),r=!1,i=[];if(e.includes("[")&&(n=n.slice(0,n.indexOf("[")),i=[...e.matchAll(/(?:\[(\d*)\])/g)].map((e=>parseInt(e[1],10))).map((e=>Number.isNaN(e)?-1:e)),r=i.length>0),Ij.includes(n))return{baseType:n,isArray:r,baseTypeSize:t,arraySizes:i};if(n.startsWith("int"))t=parseInt(n.substring(3),10),n="int";else if(n.startsWith("uint"))t=parseInt(e.substring(4),10),n="uint";else{if(!n.startsWith("bytes"))return{baseType:void 0,isArray:!1,baseTypeSize:void 0,arraySizes:i};t=parseInt(n.substring(5),10),n="bytes"}return{baseType:n,isArray:r,baseTypeSize:t,arraySizes:i}},Mj=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(Object.keys(t).includes("type"))throw new _j([{keyword:"eth",message:'Either "eth" or "type" can be presented in schema',params:{eth:e},instancePath:"",schemaPath:""}]);const{baseType:n,baseTypeSize:r}=Lj(e);if(!n&&!Oj.includes(e))throw new _j([{keyword:"eth",message:'Eth data type "'.concat(e,'" is not valid'),params:{eth:e},instancePath:"",schemaPath:""}]);if(n){if("tuple"===n)throw new Error('"tuple" type is not implemented directly.');return{format:"".concat(n).concat(null!==r&&void 0!==r?r:""),required:!0}}return e?{format:e,required:!0}:{}},Fj=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/0";const n={type:"array",items:[],maxItems:e.length,minItems:e.length};for(const[r,i]of e.entries()){let e,o,s=[];Rj(i)?(e=i.type,o=i.name,s=i.components):"string"===typeof i?(e=i,o="".concat(t,"/").concat(r)):Array.isArray(i)&&(i[0]&&"string"===typeof i[0]&&i[0].startsWith("tuple")&&!Array.isArray(i[0])&&i[1]&&Array.isArray(i[1])?(e=i[0],o="".concat(t,"/").concat(r),s=i[1]):(e="tuple",o="".concat(t,"/").concat(r),s=i));const{baseType:a,isArray:c,arraySizes:l}=Lj(e);let u,d=n;for(let t=l.length-1;t>0;t-=1)u={type:"array",$id:o,items:[],maxItems:l[t],minItems:l[t]},l[t]<0&&(delete u.maxItems,delete u.minItems),Array.isArray(d.items)?0===d.items.length?d.items=[u]:d.items.push(u):d.items=[d.items,u],d=u;if("tuple"!==a||c)if("tuple"===a&&c){const e=l[0],t=Object.assign({type:"array",$id:o,items:Fj(s,o)},e>=0&&{minItems:e,maxItems:e});d.items.push(t)}else if(c){const t=l[0],n=Object.assign({type:"array",$id:o,items:Mj(e)},t>=0&&{minItems:t,maxItems:t});d.items.push(n)}else Array.isArray(d.items),d.items.push(Object.assign({$id:o},Mj(e)));else{const e=Fj(s,o);e.$id=o,d.items.push(e)}d=n}return n},Uj=e=>Fj(e),jj=(e,t)=>1===t?e:jj(e[0],t-1),Hj=(e,t,n)=>{const r=[];for(const[i,o]of e.entries()){let e,s,a=[];Rj(o)?(e=o.type,s=o.name,a=o.components):"string"===typeof o?e=o:Array.isArray(o)&&(o[1]&&Array.isArray(o[1])?(e=o[0],a=o[1]):(e="tuple",a=o));const{baseType:c,isArray:l,arraySizes:u}=Lj(e),d=Array.isArray(t)?t[i]:t[s];if("tuple"!==c||l)if("tuple"===c&&l){const e=[];for(const t of d)if(u.length>1){const r=jj(t,u.length-1),i=[];for(const e of r)i.push(Hj(a,e,n));e.push(i)}else e.push(Hj(a,t,n));r.push(e)}else r.push(d);else r.push(Hj(a,d,n))}return(n=null!==n&&void 0!==n?n:[]).push(...r),n},zj=e=>{if(e>=48&&e<=57)return e-48;if(e>=65&&e<=70)return e-55;if(e>=97&&e<=102)return e-87;throw new Error("Invalid code point: ".concat(e))},Vj=e=>{if(!Tj(e))throw new Error("Invalid hex string");const[t,n]=e.startsWith("-")?[!0,e.slice(1)]:[!1,e],r=BigInt(n);return r>Number.MAX_SAFE_INTEGER?t?-r:r:r<Number.MIN_SAFE_INTEGER?r:t?-1*Number(r):Number(r)},qj=e=>{if(("number"===typeof e||"bigint"===typeof e)&&e<0)return"-0x".concat(e.toString(16).slice(1));if(("number"===typeof e||"bigint"===typeof e)&&e>=0)return"0x".concat(e.toString(16));if("string"===typeof e&&Tj(e)){const[t,n]=e.startsWith("-")?[!0,e.slice(1)]:[!1,e],r=n.split(/^(-)?0(x|X)/).slice(-1)[0];return"".concat(t?"-":"","0x").concat(r.replace(/^0+/,"").toLowerCase())}if("string"===typeof e&&!Tj(e))return qj(BigInt(e));throw new mM(e)},Gj=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"0";if("string"===typeof e&&!Tj(e))return e.padStart(t,n);const r="string"===typeof e&&Tj(e)?e:qj(e),[i,o]=r.startsWith("-")?["-0x",r.slice(3)]:["0x",r.slice(2)];return"".concat(i).concat(o.padStart(t,n))};function Kj(e){let t="0x";for(const n of e){const e=n.toString(16);t+=1===e.length?"0".concat(e):e}return t}const Wj={zero:48,nine:57,A:65,F:70,a:97,f:102};function Qj(e){return e>=Wj.zero&&e<=Wj.nine?e-Wj.zero:e>=Wj.A&&e<=Wj.F?e-(Wj.A-10):e>=Wj.a&&e<=Wj.f?e-(Wj.a-10):void 0}function Yj(e){let t=0;if(!e.startsWith("0")||"x"!==e[1]&&"X"!==e[1]||(t=2),e.length%2!==0)throw new gM("hex string has odd length: ".concat(e));const n=(e.length-t)/2,r=new Uint8Array(n);for(let i=0,o=t;i<n;i+=1){const t=Qj(e.charCodeAt(o++)),n=Qj(e.charCodeAt(o++));if(void 0===t||void 0===n)throw new gM('Invalid byte sequence ("'.concat(e[o-2]).concat(e[o-1],'" in "').concat(e,'").'));r[i]=16*t+n}return r}function Zj(e){var t;return e instanceof Uint8Array||"Uint8Array"!==(null===(t=null===e||void 0===e?void 0:e.constructor)||void 0===t?void 0:t.name)?e:Uint8Array.from(e)}const Jj=e=>{var t;return e instanceof Uint8Array||"Uint8Array"===(null===(t=null===e||void 0===e?void 0:e.constructor)||void 0===t?void 0:t.name)},Xj=function(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{abiType:"bytes"};if("string"!==typeof e&&!Array.isArray(e)&&!Jj(e))return!1;if("string"===typeof e&&Tj(e)&&e.startsWith("-"))return!1;if("string"===typeof e&&!Tj(e))return!1;if("string"===typeof e){if(e.length%2!==0)return!1;t=Yj(e)}else if(Array.isArray(e)){if(e.some((e=>e<0||e>255||!Number.isInteger(e))))return!1;t=new Uint8Array(e)}else t=e;if(null===n||void 0===n?void 0:n.abiType){const{baseTypeSize:e}=Lj(n.abiType);return!e||t.length===e}return!(null===n||void 0===n?void 0:n.size)||t.length===(null===n||void 0===n?void 0:n.size)},$j=e=>{if(!/^(0x)?[0-9a-f]{40}$/i.test(e))return!1;const t=e.slice(2),n=sI(t.toLowerCase()),r=Kj(sF(Zj(n))).slice(2);for(let i=0;i<40;i+=1)if(parseInt(r[i],16)>7&&t[i].toUpperCase()!==t[i]||parseInt(r[i],16)<=7&&t[i].toLowerCase()!==t[i])return!1;return!0},eH=function(e){let t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return!("string"!==typeof e&&!Jj(e))&&(t=Jj(e)?Kj(e):"string"!==typeof e||Tj(e)||e.toLowerCase().startsWith("0x")?e:"0x".concat(e),!!/^(0x)?[0-9a-f]{40}$/i.test(t)&&(!(!/^(0x|0X)?[0-9a-f]{40}$/.test(t)&&!/^(0x|0X)?[0-9A-F]{40}$/.test(t))||(!n||$j(t))))};var tH,nH;!function(e){e.NUMBER="NUMBER_NUMBER",e.HEX="NUMBER_HEX",e.STR="NUMBER_STR",e.BIGINT="NUMBER_BIGINT"}(tH||(tH={})),function(e){e.HEX="BYTES_HEX",e.UINT8ARRAY="BYTES_UINT8ARRAY"}(nH||(nH={}));const rH={number:tH.BIGINT,bytes:nH.HEX},iH={number:tH.HEX,bytes:nH.HEX};var oH,sH;!function(e){e.EARLIEST="earliest",e.LATEST="latest",e.PENDING="pending",e.SAFE="safe",e.FINALIZED="finalized"}(oH||(oH={})),function(e){e.chainstart="chainstart",e.frontier="frontier",e.homestead="homestead",e.dao="dao",e.tangerineWhistle="tangerineWhistle",e.spuriousDragon="spuriousDragon",e.byzantium="byzantium",e.constantinople="constantinople",e.petersburg="petersburg",e.istanbul="istanbul",e.muirGlacier="muirGlacier",e.berlin="berlin",e.london="london",e.altair="altair",e.arrowGlacier="arrowGlacier",e.grayGlacier="grayGlacier",e.bellatrix="bellatrix",e.merge="merge",e.capella="capella",e.shanghai="shanghai"}(sH||(sH={}));const aH=Object.getPrototypeOf(Uint8Array);var cH=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(BJ){o(BJ)}}function a(e){try{c(r.throw(e))}catch(BJ){o(BJ)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};const lH=Symbol.for("web3/base-provider");class uH{static isWeb3Provider(e){return e instanceof uH||Boolean(e&&e[lH])}get[lH](){return!0}send(e,t){this.request(e).then((e=>{t(null,e)})).catch((e=>{t(e)}))}sendAsync(e){return cH(this,void 0,void 0,(function*(){return this.request(e)}))}asEIP1193Provider(){const e=Object.create(this),t=e.request;return e.request=function(e){return cH(this,void 0,void 0,(function*(){return(yield t(e)).result}))},e.asEIP1193Provider=void 0,e}}class dH extends Array{constructor(e){super(),this._accountProvider=e}}const hH=(e,t)=>{let n=e;for(let r=1;r<t;r+=1)n*=e;return n},fH=function(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{abiType:"uint"};if(!["number","string","bigint"].includes(typeof e)||"string"===typeof e&&0===e.length)return!1;if(null===n||void 0===n?void 0:n.abiType){const{baseTypeSize:e}=Lj(n.abiType);e&&(t=e)}else n.bitSize&&(t=n.bitSize);const r=hH(BigInt(2),BigInt(null!==t&&void 0!==t?t:256))-BigInt(1);try{const t="string"===typeof e&&Tj(e)?BigInt(Vj(e)):BigInt(e);return t>=0&&t<=r}catch(i){return!1}},pH=function(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{abiType:"int"};if(!["number","string","bigint"].includes(typeof e))return!1;if("number"===typeof e&&e>Number.MAX_SAFE_INTEGER)return!1;if(null===n||void 0===n?void 0:n.abiType){const{baseTypeSize:e,baseType:r}=Lj(n.abiType);if("int"!==r)return!1;e&&(t=e)}else n.bitSize&&(t=n.bitSize);const r=hH(BigInt(2),BigInt((null!==t&&void 0!==t?t:256)-1)),i=BigInt(-1)*hH(BigInt(2),BigInt((null!==t&&void 0!==t?t:256)-1));try{const t="string"===typeof e&&Tj(e)?BigInt(Vj(e)):BigInt(e);return t>=i&&t<=r}catch(o){return!1}},gH=e=>!!pH(e)||(!("string"!==typeof e||!/[0-9.]/.test(e)||e.indexOf(".")!==e.lastIndexOf("."))||"number"===typeof e),mH=e=>fH(e),vH=e=>Object.values(oH).includes(e),yH=e=>vH(e)||mH(e),wH=e=>"string"===typeof e&&(!!/^(0x)?[0-9a-f]{512}$/i.test(e)&&!(!/^(0x)?[0-9a-f]{512}$/.test(e)&&!/^(0x)?[0-9A-F]{512}$/.test(e))),bH=(e,t)=>{if("string"===typeof t&&!Tj(t))return!1;if(!wH(e))return!1;const n="string"===typeof t?Yj(t):t,r=Kj(sF(n)).slice(2);for(let i=0;i<12;i+=4){const t=(parseInt(r.slice(i,i+2),16)<<8)+parseInt(r.slice(i+2,i+4),16)&2047,n=1<<t%4;if((zj(e.charCodeAt(e.length-1-Math.floor(t/4)))&n)!==n)return!1}return!0},EH=e=>void 0===e||null===e,kH=e=>"object"===typeof e&&!EH(e)&&!Array.isArray(e)&&!(e instanceof aH),AH=e=>"string"===typeof e&&(!!/^(0x)?[0-9a-f]{64}$/i.test(e)&&!(!/^(0x)?[0-9a-f]{64}$/.test(e)&&!/^(0x)?[0-9A-F]{64}$/.test(e))),SH={address:e=>eH(e),bloom:e=>wH(e),blockNumber:e=>mH(e),blockTag:e=>vH(e),blockNumberOrTag:e=>yH(e),bool:e=>{return!!["number","string","boolean"].includes(typeof(t=e))&&("boolean"===typeof t||("string"!==typeof t||Tj(t)?"string"===typeof t&&Tj(t)?"0x1"===t||"0x0"===t:1===t||0===t:"1"===t||"0"===t));var t},bytes:e=>Xj(e),filter:e=>(e=>{const t=["fromBlock","toBlock","address","topics","blockHash"];if(EH(e)||"object"!==typeof e)return!1;if(!Object.keys(e).every((e=>t.includes(e))))return!1;if(!EH(e.fromBlock)&&!yH(e.fromBlock)||!EH(e.toBlock)&&!yH(e.toBlock))return!1;if(!EH(e.address))if(Array.isArray(e.address)){if(!e.address.every((e=>eH(e))))return!1}else if(!eH(e.address))return!1;return!(!EH(e.topics)&&!e.topics.every((e=>!!EH(e)||(Array.isArray(e)?e.every((e=>AH(e))):!!AH(e)))))})(e),hex:e=>Tj(e),uint:e=>fH(e),int:e=>pH(e),number:e=>gH(e),string:e=>Cj(e)};for(let n=8;n<=256;n+=8)SH["int".concat(n)]=e=>pH(e,{bitSize:n}),SH["uint".concat(n)]=e=>fH(e,{bitSize:n});for(let n=1;n<=32;n+=1)SH["bytes".concat(n)]=e=>Xj(e,{size:n});SH.bytes256=SH.bytes;const xH=SH,_H=e=>{if((!(null===e||void 0===e?void 0:e.type)||"object"===(null===e||void 0===e?void 0:e.type))&&(null===e||void 0===e?void 0:e.properties)){const t={};for(const n of Object.keys(e.properties)){const r=_H(e.properties[n]);r&&(t[n]=r)}return Array.isArray(e.required)?Sj.object(t).partial().required(e.required.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t]:!0})),{})):Sj.object(t).partial()}if("array"===(null===e||void 0===e?void 0:e.type)&&(null===e||void 0===e?void 0:e.items)){if(Array.isArray(e.items)&&e.items.length>1&&void 0!==e.maxItems&&new Set(e.items.map((e=>e.$id))).size===e.items.length){const t=[];for(const n of e.items){const e=_H(n);e&&t.push(e)}return Sj.tuple(t)}const t=Array.isArray(e.items)?e.items[0]:e.items;let n=Sj.array(_H(t));return n=void 0!==e.minItems?n.min(e.minItems):n,n=void 0!==e.maxItems?n.max(e.maxItems):n,n}if(e.oneOf&&Array.isArray(e.oneOf))return Sj.union(e.oneOf.map((e=>_H(e))));if(null===e||void 0===e?void 0:e.format){if(!xH[e.format])throw new MM(e.format);return Sj.any().refine(xH[e.format],(t=>({params:{value:t,format:e.format}})))}return(null===e||void 0===e?void 0:e.type)&&"object"!==(null===e||void 0===e?void 0:e.type)&&"function"===typeof Sj[String(e.type)]?Sj[String(e.type)]():Sj.object({data:Sj.any()}).partial()};class IH{static factory(){return IH.validatorInstance||(IH.validatorInstance=new IH),IH.validatorInstance}validate(e,t,n){var r,i;const o=_H(e).safeParse(t);if(!o.success){const e=this.convertErrors(null!==(i=null===(r=o.error)||void 0===r?void 0:r.issues)&&void 0!==i?i:[]);if(e){if(null===n||void 0===n?void 0:n.silent)return e;throw new _j(e)}}}convertErrors(e){if(e&&Array.isArray(e)&&e.length>0)return e.map((e=>{var t;let n,r,i,o;o=e.path.join("/");const s=String(e.path[e.path.length-1]),a=e.path.join("/");if(e.code===dF.too_big)r="maxItems",o="".concat(a,"/maxItems"),i={limit:e.maximum},n="must NOT have more than ".concat(e.maximum," items");else if(e.code===dF.too_small)r="minItems",o="".concat(a,"/minItems"),i={limit:e.minimum},n="must NOT have fewer than ".concat(e.minimum," items");else if(e.code===dF.custom){const{value:r,format:s}=null!==(t=e.params)&&void 0!==t?t:{};n="undefined"===typeof r?'value at "/'.concat(o,'" is required'):'value "'.concat("object"===typeof r?JSON.stringify(r):r,'" at "/').concat(o,'" must pass "').concat(s,'" validation'),i={value:r}}return{keyword:null!==r&&void 0!==r?r:s,instancePath:a?"/".concat(a):"",schemaPath:o?"#".concat(o):"#",params:null!==i&&void 0!==i?i:{value:e.message},message:null!==n&&void 0!==n?n:e.message}}))}}const RH=new class{constructor(){this._validator=IH.factory()}validateJSONSchema(e,t,n){return this._validator.validate(e,t,n)}validate(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{silent:!1};var r,i;const o=Uj(e);if(!Array.isArray(o.items)||0!==(null===(r=o.items)||void 0===r?void 0:r.length)||0!==t.length){if(Array.isArray(o.items)&&0===(null===(i=o.items)||void 0===i?void 0:i.length)&&0!==t.length)throw new _j([{instancePath:"/0",schemaPath:"/",keyword:"required",message:"empty schema against data can not be validated",params:t}]);return this._validator.validate(o,t,n)}}};function CH(e){var t,n;return e instanceof Uint8Array||"Uint8Array"===(null===(t=null===e||void 0===e?void 0:e.constructor)||void 0===t?void 0:t.name)||"Buffer"===(null===(n=null===e||void 0===e?void 0:e.constructor)||void 0===n?void 0:n.name)}function TH(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=t.reduce(((e,t)=>e+t.length),0),i=new Uint8Array(r);let o=0;for(const s of t)i.set(s,o),o+=s.length;return i}function PH(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n+=1)if(e[n]!==t[n])return!1;return!0}const NH={noether:BigInt(0),wei:BigInt(1),kwei:BigInt(1e3),Kwei:BigInt(1e3),babbage:BigInt(1e3),femtoether:BigInt(1e3),mwei:BigInt(1e6),Mwei:BigInt(1e6),lovelace:BigInt(1e6),picoether:BigInt(1e6),gwei:BigInt(1e9),Gwei:BigInt(1e9),shannon:BigInt(1e9),nanoether:BigInt(1e9),nano:BigInt(1e9),szabo:BigInt(1e12),microether:BigInt(1e12),micro:BigInt(1e12),finney:BigInt(1e15),milliether:BigInt(1e15),milli:BigInt(1e15),ether:BigInt("1000000000000000000"),kether:BigInt("1000000000000000000000"),grand:BigInt("1000000000000000000000"),mether:BigInt("1000000000000000000000000"),gether:BigInt("1000000000000000000000000000"),tether:BigInt("1000000000000000000000000000000")},BH=e=>{if(RH.validate(["bytes"],[e]),CH(e))return e;if(Array.isArray(e))return new Uint8Array(e);if("string"===typeof e)return Yj(e);throw new gM(e)},{uint8ArrayToHexString:DH}=k,OH=e=>DH(BH(e)),LH=e=>"string"===typeof e&&"0x"!==e.slice(0,2).toLowerCase()?BH("0x".concat(e)):BH(e),MH=e=>(RH.validate(["hex"],[e]),Vj(e)),FH=MH,UH=(e,t)=>{"bigint"!==typeof e&&RH.validate(["int"],[e]);let n=qj(e);return t&&(n.startsWith("-")||n.length%2!==1?n.length%2===0&&n.startsWith("-")&&(n="-0x0".concat(n.slice(3))):n="0x0".concat(n.slice(2))),n},jH=UH,HH=e=>MH(e).toString(),zH=e=>{RH.validate(["string"],[e]);let t=e.replace(/^(?:\u0000)/,"");return t=t.replace(/(?:\u0000)$/,""),OH((new TextEncoder).encode(t))},VH=zH,qH=zH,GH=e=>iF(LH(e)),KH=e=>"string"===typeof e?GH(e):(RH.validate(["bytes"],[e]),iF(e)),WH=sI,QH=GH,YH=e=>{RH.validate(["string"],[e]);let t="";for(let n=0;n<e.length;n+=1){const r=e.charCodeAt(n).toString(16);t+=r.length%2!==0?"0".concat(r):r}return"0x".concat(t)},ZH=YH,JH=e=>new TextDecoder("ascii").decode(LH(e)),XH=JH,$H=(e,t)=>{if("string"===typeof e&&eH(e))return t?"address":"0x".concat(e.toLowerCase().replace(/^0x/i,""));if("boolean"===typeof e)return t?"bool":e?"0x01":"0x00";if("number"===typeof e)return t?e<0?"int256":"uint256":UH(e);if("bigint"===typeof e)return t?"bigint":UH(e);if(CH(e))return t?"bytes":OH(e);if("object"===typeof e&&e)return t?"string":zH(JSON.stringify(e));if("string"===typeof e){if(e.startsWith("-0x")||e.startsWith("-0X"))return t?"int256":UH(e);if(Tj(e))return t?"bytes":e;if(Nj(e)&&!pH(e)&&!fH(e))return t?"bytes":"0x".concat(e);if(Nj(e)&&!pH(e)&&fH(e))return t?"uint":UH(e);if(!Number.isFinite(e))return t?"string":zH(e)}throw new bM(e)},ez=e=>{if("number"===typeof e)return e>1e20?BigInt(e):e;if("bigint"===typeof e)return e>=Number.MIN_SAFE_INTEGER&&e<=Number.MAX_SAFE_INTEGER?Number(e):e;if("string"===typeof e&&Tj(e))return MH(e);try{return ez(BigInt(e))}catch(dk){throw new mM(e)}},tz=e=>{if("number"===typeof e)return BigInt(e);if("bigint"===typeof e)return e;if("string"===typeof e&&Nj(e))return e.startsWith("-")?-BigInt(e.substring(1)):BigInt(e);throw new mM(e)},nz=(e,t)=>{const n=NH[t];if(!n)throw new wM(t);const r=String(ez(e)),i=n.toString().length-1;if(i<=0)return r.toString();const o=r.padStart(i,"0"),s=o.slice(0,-i),a=o.slice(-i).replace(/\.?0+$/,"");return""===s?"0.".concat(a):""===a?s:"".concat(s,".").concat(a)},rz=(e,t)=>{RH.validate(["number"],[e]);const n=NH[t];if(!n)throw new wM(t);const[r,i]=String("string"!==typeof e||Tj(e)?ez(e):e).split(".").concat(""),o=BigInt("".concat(r).concat(i))*n,s=n.toString().length-1,a=Math.min(i.length,s);return 0===a?o.toString():o.toString().padStart(a,"0").slice(0,-a)},iz=e=>{if(!eH(e,!1))throw new vM(e);const t=e.toLowerCase().replace(/^0x/i,""),n=Kj(sF(Zj(WH(t))));if(EH(n)||"0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470"===n)return"";let r="0x";const i=n.replace(/^0x/i,"");for(let o=0;o<t.length;o+=1)parseInt(i[o],16)>7?r+=t[o].toUpperCase():r+=t[o];return r},oz=e=>{if("boolean"===typeof e)return e;if("number"===typeof e&&(0===e||1===e))return Boolean(e);if("bigint"===typeof e&&(e===BigInt(0)||e===BigInt(1)))return Boolean(e);if("string"===typeof e&&!Tj(e)&&("1"===e||"0"===e||"false"===e||"true"===e))return"true"===e||"false"!==e&&Boolean(Number(e));if("string"===typeof e&&Tj(e)&&("0x1"===e||"0x0"===e))return Boolean(ez(e));throw new kM(e)};var sz=n(6926);const az=sz;class cz extends az{constructor(){super(...arguments),this.maxListeners=Number.MAX_SAFE_INTEGER}setMaxListeners(e){return this.maxListeners=e,this}getMaxListeners(){return this.maxListeners}}const lz=Tj,uz=Nj,dz=$j,hz=eH,fz=wH,pz=bH,gz=(e,t)=>{if(!wH(e))return!1;if(!eH(t))return!1;const n=Gj(t,64);return bH(e,n)},mz=(e,t)=>!!wH(e)&&(!!eH(t)&&bH(e,t)),vz=AH,yz=(e,t)=>!!wH(e)&&(!!AH(t)&&bH(e,t)),wz=(e,t)=>{const n="string"===typeof e&&vH(e),r="string"===typeof t&&vH(t);if(e===t||("earliest"===e||0===e)&&("earliest"===t||0===t))return 0;if("earliest"===e&&t>0)return-1;if("earliest"===t&&e>0)return 1;if(n&&r){const n={[oH.EARLIEST]:1,[oH.FINALIZED]:2,[oH.SAFE]:3,[oH.LATEST]:4,[oH.PENDING]:5};return n[e]<n[t]?-1:1}if(n&&!r||!n&&r)throw new _M("Cannot compare blocktag with provided non-blocktag input.");const i=BigInt(e),o=BigInt(t);return i<o?-1:i===o?0:1},bz=e=>"object"===typeof e&&!EH(e)&&0!==Object.keys(e).length&&["input","data","from","gas","gasPrice","gasLimit","address","jsonInterface","syncWithContext","dataInputFill"].some((t=>t in e)),Ez=EH,kz=e=>"object"===typeof e&&!EH(e)&&!Array.isArray(e)&&!(e instanceof aH),Az=function(e){if(!kz(e))return e;const t=Object.assign({},e);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(const o of r)for(const e in o)kz(o[e])?(t[e]||(t[e]={}),t[e]=Az(t[e],o[e])):!EH(o[e])&&Object.hasOwnProperty.call(o,e)&&(Array.isArray(o[e])||o[e]instanceof aH?t[e]=o[e].slice(0):t[e]=o[e]);return t},Sz=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"0";return"string"===typeof e?Tj(e)?Gj(e,t,n):e.padStart(t,n):(RH.validate(["int"],[e]),Gj(e,t,n))},xz=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"0";if("string"===typeof e&&!Tj(e))return e.padEnd(t,n);RH.validate(["int"],[e]);const r="string"===typeof e&&Tj(e)?e:UH(e),i=r.startsWith("-")?3:2;return r.padEnd(t+i,n)},_z=xz,Iz=Sz,Rz=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64;RH.validate(["int"],[e]);const n=ez(e);if(n>=0)return Sz($H(n),t);const r=hH(BigInt(2),BigInt(4*t));if(-n>=r)throw new EM("value: ".concat(e,", nibbleWidth: ").concat(t));const i=BigInt(n);return Sz(UH(i+r),t)},Cz=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64;RH.validate(["int"],[e]);const n=ez(e);if(n<0)return n;const r=Math.ceil(Math.log(Number(n))/Math.log(2));if(r>4*t)throw new EM('value: "'.concat(e,'", nibbleWidth: "').concat(t,'"'));if(4*t!==r)return n;const i=hH(BigInt(2),BigInt(t)*BigInt(4));return ez(BigInt(n)-i)},{parseBaseType:Tz}=k,Pz=e=>"object"===typeof e&&!EH(e)&&"number"in e&&"bytes"in e,Nz=function(e,t){let n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=Object.assign({},e);for(const o of t){if(i.oneOf&&n){const e=r.find((function(e){return this===e[0]}),null!==n&&void 0!==n?n:"");e&&e[0]===n&&(i=i.oneOf[e[1]])}if(!i.properties&&!i.items)return;if(i.properties)i=i.properties[o];else if(i.items&&i.items.properties){const e=i.items.properties;if(!e)return;i=e[o]}else i.items&&kH(i.items)?i=i.items:i.items&&Array.isArray(i.items)&&(i=i.items[parseInt(o,10)]);i&&o&&(n=o)}return i},Bz=(e,t,n)=>{try{const{baseType:r,baseTypeSize:i}=Tz(t);if("int"===r||"uint"===r)switch(n.number){case tH.NUMBER:return Number(tz(e));case tH.HEX:return UH(tz(e));case tH.STR:return tz(e).toString();case tH.BIGINT:return tz(e);default:throw new bL("Invalid format: ".concat(String(n.number)))}if("bytes"===r){let t;switch(i?"string"===typeof e?t=Sz(e,2*i):CH(e)&&(t=TH(new Uint8Array(i-e.length),e)):t=e,n.bytes){case nH.HEX:return OH(BH(t));case nH.UINT8ARRAY:return BH(t);default:throw new bL("Invalid format: ".concat(String(n.bytes)))}}}catch(r){return e}return e},Dz=function(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];var o,s;if(!kH(e)&&!Array.isArray(e))return Bz(e,null===t||void 0===t?void 0:t.format,r);const a=e;for(const[c,l]of Object.entries(a)){n.push(c);const e=Nz(t,n,i);if(EH(e))delete a[c],n.pop();else if(kH(l))Dz(l,t,n,r),n.pop();else{if(Array.isArray(l)){let u=e;if(void 0!==(null===e||void 0===e?void 0:e.oneOf)&&e.oneOf.forEach(((t,n)=>{var r,o;!Array.isArray(null===e||void 0===e?void 0:e.items)&&("object"===typeof l[0]&&"object"===(null===(r=null===t||void 0===t?void 0:t.items)||void 0===r?void 0:r.type)||"string"===typeof l[0]&&"object"!==(null===(o=null===t||void 0===t?void 0:t.items)||void 0===o?void 0:o.type))&&(u=t,i.push([c,n]))})),EH(null===u||void 0===u?void 0:u.items)){delete a[c],n.pop();continue}if(kH(u.items)&&!EH(u.items.format)){for(let e=0;e<l.length;e+=1)a[c][e]=Bz(l[e],null===(o=null===u||void 0===u?void 0:u.items)||void 0===o?void 0:o.format,r);n.pop();continue}if(!Array.isArray(null===u||void 0===u?void 0:u.items)&&"object"===(null===(s=null===u||void 0===u?void 0:u.items)||void 0===s?void 0:s.type)){for(const e of l)Dz(e,t,n,r,i);n.pop();continue}if(Array.isArray(null===u||void 0===u?void 0:u.items)){for(let e=0;e<l.length;e+=1)a[c][e]=Bz(l[e],u.items[e].format,r);n.pop();continue}}a[c]=Bz(l,e.format,r),n.pop()}}return a},Oz=(e,t,n)=>{let r;r=kH(t)?Az({},t):Array.isArray(t)?[...t]:t;const i=kH(e)?e:Uj(e);if(!i.properties&&!i.items&&!i.format)throw new bL("Invalid json schema for formatting");return Dz(r,i,[],n)},Lz="0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470",Mz=e=>{let t;t="string"===typeof e?e.startsWith("0x")&&Tj(e)?LH(e):sI(e):e;const n=OH(sF(Zj(t)));return n===Lz?void 0:n},Fz=e=>{const t=Mz(e);return EH(t)?Lz:t},Uz=e=>{let t;return t="bigint"===typeof e||"number"===typeof e?sI(e.toString()):Array.isArray(e)?new Uint8Array(e):"string"!==typeof e||Tj(e)?BH(e):sI(e),OH(sF(Zj(t)))},jz=(e,t)=>{const n=/^(\d+).*$/.exec(e.slice(t));return n?parseInt(n[1],10):0},Hz=e=>e.toString(2).length,zz=(e,t)=>{const n=t.toString();if("string"===e){if("string"===typeof t)return zH(t);throw new yM(t)}if("bool"===e||"boolean"===e){if("boolean"===typeof t)return t?"01":"00";throw new kM(t)}if("address"===e){if(!eH(n))throw new vM(n);return n}const r=(e=>e.startsWith("int[")?"int256".concat(e.slice(3)):"int"===e?"int256":e.startsWith("uint[")?"uint256'".concat(e.slice(4)):"uint"===e?"uint256":e)(e);if(e.startsWith("uint")){const e=jz(r,4);if(e%8||e<8||e>256)throw new SM(n);const t=ez(n);if(Hz(t)>e)throw new xM(n);if(t<BigInt(0))throw new AM(n);return e?Iz(t.toString(16),e/8*2):t.toString(16)}if(e.startsWith("int")){const t=jz(r,3);if(t%8||t<8||t>256)throw new SM(e);const i=ez(n);if(Hz(i)>t)throw new xM(n);return i<BigInt(0)?Rz(i.toString(),t/8*2):t?Iz(i.toString(16),t/4):i.toString(16)}if("bytes"===r){if(n.replace(/^0x/i,"").length%2!==0)throw new gM(n);return n}if(e.startsWith("bytes")){if(n.replace(/^0x/i,"").length%2!==0)throw new gM(n);const t=jz(e,5);if(!t||t<1||t>64||t<n.replace(/^0x/i,"").length/2)throw new gM(n);return _z(n,2*t)}return""},Vz=e=>{const[t,n]=(e=>{if(Array.isArray(e))throw new Error("Autodetection of array types is not supported.");let t,n;if("object"===typeof e&&("t"in e||"type"in e)&&("v"in e||"value"in e))t="t"in e?e.t:e.type,n="v"in e?e.v:e.value,t="bigint"===t.toLowerCase()?"int":t;else{if("bigint"===typeof e)return["int",e];t=$H(e,!0),n=$H(e),t.startsWith("int")||t.startsWith("uint")||(t="bytes")}return!t.startsWith("int")&&!t.startsWith("uint")||"string"!==typeof n||/^(-)?0x/i.test(n)||(n=tz(n)),[t,n]})(e);if(Array.isArray(n)){return n.map((e=>zz(t,e).replace("0x",""))).join("")}return zz(t,n).replace("0x","")},qz=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=t.map(Vz);return"0x".concat(r.join("").toLowerCase())},Gz=function(){return Mz(qz(...arguments))},Kz=function(){return Fz(qz(...arguments))},Wz=e=>Mz("0x".concat(("number"===typeof e?e.toString():e).padStart(64,"0")));const Qz=e=>function(e){return fI(e)}(e),Yz=e=>OH(Qz(e));var Zz=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(BJ){o(BJ)}}function a(e){try{c(r.throw(e))}catch(BJ){o(BJ)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};function Jz(e){return("object"===typeof e||"function"===typeof e)&&"function"===typeof e.then}function Xz(e,t,n){return Zz(this,void 0,void 0,(function*(){let r;const i=yield Promise.race([e instanceof Promise?e:e(),new Promise(((e,i)=>{r=setTimeout((()=>n?i(n):e(void 0)),t)}))]);if(r&&clearTimeout(r),i instanceof Error)throw i;return i}))}function $z(e,t){let n;const r=new Promise(((r,i)=>{n=setInterval(function o(){return(()=>{Zz(this,void 0,void 0,(function*(){try{const i=yield Xz(e,t);EH(i)||(clearInterval(n),r(i))}catch(o){clearInterval(n),i(o)}}))})(),o}(),t)}));return[r,n]}function eV(e,t){return Zz(this,void 0,void 0,(function*(){return $z(e,t)[0]}))}function tV(e,t){let n;const r=new Promise(((r,i)=>{n=setTimeout((()=>{i(t)}),e)}));return[n,r]}function nV(e,t){let n;const r=new Promise(((r,i)=>{n=setInterval((()=>{(()=>{Zz(this,void 0,void 0,(function*(){const t=yield e();t&&(clearInterval(n),i(t))}))})()}),t)}));return[n,r]}const rV=()=>{const e=Qz(16);e[6]=15&e[6]|64,e[8]=63&e[8]|128;const t=OH(e);return[t.substring(2,10),t.substring(10,14),t.substring(14,18),t.substring(18,22),t.substring(22,34)].join("-")},iV=e=>{const t=e.error.code;return LM.has(t)||t>=-32099&&t<=-32e3},oV=e=>!Array.isArray(e)&&!!e&&"2.0"===e.jsonrpc&&"result"in e&&EH(e.error)&&("number"===typeof e.id||"string"===typeof e.id),sV=e=>!Array.isArray(e)&&"2.0"===e.jsonrpc&&!!e&&EH(e.result)&&"error"in e&&("number"===typeof e.id||"string"===typeof e.id),aV=e=>!Array.isArray(e)&&!!e&&"2.0"===e.jsonrpc&&!EH(e.params)&&!EH(e.method),cV=e=>!Array.isArray(e)&&!!e&&"2.0"===e.jsonrpc&&"id"in e&&"result"in e,lV=e=>oV(e)||sV(e),uV=e=>Array.isArray(e)?e.every(lV):lV(e),dV=e=>Array.isArray(e)&&e.length>0&&uV(e);let hV;const fV=e=>{hV=e},pV=e=>{var t,n,r,i;return"undefined"!==typeof hV&&(hV+=1),{jsonrpc:null!==(t=e.jsonrpc)&&void 0!==t?t:"2.0",id:null!==(r=null!==(n=e.id)&&void 0!==n?n:hV)&&void 0!==r?r:rV(),method:e.method,params:null!==(i=e.params)&&void 0!==i?i:void 0}},gV=e=>e.map((e=>pV(e))),mV=e=>Array.isArray(e)&&e.length>0;var vV,yV=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(BJ){o(BJ)}}function a(e){try{c(r.throw(e))}catch(BJ){o(BJ)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};class wV{constructor(){let{timeout:e,eagerStart:t,timeoutMessage:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{timeout:0,eagerStart:!1,timeoutMessage:"DeferredPromise timed out"};this[vV]="Promise",this._state="pending",this._promise=new Promise(((e,t)=>{this._resolve=e,this._reject=t})),this._timeoutMessage=n,this._timeoutInterval=e,t&&this.startTimer()}get state(){return this._state}then(e,t){return yV(this,void 0,void 0,(function*(){return this._promise.then(e,t)}))}catch(e){return yV(this,void 0,void 0,(function*(){return this._promise.catch(e)}))}finally(e){return yV(this,void 0,void 0,(function*(){return this._promise.finally(e)}))}resolve(e){this._resolve(e),this._state="fulfilled",this._clearTimeout()}reject(e){this._reject(e),this._state="rejected",this._clearTimeout()}startTimer(){this._timeoutInterval&&this._timeoutInterval>0&&(this._timeoutId=setTimeout(this._checkTimeout.bind(this),this._timeoutInterval))}_checkTimeout(){"pending"===this._state&&this._timeoutId&&this.reject(new kL(this._timeoutMessage))}_clearTimeout(){this._timeoutId&&clearTimeout(this._timeoutId)}}vV=Symbol.toStringTag;class bV{constructor(e,t){this.eventEmitter=e,this.autoReconnect=t,this.chunkTimeout=15e3}clearQueues(){"function"===typeof this._clearQueues&&this._clearQueues()}onError(e){this._clearQueues=e}parseResponse(e){const t=[];return e.replace(/\}[\n\r]?\{/g,"}|--|{").replace(/\}\][\n\r]?\[\{/g,"}]|--|[{").replace(/\}[\n\r]?\[\{/g,"}|--|[{").replace(/\}\][\n\r]?\{/g,"}]|--|{").split("|--|").forEach((e=>{let n,r=e;this.lastChunk&&(r=this.lastChunk+r);try{n=JSON.parse(r)}catch(BJ){return this.lastChunk=r,this.lastChunkTimeout&&clearTimeout(this.lastChunkTimeout),void(this.lastChunkTimeout=setTimeout((()=>{this.autoReconnect||(this.clearQueues(),this.eventEmitter.emit("error",new CM({id:1,jsonrpc:"2.0",error:{code:2,message:"Chunk timeout"}})))}),this.chunkTimeout))}clearTimeout(this.lastChunkTimeout),this.lastChunk=void 0,n&&t.push(n)})),t}}var EV=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(BJ){o(BJ)}}function a(e){try{c(r.throw(e))}catch(BJ){o(BJ)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};class kV extends uH{constructor(){super(...arguments),this._eventEmitter=new sz,this._chainId="",this._accounts=[]}_getChainId(){var e;return EV(this,void 0,void 0,(function*(){const t=yield this.request(pV({method:"eth_chainId",params:[]}));return null!==(e=null===t||void 0===t?void 0:t.result)&&void 0!==e?e:""}))}_getAccounts(){var e;return EV(this,void 0,void 0,(function*(){const t=yield this.request(pV({method:"eth_accounts",params:[]}));return null!==(e=null===t||void 0===t?void 0:t.result)&&void 0!==e?e:[]}))}_onConnect(){Promise.all([this._getChainId().then((e=>{e!==this._chainId&&(this._chainId=e,this._eventEmitter.emit("chainChanged",this._chainId))})).catch((e=>{console.error(e)})),this._getAccounts().then((e=>{this._accounts.length===e.length&&e.every((t=>e.includes(t)))||(this._accounts=e,this._onAccountsChanged())})).catch((e=>{console.error(e)}))]).then((()=>this._eventEmitter.emit("connect",{chainId:this._chainId}))).catch((e=>{console.error(e)}))}_onDisconnect(e,t){this._eventEmitter.emit("disconnect",new OM(e,t))}_onAccountsChanged(){this._eventEmitter.emit("accountsChanged",this._accounts)}}var AV=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(BJ){o(BJ)}}function a(e){try{c(r.throw(e))}catch(BJ){o(BJ)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};const SV={autoReconnect:!0,delay:5e3,maxAttempts:5};class xV extends kV{constructor(e,t,n){if(super(),this._connectionStatus="connecting",this._onMessageHandler=this._onMessage.bind(this),this._onOpenHandler=this._onConnect.bind(this),this._onCloseHandler=this._onCloseEvent.bind(this),this._onErrorHandler=this._onError.bind(this),!this._validateProviderPath(e))throw new IL(e);this._socketPath=e,this._socketOptions=t,this._reconnectOptions=Object.assign(Object.assign({},SV),null!==n&&void 0!==n?n:{}),this._pendingRequestsQueue=new Map,this._sentRequestsQueue=new Map,this._init(),this.connect(),this.chunkResponseParser=new bV(this._eventEmitter,this._reconnectOptions.autoReconnect),this.chunkResponseParser.onError((()=>{this._clearQueues()})),this.isReconnecting=!1}get SocketConnection(){return this._socketConnection}_init(){this._reconnectAttempts=0}connect(){try{this._openSocketConnection(),this._connectionStatus="connecting",this._addSocketListeners()}catch(BJ){if(!this.isReconnecting)throw this._connectionStatus="disconnected",BJ&&BJ.message?new aL("Error while connecting to ".concat(this._socketPath,". Reason: ").concat(BJ.message)):new IL(this._socketPath);setImmediate((()=>{this._reconnect()}))}}_validateProviderPath(e){return!!e}getPendingRequestQueueSize(){return this._pendingRequestsQueue.size}getSentRequestsQueueSize(){return this._sentRequestsQueue.size}supportsSubscriptions(){return!0}on(e,t){this._eventEmitter.on(e,t)}once(e,t){this._eventEmitter.once(e,t)}removeListener(e,t){this._eventEmitter.removeListener(e,t)}_onDisconnect(e,t){this._connectionStatus="disconnected",super._onDisconnect(e,t)}disconnect(e,t){const n=null!==e&&void 0!==e?e:1e3;this._removeSocketListeners(),"disconnected"!==this.getStatus()&&this._closeSocketConnection(n,t),this._onDisconnect(n,t)}safeDisconnect(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e3;return AV(this,void 0,void 0,(function*(){let i=0;yield(()=>AV(this,void 0,void 0,(function*(){return new Promise((e=>{const t=setInterval((()=>{n&&5===i&&this.clearQueues(),0===this.getPendingRequestQueueSize()&&0===this.getSentRequestsQueueSize()&&(clearInterval(t),e(!0)),i+=1}),r)}))})))(),this.disconnect(e,t)}))}removeAllListeners(e){this._eventEmitter.removeAllListeners(e)}_onError(e){this.isReconnecting?this._reconnect():this._eventEmitter.emit("error",e)}reset(){this._sentRequestsQueue.clear(),this._pendingRequestsQueue.clear(),this._init(),this._removeSocketListeners(),this._addSocketListeners()}_reconnect(){this.isReconnecting||(this.isReconnecting=!0,this._sentRequestsQueue.size>0&&this._sentRequestsQueue.forEach(((e,t)=>{e.deferredPromise.reject(new uL),this._sentRequestsQueue.delete(t)})),this._reconnectAttempts<this._reconnectOptions.maxAttempts?(this._reconnectAttempts+=1,setTimeout((()=>{this._removeSocketListeners(),this.connect(),this.isReconnecting=!1}),this._reconnectOptions.delay)):(this.isReconnecting=!1,this._clearQueues(),this._removeSocketListeners(),this._eventEmitter.emit("error",new lL(this._reconnectOptions.maxAttempts))))}request(e){return AV(this,void 0,void 0,(function*(){if(Ez(this._socketConnection))throw new Error("Connection is undefined");"disconnected"===this.getStatus()&&this.connect();const t=mV(e)?e[0].id:e.id;if(!t)throw new CL("Request Id not defined");if(this._sentRequestsQueue.has(t))throw new dL(t);const n=new wV;n.catch((e=>{this._eventEmitter.emit("error",e)}));const r={payload:e,deferredPromise:n};if("connecting"===this.getStatus())return this._pendingRequestsQueue.set(t,r),r.deferredPromise;this._sentRequestsQueue.set(t,r);try{this._sendToSocket(r.payload)}catch(i){this._sentRequestsQueue.delete(t),this._eventEmitter.emit("error",i)}return n}))}_onConnect(){this._connectionStatus="connected",this._reconnectAttempts=0,super._onConnect(),this._sendPendingRequests()}_sendPendingRequests(){for(const[e,t]of this._pendingRequestsQueue.entries())this._sendToSocket(t.payload),this._pendingRequestsQueue.delete(e),this._sentRequestsQueue.set(e,t)}_onMessage(e){const t=this._parseResponses(e);if(!Ez(t)&&0!==t.length)for(const n of t){if(aV(n)&&n.method.endsWith("_subscription"))return void this._eventEmitter.emit("message",n);const e=dV(n)?n[0].id:n.id,t=this._sentRequestsQueue.get(e);if(!t)return;(dV(n)||oV(n)||sV(n))&&(this._eventEmitter.emit("message",n),t.deferredPromise.resolve(n)),this._sentRequestsQueue.delete(e)}}clearQueues(e){this._clearQueues(e)}_clearQueues(e){this._pendingRequestsQueue.size>0&&this._pendingRequestsQueue.forEach(((t,n)=>{t.deferredPromise.reject(new cL(e)),this._pendingRequestsQueue.delete(n)})),this._sentRequestsQueue.size>0&&this._sentRequestsQueue.forEach(((t,n)=>{t.deferredPromise.reject(new cL(e)),this._sentRequestsQueue.delete(n)})),this._removeSocketListeners()}}class _V{constructor(){this._emitter=new cz}on(e,t){this._emitter.on(e,t)}once(e,t){this._emitter.once(e,t)}off(e,t){this._emitter.off(e,t)}emit(e,t){this._emitter.emit(e,t)}listenerCount(e){return this._emitter.listenerCount(e)}listeners(e){return this._emitter.listeners(e)}eventNames(){return this._emitter.eventNames()}removeAllListeners(){return this._emitter.removeAllListeners()}setMaxListenerWarningThreshold(e){this._emitter.setMaxListeners(e)}getMaxListeners(){return this._emitter.getMaxListeners()}}var IV;!function(e){e.CONFIG_CHANGE="CONFIG_CHANGE"}(IV||(IV={}));class RV extends _V{constructor(e){super(),this.config={handleRevert:!1,defaultAccount:void 0,defaultBlock:"latest",transactionBlockTimeout:50,transactionConfirmationBlocks:24,transactionPollingInterval:1e3,transactionPollingTimeout:75e4,transactionReceiptPollingInterval:void 0,transactionSendTimeout:75e4,transactionConfirmationPollingInterval:void 0,blockHeaderTimeout:10,maxListenersWarningThreshold:100,contractDataInputFill:"data",defaultNetworkId:void 0,defaultChain:"mainnet",defaultHardfork:"london",defaultCommon:void 0,defaultTransactionType:"0x2",defaultMaxPriorityFeePerGas:$H(25e8),enableExperimentalFeatures:{useSubscriptionWhenCheckingBlockTimeout:!1,useRpcCallSpecification:!1},transactionBuilder:void 0,transactionTypeParser:void 0},this.setConfig(null!==e&&void 0!==e?e:{})}setConfig(e){const t=Object.keys(e);for(const n of t)this._triggerConfigChange(n,e[n]);Object.assign(this.config,e)}get handleRevert(){return this.config.handleRevert}set handleRevert(e){this._triggerConfigChange("handleRevert",e),this.config.handleRevert=e}get contractDataInputFill(){return this.config.contractDataInputFill}set contractDataInputFill(e){this._triggerConfigChange("contractDataInputFill",e),this.config.contractDataInputFill=e}get defaultAccount(){return this.config.defaultAccount}set defaultAccount(e){this._triggerConfigChange("defaultAccount",e),this.config.defaultAccount=e}get defaultBlock(){return this.config.defaultBlock}set defaultBlock(e){this._triggerConfigChange("defaultBlock",e),this.config.defaultBlock=e}get transactionSendTimeout(){return this.config.transactionSendTimeout}set transactionSendTimeout(e){this._triggerConfigChange("transactionSendTimeout",e),this.config.transactionSendTimeout=e}get transactionBlockTimeout(){return this.config.transactionBlockTimeout}set transactionBlockTimeout(e){this._triggerConfigChange("transactionBlockTimeout",e),this.config.transactionBlockTimeout=e}get transactionConfirmationBlocks(){return this.config.transactionConfirmationBlocks}set transactionConfirmationBlocks(e){this._triggerConfigChange("transactionConfirmationBlocks",e),this.config.transactionConfirmationBlocks=e}get transactionPollingInterval(){return this.config.transactionPollingInterval}set transactionPollingInterval(e){this._triggerConfigChange("transactionPollingInterval",e),this.config.transactionPollingInterval=e,this.transactionReceiptPollingInterval=e,this.transactionConfirmationPollingInterval=e}get transactionPollingTimeout(){return this.config.transactionPollingTimeout}set transactionPollingTimeout(e){this._triggerConfigChange("transactionPollingTimeout",e),this.config.transactionPollingTimeout=e}get transactionReceiptPollingInterval(){return this.config.transactionReceiptPollingInterval}set transactionReceiptPollingInterval(e){this._triggerConfigChange("transactionReceiptPollingInterval",e),this.config.transactionReceiptPollingInterval=e}get transactionConfirmationPollingInterval(){return this.config.transactionConfirmationPollingInterval}set transactionConfirmationPollingInterval(e){this._triggerConfigChange("transactionConfirmationPollingInterval",e),this.config.transactionConfirmationPollingInterval=e}get blockHeaderTimeout(){return this.config.blockHeaderTimeout}set blockHeaderTimeout(e){this._triggerConfigChange("blockHeaderTimeout",e),this.config.blockHeaderTimeout=e}get enableExperimentalFeatures(){return this.config.enableExperimentalFeatures}set enableExperimentalFeatures(e){this._triggerConfigChange("enableExperimentalFeatures",e),this.config.enableExperimentalFeatures=e}get maxListenersWarningThreshold(){return this.config.maxListenersWarningThreshold}set maxListenersWarningThreshold(e){this._triggerConfigChange("maxListenersWarningThreshold",e),this.setMaxListenerWarningThreshold(e),this.config.maxListenersWarningThreshold=e}get defaultNetworkId(){return this.config.defaultNetworkId}set defaultNetworkId(e){this._triggerConfigChange("defaultNetworkId",e),this.config.defaultNetworkId=e}get defaultChain(){return this.config.defaultChain}set defaultChain(e){if(!Ez(this.config.defaultCommon)&&!Ez(this.config.defaultCommon.baseChain)&&e!==this.config.defaultCommon.baseChain)throw new PM(this.config.defaultChain,e);this._triggerConfigChange("defaultChain",e),this.config.defaultChain=e}get defaultHardfork(){return this.config.defaultHardfork}set defaultHardfork(e){if(!Ez(this.config.defaultCommon)&&!Ez(this.config.defaultCommon.hardfork)&&e!==this.config.defaultCommon.hardfork)throw new TM(this.config.defaultCommon.hardfork,e);this._triggerConfigChange("defaultHardfork",e),this.config.defaultHardfork=e}get defaultCommon(){return this.config.defaultCommon}set defaultCommon(e){if(!Ez(this.config.defaultHardfork)&&!Ez(e)&&!Ez(e.hardfork)&&this.config.defaultHardfork!==e.hardfork)throw new TM(this.config.defaultHardfork,e.hardfork);if(!Ez(this.config.defaultChain)&&!Ez(e)&&!Ez(e.baseChain)&&this.config.defaultChain!==e.baseChain)throw new PM(this.config.defaultChain,e.baseChain);this._triggerConfigChange("defaultCommon",e),this.config.defaultCommon=e}get defaultTransactionType(){return this.config.defaultTransactionType}set defaultTransactionType(e){this._triggerConfigChange("defaultTransactionType",e),this.config.defaultTransactionType=e}get defaultMaxPriorityFeePerGas(){return this.config.defaultMaxPriorityFeePerGas}set defaultMaxPriorityFeePerGas(e){this._triggerConfigChange("defaultMaxPriorityFeePerGas",e),this.config.defaultMaxPriorityFeePerGas=e}get transactionBuilder(){return this.config.transactionBuilder}set transactionBuilder(e){this._triggerConfigChange("transactionBuilder",e),this.config.transactionBuilder=e}get transactionTypeParser(){return this.config.transactionTypeParser}set transactionTypeParser(e){this._triggerConfigChange("transactionTypeParser",e),this.config.transactionTypeParser=e}_triggerConfigChange(e,t){this.emit(IV.CONFIG_CHANGE,{name:e,oldValue:this.config[e],newValue:t})}}var CV=n(9038),TV=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(BJ){o(BJ)}}function a(e){try{c(r.throw(e))}catch(BJ){o(BJ)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};class PV extends uH{constructor(e,t){if(super(),!PV.validateClientUrl(e))throw new IL(e);this.clientUrl=e,this.httpProviderOptions=t}static validateClientUrl(e){return"string"===typeof e&&/^http(s)?:\/\//i.test(e)}getStatus(){throw new EL}supportsSubscriptions(){return!1}request(e,t){var n;return TV(this,void 0,void 0,(function*(){const r=Object.assign(Object.assign({},null===(n=this.httpProviderOptions)||void 0===n?void 0:n.providerOptions),t),i=yield CV(this.clientUrl,Object.assign(Object.assign({},r),{method:"POST",headers:Object.assign(Object.assign({},r.headers),{"Content-Type":"application/json"}),body:JSON.stringify(e)}));if(!i.ok)throw new RM(yield i.json());return yield i.json()}))}on(){throw new EL}removeListener(){throw new EL}once(){throw new EL}removeAllListeners(){throw new EL}connect(){throw new EL}disconnect(){throw new EL}reset(){throw new EL}reconnect(){throw new EL}}var NV=null;"undefined"!==typeof WebSocket?NV=WebSocket:"undefined"!==typeof MozWebSocket?NV=MozWebSocket:"undefined"!==typeof n.g?NV=n.g.WebSocket||n.g.MozWebSocket:"undefined"!==typeof window?NV=window.WebSocket||window.MozWebSocket:"undefined"!==typeof self&&(NV=self.WebSocket||self.MozWebSocket);const BV=NV;const DV=e=>uH.isWeb3Provider(e),OV=e=>"string"!==typeof e&&"request"in e&&"Function"===e.request.constructor.name,LV=e=>"string"!==typeof e&&"request"in e&&"AsyncFunction"===e.request.constructor.name,MV=e=>"string"!==typeof e&&"send"in e,FV=e=>"string"!==typeof e&&"sendAsync"in e,UV=e=>e&&(DV(e)||LV(e)||OV(e)||FV(e)||MV(e));var jV,HV=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(BJ){o(BJ)}}function a(e){try{c(r.throw(e))}catch(BJ){o(BJ)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};!function(e){e.PROVIDER_CHANGED="PROVIDER_CHANGED",e.BEFORE_PROVIDER_CHANGE="BEFORE_PROVIDER_CHANGE"}(jV||(jV={}));const zV={HttpProvider:PV,WebsocketProvider:class extends xV{constructor(e,t,n){super(e,t,n)}_validateProviderPath(e){return"string"===typeof e&&/^ws(s)?:\/\//i.test(e)}getStatus(){if(this._socketConnection&&!Ez(this._socketConnection))switch(this._socketConnection.readyState){case this._socketConnection.CONNECTING:return"connecting";case this._socketConnection.OPEN:return"connected";default:return"disconnected"}return"disconnected"}_openSocketConnection(){this._socketConnection=new BV(this._socketPath,void 0,this._socketOptions&&0===Object.keys(this._socketOptions).length?void 0:this._socketOptions)}_closeSocketConnection(e,t){var n;null===(n=this._socketConnection)||void 0===n||n.close(e,t)}_sendToSocket(e){var t;if("disconnected"===this.getStatus())throw new cL;null===(t=this._socketConnection)||void 0===t||t.send(JSON.stringify(e))}_parseResponses(e){return this.chunkResponseParser.parseResponse(e.data)}_addSocketListeners(){var e,t,n,r;null===(e=this._socketConnection)||void 0===e||e.addEventListener("open",this._onOpenHandler),null===(t=this._socketConnection)||void 0===t||t.addEventListener("message",this._onMessageHandler),null===(n=this._socketConnection)||void 0===n||n.addEventListener("close",(e=>this._onCloseHandler(e))),null===(r=this._socketConnection)||void 0===r||r.addEventListener("error",this._onErrorHandler)}_removeSocketListeners(){var e,t,n;null===(e=this._socketConnection)||void 0===e||e.removeEventListener("message",this._onMessageHandler),null===(t=this._socketConnection)||void 0===t||t.removeEventListener("open",this._onOpenHandler),null===(n=this._socketConnection)||void 0===n||n.removeEventListener("close",this._onCloseHandler)}_onCloseEvent(e){var t;!this._reconnectOptions.autoReconnect||[1e3,1001].includes(e.code)&&e.wasClean?(this._clearQueues(e),this._removeSocketListeners(),this._onDisconnect(e.code,e.reason),null===(t=this._socketConnection)||void 0===t||t.removeEventListener("error",this._onErrorHandler)):this._reconnect()}}};class VV extends _V{constructor(e,t){super(),Ez(e)||this.setProvider(e),this.useRpcCallSpecification=t}static get providers(){return zV}get provider(){return this._provider}get providers(){return zV}setProvider(e){let t;if(e&&"string"===typeof e&&this.providers)if(/^http(s)?:\/\//i.test(e))t=new this.providers.HttpProvider(e);else{if(!/^ws(s)?:\/\//i.test(e))throw new _L("Can't autodetect provider for \"".concat(e,'"'));t=new this.providers.WebsocketProvider(e)}else t=Ez(e)?void 0:e;return this.emit(jV.BEFORE_PROVIDER_CHANGE,this._provider),this._provider=t,this.emit(jV.PROVIDER_CHANGED,this._provider),!0}send(e){return HV(this,void 0,void 0,(function*(){const t=yield this._sendRequest(e);if(oV(t))return t.result;throw new RM(t)}))}sendBatch(e){return HV(this,void 0,void 0,(function*(){return yield this._sendRequest(e)}))}_sendRequest(e){return HV(this,void 0,void 0,(function*(){const{provider:t}=this;if(Ez(t))throw new _L("Provider not available. Use `.setProvider` or `.provider=` to initialize the provider.");const n=mV(e)?gV(e):pV(e);if(DV(t)){let e;try{e=yield t.request(n)}catch(r){e=r}return this._processJsonRpcResponse(n,e,{legacy:!1,error:!1})}if(LV(t))return t.request(n).then((e=>this._processJsonRpcResponse(n,e,{legacy:!0,error:!1}))).catch((e=>this._processJsonRpcResponse(n,e,{legacy:!0,error:!0})));if(OV(t))return new Promise(((e,r)=>{const i=e=>r(this._processJsonRpcResponse(n,e,{legacy:!0,error:!0})),o=t=>e(this._processJsonRpcResponse(n,t,{legacy:!0,error:!1})),s=t.request(n,((e,t)=>e?i(e):o(t)));if(Jz(s)){s.then(o).catch(i)}}));if(MV(t))return new Promise(((e,r)=>{t.send(n,((t,i)=>{if(t)return r(this._processJsonRpcResponse(n,t,{legacy:!0,error:!0}));if(Ez(i))throw new RM("",'Got a "nullish" response from provider.');return e(this._processJsonRpcResponse(n,i,{legacy:!0,error:!1}))}))}));if(FV(t))return t.sendAsync(n).then((e=>this._processJsonRpcResponse(n,e,{legacy:!0,error:!1}))).catch((e=>this._processJsonRpcResponse(n,e,{legacy:!0,error:!0})));throw new _L("Provider does not have a request or send method to use.")}))}_processJsonRpcResponse(e,t,n){let{legacy:r,error:i}=n;if(Ez(t))return this._buildResponse(e,null,i);if(sV(t)){if(this.useRpcCallSpecification&&iV(t)){const e=t;if(LM.get(e.error.code)){throw new(0,LM.get(e.error.code).error)(e)}throw new DM(e)}if(!VV._isReverted(t))throw new CM(t,e)}if(oV(t))return t;if(t instanceof Error)throw VV._isReverted(t),t;if(!r&&mV(e)&&dV(t))return t;if(r&&!i&&mV(e))return t;if(r&&i&&mV(e))throw t;if(r&&!sV(t)&&!oV(t))return this._buildResponse(e,t,i);if(mV(e)&&!Array.isArray(t))throw new RM(t,"Got normal response for a batch request.");if(!mV(e)&&Array.isArray(t))throw new RM(t,"Got batch response for a normal request.");if((sV(t)||oV(t))&&!mV(e)&&t.id&&e.id!==t.id)throw new CM(t);throw new RM(t,"Invalid response")}static _isReverted(e){let t;if(sV(e)?t=e.error:e instanceof Error&&(t=e),null===t||void 0===t?void 0:t.message.includes("revert"))throw new gL(t);return!1}_buildResponse(e,t,n){const r={jsonrpc:"2.0",id:mV(e)?e[0].id:"id"in e?e.id:null};return n?Object.assign(Object.assign({},r),{error:t}):Object.assign(Object.assign({},r),{result:t})}}var qV=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(BJ){o(BJ)}}function a(e){try{c(r.throw(e))}catch(BJ){o(BJ)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};class GV{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.requestManager=e,this.registeredSubscriptions=t,this.tolerateUnlinkedSubscription=n,this._subscriptions=new Map,this.requestManager.on(jV.BEFORE_PROVIDER_CHANGE,(()=>qV(this,void 0,void 0,(function*(){yield this.unsubscribe()})))),this.requestManager.on(jV.PROVIDER_CHANGED,(()=>{this.clear(),this.listenToProviderEvents()})),this.listenToProviderEvents()}listenToProviderEvents(){const e=this.requestManager.provider;this.requestManager.provider&&("function"!==typeof(null===e||void 0===e?void 0:e.supportsSubscriptions)||(null===e||void 0===e?void 0:e.supportsSubscriptions()))&&"function"===typeof this.requestManager.provider.on&&("function"===typeof this.requestManager.provider.request?this.requestManager.provider.on("message",(e=>this.messageListener(e))):e.on("data",(e=>this.messageListener(e))))}messageListener(e){var t,n,r;if(!e)throw new RL("Should not call messageListener with no data. Type was");const i=(null===(t=e.params)||void 0===t?void 0:t.subscription)||(null===(n=e.data)||void 0===n?void 0:n.subscription)||(null===(r=e.id)||void 0===r?void 0:r.toString(16));if(i){const t=this._subscriptions.get(i);null===t||void 0===t||t.processSubscriptionData(e)}}subscribe(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rH;return qV(this,void 0,void 0,(function*(){const r=this.registeredSubscriptions[e];if(!r)throw new RL("Invalid subscription type");const i=new r(null!==t&&void 0!==t?t:void 0,{subscriptionManager:this,returnFormat:n});return yield this.addSubscription(i),i}))}get subscriptions(){return this._subscriptions}addSubscription(e){return qV(this,void 0,void 0,(function*(){if(!this.requestManager.provider)throw new _L("Provider not available");if(!this.supportsSubscriptions())throw new RL("The current provider does not support subscriptions");if(e.id&&this._subscriptions.has(e.id))throw new RL('Subscription with id "'.concat(e.id,'" already exists'));if(yield e.sendSubscriptionRequest(),Ez(e.id))throw new RL("Subscription is not subscribed yet.");return this._subscriptions.set(e.id,e),e.id}))}removeSubscription(e){return qV(this,void 0,void 0,(function*(){const{id:t}=e;if(Ez(t))throw new RL("Subscription is not subscribed yet. Or, had already been unsubscribed but not through the Subscription Manager.");if(!this._subscriptions.has(t)&&!this.tolerateUnlinkedSubscription)throw new RL('Subscription with id "'.concat(t.toString(),'" does not exists'));return yield e.sendUnsubscribeRequest(),this._subscriptions.delete(t),t}))}unsubscribe(e){return qV(this,void 0,void 0,(function*(){const t=[];for(const[n,r]of this.subscriptions.entries())(!e||"function"===typeof e&&e({id:n,sub:r}))&&t.push(this.removeSubscription(r));return Promise.all(t)}))}clear(){this._subscriptions.clear()}supportsSubscriptions(){return!Ez(this.requestManager.provider)&&((e=this.requestManager.provider)&&"supportsSubscriptions"in e?e.supportsSubscriptions():!(!e||"string"===typeof e||!("on"in e)));var e}}var KV=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(BJ){o(BJ)}}function a(e){try{c(r.throw(e))}catch(BJ){o(BJ)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};class WV extends _V{constructor(e,t){var n;super(),this.args=e;const{requestManager:r}=t,{subscriptionManager:i}=t;if(r&&i)throw new RL("Only requestManager or subscriptionManager should be provided at Subscription constructor");if(!r&&!i)throw new RL("Either requestManager or subscriptionManager should be provided at Subscription constructor");this._subscriptionManager=r?new GV(r,{},!0):i,this._returnFormat=null!==(n=null===t||void 0===t?void 0:t.returnFormat)&&void 0!==n?n:rH}get id(){return this._id}get lastBlock(){return this._lastBlock}subscribe(){return KV(this,void 0,void 0,(function*(){return this._subscriptionManager.addSubscription(this)}))}processSubscriptionData(e){var t,n;(null===e||void 0===e?void 0:e.data)?this._processSubscriptionResult(null!==(n=null===(t=null===e||void 0===e?void 0:e.data)||void 0===t?void 0:t.result)&&void 0!==n?n:null===e||void 0===e?void 0:e.data):e&&aV(e)&&this._processSubscriptionResult(null===e||void 0===e?void 0:e.params.result)}sendSubscriptionRequest(){return KV(this,void 0,void 0,(function*(){return this._id=yield this._subscriptionManager.requestManager.send({method:"eth_subscribe",params:this._buildSubscriptionParams()}),this.emit("connected",this._id),this._id}))}get returnFormat(){return this._returnFormat}get subscriptionManager(){return this._subscriptionManager}resubscribe(){return KV(this,void 0,void 0,(function*(){yield this.unsubscribe(),yield this.subscribe()}))}unsubscribe(){return KV(this,void 0,void 0,(function*(){this.id&&(yield this._subscriptionManager.removeSubscription(this))}))}sendUnsubscribeRequest(){return KV(this,void 0,void 0,(function*(){yield this._subscriptionManager.requestManager.send({method:"eth_unsubscribe",params:[this.id]}),this._id=void 0}))}formatSubscriptionResult(e){return e}_processSubscriptionResult(e){this.emit("data",this.formatSubscriptionResult(e))}_processSubscriptionError(e){this.emit("error",e)}_buildSubscriptionParams(){throw new Error("Implement in the child class")}}var QV=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(BJ){o(BJ)}}function a(e){try{c(r.throw(e))}catch(BJ){o(BJ)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};class YV extends dH{constructor(){super(...arguments),this._addressMap=new Map,this._defaultKeyName="web3js_wallet"}static getStorage(){let e;try{e=window.localStorage;const t="__storage_test__";return e.setItem(t,t),e.removeItem(t),e}catch(BJ){return!BJ||22!==BJ.code&&1014!==BJ.code&&"QuotaExceededError"!==BJ.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==BJ.name||EH(e)||0===e.length?void 0:e}}create(e){for(let t=0;t<e;t+=1)this.add(this._accountProvider.create());return this}add(e){var t;if("string"===typeof e)return this.add(this._accountProvider.privateKeyToAccount(e));let n=this.length;return this.get(e.address)&&(console.warn("Account ".concat(e.address.toLowerCase()," already exists.")),n=null!==(t=this._addressMap.get(e.address.toLowerCase()))&&void 0!==t?t:n),this._addressMap.set(e.address.toLowerCase(),n),this[n]=e,this}get(e){if("string"===typeof e){const t=this._addressMap.get(e.toLowerCase());return EH(t)?void 0:this[t]}return this[e]}remove(e){if("string"===typeof e){const t=this._addressMap.get(e.toLowerCase());return!EH(t)&&(this._addressMap.delete(e.toLowerCase()),this.splice(t,1),!0)}return!!this[e]&&(this.splice(e,1),!0)}clear(){return this._addressMap.clear(),this.length=0,this}encrypt(e,t){return QV(this,void 0,void 0,(function*(){return Promise.all(this.map((n=>QV(this,void 0,void 0,(function*(){return n.encrypt(e,t)})))))}))}decrypt(e,t,n){return QV(this,void 0,void 0,(function*(){const r=yield Promise.all(e.map((e=>QV(this,void 0,void 0,(function*(){return this._accountProvider.decrypt(e,t,n)})))));for(const e of r)this.add(e);return this}))}save(e,t){return QV(this,void 0,void 0,(function*(){const n=YV.getStorage();if(!n)throw new Error("Local storage not available.");return n.setItem(null!==t&&void 0!==t?t:this._defaultKeyName,JSON.stringify(yield this.encrypt(e))),!0}))}load(e,t){return QV(this,void 0,void 0,(function*(){const n=YV.getStorage();if(!n)throw new Error("Local storage not available.");const r=n.getItem(null!==t&&void 0!==t?t:this._defaultKeyName);return r&&(yield this.decrypt(JSON.parse(r)||[],e)),this}))}}const ZV={web:tI};function JV(e,t,n){if(!n.startsWith("aes-"))throw new Error("AES submodule doesn't support mode ".concat(n));if(16!==t.length)throw new Error("AES: wrong IV length");if(n.startsWith("aes-128")&&16!==e.length||n.startsWith("aes-256")&&32!==e.length)throw new Error("AES: wrong key length")}async function XV(e,t,n){if(!ZV.web)throw new Error("Browser crypto not available.");let r;if(["aes-128-cbc","aes-256-cbc"].includes(e)&&(r="cbc"),["aes-128-ctr","aes-256-ctr"].includes(e)&&(r="ctr"),!r)throw new Error("AES: unsupported mode");return[await ZV.web.subtle.importKey("raw",t,{name:"AES-".concat(r.toUpperCase()),length:8*t.length},!0,["encrypt","decrypt"]),{name:"aes-".concat(r),iv:n,counter:n,length:128}]}async function $V(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"aes-128-ctr",i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(JV(t,n,r),ZV.web){const[o,s]=await XV(r,t,n),a=await ZV.web.subtle.encrypt(s,o,e);let c=new Uint8Array(a);return i||"aes-cbc"!==s.name||e.length%16||(c=c.slice(0,-16)),c}if(ZV.node){const o=ZV.node.createCipheriv(r,t,n);return o.setAutoPadding(i),cI(o.update(e),o.final())}throw new Error("The environment doesn't have AES module")}async function eq(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"aes-128-ctr",i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(JV(t,n,r),ZV.web){const[o,s]=await XV(r,t,n);if(!i&&"aes-cbc"===s.name){const i=await async function(e,t,n,r){const i=e.slice(-16);for(let o=0;o<16;o++)i[o]^=16^n[o];return(await $V(i,t,n,r)).slice(0,16)}(e,t,n,r);e=cI(e,i)}const a=await ZV.web.subtle.decrypt(s,o,e),c=new Uint8Array(a);if("aes-cbc"===s.name){if(!function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}(await $V(c,t,n,r),e))throw new Error("AES: wrong padding")}return c}if(ZV.node){const o=ZV.node.createDecipheriv(r,t,n);return o.setAutoPadding(i),cI(o.update(e),o.final())}throw new Error("The environment doesn't have AES module")}function tq(e,t,n,r){J_(e);const i=dI({dkLen:32,asyncTick:10},r),{c:o,dkLen:s,asyncTick:a}=i;if(Y_(o),Y_(s),Y_(a),o<1)throw new Error("PBKDF2: iterations (c) should be >= 1");const c=aI(t),l=aI(n),u=new Uint8Array(s),d=WR.create(e,c),h=d._cloneInto().update(l);return{c:o,dkLen:s,asyncTick:a,DK:u,PRF:d,PRFSalt:h}}function nq(e,t,n,r,i){return e.destroy(),t.destroy(),r&&r.destroy(),i.fill(0),n}function rq(e,t,n,r){const{c:i,dkLen:o,DK:s,PRF:a,PRFSalt:c}=tq(e,t,n,r);let l;const u=new Uint8Array(4),d=iI(u),h=new Uint8Array(a.outputLen);for(let f=1,p=0;p<o;f++,p+=a.outputLen){const e=s.subarray(p,p+a.outputLen);d.setInt32(0,f,!1),(l=c._cloneInto(l)).update(u).digestInto(h),e.set(h.subarray(0,e.length));for(let t=1;t<i;t++){a._cloneInto(l).update(h).digestInto(h);for(let t=0;t<e.length;t++)e[t]^=h[t]}}return nq(a,c,s,l,h)}function iq(e,t,n,r,i){if(!["sha256","sha512"].includes(i))throw new Error("Only sha256 and sha512 are supported");return rF(e),rF(t),rq("sha256"===i?rC:TI,e,t,{c:n,dkLen:r})}const oq=(e,t)=>e<<t|e>>>32-t;function sq(e,t,n,r,i,o){let s=e[t++]^n[r++],a=e[t++]^n[r++],c=e[t++]^n[r++],l=e[t++]^n[r++],u=e[t++]^n[r++],d=e[t++]^n[r++],h=e[t++]^n[r++],f=e[t++]^n[r++],p=e[t++]^n[r++],g=e[t++]^n[r++],m=e[t++]^n[r++],v=e[t++]^n[r++],y=e[t++]^n[r++],w=e[t++]^n[r++],b=e[t++]^n[r++],E=e[t++]^n[r++],k=s,A=a,S=c,x=l,_=u,I=d,R=h,C=f,T=p,P=g,N=m,B=v,D=y,O=w,L=b,M=E;for(let F=0;F<8;F+=2)_^=oq(k+D|0,7),T^=oq(_+k|0,9),D^=oq(T+_|0,13),k^=oq(D+T|0,18),P^=oq(I+A|0,7),O^=oq(P+I|0,9),A^=oq(O+P|0,13),I^=oq(A+O|0,18),L^=oq(N+R|0,7),S^=oq(L+N|0,9),R^=oq(S+L|0,13),N^=oq(R+S|0,18),x^=oq(M+B|0,7),C^=oq(x+M|0,9),B^=oq(C+x|0,13),M^=oq(B+C|0,18),A^=oq(k+x|0,7),S^=oq(A+k|0,9),x^=oq(S+A|0,13),k^=oq(x+S|0,18),R^=oq(I+_|0,7),C^=oq(R+I|0,9),_^=oq(C+R|0,13),I^=oq(_+C|0,18),B^=oq(N+P|0,7),T^=oq(B+N|0,9),P^=oq(T+B|0,13),N^=oq(P+T|0,18),D^=oq(M+L|0,7),O^=oq(D+M|0,9),L^=oq(O+D|0,13),M^=oq(L+O|0,18);i[o++]=s+k|0,i[o++]=a+A|0,i[o++]=c+S|0,i[o++]=l+x|0,i[o++]=u+_|0,i[o++]=d+I|0,i[o++]=h+R|0,i[o++]=f+C|0,i[o++]=p+T|0,i[o++]=g+P|0,i[o++]=m+N|0,i[o++]=v+B|0,i[o++]=y+D|0,i[o++]=w+O|0,i[o++]=b+L|0,i[o++]=E+M|0}function aq(e,t,n,r,i){let o=r+0,s=r+16*i;for(let a=0;a<16;a++)n[s+a]=e[t+16*(2*i-1)+a];for(let a=0;a<i;a++,o+=16,t+=16)sq(n,s,e,t,n,o),a>0&&(s+=16),sq(n,o,e,t+=16,n,s)}function cq(e,t,n){const r=dI({dkLen:32,asyncTick:10,maxmem:1073742848},n),{N:i,r:o,p:s,dkLen:a,asyncTick:c,maxmem:l,onProgress:u}=r;if(Y_(i),Y_(o),Y_(s),Y_(a),Y_(c),Y_(l),void 0!==u&&"function"!==typeof u)throw new Error("progressCb should be function");const d=128*o,h=d/4;if(i<=1||0!==(i&i-1)||i>=2**(d/8)||i>2**32)throw new Error("Scrypt: N must be larger than 1, a power of 2, less than 2^(128 * r / 8) and less than 2^32");if(s<0||s>137438953440/d)throw new Error("Scrypt: p must be a positive integer less than or equal to ((2^32 - 1) * 32) / (128 * r)");if(a<0||a>137438953440)throw new Error("Scrypt: dkLen should be positive integer less than or equal to (2^32 - 1) * 32");const f=d*(i+s);if(f>l)throw new Error("Scrypt: parameters too large, ".concat(f," (128 * r * (N + p)) > ").concat(l," (maxmem)"));const p=rq(rC,e,t,{c:1,dkLen:d*s}),g=nI(p),m=nI(new Uint8Array(d*i)),v=nI(new Uint8Array(d));let y=()=>{};if(u){const e=2*i*s,t=Math.max(Math.floor(e/1e4),1);let n=0;y=()=>{n++,!u||n%t&&n!==e||u(n/e)}}return{N:i,r:o,p:s,dkLen:a,blockSize32:h,V:m,B32:g,B:p,tmp:v,blockMixCb:y,asyncTick:c}}function lq(e,t,n,r,i){const o=rq(rC,e,n,{c:1,dkLen:t});return n.fill(0),r.fill(0),i.fill(0),o}function uq(e,t,n,r,i,o,s){return rF(e),rF(t),function(e,t,n){const{N:r,r:i,p:o,dkLen:s,blockSize32:a,V:c,B32:l,B:u,tmp:d,blockMixCb:h}=cq(e,t,n);for(let f=0;f<o;f++){const e=a*f;for(let t=0;t<a;t++)c[t]=l[e+t];for(let t=0,n=0;t<r-1;t++)aq(c,n,c,n+=a,i),h();aq(c,(r-1)*a,l,e,i),h();for(let t=0;t<r;t++){const t=l[e+a-16]%r;for(let n=0;n<a;n++)d[n]=l[e+n]^c[t*a+n];aq(d,0,l,e,i),h()}}return lq(e,s,u,c,d)}(e,t,{N:n,r:i,p:r,dkLen:o,onProgress:s})}const{bytesToNumberBE:dq,hexToBytes:hq}=E,fq={Err:class extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")}},_parseInt(e){const{Err:t}=fq;if(e.length<2||2!==e[0])throw new t("Invalid signature integer tag");const n=e[1],r=e.subarray(2,n+2);if(!n||r.length!==n)throw new t("Invalid signature integer: wrong length");if(128&r[0])throw new t("Invalid signature integer: negative");if(0===r[0]&&!(128&r[1]))throw new t("Invalid signature integer: unnecessary leading zero");return{d:dq(r),l:e.subarray(n+2)}},toSig(e){const{Err:t}=fq,n="string"===typeof e?hq(e):e;if(!BI(n))throw new Error("ui8a expected");let r=n.length;if(r<2||48!=n[0])throw new t("Invalid signature tag");if(n[1]!==r-2)throw new t("Invalid signature: incorrect length");const{d:i,l:o}=fq._parseInt(n.subarray(2)),{d:s,l:a}=fq._parseInt(o);if(a.length)throw new t("Invalid signature: left bytes after parsing");return{r:i,s:s}},hexFromSig(e){const t=e=>8&Number.parseInt(e[0],16)?"00"+e:e,n=e=>{const t=e.toString(16);return 1&t.length?"0".concat(t):t},r=t(n(e.s)),i=t(n(e.r)),o=r.length/2,s=i.length/2,a=n(o),c=n(s);return"30".concat(n(s+o+4),"02").concat(c).concat(i,"02").concat(a).concat(r)}},pq=BigInt(0),gq=BigInt(1),mq=(BigInt(2),BigInt(3));BigInt(4);function vq(e){const t=function(e){const t=wR(e);JI(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:n,Fp:r,a:i}=t;if(n){if(!r.eql(i,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if("object"!==typeof n||"bigint"!==typeof n.beta||"function"!==typeof n.splitScalar)throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}(e),{Fp:n}=t,r=t.toBytes||((e,t,r)=>{const i=t.toAffine();return GI(Uint8Array.from([4]),n.toBytes(i.x),n.toBytes(i.y))}),i=t.fromBytes||(e=>{const t=e.subarray(1);return{x:n.fromBytes(t.subarray(0,n.BYTES)),y:n.fromBytes(t.subarray(n.BYTES,2*n.BYTES))}});function o(e){const{a:r,b:i}=t,o=n.sqr(e),s=n.mul(o,e);return n.add(n.add(s,n.mul(e,r)),i)}if(!n.eql(n.sqr(t.Gy),o(t.Gx)))throw new Error("bad generator point: equation left != right");function s(e){return"bigint"===typeof e&&pq<e&&e<t.n}function a(e){if(!s(e))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(e){const{allowedPrivateKeyLengths:n,nByteLength:r,wrapPrivateKey:i,n:o}=t;if(n&&"bigint"!==typeof e){if(BI(e)&&(e=OI(e)),"string"!==typeof e||!n.includes(e.length))throw new Error("Invalid key");e=e.padStart(2*r,"0")}let s;try{s="bigint"===typeof e?e:jI(qI("private key",e,r))}catch(c){throw new Error("private key must be ".concat(r," bytes, hex or bigint, not ").concat(typeof e))}return i&&(s=oR(s,o)),a(s),s}const l=new Map;function u(e){if(!(e instanceof d))throw new Error("ProjectivePoint expected")}class d{constructor(e,t,r){if(this.px=e,this.py=t,this.pz=r,null==e||!n.isValid(e))throw new Error("x required");if(null==t||!n.isValid(t))throw new Error("y required");if(null==r||!n.isValid(r))throw new Error("z required")}static fromAffine(e){const{x:t,y:r}=e||{};if(!e||!n.isValid(t)||!n.isValid(r))throw new Error("invalid affine point");if(e instanceof d)throw new Error("projective point not allowed");const i=e=>n.eql(e,n.ZERO);return i(t)&&i(r)?d.ZERO:new d(t,r,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(e){const t=n.invertBatch(e.map((e=>e.pz)));return e.map(((e,n)=>e.toAffine(t[n]))).map(d.fromAffine)}static fromHex(e){const t=d.fromAffine(i(qI("pointHex",e)));return t.assertValidity(),t}static fromPrivateKey(e){return d.BASE.multiply(c(e))}_setWindowSize(e){this._WINDOW_SIZE=e,l.delete(this)}assertValidity(){if(this.is0()){if(t.allowInfinityPoint&&!n.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:e,y:r}=this.toAffine();if(!n.isValid(e)||!n.isValid(r))throw new Error("bad point: x or y not FE");const i=n.sqr(r),s=o(e);if(!n.eql(i,s))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:e}=this.toAffine();if(n.isOdd)return!n.isOdd(e);throw new Error("Field doesn't support isOdd")}equals(e){u(e);const{px:t,py:r,pz:i}=this,{px:o,py:s,pz:a}=e,c=n.eql(n.mul(t,a),n.mul(o,i)),l=n.eql(n.mul(r,a),n.mul(s,i));return c&&l}negate(){return new d(this.px,n.neg(this.py),this.pz)}double(){const{a:e,b:r}=t,i=n.mul(r,mq),{px:o,py:s,pz:a}=this;let c=n.ZERO,l=n.ZERO,u=n.ZERO,h=n.mul(o,o),f=n.mul(s,s),p=n.mul(a,a),g=n.mul(o,s);return g=n.add(g,g),u=n.mul(o,a),u=n.add(u,u),c=n.mul(e,u),l=n.mul(i,p),l=n.add(c,l),c=n.sub(f,l),l=n.add(f,l),l=n.mul(c,l),c=n.mul(g,c),u=n.mul(i,u),p=n.mul(e,p),g=n.sub(h,p),g=n.mul(e,g),g=n.add(g,u),u=n.add(h,h),h=n.add(u,h),h=n.add(h,p),h=n.mul(h,g),l=n.add(l,h),p=n.mul(s,a),p=n.add(p,p),h=n.mul(p,g),c=n.sub(c,h),u=n.mul(p,f),u=n.add(u,u),u=n.add(u,u),new d(c,l,u)}add(e){u(e);const{px:r,py:i,pz:o}=this,{px:s,py:a,pz:c}=e;let l=n.ZERO,h=n.ZERO,f=n.ZERO;const p=t.a,g=n.mul(t.b,mq);let m=n.mul(r,s),v=n.mul(i,a),y=n.mul(o,c),w=n.add(r,i),b=n.add(s,a);w=n.mul(w,b),b=n.add(m,v),w=n.sub(w,b),b=n.add(r,o);let E=n.add(s,c);return b=n.mul(b,E),E=n.add(m,y),b=n.sub(b,E),E=n.add(i,o),l=n.add(a,c),E=n.mul(E,l),l=n.add(v,y),E=n.sub(E,l),f=n.mul(p,b),l=n.mul(g,y),f=n.add(l,f),l=n.sub(v,f),f=n.add(v,f),h=n.mul(l,f),v=n.add(m,m),v=n.add(v,m),y=n.mul(p,y),b=n.mul(g,b),v=n.add(v,y),y=n.sub(m,y),y=n.mul(p,y),b=n.add(b,y),m=n.mul(v,b),h=n.add(h,m),m=n.mul(E,b),l=n.mul(w,l),l=n.sub(l,m),m=n.mul(w,v),f=n.mul(E,f),f=n.add(f,m),new d(l,h,f)}subtract(e){return this.add(e.negate())}is0(){return this.equals(d.ZERO)}wNAF(e){return f.wNAFCached(this,l,e,(e=>{const t=n.invertBatch(e.map((e=>e.pz)));return e.map(((e,n)=>e.toAffine(t[n]))).map(d.fromAffine)}))}multiplyUnsafe(e){const r=d.ZERO;if(e===pq)return r;if(a(e),e===gq)return this;const{endo:i}=t;if(!i)return f.unsafeLadder(this,e);let{k1neg:o,k1:s,k2neg:c,k2:l}=i.splitScalar(e),u=r,h=r,p=this;for(;s>pq||l>pq;)s&gq&&(u=u.add(p)),l&gq&&(h=h.add(p)),p=p.double(),s>>=gq,l>>=gq;return o&&(u=u.negate()),c&&(h=h.negate()),h=new d(n.mul(h.px,i.beta),h.py,h.pz),u.add(h)}multiply(e){a(e);let r,i,o=e;const{endo:s}=t;if(s){const{k1neg:e,k1:t,k2neg:a,k2:c}=s.splitScalar(o);let{p:l,f:u}=this.wNAF(t),{p:h,f:p}=this.wNAF(c);l=f.constTimeNegate(e,l),h=f.constTimeNegate(a,h),h=new d(n.mul(h.px,s.beta),h.py,h.pz),r=l.add(h),i=u.add(p)}else{const{p:e,f:t}=this.wNAF(o);r=e,i=t}return d.normalizeZ([r,i])[0]}multiplyAndAddUnsafe(e,t,n){const r=d.BASE,i=(e,t)=>t!==pq&&t!==gq&&e.equals(r)?e.multiply(t):e.multiplyUnsafe(t),o=i(this,t).add(i(e,n));return o.is0()?void 0:o}toAffine(e){const{px:t,py:r,pz:i}=this,o=this.is0();null==e&&(e=o?n.ONE:n.inv(i));const s=n.mul(t,e),a=n.mul(r,e),c=n.mul(i,e);if(o)return{x:n.ZERO,y:n.ZERO};if(!n.eql(c,n.ONE))throw new Error("invZ was invalid");return{x:s,y:a}}isTorsionFree(){const{h:e,isTorsionFree:n}=t;if(e===gq)return!0;if(n)return n(d,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:e,clearCofactor:n}=t;return e===gq?this:n?n(d,this):this.multiplyUnsafe(t.h)}toRawBytes(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.assertValidity(),r(d,this,e)}toHex(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return OI(this.toRawBytes(e))}}d.BASE=new d(t.Gx,t.Gy,n.ONE),d.ZERO=new d(n.ZERO,n.ONE,n.ZERO);const h=t.nBitLength,f=yR(d,t.endo?Math.ceil(h/2):h);return{CURVE:t,ProjectivePoint:d,normPrivateKeyToScalar:c,weierstrassEquation:o,isWithinCurveOrder:s}}function yq(e){const t=function(e){const t=wR(e);return JI(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}(e),{Fp:n,n:r}=t,i=n.BYTES+1,o=2*n.BYTES+1;function s(e){return oR(e,r)}function a(e){return cR(e,r)}const{ProjectivePoint:c,normPrivateKeyToScalar:l,weierstrassEquation:u,isWithinCurveOrder:d}=vq({...t,toBytes(e,t,r){const i=t.toAffine(),o=n.toBytes(i.x),s=GI;return r?s(Uint8Array.from([t.hasEvenY()?2:3]),o):s(Uint8Array.from([4]),o,n.toBytes(i.y))},fromBytes(e){const t=e.length,r=e[0],s=e.subarray(1);if(t!==i||2!==r&&3!==r){if(t===o&&4===r){return{x:n.fromBytes(s.subarray(0,n.BYTES)),y:n.fromBytes(s.subarray(n.BYTES,2*n.BYTES))}}throw new Error("Point of length ".concat(t," was invalid. Expected ").concat(i," compressed bytes or ").concat(o," uncompressed bytes"))}{const e=jI(s);if(!(pq<(a=e)&&a<n.ORDER))throw new Error("Point is not on curve");const t=u(e);let i=n.sqrt(t);return 1===(1&r)!==((i&gq)===gq)&&(i=n.neg(i)),{x:e,y:i}}var a}}),h=e=>OI(zI(e,t.nByteLength));function f(e){return e>r>>gq}const p=(e,t,n)=>jI(e.slice(t,n));class g{constructor(e,t,n){this.r=e,this.s=t,this.recovery=n,this.assertValidity()}static fromCompact(e){const n=t.nByteLength;return e=qI("compactSignature",e,2*n),new g(p(e,0,n),p(e,n,2*n))}static fromDER(e){const{r:t,s:n}=fq.toSig(qI("DER",e));return new g(t,n)}assertValidity(){if(!d(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!d(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(e){return new g(this.r,this.s,e)}recoverPublicKey(e){const{r:r,s:i,recovery:o}=this,l=w(qI("msgHash",e));if(null==o||![0,1,2,3].includes(o))throw new Error("recovery id invalid");const u=2===o||3===o?r+t.n:r;if(u>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const d=0===(1&o)?"02":"03",f=c.fromHex(d+h(u)),p=a(u),g=s(-l*p),m=s(i*p),v=c.BASE.multiplyAndAddUnsafe(f,g,m);if(!v)throw new Error("point at infinify");return v.assertValidity(),v}hasHighS(){return f(this.s)}normalizeS(){return this.hasHighS()?new g(this.r,s(-this.s),this.recovery):this}toDERRawBytes(){return UI(this.toDERHex())}toDERHex(){return fq.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return UI(this.toCompactHex())}toCompactHex(){return h(this.r)+h(this.s)}}const m={isValidPrivateKey(e){try{return l(e),!0}catch(t){return!1}},normPrivateKeyToScalar:l,randomPrivateKey:()=>{const e=gR(t.n);return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=e.length,i=pR(t),o=gR(t);if(r<16||r<o||r>1024)throw new Error("expected ".concat(o,"-1024 bytes of input, got ").concat(r));const s=oR(n?jI(e):HI(e),t-$I)+$I;return n?VI(s,i):zI(s,i)}(t.randomBytes(e),t.n)},precompute(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.BASE;return t._setWindowSize(e),t.multiply(BigInt(3)),t}};function v(e){const t=BI(e),n="string"===typeof e,r=(t||n)&&e.length;return t?r===i||r===o:n?r===2*i||r===2*o:e instanceof c}const y=t.bits2int||function(e){const n=jI(e),r=8*e.length-t.nBitLength;return r>0?n>>BigInt(r):n},w=t.bits2int_modN||function(e){return s(y(e))},b=KI(t.nBitLength);function E(e){if("bigint"!==typeof e)throw new Error("bigint expected");if(!(pq<=e&&e<b))throw new Error("bigint expected < 2^".concat(t.nBitLength));return zI(e,t.nByteLength)}function k(e,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:A;if(["recovered","canonical"].some((e=>e in i)))throw new Error("sign() legacy options not supported");const{hash:o,randomBytes:u}=t;let{lowS:h,prehash:p,extraEntropy:m}=i;null==h&&(h=!0),e=qI("msgHash",e),p&&(e=qI("prehashed msgHash",o(e)));const v=w(e),b=l(r),k=[E(b),E(v)];if(null!=m){const e=!0===m?u(n.BYTES):m;k.push(qI("extraEntropy",e))}const S=GI(...k),x=v;return{seed:S,k2sig:function(e){const t=y(e);if(!d(t))return;const n=a(t),r=c.BASE.multiply(t).toAffine(),i=s(r.x);if(i===pq)return;const o=s(n*s(x+i*b));if(o===pq)return;let l=(r.x===i?0:2)|Number(r.y&gq),u=o;return h&&f(o)&&(u=function(e){return f(e)?s(-e):e}(o),l^=1),new g(i,u,l)}}}const A={lowS:t.lowS,prehash:!1},S={lowS:t.lowS,prehash:!1};return c.BASE._setWindowSize(8),{CURVE:t,getPublicKey:function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return c.fromPrivateKey(e).toRawBytes(t)},getSharedSecret:function(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(v(e))throw new Error("first arg must be private key");if(!v(t))throw new Error("second arg must be public key");return c.fromHex(t).multiply(l(e)).toRawBytes(n)},sign:function(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:A;const{seed:i,k2sig:o}=k(e,n,r),s=t;return YI(s.hash.outputLen,s.nByteLength,s.hmac)(i,o)},verify:function(e,n,r){var i;let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:S;const l=e;if(n=qI("msgHash",n),r=qI("publicKey",r),"strict"in o)throw new Error("options.strict was renamed to lowS");const{lowS:u,prehash:d}=o;let h,f;try{if("string"===typeof l||BI(l))try{h=g.fromDER(l)}catch(A){if(!(A instanceof fq.Err))throw A;h=g.fromCompact(l)}else{if("object"!==typeof l||"bigint"!==typeof l.r||"bigint"!==typeof l.s)throw new Error("PARSE");{const{r:e,s:t}=l;h=new g(e,t)}}f=c.fromHex(r)}catch(x){if("PARSE"===x.message)throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(u&&h.hasHighS())return!1;d&&(n=t.hash(n));const{r:p,s:m}=h,v=w(n),y=a(m),b=s(v*y),E=s(p*y),k=null===(i=c.BASE.multiplyAndAddUnsafe(f,b,E))||void 0===i?void 0:i.toAffine();return!!k&&s(k.x)===p},ProjectivePoint:c,Signature:g,utils:m}}function wq(e){return{hash:e,hmac:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return WR(e,t,cI(...r))},randomBytes:fI}}const bq=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Eq=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),kq=BigInt(1),Aq=BigInt(2),Sq=(e,t)=>(e+t/Aq)/t;function xq(e){const t=bq,n=BigInt(3),r=BigInt(6),i=BigInt(11),o=BigInt(22),s=BigInt(23),a=BigInt(44),c=BigInt(88),l=e*e*e%t,u=l*l*e%t,d=aR(u,n,t)*u%t,h=aR(d,n,t)*u%t,f=aR(h,Aq,t)*l%t,p=aR(f,i,t)*f%t,g=aR(p,o,t)*p%t,m=aR(g,a,t)*g%t,v=aR(m,c,t)*m%t,y=aR(v,a,t)*g%t,w=aR(y,n,t)*u%t,b=aR(w,s,t)*p%t,E=aR(b,r,t)*l%t,k=aR(E,Aq,t);if(!_q.eql(_q.sqr(k),e))throw new Error("Cannot find square root");return k}const _q=fR(bq,void 0,void 0,{sqrt:xq}),Iq=function(e,t){const n=t=>yq({...e,...wq(t)});return Object.freeze({...n(t),create:n})}({a:BigInt(0),b:BigInt(7),Fp:_q,n:Eq,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{const t=Eq,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-kq*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=n,s=BigInt("0x100000000000000000000000000000000"),a=Sq(o*e,t),c=Sq(-r*e,t);let l=oR(e-a*n-c*i,t),u=oR(-a*r-c*o,t);const d=l>s,h=u>s;if(d&&(l=t-l),h&&(u=t-u),l>s||u>s)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:d,k1:l,k2neg:h,k2:u}}}},rC);BigInt(0);Iq.ProjectivePoint;var Rq;const Cq=null!==(Rq=Iq)&&void 0!==Rq?Rq:x,Tq=BigInt("0xffffffffffffffff"),Pq=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),Nq=Cq.CURVE.n/BigInt(2),Bq={type:"object",required:["crypto","id","version","address"],properties:{crypto:{type:"object",required:["cipher","ciphertext","cipherparams","kdf","kdfparams","mac"],properties:{cipher:{type:"string"},ciphertext:{type:"string"},cipherparams:{type:"object"},kdf:{type:"string"},kdfparams:{type:"object"},salt:{type:"string"},mac:{type:"string"}}},id:{type:"string"},version:{type:"number"},address:{type:"string"}}};var Dq,Oq,Lq,Mq,Fq,Uq;!function(e){e[e.Mainnet=1]="Mainnet",e[e.Goerli=5]="Goerli",e[e.Sepolia=11155111]="Sepolia"}(Dq||(Dq={})),function(e){e.Chainstart="chainstart",e.Homestead="homestead",e.Dao="dao",e.TangerineWhistle="tangerineWhistle",e.SpuriousDragon="spuriousDragon",e.Byzantium="byzantium",e.Constantinople="constantinople",e.Petersburg="petersburg",e.Istanbul="istanbul",e.MuirGlacier="muirGlacier",e.Berlin="berlin",e.London="london",e.ArrowGlacier="arrowGlacier",e.GrayGlacier="grayGlacier",e.MergeForkIdTransition="mergeForkIdTransition",e.Merge="merge",e.Shanghai="shanghai",e.ShardingForkDev="shardingFork"}(Oq||(Oq={})),function(e){e.ProofOfStake="pos",e.ProofOfWork="pow",e.ProofOfAuthority="poa"}(Lq||(Lq={})),function(e){e.Ethash="ethash",e.Clique="clique",e.Casper="casper"}(Mq||(Mq={})),function(e){e.PolygonMainnet="polygon-mainnet",e.PolygonMumbai="polygon-mumbai",e.ArbitrumRinkebyTestnet="arbitrum-rinkeby-testnet",e.ArbitrumOne="arbitrum-one",e.xDaiChain="x-dai-chain",e.OptimisticKovan="optimistic-kovan",e.OptimisticEthereum="optimistic-ethereum"}(Fq||(Fq={})),function(e){e[e.Number=0]="Number",e[e.BigInt=1]="BigInt",e[e.Uint8Array=2]="Uint8Array",e[e.PrefixedHexString=3]="PrefixedHexString"}(Uq||(Uq={}));const jq=e=>{if("string"!==typeof e)throw new Error("[stripHexPrefix] input must be type 'string', received ".concat(typeof e));return Bj(e)?e.slice(2):e};const Hq=function(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("Received an invalid integer type: ".concat(e));return"0x".concat(e.toString(16))};function zq(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];var n,r;const{name:i,config:o,difficulty:s,mixHash:a,gasLimit:c,coinbase:l,baseFeePerGas:u}=e;let{extraData:d,timestamp:h,nonce:f}=e;const p=Number(h),{chainId:g}=o;if(""===d&&(d="0x"),Bj(h)||(h=Hq(parseInt(h))),18!==f.length&&(f=function(e){return e&&"0x0"!==e?Bj(e)?"0x".concat(jq(e).padStart(16,"0")):"0x".concat(e.padStart(16,"0")):"0x0000000000000000"}(f)),o.eip155Block!==o.eip158Block)throw new Error("EIP155 block number must equal EIP 158 block number since both are part of SpuriousDragon hardfork and the client only supports activating the full hardfork");const m={name:i,chainId:g,networkId:g,genesis:{timestamp:h,gasLimit:parseInt(c),difficulty:parseInt(s),nonce:f,extraData:d,mixHash:a,coinbase:l,baseFeePerGas:u},hardfork:void 0,hardforks:[],bootstrapNodes:[],consensus:void 0!==o.clique?{type:"poa",algorithm:"clique",clique:{period:null!==(n=o.clique.period)&&void 0!==n?n:o.clique.blockperiodseconds,epoch:null!==(r=o.clique.epoch)&&void 0!==r?r:o.clique.epochlength}}:{type:"pow",algorithm:"ethash",ethash:{}}},v={[Oq.Homestead]:{name:"homesteadBlock"},[Oq.Dao]:{name:"daoForkBlock"},[Oq.TangerineWhistle]:{name:"eip150Block"},[Oq.SpuriousDragon]:{name:"eip155Block"},[Oq.Byzantium]:{name:"byzantiumBlock"},[Oq.Constantinople]:{name:"constantinopleBlock"},[Oq.Petersburg]:{name:"petersburgBlock"},[Oq.Istanbul]:{name:"istanbulBlock"},[Oq.MuirGlacier]:{name:"muirGlacierBlock"},[Oq.Berlin]:{name:"berlinBlock"},[Oq.London]:{name:"londonBlock"},[Oq.MergeForkIdTransition]:{name:"mergeForkBlock",postMerge:t},[Oq.Shanghai]:{name:"shanghaiTime",postMerge:!0,isTimestamp:!0},[Oq.ShardingForkDev]:{name:"shardingForkTime",postMerge:!0,isTimestamp:!0}},y=Object.keys(v).reduce(((e,t)=>(e[v[t].name]=t,e)),{}),w=Object.keys(o).filter((e=>void 0!==y[e]&&void 0!==o[e]&&null!==o[e]));if(m.hardforks=w.map((e=>({name:y[e],block:!0===v[y[e]].isTimestamp||"number"!==typeof o[e]?null:o[e],timestamp:!0===v[y[e]].isTimestamp&&"number"===typeof o[e]?o[e]:void 0}))).filter((e=>null!==e.block||void 0!==e.timestamp)),m.hardforks.sort(((e,t)=>{var n,r;return(null!==(n=e.block)&&void 0!==n?n:1/0)-(null!==(r=t.block)&&void 0!==r?r:1/0)})),m.hardforks.sort(((e,t)=>{var n,r;return(null!==(n=e.timestamp)&&void 0!==n?n:p)-(null!==(r=t.timestamp)&&void 0!==r?r:p)})),void 0!==o.terminalTotalDifficulty){const e={name:Oq.Merge,ttd:o.terminalTotalDifficulty,block:null},t=m.hardforks.findIndex((e=>{var t;return!0===(null===(t=v[e.name])||void 0===t?void 0:t.postMerge)}));-1!==t?m.hardforks.splice(t,0,e):m.hardforks.push(e)}const b=m.hardforks.length>0?m.hardforks.slice(-1)[0]:void 0;return m.hardfork=null===b||void 0===b?void 0:b.name,m.hardforks.unshift({name:Oq.Chainstart,block:0}),m}function Vq(e){let t=e;if("string"!==typeof t)throw new Error("[padToEven] value must be type 'string', received ".concat(typeof t));return t.length%2&&(t="0".concat(t)),t}const qq=function(e){var t;if(null===e||void 0===e)return new Uint8Array;if(e instanceof Uint8Array)return e;if("Uint8Array"===(null===(t=null===e||void 0===e?void 0:e.constructor)||void 0===t?void 0:t.name))return Uint8Array.from(e);if(Array.isArray(e))return Uint8Array.from(e);if("string"===typeof e){if(!Pj(e))throw new Error("Cannot convert string to Uint8Array. only supports 0x-prefixed hex strings and this string was given: ".concat(e));return LH(Vq(jq(e)))}if("number"===typeof e)return qq(UH(e));if("bigint"===typeof e){if(e<BigInt(0))throw new Error("Cannot convert negative bigint to Uint8Array. Given: ".concat(e));let t=e.toString(16);return t.length%2&&(t="0".concat(t)),qq("0x".concat(t))}if(e.toArray)return Uint8Array.from(e.toArray());throw new Error("invalid type")};function Gq(e){const t=OH(e);return"0x"===t?BigInt(0):BigInt(t)}const Kq=function(e){return new Uint8Array(e).fill(0)};function Wq(e){if(!CH(e)){const t="This method only supports Uint8Array but input was: ".concat(e);throw new Error(t)}}const Qq=function(e,t){return Wq(e),function(e,t,n){const r=Kq(t);return n?e.length<t?(r.set(e),r):e.subarray(0,t):e.length<t?(r.set(e,t-e.length),r):e.subarray(-t)}(e,t,!1)};const Yq=function(e){return Wq(e),function(e){let t=e[0];for(;e.length>0&&"0"===t.toString();)t=(e=e.slice(1))[0];return e}(e)},Zq=e=>"0x".concat(e.toString(16));function Jq(e){return Yq(qq("0x".concat(e.toString(16))))}const Xq=function(e,t,n,r,i){const o=function(e,t){return e===BigInt(0)||e===BigInt(1)?e:void 0===t?e-BigInt(27):e-(t*BigInt(2)+BigInt(35))}(t,i);if(!function(e){return e===BigInt(0)||e===BigInt(1)}(o))throw new Error("Invalid signature v value");return new Cq.Signature(Gq(n),Gq(r)).addRecoveryBit(Number(o)).recoverPublicKey(e).toRawBytes(!1).slice(1)};function $q(e,t){if(null===e)return null;if(void 0===e)return;if("string"===typeof e&&!Pj(e))throw new Error("A string must be provided with a 0x-prefix, given: ".concat(e));if("number"===typeof e&&!Number.isSafeInteger(e))throw new Error("The provided number is greater than MAX_SAFE_INTEGER (please use an alternative input type)");const n=qq(e);switch(t){case Uq.Uint8Array:return n;case Uq.BigInt:return Gq(n);case Uq.Number:{const e=Gq(n);if(e>BigInt(Number.MAX_SAFE_INTEGER))throw new Error("The provided number is greater than MAX_SAFE_INTEGER (please use an alternative output type)");return Number(e)}case Uq.PrefixedHexString:return OH(n);default:throw new Error("unknown outputType")}}var eG=n(5576),tG=n(1031);const nG={name:"goerli",chainId:5,networkId:5,defaultHardfork:"merge",consensus:{type:"poa",algorithm:"clique",clique:{period:15,epoch:3e4}},comment:"Cross-client PoA test network",url:"https://github.com/goerli/testnet",genesis:{timestamp:"0x5c51a607",gasLimit:10485760,difficulty:1,nonce:"0x0000000000000000",extraData:"0x22466c6578692069732061207468696e6722202d204166726900000000000000e0a2bd4258d2768837baa26a28fe71dc079f84c70000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"},hardforks:[{name:"chainstart",block:0,forkHash:"0xa3f5ab08"},{name:"homestead",block:0,forkHash:"0xa3f5ab08"},{name:"tangerineWhistle",block:0,forkHash:"0xa3f5ab08"},{name:"spuriousDragon",block:0,forkHash:"0xa3f5ab08"},{name:"byzantium",block:0,forkHash:"0xa3f5ab08"},{name:"constantinople",block:0,forkHash:"0xa3f5ab08"},{name:"petersburg",block:0,forkHash:"0xa3f5ab08"},{name:"istanbul",block:1561651,forkHash:"0xc25efa5c"},{name:"berlin",block:4460644,forkHash:"0x757a1c47"},{name:"london",block:5062605,forkHash:"0xb8c6299d"},{"//_comment":"The forkHash will remain same as mergeForkIdTransition is post merge, terminal block: https://goerli.etherscan.io/block/7382818",name:"merge",ttd:"10790000",block:7382819,forkHash:"0xb8c6299d"},{name:"mergeForkIdTransition",block:null,forkHash:null},{name:"shanghai",block:null,forkHash:null}],bootstrapNodes:[],dnsNetworks:["enrtree://AKA3AM6LPBYEUDMVNU3BSVQJ5AD45Y7YPOHJLEF6W26QOE4VTUDPE@all.goerli.ethdisco.net"]},rG={name:"mainnet",chainId:1,networkId:1,defaultHardfork:"merge",consensus:{type:"pow",algorithm:"ethash",ethash:{}},comment:"The Ethereum main chain",url:"https://ethstats.net/",genesis:{gasLimit:5e3,difficulty:17179869184,nonce:"0x0000000000000042",extraData:"0x11bbe8db4e347b4e8c937c1c8370e4b5ed33adb3db69cbdb7a38e1e50b1b82fa"},hardforks:[{name:"chainstart",block:0,forkHash:"0xfc64ec04"},{name:"homestead",block:115e4,forkHash:"0x97c2c34c"},{name:"dao",block:192e4,forkHash:"0x91d1f948"},{name:"tangerineWhistle",block:2463e3,forkHash:"0x7a64da13"},{name:"spuriousDragon",block:2675e3,forkHash:"0x3edd5b10"},{name:"byzantium",block:437e4,forkHash:"0xa00bc324"},{name:"constantinople",block:728e4,forkHash:"0x668db0af"},{name:"petersburg",block:728e4,forkHash:"0x668db0af"},{name:"istanbul",block:9069e3,forkHash:"0x879d6e30"},{name:"muirGlacier",block:92e5,forkHash:"0xe029e991"},{name:"berlin",block:12244e3,forkHash:"0x0eb440f6"},{name:"london",block:12965e3,forkHash:"0xb715077d"},{name:"arrowGlacier",block:13773e3,forkHash:"0x20c327fc"},{name:"grayGlacier",block:1505e4,forkHash:"0xf0afd0e3"},{"//_comment":"The forkHash will remain same as mergeForkIdTransition is post merge, terminal block: https://etherscan.io/block/15537393",name:"merge",ttd:"58750000000000000000000",block:15537394,forkHash:"0xf0afd0e3"},{name:"mergeForkIdTransition",block:null,forkHash:null},{name:"shanghai",block:null,forkHash:null}],bootstrapNodes:[],dnsNetworks:["enrtree://AKA3AM6LPBYEUDMVNU3BSVQJ5AD45Y7YPOHJLEF6W26QOE4VTUDPE@all.mainnet.ethdisco.net"]},iG={name:"sepolia",chainId:11155111,networkId:11155111,defaultHardfork:"merge",consensus:{type:"pow",algorithm:"ethash",ethash:{}},comment:"PoW test network to replace Ropsten",url:"https://github.com/ethereum/go-ethereum/pull/23730",genesis:{timestamp:"0x6159af19",gasLimit:3e7,difficulty:131072,nonce:"0x0000000000000000",extraData:"0x5365706f6c69612c20417468656e732c204174746963612c2047726565636521"},hardforks:[{name:"chainstart",block:0,forkHash:"0xfe3366e7"},{name:"homestead",block:0,forkHash:"0xfe3366e7"},{name:"tangerineWhistle",block:0,forkHash:"0xfe3366e7"},{name:"spuriousDragon",block:0,forkHash:"0xfe3366e7"},{name:"byzantium",block:0,forkHash:"0xfe3366e7"},{name:"constantinople",block:0,forkHash:"0xfe3366e7"},{name:"petersburg",block:0,forkHash:"0xfe3366e7"},{name:"istanbul",block:0,forkHash:"0xfe3366e7"},{name:"muirGlacier",block:0,forkHash:"0xfe3366e7"},{name:"berlin",block:0,forkHash:"0xfe3366e7"},{name:"london",block:0,forkHash:"0xfe3366e7"},{"//_comment":"The forkHash will remain same as mergeForkIdTransition is post merge, terminal block: https://sepolia.etherscan.io/block/1450408",name:"merge",ttd:"17000000000000000",block:1450409,forkHash:"0xfe3366e7"},{name:"mergeForkIdTransition",block:1735371,forkHash:"0xb96cbd13"},{name:"shanghai",block:null,timestamp:"1677557088",forkHash:"0xf7f9bc08"}],bootstrapNodes:[],dnsNetworks:["enrtree://AKA3AM6LPBYEUDMVNU3BSVQJ5AD45Y7YPOHJLEF6W26QOE4VTUDPE@all.sepolia.ethdisco.net"]},oG={1153:{name:"EIP-1153",number:1153,comment:"Transient Storage",url:"https://eips.ethereum.org/EIPS/eip-1153",status:"Review",minimumHardfork:"chainstart",requiredEIPs:[],gasConfig:{},gasPrices:{tstore:{v:100,d:"Base fee of the TSTORE opcode"},tload:{v:100,d:"Base fee of the TLOAD opcode"}},vm:{},pow:{}},1559:{name:"EIP-1559",number:1559,comment:"Fee market change for ETH 1.0 chain",url:"https://eips.ethereum.org/EIPS/eip-1559",status:"Final",minimumHardfork:"berlin",requiredEIPs:[2930],gasConfig:{baseFeeMaxChangeDenominator:{v:8,d:"Maximum base fee change denominator"},elasticityMultiplier:{v:2,d:"Maximum block gas target elasticity"},initialBaseFee:{v:1e9,d:"Initial base fee on first EIP1559 block"}},gasPrices:{},vm:{},pow:{}},2315:{name:"EIP-2315",number:2315,comment:"Simple subroutines for the EVM",url:"https://eips.ethereum.org/EIPS/eip-2315",status:"Draft",minimumHardfork:"istanbul",gasConfig:{},gasPrices:{beginsub:{v:2,d:"Base fee of the BEGINSUB opcode"},returnsub:{v:5,d:"Base fee of the RETURNSUB opcode"},jumpsub:{v:10,d:"Base fee of the JUMPSUB opcode"}},vm:{},pow:{}},2537:{name:"EIP-2537",number:2537,comment:"BLS12-381 precompiles",url:"https://eips.ethereum.org/EIPS/eip-2537",status:"Draft",minimumHardfork:"chainstart",gasConfig:{},gasPrices:{Bls12381G1AddGas:{v:600,d:"Gas cost of a single BLS12-381 G1 addition precompile-call"},Bls12381G1MulGas:{v:12e3,d:"Gas cost of a single BLS12-381 G1 multiplication precompile-call"},Bls12381G2AddGas:{v:4500,d:"Gas cost of a single BLS12-381 G2 addition precompile-call"},Bls12381G2MulGas:{v:55e3,d:"Gas cost of a single BLS12-381 G2 multiplication precompile-call"},Bls12381PairingBaseGas:{v:115e3,d:"Base gas cost of BLS12-381 pairing check"},Bls12381PairingPerPairGas:{v:23e3,d:"Per-pair gas cost of BLS12-381 pairing check"},Bls12381MapG1Gas:{v:5500,d:"Gas cost of BLS12-381 map field element to G1"},Bls12381MapG2Gas:{v:11e4,d:"Gas cost of BLS12-381 map field element to G2"},Bls12381MultiExpGasDiscount:{v:[[1,1200],[2,888],[3,764],[4,641],[5,594],[6,547],[7,500],[8,453],[9,438],[10,423],[11,408],[12,394],[13,379],[14,364],[15,349],[16,334],[17,330],[18,326],[19,322],[20,318],[21,314],[22,310],[23,306],[24,302],[25,298],[26,294],[27,289],[28,285],[29,281],[30,277],[31,273],[32,269],[33,268],[34,266],[35,265],[36,263],[37,262],[38,260],[39,259],[40,257],[41,256],[42,254],[43,253],[44,251],[45,250],[46,248],[47,247],[48,245],[49,244],[50,242],[51,241],[52,239],[53,238],[54,236],[55,235],[56,233],[57,232],[58,231],[59,229],[60,228],[61,226],[62,225],[63,223],[64,222],[65,221],[66,220],[67,219],[68,219],[69,218],[70,217],[71,216],[72,216],[73,215],[74,214],[75,213],[76,213],[77,212],[78,211],[79,211],[80,210],[81,209],[82,208],[83,208],[84,207],[85,206],[86,205],[87,205],[88,204],[89,203],[90,202],[91,202],[92,201],[93,200],[94,199],[95,199],[96,198],[97,197],[98,196],[99,196],[100,195],[101,194],[102,193],[103,193],[104,192],[105,191],[106,191],[107,190],[108,189],[109,188],[110,188],[111,187],[112,186],[113,185],[114,185],[115,184],[116,183],[117,182],[118,182],[119,181],[120,180],[121,179],[122,179],[123,178],[124,177],[125,176],[126,176],[127,175],[128,174]],d:"Discount gas costs of calls to the MultiExp precompiles with `k` (point, scalar) pair"}},vm:{},pow:{}},2565:{name:"EIP-2565",number:2565,comment:"ModExp gas cost",url:"https://eips.ethereum.org/EIPS/eip-2565",status:"Final",minimumHardfork:"byzantium",gasConfig:{},gasPrices:{modexpGquaddivisor:{v:3,d:"Gquaddivisor from modexp precompile for gas calculation"}},vm:{},pow:{}},2718:{name:"EIP-2718",comment:"Typed Transaction Envelope",url:"https://eips.ethereum.org/EIPS/eip-2718",status:"Final",minimumHardfork:"chainstart",gasConfig:{},gasPrices:{},vm:{},pow:{}},2929:{name:"EIP-2929",comment:"Gas cost increases for state access opcodes",url:"https://eips.ethereum.org/EIPS/eip-2929",status:"Final",minimumHardfork:"chainstart",gasConfig:{},gasPrices:{coldsload:{v:2100,d:"Gas cost of the first read of storage from a given location (per transaction)"},coldaccountaccess:{v:2600,d:"Gas cost of the first read of a given address (per transaction)"},warmstorageread:{v:100,d:"Gas cost of reading storage locations which have already loaded 'cold'"},sstoreCleanGasEIP2200:{v:2900,d:"Once per SSTORE operation from clean non-zero to something else"},sstoreNoopGasEIP2200:{v:100,d:"Once per SSTORE operation if the value doesn't change"},sstoreDirtyGasEIP2200:{v:100,d:"Once per SSTORE operation if a dirty value is changed"},sstoreInitRefundEIP2200:{v:19900,d:"Once per SSTORE operation for resetting to the original zero value"},sstoreCleanRefundEIP2200:{v:4900,d:"Once per SSTORE operation for resetting to the original non-zero value"},call:{v:0,d:"Base fee of the CALL opcode"},callcode:{v:0,d:"Base fee of the CALLCODE opcode"},delegatecall:{v:0,d:"Base fee of the DELEGATECALL opcode"},staticcall:{v:0,d:"Base fee of the STATICCALL opcode"},balance:{v:0,d:"Base fee of the BALANCE opcode"},extcodesize:{v:0,d:"Base fee of the EXTCODESIZE opcode"},extcodecopy:{v:0,d:"Base fee of the EXTCODECOPY opcode"},extcodehash:{v:0,d:"Base fee of the EXTCODEHASH opcode"},sload:{v:0,d:"Base fee of the SLOAD opcode"},sstore:{v:0,d:"Base fee of the SSTORE opcode"}},vm:{},pow:{}},2930:{name:"EIP-2930",comment:"Optional access lists",url:"https://eips.ethereum.org/EIPS/eip-2930",status:"Final",minimumHardfork:"istanbul",requiredEIPs:[2718,2929],gasConfig:{},gasPrices:{accessListStorageKeyCost:{v:1900,d:"Gas cost per storage key in an Access List transaction"},accessListAddressCost:{v:2400,d:"Gas cost per storage key in an Access List transaction"}},vm:{},pow:{}},3198:{name:"EIP-3198",number:3198,comment:"BASEFEE opcode",url:"https://eips.ethereum.org/EIPS/eip-3198",status:"Final",minimumHardfork:"london",gasConfig:{},gasPrices:{basefee:{v:2,d:"Gas cost of the BASEFEE opcode"}},vm:{},pow:{}},3529:{name:"EIP-3529",comment:"Reduction in refunds",url:"https://eips.ethereum.org/EIPS/eip-3529",status:"Final",minimumHardfork:"berlin",requiredEIPs:[2929],gasConfig:{maxRefundQuotient:{v:5,d:"Maximum refund quotient; max tx refund is min(tx.gasUsed/maxRefundQuotient, tx.gasRefund)"}},gasPrices:{selfdestructRefund:{v:0,d:"Refunded following a selfdestruct operation"},sstoreClearRefundEIP2200:{v:4800,d:"Once per SSTORE operation for clearing an originally existing storage slot"}},vm:{},pow:{}},3540:{name:"EIP-3540",number:3540,comment:"EVM Object Format (EOF) v1",url:"https://eips.ethereum.org/EIPS/eip-3540",status:"Review",minimumHardfork:"london",requiredEIPs:[3541],gasConfig:{},gasPrices:{},vm:{},pow:{}},3541:{name:"EIP-3541",comment:"Reject new contracts starting with the 0xEF byte",url:"https://eips.ethereum.org/EIPS/eip-3541",status:"Final",minimumHardfork:"berlin",requiredEIPs:[],gasConfig:{},gasPrices:{},vm:{},pow:{}},3554:{name:"EIP-3554",comment:"Reduction in refunds",url:"Difficulty Bomb Delay to December 1st 2021",status:"Final",minimumHardfork:"muirGlacier",requiredEIPs:[],gasConfig:{},gasPrices:{},vm:{},pow:{difficultyBombDelay:{v:95e5,d:"the amount of blocks to delay the difficulty bomb with"}}},3607:{name:"EIP-3607",number:3607,comment:"Reject transactions from senders with deployed code",url:"https://eips.ethereum.org/EIPS/eip-3607",status:"Final",minimumHardfork:"chainstart",requiredEIPs:[],gasConfig:{},gasPrices:{},vm:{},pow:{}},3651:{name:"EIP-3651",number:3198,comment:"Warm COINBASE",url:"https://eips.ethereum.org/EIPS/eip-3651",status:"Review",minimumHardfork:"london",requiredEIPs:[2929],gasConfig:{},gasPrices:{},vm:{},pow:{}},3670:{name:"EIP-3670",number:3670,comment:"EOF - Code Validation",url:"https://eips.ethereum.org/EIPS/eip-3670",status:"Review",minimumHardfork:"london",requiredEIPs:[3540],gasConfig:{},gasPrices:{},vm:{},pow:{}},3675:{name:"EIP-3675",number:3675,comment:"Upgrade consensus to Proof-of-Stake",url:"https://eips.ethereum.org/EIPS/eip-3675",status:"Final",minimumHardfork:"london",requiredEIPs:[],gasConfig:{},gasPrices:{},vm:{},pow:{}},3855:{name:"EIP-3855",number:3855,comment:"PUSH0 instruction",url:"https://eips.ethereum.org/EIPS/eip-3855",status:"Review",minimumHardfork:"chainstart",requiredEIPs:[],gasConfig:{},gasPrices:{push0:{v:2,d:"Base fee of the PUSH0 opcode"}},vm:{},pow:{}},3860:{name:"EIP-3860",number:3860,comment:"Limit and meter initcode",url:"https://eips.ethereum.org/EIPS/eip-3860",status:"Review",minimumHardfork:"spuriousDragon",requiredEIPs:[],gasConfig:{},gasPrices:{initCodeWordCost:{v:2,d:"Gas to pay for each word (32 bytes) of initcode when creating a contract"}},vm:{maxInitCodeSize:{v:49152,d:"Maximum length of initialization code when creating a contract"}},pow:{}},4345:{name:"EIP-4345",number:4345,comment:"Difficulty Bomb Delay to June 2022",url:"https://eips.ethereum.org/EIPS/eip-4345",status:"Final",minimumHardfork:"london",gasConfig:{},gasPrices:{},vm:{},pow:{difficultyBombDelay:{v:107e5,d:"the amount of blocks to delay the difficulty bomb with"}}},4399:{name:"EIP-4399",number:4399,comment:"Supplant DIFFICULTY opcode with PREVRANDAO",url:"https://eips.ethereum.org/EIPS/eip-4399",status:"Review",minimumHardfork:"london",requiredEIPs:[],gasConfig:{},gasPrices:{},vm:{},pow:{}},5133:{name:"EIP-5133",number:5133,comment:"Delaying Difficulty Bomb to mid-September 2022",url:"https://eips.ethereum.org/EIPS/eip-5133",status:"Draft",minimumHardfork:"grayGlacier",gasConfig:{},gasPrices:{},vm:{},pow:{difficultyBombDelay:{v:114e5,d:"the amount of blocks to delay the difficulty bomb with"}}}},sG={chainstart:{name:"chainstart",comment:"Start of the Ethereum main chain",url:"",status:"",gasConfig:{minGasLimit:{v:5e3,d:"Minimum the gas limit may ever be"},gasLimitBoundDivisor:{v:1024,d:"The bound divisor of the gas limit, used in update calculations"},maxRefundQuotient:{v:2,d:"Maximum refund quotient; max tx refund is min(tx.gasUsed/maxRefundQuotient, tx.gasRefund)"}},gasPrices:{base:{v:2,d:"Gas base cost, used e.g. for ChainID opcode (Istanbul)"},tierStep:{v:[0,2,3,5,8,10,20],d:"Once per operation, for a selection of them"},exp:{v:10,d:"Base fee of the EXP opcode"},expByte:{v:10,d:"Times ceil(log256(exponent)) for the EXP instruction"},sha3:{v:30,d:"Base fee of the SHA3 opcode"},sha3Word:{v:6,d:"Once per word of the SHA3 operation's data"},sload:{v:50,d:"Base fee of the SLOAD opcode"},sstoreSet:{v:2e4,d:"Once per SSTORE operation if the zeroness changes from zero"},sstoreReset:{v:5e3,d:"Once per SSTORE operation if the zeroness does not change from zero"},sstoreRefund:{v:15e3,d:"Once per SSTORE operation if the zeroness changes to zero"},jumpdest:{v:1,d:"Base fee of the JUMPDEST opcode"},log:{v:375,d:"Base fee of the LOG opcode"},logData:{v:8,d:"Per byte in a LOG* operation's data"},logTopic:{v:375,d:"Multiplied by the * of the LOG*, per LOG transaction. e.g. LOG0 incurs 0 * c_txLogTopicGas, LOG4 incurs 4 * c_txLogTopicGas"},create:{v:32e3,d:"Base fee of the CREATE opcode"},call:{v:40,d:"Base fee of the CALL opcode"},callStipend:{v:2300,d:"Free gas given at beginning of call"},callValueTransfer:{v:9e3,d:"Paid for CALL when the value transfor is non-zero"},callNewAccount:{v:25e3,d:"Paid for CALL when the destination address didn't exist prior"},selfdestructRefund:{v:24e3,d:"Refunded following a selfdestruct operation"},memory:{v:3,d:"Times the address of the (highest referenced byte in memory + 1). NOTE: referencing happens on read, write and in instructions such as RETURN and CALL"},quadCoeffDiv:{v:512,d:"Divisor for the quadratic particle of the memory cost equation"},createData:{v:200,d:""},tx:{v:21e3,d:"Per transaction. NOTE: Not payable on data of calls between transactions"},txCreation:{v:32e3,d:"The cost of creating a contract via tx"},txDataZero:{v:4,d:"Per byte of data attached to a transaction that equals zero. NOTE: Not payable on data of calls between transactions"},txDataNonZero:{v:68,d:"Per byte of data attached to a transaction that is not equal to zero. NOTE: Not payable on data of calls between transactions"},copy:{v:3,d:"Multiplied by the number of 32-byte words that are copied (round up) for any *COPY operation and added"},ecRecover:{v:3e3,d:""},sha256:{v:60,d:""},sha256Word:{v:12,d:""},ripemd160:{v:600,d:""},ripemd160Word:{v:120,d:""},identity:{v:15,d:""},identityWord:{v:3,d:""},stop:{v:0,d:"Base fee of the STOP opcode"},add:{v:3,d:"Base fee of the ADD opcode"},mul:{v:5,d:"Base fee of the MUL opcode"},sub:{v:3,d:"Base fee of the SUB opcode"},div:{v:5,d:"Base fee of the DIV opcode"},sdiv:{v:5,d:"Base fee of the SDIV opcode"},mod:{v:5,d:"Base fee of the MOD opcode"},smod:{v:5,d:"Base fee of the SMOD opcode"},addmod:{v:8,d:"Base fee of the ADDMOD opcode"},mulmod:{v:8,d:"Base fee of the MULMOD opcode"},signextend:{v:5,d:"Base fee of the SIGNEXTEND opcode"},lt:{v:3,d:"Base fee of the LT opcode"},gt:{v:3,d:"Base fee of the GT opcode"},slt:{v:3,d:"Base fee of the SLT opcode"},sgt:{v:3,d:"Base fee of the SGT opcode"},eq:{v:3,d:"Base fee of the EQ opcode"},iszero:{v:3,d:"Base fee of the ISZERO opcode"},and:{v:3,d:"Base fee of the AND opcode"},or:{v:3,d:"Base fee of the OR opcode"},xor:{v:3,d:"Base fee of the XOR opcode"},not:{v:3,d:"Base fee of the NOT opcode"},byte:{v:3,d:"Base fee of the BYTE opcode"},address:{v:2,d:"Base fee of the ADDRESS opcode"},balance:{v:20,d:"Base fee of the BALANCE opcode"},origin:{v:2,d:"Base fee of the ORIGIN opcode"},caller:{v:2,d:"Base fee of the CALLER opcode"},callvalue:{v:2,d:"Base fee of the CALLVALUE opcode"},calldataload:{v:3,d:"Base fee of the CALLDATALOAD opcode"},calldatasize:{v:2,d:"Base fee of the CALLDATASIZE opcode"},calldatacopy:{v:3,d:"Base fee of the CALLDATACOPY opcode"},codesize:{v:2,d:"Base fee of the CODESIZE opcode"},codecopy:{v:3,d:"Base fee of the CODECOPY opcode"},gasprice:{v:2,d:"Base fee of the GASPRICE opcode"},extcodesize:{v:20,d:"Base fee of the EXTCODESIZE opcode"},extcodecopy:{v:20,d:"Base fee of the EXTCODECOPY opcode"},blockhash:{v:20,d:"Base fee of the BLOCKHASH opcode"},coinbase:{v:2,d:"Base fee of the COINBASE opcode"},timestamp:{v:2,d:"Base fee of the TIMESTAMP opcode"},number:{v:2,d:"Base fee of the NUMBER opcode"},difficulty:{v:2,d:"Base fee of the DIFFICULTY opcode"},gaslimit:{v:2,d:"Base fee of the GASLIMIT opcode"},pop:{v:2,d:"Base fee of the POP opcode"},mload:{v:3,d:"Base fee of the MLOAD opcode"},mstore:{v:3,d:"Base fee of the MSTORE opcode"},mstore8:{v:3,d:"Base fee of the MSTORE8 opcode"},sstore:{v:0,d:"Base fee of the SSTORE opcode"},jump:{v:8,d:"Base fee of the JUMP opcode"},jumpi:{v:10,d:"Base fee of the JUMPI opcode"},pc:{v:2,d:"Base fee of the PC opcode"},msize:{v:2,d:"Base fee of the MSIZE opcode"},gas:{v:2,d:"Base fee of the GAS opcode"},push:{v:3,d:"Base fee of the PUSH opcode"},dup:{v:3,d:"Base fee of the DUP opcode"},swap:{v:3,d:"Base fee of the SWAP opcode"},callcode:{v:40,d:"Base fee of the CALLCODE opcode"},return:{v:0,d:"Base fee of the RETURN opcode"},invalid:{v:0,d:"Base fee of the INVALID opcode"},selfdestruct:{v:0,d:"Base fee of the SELFDESTRUCT opcode"}},vm:{stackLimit:{v:1024,d:"Maximum size of VM stack allowed"},callCreateDepth:{v:1024,d:"Maximum depth of call/create stack"},maxExtraDataSize:{v:32,d:"Maximum size extra data may be after Genesis"}},pow:{minimumDifficulty:{v:131072,d:"The minimum that the difficulty may ever be"},difficultyBoundDivisor:{v:2048,d:"The bound divisor of the difficulty, used in the update calculations"},durationLimit:{v:13,d:"The decision boundary on the blocktime duration used to determine whether difficulty should go up or not"},epochDuration:{v:3e4,d:"Duration between proof-of-work epochs"},timebombPeriod:{v:1e5,d:"Exponential difficulty timebomb period"},minerReward:{v:"5000000000000000000",d:"the amount a miner get rewarded for mining a block"},difficultyBombDelay:{v:0,d:"the amount of blocks to delay the difficulty bomb with"}}},homestead:{name:"homestead",comment:"Homestead hardfork with protocol and network changes",url:"https://eips.ethereum.org/EIPS/eip-606",status:"Final",gasConfig:{},gasPrices:{delegatecall:{v:40,d:"Base fee of the DELEGATECALL opcode"}},vm:{},pow:{}},dao:{name:"dao",comment:"DAO rescue hardfork",url:"https://eips.ethereum.org/EIPS/eip-779",status:"Final",gasConfig:{},gasPrices:{},vm:{},pow:{}},tangerineWhistle:{name:"tangerineWhistle",comment:"Hardfork with gas cost changes for IO-heavy operations",url:"https://eips.ethereum.org/EIPS/eip-608",status:"Final",gasConfig:{},gasPrices:{sload:{v:200,d:"Once per SLOAD operation"},call:{v:700,d:"Once per CALL operation & message call transaction"},extcodesize:{v:700,d:"Base fee of the EXTCODESIZE opcode"},extcodecopy:{v:700,d:"Base fee of the EXTCODECOPY opcode"},balance:{v:400,d:"Base fee of the BALANCE opcode"},delegatecall:{v:700,d:"Base fee of the DELEGATECALL opcode"},callcode:{v:700,d:"Base fee of the CALLCODE opcode"},selfdestruct:{v:5e3,d:"Base fee of the SELFDESTRUCT opcode"}},vm:{},pow:{}},spuriousDragon:{name:"spuriousDragon",comment:"HF with EIPs for simple replay attack protection, EXP cost increase, state trie clearing, contract code size limit",url:"https://eips.ethereum.org/EIPS/eip-607",status:"Final",gasConfig:{},gasPrices:{expByte:{v:50,d:"Times ceil(log256(exponent)) for the EXP instruction"}},vm:{maxCodeSize:{v:24576,d:"Maximum length of contract code"}},pow:{}},byzantium:{name:"byzantium",comment:"Hardfork with new precompiles, instructions and other protocol changes",url:"https://eips.ethereum.org/EIPS/eip-609",status:"Final",gasConfig:{},gasPrices:{modexpGquaddivisor:{v:20,d:"Gquaddivisor from modexp precompile for gas calculation"},ecAdd:{v:500,d:"Gas costs for curve addition precompile"},ecMul:{v:4e4,d:"Gas costs for curve multiplication precompile"},ecPairing:{v:1e5,d:"Base gas costs for curve pairing precompile"},ecPairingWord:{v:8e4,d:"Gas costs regarding curve pairing precompile input length"},revert:{v:0,d:"Base fee of the REVERT opcode"},staticcall:{v:700,d:"Base fee of the STATICCALL opcode"},returndatasize:{v:2,d:"Base fee of the RETURNDATASIZE opcode"},returndatacopy:{v:3,d:"Base fee of the RETURNDATACOPY opcode"}},vm:{},pow:{minerReward:{v:"3000000000000000000",d:"the amount a miner get rewarded for mining a block"},difficultyBombDelay:{v:3e6,d:"the amount of blocks to delay the difficulty bomb with"}}},constantinople:{name:"constantinople",comment:"Postponed hardfork including EIP-1283 (SSTORE gas metering changes)",url:"https://eips.ethereum.org/EIPS/eip-1013",status:"Final",gasConfig:{},gasPrices:{netSstoreNoopGas:{v:200,d:"Once per SSTORE operation if the value doesn't change"},netSstoreInitGas:{v:2e4,d:"Once per SSTORE operation from clean zero"},netSstoreCleanGas:{v:5e3,d:"Once per SSTORE operation from clean non-zero"},netSstoreDirtyGas:{v:200,d:"Once per SSTORE operation from dirty"},netSstoreClearRefund:{v:15e3,d:"Once per SSTORE operation for clearing an originally existing storage slot"},netSstoreResetRefund:{v:4800,d:"Once per SSTORE operation for resetting to the original non-zero value"},netSstoreResetClearRefund:{v:19800,d:"Once per SSTORE operation for resetting to the original zero value"},shl:{v:3,d:"Base fee of the SHL opcode"},shr:{v:3,d:"Base fee of the SHR opcode"},sar:{v:3,d:"Base fee of the SAR opcode"},extcodehash:{v:400,d:"Base fee of the EXTCODEHASH opcode"},create2:{v:32e3,d:"Base fee of the CREATE2 opcode"}},vm:{},pow:{minerReward:{v:"2000000000000000000",d:"The amount a miner gets rewarded for mining a block"},difficultyBombDelay:{v:5e6,d:"the amount of blocks to delay the difficulty bomb with"}}},petersburg:{name:"petersburg",comment:"Aka constantinopleFix, removes EIP-1283, activate together with or after constantinople",url:"https://eips.ethereum.org/EIPS/eip-1716",status:"Final",gasConfig:{},gasPrices:{netSstoreNoopGas:{v:null,d:"Removed along EIP-1283"},netSstoreInitGas:{v:null,d:"Removed along EIP-1283"},netSstoreCleanGas:{v:null,d:"Removed along EIP-1283"},netSstoreDirtyGas:{v:null,d:"Removed along EIP-1283"},netSstoreClearRefund:{v:null,d:"Removed along EIP-1283"},netSstoreResetRefund:{v:null,d:"Removed along EIP-1283"},netSstoreResetClearRefund:{v:null,d:"Removed along EIP-1283"}},vm:{},pow:{}},istanbul:{name:"istanbul",comment:"HF targeted for December 2019 following the Constantinople/Petersburg HF",url:"https://eips.ethereum.org/EIPS/eip-1679",status:"Final",gasConfig:{},gasPrices:{blake2Round:{v:1,d:"Gas cost per round for the Blake2 F precompile"},ecAdd:{v:150,d:"Gas costs for curve addition precompile"},ecMul:{v:6e3,d:"Gas costs for curve multiplication precompile"},ecPairing:{v:45e3,d:"Base gas costs for curve pairing precompile"},ecPairingWord:{v:34e3,d:"Gas costs regarding curve pairing precompile input length"},txDataNonZero:{v:16,d:"Per byte of data attached to a transaction that is not equal to zero. NOTE: Not payable on data of calls between transactions"},sstoreSentryGasEIP2200:{v:2300,d:"Minimum gas required to be present for an SSTORE call, not consumed"},sstoreNoopGasEIP2200:{v:800,d:"Once per SSTORE operation if the value doesn't change"},sstoreDirtyGasEIP2200:{v:800,d:"Once per SSTORE operation if a dirty value is changed"},sstoreInitGasEIP2200:{v:2e4,d:"Once per SSTORE operation from clean zero to non-zero"},sstoreInitRefundEIP2200:{v:19200,d:"Once per SSTORE operation for resetting to the original zero value"},sstoreCleanGasEIP2200:{v:5e3,d:"Once per SSTORE operation from clean non-zero to something else"},sstoreCleanRefundEIP2200:{v:4200,d:"Once per SSTORE operation for resetting to the original non-zero value"},sstoreClearRefundEIP2200:{v:15e3,d:"Once per SSTORE operation for clearing an originally existing storage slot"},balance:{v:700,d:"Base fee of the BALANCE opcode"},extcodehash:{v:700,d:"Base fee of the EXTCODEHASH opcode"},chainid:{v:2,d:"Base fee of the CHAINID opcode"},selfbalance:{v:5,d:"Base fee of the SELFBALANCE opcode"},sload:{v:800,d:"Base fee of the SLOAD opcode"}},vm:{},pow:{}},muirGlacier:{name:"muirGlacier",comment:"HF to delay the difficulty bomb",url:"https://eips.ethereum.org/EIPS/eip-2384",status:"Final",gasConfig:{},gasPrices:{},vm:{},pow:{difficultyBombDelay:{v:9e6,d:"the amount of blocks to delay the difficulty bomb with"}}},berlin:{name:"berlin",comment:"HF targeted for July 2020 following the Muir Glacier HF",url:"https://eips.ethereum.org/EIPS/eip-2070",status:"Final",eips:[2565,2929,2718,2930]},london:{name:"london",comment:"HF targeted for July 2021 following the Berlin fork",url:"https://github.com/ethereum/eth1.0-specs/blob/master/network-upgrades/mainnet-upgrades/london.md",status:"Final",eips:[1559,3198,3529,3541]},shanghai:{name:"shanghai",comment:"Next feature hardfork after the merge hardfork having withdrawals, warm coinbase, push0, limit/meter initcode",url:"https://github.com/ethereum/execution-specs/blob/master/network-upgrades/mainnet-upgrades/shanghai.md",status:"Final",eips:[3651,3855,3860,4895]},arrowGlacier:{name:"arrowGlacier",comment:"HF to delay the difficulty bomb",url:"https://github.com/ethereum/execution-specs/blob/master/network-upgrades/mainnet-upgrades/arrow-glacier.md",status:"Final",eips:[4345],gasConfig:{},gasPrices:{},vm:{},pow:{}},grayGlacier:{name:"grayGlacier",comment:"Delaying the difficulty bomb to Mid September 2022",url:"https://github.com/ethereum/execution-specs/blob/master/network-upgrades/mainnet-upgrades/gray-glacier.md",status:"Draft",eips:[5133],gasConfig:{},gasPrices:{},vm:{},pow:{}},mergeForkIdTransition:{name:"mergeForkIdTransition",comment:"Pre-merge hardfork to fork off non-upgraded clients",url:"https://eips.ethereum.org/EIPS/eip-3675",status:"Draft",eips:[]},merge:{name:"merge",comment:"Hardfork to upgrade the consensus mechanism to Proof-of-Stake",url:"https://github.com/ethereum/execution-specs/blob/master/network-upgrades/mainnet-upgrades/merge.md",status:"Final",consensus:{type:"pos",algorithm:"casper",casper:{}},eips:[3675,4399]}},{buf:aG}=tG;class cG extends cz{constructor(e){var t,n;super(),this._eips=[],this._customChains=null!==(t=e.customChains)&&void 0!==t?t:[],this._chainParams=this.setChain(e.chain),this.DEFAULT_HARDFORK=null!==(n=this._chainParams.defaultHardfork)&&void 0!==n?n:Oq.Merge,this.HARDFORK_CHANGES=this.hardforks().map((e=>[e.name,sG[e.name]])),this._hardfork=this.DEFAULT_HARDFORK,void 0!==e.hardfork&&this.setHardfork(e.hardfork),e.eips&&this.setEIPs(e.eips)}static custom(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;const r=null!==(n=t.baseChain)&&void 0!==n?n:"mainnet",i=Object.assign({},cG._getChainParams(r));if(i.name="custom-chain","string"!==typeof e)return new cG(Object.assign({chain:Object.assign(Object.assign({},i),e)},t));if(e===Fq.PolygonMainnet)return cG.custom({name:Fq.PolygonMainnet,chainId:137,networkId:137},t);if(e===Fq.PolygonMumbai)return cG.custom({name:Fq.PolygonMumbai,chainId:80001,networkId:80001},t);if(e===Fq.ArbitrumRinkebyTestnet)return cG.custom({name:Fq.ArbitrumRinkebyTestnet,chainId:421611,networkId:421611},t);if(e===Fq.ArbitrumOne)return cG.custom({name:Fq.ArbitrumOne,chainId:42161,networkId:42161},t);if(e===Fq.xDaiChain)return cG.custom({name:Fq.xDaiChain,chainId:100,networkId:100},t);if(e===Fq.OptimisticKovan)return cG.custom({name:Fq.OptimisticKovan,chainId:69,networkId:69},Object.assign({hardfork:Oq.Berlin},t));if(e===Fq.OptimisticEthereum)return cG.custom({name:Fq.OptimisticEthereum,chainId:10,networkId:10},Object.assign({hardfork:Oq.Berlin},t));throw new Error("Custom chain ".concat(e," not supported"))}static fromGethGenesis(e,t){let{chain:n,eips:r,genesisHash:i,hardfork:o,mergeForkIdPostMerge:s}=t;var a;const c=function(e,t,n){try{if(["config","difficulty","gasLimit","alloc"].some((t=>!(t in e))))throw new Error("Invalid format, expected geth genesis fields missing");return void 0!==t&&(e.name=t),zq(e,n)}catch(BJ){throw new Error("Error parsing parameters file: ".concat(BJ.message))}}(e,n,s),l=new cG({chain:null!==(a=c.name)&&void 0!==a?a:"custom",customChains:[c],eips:r,hardfork:null!==o&&void 0!==o?o:c.hardfork});return void 0!==i&&l.setForkHashes(i),l}static isSupportedChainId(e){const t=this._getInitializedChains();return Boolean(t.names[e.toString()])}static _getChainParams(e,t){let n=e;const r=this._getInitializedChains(t);if("number"===typeof n||"bigint"===typeof n){if(n=n.toString(),r.names[n]){return r[r.names[n]]}throw new Error("Chain with ID ".concat(n," not supported"))}if(void 0!==r[n])return r[n];throw new Error("Chain with name ".concat(n," not supported"))}setChain(e){if("number"===typeof e||"bigint"===typeof e||"string"===typeof e)this._chainParams=cG._getChainParams(e,this._customChains);else{if("object"!==typeof e)throw new Error("Wrong input format");{if(this._customChains.length>0)throw new Error("Chain must be a string, number, or bigint when initialized with customChains passed in");const t=["networkId","genesis","hardforks","bootstrapNodes"];for(const n of t)if(!(n in e))throw new Error("Missing required chain parameter: ".concat(n));this._chainParams=e}}for(const t of this.hardforks())if(void 0===t.block)throw new Error("Hardfork cannot have undefined block number");return this._chainParams}setHardfork(e){let t=!1;for(const n of this.HARDFORK_CHANGES)n[0]===e&&(this._hardfork!==e&&(this._hardfork=e,this.emit("hardforkChanged",e)),t=!0);if(!t)throw new Error("Hardfork with name ".concat(e," not supported"))}getHardforkByBlockNumber(e,t,n){const r=$q(e,Uq.BigInt),i=$q(t,Uq.BigInt),o=$q(n,Uq.Number),s=this.hardforks().filter((e=>null!==e.block||null!==e.ttd&&void 0!==e.ttd||void 0!==e.timestamp)),a=s.findIndex((e=>null!==e.ttd&&void 0!==e.ttd));if(s.slice(a+1).findIndex((e=>null!==e.ttd&&void 0!==e.ttd))>=0)throw Error("More than one merge hardforks found with ttd specified");let c=s.findIndex((e=>null!==e.block&&e.block>r||void 0!==o&&Number(e.timestamp)>o));if(-1===c)c=s.length;else if(0===c)throw Error("Must have at least one hardfork at block 0");if(void 0===o){c-=s.slice(0,c).reverse().findIndex((e=>null!==e.block||void 0!==e.ttd))}if(c-=1,null===s[c].block&&void 0===s[c].timestamp)(void 0===i||null===i||BigInt(s[c].ttd)>i)&&(c-=1);else if(a>=0&&void 0!==i&&null!==i){if(c>=a&&BigInt(s[a].ttd)>i)throw Error("Maximum HF determined by total difficulty is lower than the block number HF");if(c<a&&BigInt(s[a].ttd)<=i)throw Error("HF determined by block number is lower than the minimum total difficulty HF")}const l=c;for(;c<s.length-1&&(s[c].block===s[c+1].block&&s[c].timestamp===s[c+1].timestamp);c+=1);if(o){const e=s.slice(0,l).reduce(((e,t)=>{var n;return Math.max(Number(null!==(n=t.timestamp)&&void 0!==n?n:"0"),e)}),0);if(e>o)throw Error("Maximum HF determined by timestamp is lower than the block number/ttd HF");const t=s.slice(c+1).reduce(((e,t)=>{var n;return Math.min(Number(null!==(n=t.timestamp)&&void 0!==n?n:o),e)}),o);if(t<o)throw Error("Maximum HF determined by block number/ttd is lower than timestamp HF")}return s[c].name}setHardforkByBlockNumber(e,t,n){const r=this.getHardforkByBlockNumber(e,t,n);return this.setHardfork(r),r}_getHardfork(e){const t=this.hardforks();for(const n of t)if(n.name===e)return n;return null}setEIPs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];for(const t of e){if(!(t in oG))throw new Error("".concat(t," not supported"));const n=this.gteHardfork(oG[t].minimumHardfork);if(!n)throw new Error("".concat(t," cannot be activated on hardfork ").concat(this.hardfork(),", minimumHardfork: ").concat(n));if(void 0!==oG[t].requiredEIPs)for(const r of oG[t].requiredEIPs)if(!e.includes(r)&&!this.isActivatedEIP(r))throw new Error("".concat(t," requires EIP ").concat(r,", but is not included in the EIP list"))}this._eips=e}param(e,t){let n;for(const r of this._eips)if(n=this.paramByEIP(e,t,r),void 0!==n)return n;return this.paramByHardfork(e,t,this._hardfork)}paramByHardfork(e,t,n){let r=null;for(const i of this.HARDFORK_CHANGES){if("eips"in i[1]){const n=i[1].eips;for(const i of n){const n=this.paramByEIP(e,t,i);r="bigint"===typeof n?n:r}}else{if(void 0===i[1][e])throw new Error("Topic ".concat(e," not defined"));void 0!==i[1][e][t]&&(r=i[1][e][t].v)}if(i[0]===n)break}return BigInt(null!==r&&void 0!==r?r:0)}paramByEIP(e,t,n){if(!(n in oG))throw new Error("".concat(n," not supported"));const r=oG[n];if(!(e in r))throw new Error("Topic ".concat(e," not defined"));if(void 0===r[e][t])return;const i=r[e][t].v;return BigInt(i)}paramByBlock(e,t,n,r,i){const o=this.getHardforkByBlockNumber(n,r,i);return this.paramByHardfork(e,t,o)}isActivatedEIP(e){if(this.eips().includes(e))return!0;for(const t of this.HARDFORK_CHANGES){const n=t[1];if(this.gteHardfork(n.name)&&"eips"in n&&n.eips.includes(e))return!0}return!1}hardforkIsActiveOnBlock(e,t){const n=$q(t,Uq.BigInt),r=null!==e&&void 0!==e?e:this._hardfork,i=this.hardforkBlock(r);return"bigint"===typeof i&&i!==BigInt(0)&&n>=i}activeOnBlock(e){return this.hardforkIsActiveOnBlock(null,e)}hardforkGteHardfork(e,t){const n=null!==e&&void 0!==e?e:this._hardfork,r=this.hardforks();let i=-1,o=-1,s=0;for(const a of r)a.name===n&&(i=s),a.name===t&&(o=s),s+=1;return i>=o&&-1!==o}gteHardfork(e){return this.hardforkGteHardfork(null,e)}hardforkBlock(e){var t;const n=null!==e&&void 0!==e?e:this._hardfork,r=null===(t=this._getHardfork(n))||void 0===t?void 0:t.block;return void 0===r||null===r?null:BigInt(r)}hardforkTimestamp(e){var t;const n=null!==e&&void 0!==e?e:this._hardfork,r=null===(t=this._getHardfork(n))||void 0===t?void 0:t.timestamp;return void 0===r||null===r?null:BigInt(r)}eipBlock(e){for(const t of this.HARDFORK_CHANGES){const n=t[1];if("eips"in n&&n.eips.includes(e))return this.hardforkBlock("number"===typeof t[0]?String(t[0]):t[0])}return null}hardforkTTD(e){var t;const n=null!==e&&void 0!==e?e:this._hardfork,r=null===(t=this._getHardfork(n))||void 0===t?void 0:t.ttd;return void 0===r||null===r?null:BigInt(r)}isHardforkBlock(e,t){const n=$q(e,Uq.BigInt),r=null!==t&&void 0!==t?t:this._hardfork,i=this.hardforkBlock(r);return"bigint"===typeof i&&i!==BigInt(0)&&i===n}nextHardforkBlockOrTimestamp(e){var t,n;const r=null!==e&&void 0!==e?e:this._hardfork,i=this.hardforks();let o=i.findIndex((e=>e.name===r));if(r===Oq.Merge&&(o-=1),o<0)return null;let s=null!==(t=i[o].timestamp)&&void 0!==t?t:i[o].block;s=null!==s&&void 0!==s?Number(s):null;const a=i.slice(o+1).find((e=>{var t;let n=null!==(t=e.timestamp)&&void 0!==t?t:e.block;return n=null!==n&&void 0!==n?Number(n):null,e.name!==Oq.Merge&&null!==n&&void 0!==n&&n!==s}));if(void 0===a)return null;const c=null!==(n=a.timestamp)&&void 0!==n?n:a.block;return null===c||void 0===c?null:BigInt(c)}nextHardforkBlock(e){const t=null!==e&&void 0!==e?e:this._hardfork;let n=this.hardforkBlock(t);if(null===n&&t===Oq.Merge){const e=this.hardforks(),t=e.findIndex((e=>null!==e.ttd&&void 0!==e.ttd));if(t<0)throw Error("Merge hardfork should have been found");n=this.hardforkBlock(e[t-1].name)}if(null===n)return null;return this.hardforks().reduce(((e,t)=>{const r=BigInt(null===t.block||void 0!==t.ttd&&null!==t.ttd?0:t.block);return r>n&&null===e?r:e}),null)}isNextHardforkBlock(e,t){const n=$q(e,Uq.BigInt),r=null!==t&&void 0!==t?t:this._hardfork,i=this.nextHardforkBlock(r);return null!==i&&i===n}_calcForkHash(e,t){let n=new Uint8Array,r=0;for(const o of this.hardforks()){const{block:t,timestamp:i,name:s}=o;let a=null!==i&&void 0!==i?i:t;if(a=null!==a?Number(a):null,"number"===typeof a&&0!==a&&a!==r&&s!==Oq.Merge){n=TH(n,LH(a.toString(16).padStart(16,"0"))),r=a}if(o.name===e)break}const i=TH(t,n);return OH(function(e){const t=Hq(e);return LH("0x".concat(Vq(t.slice(2))))}(aG(i)>>>0))}forkHash(e,t){const n=null!==e&&void 0!==e?e:this._hardfork,r=this._getHardfork(n);if(null===r||null===(null===r||void 0===r?void 0:r.block)&&void 0===(null===r||void 0===r?void 0:r.timestamp)&&void 0===(null===r||void 0===r?void 0:r.ttd)){throw new Error("No fork hash calculation possible for future hardfork")}if(null!==(null===r||void 0===r?void 0:r.forkHash)&&void 0!==(null===r||void 0===r?void 0:r.forkHash))return r.forkHash;if(!t)throw new Error("genesisHash required for forkHash calculation");return this._calcForkHash(n,t)}hardforkForForkHash(e){const t=this.hardforks().filter((t=>t.forkHash===e));return t.length>=1?t[t.length-1]:null}setForkHashes(e){var t;for(const n of this.hardforks()){const r=null!==(t=n.timestamp)&&void 0!==t?t:n.block;null!==n.forkHash&&void 0!==n.forkHash||(null===r||void 0===r)&&"undefined"===typeof n.ttd||(n.forkHash=this.forkHash(n.name,e))}}genesis(){return this._chainParams.genesis}hardforks(){return this._chainParams.hardforks}bootstrapNodes(){return this._chainParams.bootstrapNodes}dnsNetworks(){return this._chainParams.dnsNetworks}hardfork(){return this._hardfork}chainId(){return BigInt(this._chainParams.chainId)}chainName(){return this._chainParams.name}networkId(){return BigInt(this._chainParams.networkId)}eips(){return this._eips}consensusType(){const e=this.hardfork();let t;for(const n of this.HARDFORK_CHANGES)if("consensus"in n[1]&&(t=n[1].consensus.type),n[0]===e)break;return null!==t&&void 0!==t?t:this._chainParams.consensus.type}consensusAlgorithm(){const e=this.hardfork();let t;for(const n of this.HARDFORK_CHANGES)if("consensus"in n[1]&&(t=n[1].consensus.algorithm),n[0]===e)break;return null!==t&&void 0!==t?t:this._chainParams.consensus.algorithm}consensusConfig(){var e;const t=this.hardfork();let n;for(const r of this.HARDFORK_CHANGES)if("consensus"in r[1]&&(n=r[1].consensus[r[1].consensus.algorithm]),r[0]===t)break;return null!==(e=null!==n&&void 0!==n?n:this._chainParams.consensus[this.consensusAlgorithm()])&&void 0!==e?e:{}}copy(){const e=Object.assign(Object.create(Object.getPrototypeOf(this)),this);return e.removeAllListeners(),e}static _getInitializedChains(e){const t={};for(const[r,i]of Object.entries(Dq))t[i]=r.toLowerCase();const n={mainnet:rG,goerli:nG,sepolia:iG};if(e)for(const r of e){const{name:e}=r;t[r.chainId.toString()]=e,n[e]=r}return n.names=t,n}}var lG;function uG(e){return!function(e){if(0===e.length)return!0;const t=e[0];return!!Array.isArray(t)}(e)}!function(e){e[e.EIP155ReplayProtection=155]="EIP155ReplayProtection",e[e.EIP1559FeeMarket=1559]="EIP1559FeeMarket",e[e.EIP2718TypedTransaction=2718]="EIP2718TypedTransaction",e[e.EIP2930AccessLists=2930]="EIP2930AccessLists"}(lG||(lG={}));class dG{constructor(e){if(20!==e.length)throw new Error("Invalid address length");this.buf=e}static zero(){return new dG(Kq(20))}equals(e){return PH(this.buf,e.buf)}isZero(){return this.equals(dG.zero())}toString(){return OH(this.buf)}toArray(){return this.buf}static publicToAddress(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e;if(Wq(n),t&&64!==n.length&&(n=Cq.ProjectivePoint.fromHex(n).toRawBytes(!1).slice(1)),64!==n.length)throw new Error("Expected pubKey to be of length 64");return sF(n).slice(-20)}}const hG=e=>{let t,n;if(uG(e)){t=e;const r=[];for(let t=0;t<e.length;t+=1){const n=e[t],i=qq(n.address),o=[];for(let e=0;e<n.storageKeys.length;e+=1)o.push(qq(n.storageKeys[e]));r.push([i,o])}n=r}else{n=null!==e&&void 0!==e?e:[];const r=[];for(let e=0;e<n.length;e+=1){const t=n[e],i=OH(t[0]),o=[];for(let e=0;e<t[1].length;e+=1)o.push(OH(t[1][e]));const s={address:i,storageKeys:o};r.push(s)}t=r}return{AccessListJSON:t,accessList:n}},fG=e=>{for(let t=0;t<e.length;t+=1){const n=e[t],r=n[0],i=n[1];if(void 0!==n[2])throw new Error("Access list item cannot have 3 elements. It can only have an address, and an array of storage slots.");if(20!==r.length)throw new Error("Invalid EIP-2930 transaction: address length should be 20 bytes");for(let e=0;e<i.length;e+=1)if(32!==i[e].length)throw new Error("Invalid EIP-2930 transaction: storage slot length should be 32 bytes")}},pG=e=>{const t=[];for(let n=0;n<e.length;n+=1){const r=e[n],i={address:OH(Qq(r[0],20)),storageKeys:[]},o=r&&r[1];for(let e=0;e<o.length;e+=1){const t=o[e];i.storageKeys.push(OH(Qq(t,32)))}t.push(i)}return t},gG=(e,t)=>{const n=t.param("gasPrices","accessListStorageKeyCost"),r=t.param("gasPrices","accessListAddressCost");let i=0;for(let o=0;o<e.length;o+=1){i+=e[o][1].length}return e.length*Number(r)+i*Number(n)};class mG{constructor(e,t){var n,r;this.cache={hash:void 0,dataFee:void 0},this.activeCapabilities=[],this.DEFAULT_CHAIN=Dq.Mainnet,this.DEFAULT_HARDFORK=Oq.Merge;const{nonce:i,gasLimit:o,to:s,value:a,data:c,v:l,r:u,s:d,type:h}=e;this._type=Number(Gq(qq(h))),this.txOptions=t;const f=qq(""===s?"0x":s),p=qq(""===l?"0x":l),g=qq(""===u?"0x":u),m=qq(""===d?"0x":d);this.nonce=Gq(qq(""===i?"0x":i)),this.gasLimit=Gq(qq(""===o?"0x":o)),this.to=f.length>0?new dG(f):void 0,this.value=Gq(qq(""===a?"0x":a)),this.data=qq(""===c?"0x":c),this.v=p.length>0?Gq(p):void 0,this.r=g.length>0?Gq(g):void 0,this.s=m.length>0?Gq(m):void 0,this._validateCannotExceedMaxInteger({value:this.value,r:this.r,s:this.s}),this._validateCannotExceedMaxInteger({gasLimit:this.gasLimit},64),this._validateCannotExceedMaxInteger({nonce:this.nonce},64,!0);const v=void 0===this.to||null===this.to,y=null!==(n=t.allowUnlimitedInitCodeSize)&&void 0!==n&&n,w=null!==(r=t.common)&&void 0!==r?r:this._getCommon();v&&w.isActivatedEIP(3860)&&!y&&((e,t)=>{const n=e.param("vm","maxInitCodeSize");if(n&&BigInt(t)>n)throw new Error("the initcode size of this transaction is too large: it is ".concat(t," while the max is ").concat(e.param("vm","maxInitCodeSize")))})(w,this.data.length)}get type(){return this._type}supports(e){return this.activeCapabilities.includes(e)}validate(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=[];return this.getBaseFee()>this.gasLimit&&t.push("gasLimit is too low. given ".concat(this.gasLimit,", need at least ").concat(this.getBaseFee())),this.isSigned()&&!this.verifySignature()&&t.push("Invalid Signature"),e?t:0===t.length}_validateYParity(){const{v:e}=this;if(void 0!==e&&e!==BigInt(0)&&e!==BigInt(1)){const e=this._errorMsg("The y-parity of the transaction should either be 0 or 1");throw new Error(e)}}_validateHighS(){const{s:e}=this;if(this.common.gteHardfork("homestead")&&void 0!==e&&e>Nq){const e=this._errorMsg("Invalid Signature: s-values greater than secp256k1n/2 are considered invalid");throw new Error(e)}}getBaseFee(){const e=this.common.param("gasPrices","tx");let t=this.getDataFee();if(e&&(t+=e),this.common.gteHardfork("homestead")&&this.toCreationAddress()){const e=this.common.param("gasPrices","txCreation");e&&(t+=e)}return t}getDataFee(){const e=this.common.param("gasPrices","txDataZero"),t=this.common.param("gasPrices","txDataNonZero");let n=BigInt(0);for(let r=0;r<this.data.length;r+=1)0===this.data[r]?n+=e:n+=t;if((void 0===this.to||null===this.to)&&this.common.isActivatedEIP(3860)){const e=BigInt(Math.ceil(this.data.length/32));n+=this.common.param("gasPrices","initCodeWordCost")*e}return n}toCreationAddress(){return void 0===this.to||0===this.to.buf.length}isSigned(){const{v:e,r:t,s:n}=this;return void 0!==e&&void 0!==t&&void 0!==n}verifySignature(){try{const e=this.getSenderPublicKey();return 0!==Yq(e).length}catch(BJ){return!1}}getSenderAddress(){return new dG(dG.publicToAddress(this.getSenderPublicKey()))}sign(e){if(32!==e.length){const e=this._errorMsg("Private key must be 32 bytes in length.");throw new Error(e)}let t=!1;0===this.type&&this.common.gteHardfork("spuriousDragon")&&!this.supports(lG.EIP155ReplayProtection)&&(this.activeCapabilities.push(lG.EIP155ReplayProtection),t=!0);const n=this.getMessageToSign(!0),{v:r,r:i,s:o}=this._ecsign(n,e),s=this._processSignature(r,i,o);if(t){const e=this.activeCapabilities.indexOf(lG.EIP155ReplayProtection);e>-1&&this.activeCapabilities.splice(e,1)}return s}_getCommon(e,t){var n,r,i,o;if(void 0!==t){const n=Gq(qq(t));if(e){if(e.chainId()!==n){const e=this._errorMsg("The chain ID does not match the chain ID of Common");throw new Error(e)}return e.copy()}return cG.isSupportedChainId(n)?new cG({chain:n,hardfork:this.DEFAULT_HARDFORK}):cG.custom({name:"custom-chain",networkId:n,chainId:n},{baseChain:this.DEFAULT_CHAIN,hardfork:this.DEFAULT_HARDFORK})}if((null===e||void 0===e?void 0:e.copy)&&"function"===typeof(null===e||void 0===e?void 0:e.copy))return e.copy();if(e){const t="function"===typeof e.hardfork?e.hardfork():e.hardfork;return cG.custom({name:"custom-chain",networkId:e.networkId?e.networkId():null!==(r=BigInt(null===(n=e.customChain)||void 0===n?void 0:n.networkId))&&void 0!==r?r:void 0,chainId:e.chainId?e.chainId():null!==(o=BigInt(null===(i=e.customChain)||void 0===i?void 0:i.chainId))&&void 0!==o?o:void 0},{baseChain:this.DEFAULT_CHAIN,hardfork:t||this.DEFAULT_HARDFORK})}return new cG({chain:this.DEFAULT_CHAIN,hardfork:this.DEFAULT_HARDFORK})}_validateCannotExceedMaxInteger(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:256,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];for(const[r,i]of Object.entries(e))switch(t){case 64:if(n){if(void 0!==i&&i>=Tq){const e=this._errorMsg("".concat(r," cannot equal or exceed MAX_UINT64 (2^64-1), given ").concat(i));throw new Error(e)}}else if(void 0!==i&&i>Tq){const e=this._errorMsg("".concat(r," cannot exceed MAX_UINT64 (2^64-1), given ").concat(i));throw new Error(e)}break;case 256:if(n){if(void 0!==i&&i>=Pq){const e=this._errorMsg("".concat(r," cannot equal or exceed MAX_INTEGER (2^256-1), given ").concat(i));throw new Error(e)}}else if(void 0!==i&&i>Pq){const e=this._errorMsg("".concat(r," cannot exceed MAX_INTEGER (2^256-1), given ").concat(i));throw new Error(e)}break;default:{const e=this._errorMsg("unimplemented bits value");throw new Error(e)}}}static _validateNotArray(e){const t=["nonce","gasPrice","gasLimit","to","value","data","v","r","s","type","baseFee","maxFeePerGas","chainId"];for(const[n,r]of Object.entries(e))if(t.includes(n)&&Array.isArray(r))throw new Error("".concat(n," cannot be an array"))}_getSharedErrorPostfix(){let e="";try{e=this.isSigned()?OH(this.hash()):"not available (unsigned)"}catch(BJ){e="error"}let t="";try{t=this.isSigned().toString()}catch(BJ){e="error"}let n="";try{n=this.common.hardfork()}catch(BJ){n="error"}let r="tx type=".concat(this.type," hash=").concat(e," nonce=").concat(this.nonce," value=").concat(this.value," ");return r+="signed=".concat(t," hf=").concat(n),r}_ecsign(e,t,n){const r=Cq.sign(e,t),i=r.toCompactRawBytes();return{r:i.subarray(0,32),s:i.subarray(32,64),v:void 0===n?BigInt(r.recovery+27):BigInt(r.recovery+35)+BigInt(n)*BigInt(2)}}static fromSerializedTx(e){}static fromTxData(e){}}const vG=LH(2..toString(16).padStart(2,"0"));class yG extends mG{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;super(Object.assign(Object.assign({},e),{type:2}),t),this.DEFAULT_HARDFORK="london";const{chainId:r,accessList:i,maxFeePerGas:o,maxPriorityFeePerGas:s}=e;if(this.common=this._getCommon(t.common,r),this.chainId=this.common.chainId(),!this.common.isActivatedEIP(1559))throw new Error("EIP-1559 not enabled on Common");this.activeCapabilities=this.activeCapabilities.concat([1559,2718,2930]);const a=hG(null!==i&&void 0!==i?i:[]);if(this.accessList=a.accessList,this.AccessListJSON=a.AccessListJSON,fG(this.accessList),this.maxFeePerGas=Gq(qq(""===o?"0x":o)),this.maxPriorityFeePerGas=Gq(qq(""===s?"0x":s)),this._validateCannotExceedMaxInteger({maxFeePerGas:this.maxFeePerGas,maxPriorityFeePerGas:this.maxPriorityFeePerGas}),mG._validateNotArray(e),this.gasLimit*this.maxFeePerGas>Pq){const e=this._errorMsg("gasLimit * maxFeePerGas cannot exceed MAX_INTEGER (2^256-1)");throw new Error(e)}if(this.maxFeePerGas<this.maxPriorityFeePerGas){const e=this._errorMsg("maxFeePerGas cannot be less than maxPriorityFeePerGas (The total must be the larger of the two)");throw new Error(e)}this._validateYParity(),this._validateHighS();(null===(n=null===t||void 0===t?void 0:t.freeze)||void 0===n||n)&&Object.freeze(this)}static fromTxData(e){return new yG(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}static fromSerializedTx(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!PH(e.subarray(0,1),vG))throw new Error("Invalid serialized tx input: not an EIP-1559 transaction (wrong tx type, expected: ".concat(2,", received: ").concat(OH(e.subarray(0,1))));const n=eG.Tj.decode(e.subarray(1));if(!Array.isArray(n))throw new Error("Invalid serialized tx input: must be array");return yG.fromValuesArray(n,t)}static fromValuesArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(9!==e.length&&12!==e.length)throw new Error("Invalid EIP-1559 transaction. Only expecting 9 values (for unsigned tx) or 12 values (for signed tx).");const[n,r,i,o,s,a,c,l,u,d,h,f]=e;return this._validateNotArray({chainId:n,v:d}),Dj({nonce:r,maxPriorityFeePerGas:i,maxFeePerGas:o,gasLimit:s,value:c,v:d,r:h,s:f}),new yG({chainId:Gq(n),nonce:r,maxPriorityFeePerGas:i,maxFeePerGas:o,gasLimit:s,to:a,value:c,data:l,accessList:null!==u&&void 0!==u?u:[],v:void 0!==d?Gq(d):void 0,r:h,s:f},t)}getDataFee(){if(this.cache.dataFee&&this.cache.dataFee.hardfork===this.common.hardfork())return this.cache.dataFee.value;let e=super.getDataFee();return e+=BigInt(gG(this.accessList,this.common)),Object.isFrozen(this)&&(this.cache.dataFee={value:e,hardfork:this.common.hardfork()}),e}getUpfrontCost(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:BigInt(0);const t=this.maxPriorityFeePerGas,n=this.maxFeePerGas-e,r=(t<n?t:n)+e;return this.gasLimit*r+this.value}raw(){return[Jq(this.chainId),Jq(this.nonce),Jq(this.maxPriorityFeePerGas),Jq(this.maxFeePerGas),Jq(this.gasLimit),void 0!==this.to?this.to.buf:Uint8Array.from([]),Jq(this.value),this.data,this.accessList,void 0!==this.v?Jq(this.v):Uint8Array.from([]),void 0!==this.r?Jq(this.r):Uint8Array.from([]),void 0!==this.s?Jq(this.s):Uint8Array.from([])]}serialize(){const e=this.raw();return TH(vG,eG.Tj.encode(e))}getMessageToSign(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=this.raw().slice(0,9),n=TH(vG,eG.Tj.encode(t));return e?sF(n):n}hash(){if(!this.isSigned()){const e=this._errorMsg("Cannot call hash method if transaction is not signed");throw new Error(e)}return Object.isFrozen(this)?(this.cache.hash||(this.cache.hash=sF(this.serialize())),this.cache.hash):sF(this.serialize())}getMessageToVerifySignature(){return this.getMessageToSign()}getSenderPublicKey(){if(!this.isSigned()){const e=this._errorMsg("Cannot call this method if transaction is not signed");throw new Error(e)}const e=this.getMessageToVerifySignature(),{v:t,r:n,s:r}=this;this._validateHighS();try{return Xq(e,t+BigInt(27),Jq(n),Jq(r))}catch(BJ){const t=this._errorMsg("Invalid Signature");throw new Error(t)}}_processSignature(e,t,n){const r=Object.assign(Object.assign({},this.txOptions),{common:this.common});return yG.fromTxData({chainId:this.chainId,nonce:this.nonce,maxPriorityFeePerGas:this.maxPriorityFeePerGas,maxFeePerGas:this.maxFeePerGas,gasLimit:this.gasLimit,to:this.to,value:this.value,data:this.data,accessList:this.accessList,v:e-BigInt(27),r:Gq(t),s:Gq(n)},r)}toJSON(){const e=pG(this.accessList);return{chainId:Zq(this.chainId),nonce:Zq(this.nonce),maxPriorityFeePerGas:Zq(this.maxPriorityFeePerGas),maxFeePerGas:Zq(this.maxFeePerGas),gasLimit:Zq(this.gasLimit),to:void 0!==this.to?this.to.toString():void 0,value:Zq(this.value),data:OH(this.data),accessList:e,v:void 0!==this.v?Zq(this.v):void 0,r:void 0!==this.r?Zq(this.r):void 0,s:void 0!==this.s?Zq(this.s):void 0}}errorStr(){let e=this._getSharedErrorPostfix();return e+=" maxFeePerGas=".concat(this.maxFeePerGas," maxPriorityFeePerGas=").concat(this.maxPriorityFeePerGas),e}_errorMsg(e){return"".concat(e," (").concat(this.errorStr(),")")}}const wG=LH(1..toString(16).padStart(2,"0"));class bG extends mG{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;super(Object.assign(Object.assign({},e),{type:1}),t),this.DEFAULT_HARDFORK="berlin";const{chainId:r,accessList:i,gasPrice:o}=e;if(this.common=this._getCommon(t.common,r),this.chainId=this.common.chainId(),!this.common.isActivatedEIP(2930))throw new Error("EIP-2930 not enabled on Common");this.activeCapabilities=this.activeCapabilities.concat([2718,2930]);const s=hG(null!==i&&void 0!==i?i:[]);if(this.accessList=s.accessList,this.AccessListJSON=s.AccessListJSON,fG(this.accessList),this.gasPrice=Gq(qq(""===o?"0x":o)),this._validateCannotExceedMaxInteger({gasPrice:this.gasPrice}),mG._validateNotArray(e),this.gasPrice*this.gasLimit>Pq){const e=this._errorMsg("gasLimit * gasPrice cannot exceed MAX_INTEGER");throw new Error(e)}this._validateYParity(),this._validateHighS();(null===(n=null===t||void 0===t?void 0:t.freeze)||void 0===n||n)&&Object.freeze(this)}static fromTxData(e){return new bG(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}static fromSerializedTx(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!PH(e.subarray(0,1),wG))throw new Error("Invalid serialized tx input: not an EIP-2930 transaction (wrong tx type, expected: ".concat(1,", received: ").concat(OH(e.subarray(0,1))));const n=eG.Tj.decode(Uint8Array.from(e.subarray(1)));if(!Array.isArray(n))throw new Error("Invalid serialized tx input: must be array");return bG.fromValuesArray(n,t)}static fromValuesArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(8!==e.length&&11!==e.length)throw new Error("Invalid EIP-2930 transaction. Only expecting 8 values (for unsigned tx) or 11 values (for signed tx).");const[n,r,i,o,s,a,c,l,u,d,h]=e;this._validateNotArray({chainId:n,v:u}),Dj({nonce:r,gasPrice:i,gasLimit:o,value:a,v:u,r:d,s:h});return new bG({chainId:Gq(n),nonce:r,gasPrice:i,gasLimit:o,to:s,value:a,data:c,accessList:null!==l&&void 0!==l?l:[],v:void 0!==u?Gq(u):void 0,r:d,s:h},t)}getDataFee(){if(this.cache.dataFee&&this.cache.dataFee.hardfork===this.common.hardfork())return this.cache.dataFee.value;let e=super.getDataFee();return e+=BigInt(gG(this.accessList,this.common)),Object.isFrozen(this)&&(this.cache.dataFee={value:e,hardfork:this.common.hardfork()}),e}getUpfrontCost(){return this.gasLimit*this.gasPrice+this.value}raw(){return[Jq(this.chainId),Jq(this.nonce),Jq(this.gasPrice),Jq(this.gasLimit),void 0!==this.to?this.to.buf:Uint8Array.from([]),Jq(this.value),this.data,this.accessList,void 0!==this.v?Jq(this.v):Uint8Array.from([]),void 0!==this.r?Jq(this.r):Uint8Array.from([]),void 0!==this.s?Jq(this.s):Uint8Array.from([])]}serialize(){const e=this.raw();return TH(wG,eG.Tj.encode(e))}getMessageToSign(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=this.raw().slice(0,8),n=TH(wG,eG.Tj.encode(t));return e?sF(n):n}hash(){if(!this.isSigned()){const e=this._errorMsg("Cannot call hash method if transaction is not signed");throw new Error(e)}return Object.isFrozen(this)?(this.cache.hash||(this.cache.hash=sF(this.serialize())),this.cache.hash):sF(this.serialize())}getMessageToVerifySignature(){return this.getMessageToSign()}getSenderPublicKey(){if(!this.isSigned()){const e=this._errorMsg("Cannot call this method if transaction is not signed");throw new Error(e)}const e=this.getMessageToVerifySignature(),{v:t,r:n,s:r}=this;this._validateHighS();try{return Xq(e,t+BigInt(27),Jq(n),Jq(r))}catch(BJ){const t=this._errorMsg("Invalid Signature");throw new Error(t)}}_processSignature(e,t,n){const r=Object.assign(Object.assign({},this.txOptions),{common:this.common});return bG.fromTxData({chainId:this.chainId,nonce:this.nonce,gasPrice:this.gasPrice,gasLimit:this.gasLimit,to:this.to,value:this.value,data:this.data,accessList:this.accessList,v:e-BigInt(27),r:Gq(t),s:Gq(n)},r)}toJSON(){const e=pG(this.accessList);return{chainId:Zq(this.chainId),nonce:Zq(this.nonce),gasPrice:Zq(this.gasPrice),gasLimit:Zq(this.gasLimit),to:void 0!==this.to?this.to.toString():void 0,value:Zq(this.value),data:OH(this.data),accessList:e,v:void 0!==this.v?Zq(this.v):void 0,r:void 0!==this.r?Zq(this.r):void 0,s:void 0!==this.s?Zq(this.s):void 0}}errorStr(){var e,t;let n=this._getSharedErrorPostfix();return n+=" gasPrice=".concat(this.gasPrice," accessListCount=").concat(null!==(t=null===(e=this.accessList)||void 0===e?void 0:e.length)&&void 0!==t?t:0),n}_errorMsg(e){return"".concat(e," (").concat(this.errorStr(),")")}}function EG(e,t){const n=Number(e),r=2*Number(t);return n===r+35||n===r+36}class kG extends mG{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;if(super(Object.assign(Object.assign({},e),{type:0}),t),this.common=this._validateTxV(this.v,t.common),this.gasPrice=Gq(qq(""===e.gasPrice?"0x":e.gasPrice)),this.gasPrice*this.gasLimit>Pq){const e=this._errorMsg("gas limit * gasPrice cannot exceed MAX_INTEGER (2^256-1)");throw new Error(e)}this._validateCannotExceedMaxInteger({gasPrice:this.gasPrice}),mG._validateNotArray(e),this.common.gteHardfork("spuriousDragon")&&(this.isSigned()?EG(this.v,this.common.chainId())&&this.activeCapabilities.push(lG.EIP155ReplayProtection):this.activeCapabilities.push(lG.EIP155ReplayProtection));(null===(n=null===t||void 0===t?void 0:t.freeze)||void 0===n||n)&&Object.freeze(this)}static fromTxData(e){return new kG(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}static fromSerializedTx(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=eG.Tj.decode(e);if(!Array.isArray(n))throw new Error("Invalid serialized tx input. Must be array");return this.fromValuesArray(n,t)}static fromValuesArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(6!==e.length&&9!==e.length)throw new Error("Invalid transaction. Only expecting 6 values (for unsigned tx) or 9 values (for signed tx).");const[n,r,i,o,s,a,c,l,u]=e;return Dj({nonce:n,gasPrice:r,gasLimit:i,value:s,v:c,r:l,s:u}),new kG({nonce:n,gasPrice:r,gasLimit:i,to:o,value:s,data:a,v:c,r:l,s:u},t)}raw(){return[Jq(this.nonce),Jq(this.gasPrice),Jq(this.gasLimit),void 0!==this.to?this.to.buf:Uint8Array.from([]),Jq(this.value),this.data,void 0!==this.v?Jq(this.v):Uint8Array.from([]),void 0!==this.r?Jq(this.r):Uint8Array.from([]),void 0!==this.s?Jq(this.s):Uint8Array.from([])]}serialize(){return eG.Tj.encode(this.raw())}_getMessageToSign(){const e=[Jq(this.nonce),Jq(this.gasPrice),Jq(this.gasLimit),void 0!==this.to?this.to.buf:Uint8Array.from([]),Jq(this.value),this.data];return this.supports(lG.EIP155ReplayProtection)&&(e.push(qq(this.common.chainId())),e.push(Yq(qq(0))),e.push(Yq(qq(0)))),e}getMessageToSign(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=this._getMessageToSign();return e?sF(eG.Tj.encode(t)):t}getDataFee(){return this.cache.dataFee&&this.cache.dataFee.hardfork===this.common.hardfork()?this.cache.dataFee.value:(Object.isFrozen(this)&&(this.cache.dataFee={value:super.getDataFee(),hardfork:this.common.hardfork()}),super.getDataFee())}getUpfrontCost(){return this.gasLimit*this.gasPrice+this.value}hash(){if(!this.isSigned()){const e=this._errorMsg("Cannot call hash method if transaction is not signed");throw new Error(e)}return Object.isFrozen(this)?(this.cache.hash||(this.cache.hash=sF(eG.Tj.encode(this.raw()))),this.cache.hash):sF(eG.Tj.encode(this.raw()))}getMessageToVerifySignature(){if(!this.isSigned()){const e=this._errorMsg("This transaction is not signed");throw new Error(e)}const e=this._getMessageToSign();return sF(eG.Tj.encode(e))}getSenderPublicKey(){const e=this.getMessageToVerifySignature(),{v:t,r:n,s:r}=this;this._validateHighS();try{return Xq(e,t,Jq(n),Jq(r),this.supports(lG.EIP155ReplayProtection)?this.common.chainId():void 0)}catch(BJ){const t=this._errorMsg("Invalid Signature");throw new Error(t)}}_processSignature(e,t,n){let r=e;this.supports(lG.EIP155ReplayProtection)&&(r+=this.common.chainId()*BigInt(2)+BigInt(8));const i=Object.assign(Object.assign({},this.txOptions),{common:this.common});return kG.fromTxData({nonce:this.nonce,gasPrice:this.gasPrice,gasLimit:this.gasLimit,to:this.to,value:this.value,data:this.data,v:r,r:Gq(t),s:Gq(n)},i)}toJSON(){return{nonce:Zq(this.nonce),gasPrice:Zq(this.gasPrice),gasLimit:Zq(this.gasLimit),to:void 0!==this.to?this.to.toString():void 0,value:Zq(this.value),data:OH(this.data),v:void 0!==this.v?Zq(this.v):void 0,r:void 0!==this.r?Zq(this.r):void 0,s:void 0!==this.s?Zq(this.s):void 0}}_validateTxV(e,t){let n;const r=void 0!==e?Number(e):void 0;if(void 0!==r&&r<37&&27!==r&&28!==r)throw new Error("Legacy txs need either v = 27/28 or v >= 37 (EIP-155 replay protection), got v = ".concat(r));if(void 0!==r&&0!==r&&(!t||t.gteHardfork("spuriousDragon"))&&27!==r&&28!==r)if(t){if(!EG(BigInt(r),t.chainId()))throw new Error("Incompatible EIP155-based V ".concat(r," and chain id ").concat(t.chainId(),". See the Common parameter of the Transaction constructor to set the chain id."))}else{let e;e=(r-35)%2===0?35:36,n=BigInt(r-e)/BigInt(2)}return this._getCommon(t,n)}errorStr(){let e=this._getSharedErrorPostfix();return e+=" gasPrice=".concat(this.gasPrice),e}_errorMsg(e){return"".concat(e," (").concat(this.errorStr(),")")}}const AG=new Map;class SG{constructor(){}static typeToInt(e){return Number(Gq(qq(e)))}static registerTransactionType(e,t){const n=SG.typeToInt(e);AG.set(n,t)}static fromTxData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!("type"in e)||void 0===e.type)return kG.fromTxData(e,t);const n=SG.typeToInt(e.type);if(0===n)return kG.fromTxData(e,t);if(1===n)return bG.fromTxData(e,t);if(2===n)return yG.fromTxData(e,t);const r=AG.get(n);if(null===r||void 0===r?void 0:r.fromTxData)return r.fromTxData(e,t);throw new Error("Tx instantiation with type ".concat(n," not supported"))}static fromSerializedData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(e[0]<=127))return kG.fromSerializedTx(e,t);switch(e[0]){case 1:return bG.fromSerializedTx(e,t);case 2:return yG.fromSerializedTx(e,t);default:{const n=AG.get(Number(e[0]));if(null===n||void 0===n?void 0:n.fromSerializedTx)return n.fromSerializedTx(e,t);throw new Error("TypedTransaction with ID ".concat(e[0]," unknown"))}}}static fromBlockBodyData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(CH(e))return this.fromSerializedData(e,t);if(Array.isArray(e))return kG.fromValuesArray(e,t);throw new Error("Cannot decode transaction: unknown type input")}}var xG=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(BJ){o(BJ)}}function a(e){try{c(r.throw(e))}catch(BJ){o(BJ)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};const _G=(e,t)=>{let n;if(!t&&"string"===typeof e&&Tj(e)&&66!==e.length)throw new XO;try{n=CH(e)?e:BH(e)}catch(dk){throw new $O}if(!t&&32!==n.byteLength)throw new XO;return n},IG=e=>{const t=Tj(e)?e:zH(e),n=LH(t),r=TH(LH(VH("\x19Ethereum Signed Message:\n".concat(n.byteLength))),n);return Fz(r)},RG=(e,t)=>{const n=_G(t),r=IG(e),i=Cq.sign(r.substring(2),n),o=i.toCompactRawBytes(),s=i.r.toString(16).padStart(64,"0"),a=i.s.toString(16).padStart(64,"0"),c=i.recovery+27;return{message:e,messageHash:r,v:UH(c),r:"0x".concat(s),s:"0x".concat(a),signature:"".concat(OH(o)).concat(c.toString(16))}},CG=e=>{if(EH(e))throw new OL;const t=SG.fromSerializedData(LH(e));return iz(t.getSenderAddress().toString())},TG=(e,t,n,r,i)=>{if("object"===typeof e){const t="".concat(e.r).concat(e.s.slice(2)).concat(e.v.slice(2));return TG(e.messageHash,t,n)}if("string"===typeof t&&"string"===typeof n&&!EH(r)){const o="".concat(n).concat(r.slice(2)).concat(t.slice(2));return TG(e,o,i)}if(EH(t))throw new eL("signature string undefined");const o=n?e:IG(e);let s=parseInt(t.substring(130),16);s>26&&(s-=27);const a=Cq.Signature.fromCompact(t.slice(2,130)).addRecoveryBit(s).recoverPublicKey(o.replace("0x","")).toRawBytes(!1),c=Fz(a.subarray(1));return iz("0x".concat(c.slice(-40)))},PG=e=>{const t=_G(e),n=Cq.getPublicKey(t,!1),r=Fz(n.slice(1)).slice(-40);return iz("0x".concat(r))},NG=(e,t)=>{const n=_G(e);return"0x".concat(OH(Cq.getPublicKey(n,t)).slice(4))},BG=(e,t,n)=>xG(void 0,void 0,void 0,(function*(){var r,i,o,s,a,c,l;const u=_G(e);let d;if(d=(null===n||void 0===n?void 0:n.salt)?"string"===typeof n.salt?LH(n.salt):n.salt:Qz(32),!Cj(t)&&!CH(t))throw new iL;const h="string"===typeof t?LH(zH(t)):t;let f;if(null===n||void 0===n?void 0:n.iv){if(f="string"===typeof n.iv?LH(n.iv):n.iv,16!==f.length)throw new oL}else f=Qz(16);const p=null!==(r=null===n||void 0===n?void 0:n.kdf)&&void 0!==r?r:"scrypt";let g,m;if("pbkdf2"===p){if(m={dklen:null!==(i=null===n||void 0===n?void 0:n.dklen)&&void 0!==i?i:32,salt:OH(d).replace("0x",""),c:null!==(o=null===n||void 0===n?void 0:n.c)&&void 0!==o?o:262144,prf:"hmac-sha256"},m.c<1e3)throw new sL;g=iq(h,d,m.c,m.dklen,"sha256")}else{if("scrypt"!==p)throw new tL;m={n:null!==(s=null===n||void 0===n?void 0:n.n)&&void 0!==s?s:8192,r:null!==(a=null===n||void 0===n?void 0:n.r)&&void 0!==a?a:8,p:null!==(c=null===n||void 0===n?void 0:n.p)&&void 0!==c?c:1,dklen:null!==(l=null===n||void 0===n?void 0:n.dklen)&&void 0!==l?l:32,salt:OH(d).replace("0x","")},g=uq(h,d,m.n,m.p,m.r,m.dklen)}const v=yield $V(u,g.slice(0,16),f,"aes-128-ctr"),y=OH(v).slice(2),w=Fz(TH(g.slice(16,32),v)).replace("0x","");return{version:3,id:rV(),address:PG(u).toLowerCase().replace("0x",""),crypto:{ciphertext:y,cipherparams:{iv:OH(f).replace("0x","")},cipher:"aes-128-ctr",kdf:p,kdfparams:m,mac:w}}})),DG=(e,t)=>{const n=_G(e,t);return{address:PG(n),privateKey:OH(n),signTransaction:e=>{throw new hM("Do not have network access to sign the transaction")},sign:e=>RG("string"===typeof e?e:JSON.stringify(e),n),encrypt:(e,t)=>xG(void 0,void 0,void 0,(function*(){return BG(n,e,t)}))}};var OG=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(BJ){o(BJ)}}function a(e){try{c(r.throw(e))}catch(BJ){o(BJ)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};class LG{constructor(e){this._requestManager=e,this._requests=new Map}get requests(){return[...this._requests.values()].map((e=>e.payload))}add(e){const t=pV(e),n=new wV;return this._requests.set(t.id,{payload:t,promise:n}),n}execute(e){var t;return OG(this,void 0,void 0,(function*(){if(0===this.requests.length)return Promise.resolve([]);const n=new wV({timeout:null!==(t=null===e||void 0===e?void 0:e.timeout)&&void 0!==t?t:1e3,eagerStart:!0,timeoutMessage:"Batch request timeout"});return this._processBatchRequest(n).catch((e=>n.reject(e))),n.catch((e=>{e instanceof kL&&this._abortAllRequests("Batch request timeout"),n.reject(e)})),n}))}_processBatchRequest(e){var t,n;return OG(this,void 0,void 0,(function*(){const r=yield this._requestManager.sendBatch([...this._requests.values()].map((e=>e.payload)));if(r.length!==this._requests.size)throw this._abortAllRequests("Invalid batch response"),new RM(r,"Batch request size mismatch the results size. Requests: ".concat(this._requests.size,", Responses: ").concat(r.length));const i=this.requests.map((e=>e.id)).map(Number).sort(((e,t)=>e-t)),o=r.map((e=>e.id)).map(Number).sort(((e,t)=>e-t));if(JSON.stringify(i)!==JSON.stringify(o))throw this._abortAllRequests("Invalid batch response"),new RM(r,"Batch request mismatch the results. Requests: [".concat(i.join(),"], Responses: [").concat(o.join(),"]"));for(const e of r)oV(e)?null===(t=this._requests.get(e.id))||void 0===t||t.promise.resolve(e.result):sV(e)&&(null===(n=this._requests.get(e.id))||void 0===n||n.promise.reject(e.error));e.resolve(r)}))}_abortAllRequests(e){for(const{promise:t}of this._requests.values())t.reject(new AL(e))}}var MG=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(BJ){o(BJ)}}function a(e){try{c(r.throw(e))}catch(BJ){o(BJ)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};class FG extends RV{constructor(e){var t;if(super(),this.providers=VV.providers,Ez(e)||"string"===typeof e&&""!==e.trim()||UV(e))return this._requestManager=new VV(e),void(this._subscriptionManager=new GV(this._requestManager,{}));const{config:n,provider:r,requestManager:i,subscriptionManager:o,registeredSubscriptions:s,accountProvider:a,wallet:c}=e;this.setConfig(null!==n&&void 0!==n?n:{}),this._requestManager=null!==i&&void 0!==i?i:new VV(r,null===(t=null===n||void 0===n?void 0:n.enableExperimentalFeatures)||void 0===t?void 0:t.useSubscriptionWhenCheckingBlockTimeout),this._subscriptionManager=o||new GV(this.requestManager,null!==s&&void 0!==s?s:{}),a&&(this._accountProvider=a),c&&(this._wallet=c)}get requestManager(){return this._requestManager}get subscriptionManager(){return this._subscriptionManager}get wallet(){return this._wallet}get accountProvider(){return this._accountProvider}static fromContextObject(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new this(...t.reverse())}getContextObject(){var e;return{config:this.config,provider:this.provider,requestManager:this.requestManager,subscriptionManager:this.subscriptionManager,registeredSubscriptions:null===(e=this.subscriptionManager)||void 0===e?void 0:e.registeredSubscriptions,providers:this.providers,wallet:this.wallet,accountProvider:this.accountProvider}}use(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=new e(...[...n,this.getContextObject()]);return this.on(IV.CONFIG_CHANGE,(e=>{i.setConfig({[e.name]:e.newValue})})),i}link(e){this.setConfig(e.config),this._requestManager=e.requestManager,this.provider=e.provider,this._subscriptionManager=e.subscriptionManager,this._wallet=e.wallet,this._accountProvider=e._accountProvider,e.on(IV.CONFIG_CHANGE,(e=>{this.setConfig({[e.name]:e.newValue})}))}registerPlugin(e){if(void 0!==this[e.pluginNamespace])throw new xL(e.pluginNamespace);const t={[e.pluginNamespace]:e};t[e.pluginNamespace].link(this),Object.assign(this,t)}get provider(){return this.currentProvider}set provider(e){this.requestManager.setProvider(e)}get currentProvider(){return this.requestManager.provider}set currentProvider(e){this.requestManager.setProvider(e)}get givenProvider(){return FG.givenProvider}setProvider(e){return this.provider=e,!0}get BatchRequest(){return LG.bind(void 0,this._requestManager)}extend(e){var t,n=this;return e.property&&!this[e.property]&&(this[e.property]={}),null===(t=e.methods)||void 0===t||t.forEach((t=>{const r=function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return MG(n,void 0,void 0,(function*(){return this.requestManager.send({method:t.call,params:r})}))};e.property?this[e.property][t.name]=r:this[t.name]=r})),this}}FG.providers=VV.providers;class UG{constructor(e){if(this.toAddress=()=>{if(this.isDirect()){const e=this._iban.slice(4),t=UG._parseInt(e,36),n=Iz(t,40);return iz(n)}throw new Error("Iban is indirect and cannot be converted. Must be length of 34 or 35")},!UG.isIndirect(e)&&!UG.isDirect(e))throw new Error("Invalid IBAN was provided");this._iban=e}static isDirect(e){return 34===e.length||35===e.length}isDirect(){return UG.isDirect(this._iban)}static isIndirect(e){return 20===e.length}isIndirect(){return UG.isIndirect(this._iban)}static isValid(e){return/^XE[0-9]{2}(ETH[0-9A-Z]{13}|[0-9A-Z]{30,31})$/.test(e)&&1===UG._mod9710(UG._iso13616Prepare(e))}isValid(){return UG.isValid(this._iban)}static fromBban(e){const t=this._mod9710(this._iso13616Prepare("".concat("XE","00").concat(e))),n="0".concat((98-t).toString()).slice(-2);return new UG("".concat("XE").concat(n).concat(e))}static createIndirect(e){return UG.fromBban("ETH".concat(e.institution).concat(e.identifier))}static fromAddress(e){if(!eH(e))throw new vM(e);const t=BigInt(MH(e)).toString(36),n=Iz(t,15);return UG.fromBban(n.toUpperCase())}static toIban(e){return UG.fromAddress(e).toString()}client(){return this.isIndirect()?this._iban.slice(11):""}checksum(){return this._iban.slice(2,4)}institution(){return this.isIndirect()?this._iban.slice(7,11):""}toString(){return this._iban}}UG._iso13616Prepare=e=>{const t="A".charCodeAt(0),n="Z".charCodeAt(0),r=e.toUpperCase();return"".concat(r.slice(4)).concat(r.slice(0,4)).split("").map((e=>{const r=e.charCodeAt(0);return r>=t&&r<=n?r-t+10:e})).join("")},UG._parseInt=(e,t)=>[...e].reduce(((e,n)=>BigInt(parseInt(n,t))+BigInt(t)*e),BigInt(0)),UG._mod9710=e=>{let t,n=e;for(;n.length>2;)t=n.slice(0,9),n="".concat((parseInt(t,10)%97).toString()).concat(n.slice(t.length));return parseInt(n,10)%97},UG.toAddress=e=>new UG(e).toAddress();var jG,HG=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(BJ){o(BJ)}}function a(e){try{c(r.throw(e))}catch(BJ){o(BJ)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};class zG extends _V{constructor(e){super(),this[jG]="Promise",this._promise=new Promise(e)}then(e,t){return HG(this,void 0,void 0,(function*(){return this._promise.then(e,t)}))}catch(e){return HG(this,void 0,void 0,(function*(){return this._promise.catch(e)}))}finally(e){return HG(this,void 0,void 0,(function*(){return this._promise.finally(e)}))}on(e,t){return super.on(e,t),this}once(e,t){return super.once(e,t),this}}jG=Symbol.toStringTag;n(4132);var VG=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(BJ){o(BJ)}}function a(e){try{c(r.throw(e))}catch(BJ){o(BJ)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};function qG(e){return VG(this,void 0,void 0,(function*(){return e.send({method:"eth_syncing",params:[]})}))}function GG(e,t){return VG(this,void 0,void 0,(function*(){return RH.validate(["hex"],[t]),e.send({method:"eth_sendRawTransaction",params:[t]})}))}function KG(e,t,n){return VG(this,void 0,void 0,(function*(){return RH.validate(["blockNumberOrTag","bool"],[t,n]),e.send({method:"eth_getBlockByNumber",params:[t,n]})}))}var WG=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(BJ){o(BJ)}}function a(e){try{c(r.throw(e))}catch(BJ){o(BJ)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};var QG=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(BJ){o(BJ)}}function a(e){try{c(r.throw(e))}catch(BJ){o(BJ)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};const YG={type:"object",properties:{accessList:{type:"null"},maxFeePerGas:{type:"null"},maxPriorityFeePerGas:{type:"null"}}},ZG={type:"object",properties:{maxFeePerGas:{type:"null"},maxPriorityFeePerGas:{type:"null"}}},JG={type:"object",properties:{gasPrice:{type:"null"}}},XG=(e,t,n)=>{try{RH.validateJSONSchema(e,t)}catch(r){if(r instanceof _j)throw new pM(r.errors,n);throw r}},$G=e=>{var t,n;const r=e;if(!EH(r.type)){let e;switch(r.type){case"0x0":e=YG;break;case"0x1":e=ZG;break;case"0x2":e=JG;break;default:return Oz({format:"uint"},r.type,iH)}return XG(e,r,r.type),Oz({format:"uint"},r.type,iH)}if(!EH(r.maxFeePerGas)||!EH(r.maxPriorityFeePerGas))return XG(JG,r,"0x2"),"0x2";if(!EH(r.accessList))return XG(ZG,r,"0x1"),"0x1";const i=null!==(t=r.hardfork)&&void 0!==t?t:null===(n=r.common)||void 0===n?void 0:n.hardfork;if(!EH(i)){const e=Object.keys(sH).indexOf(i);if(e>=Object.keys(sH).indexOf("london"))return EH(r.gasPrice)?"0x2":"0x0";if(e===Object.keys(sH).indexOf("berlin"))return"0x0"}return EH(r.gasPrice)?void 0:(XG(YG,r,"0x0"),"0x0")},eK=(e,t)=>{var n;return(null!==(n=null===t||void 0===t?void 0:t.transactionTypeParser)&&void 0!==n?n:$G)(e)},tK=e=>e[0]>127?"0x0":$H(e[0]),nK={type:"array",items:Object.assign({},{type:"object",properties:{address:{format:"address"},storageKeys:{type:"array",items:{format:"bytes32"}}}})},rK={type:"object",properties:{accessList:Object.assign({},nK),gasUsed:{type:"string"}}},iK={type:"string",enum:["goerli","kovan","mainnet","rinkeby","ropsten","sepolia"]},oK={type:"string",enum:["arrowGlacier","berlin","byzantium","chainstart","constantinople","dao","homestead","istanbul","london","merge","muirGlacier","petersburg","shanghai","spuriousDragon","tangerineWhistle"]},sK={type:"object",properties:{from:{format:"address"},to:{oneOf:[{format:"address"},{type:"null"}]},value:{format:"uint"},gas:{format:"uint"},gasPrice:{format:"uint"},effectiveGasPrice:{format:"uint"},type:{format:"uint"},maxFeePerGas:{format:"uint"},maxPriorityFeePerGas:{format:"uint"},accessList:Object.assign({},nK),data:{format:"bytes"},input:{format:"bytes"},nonce:{format:"uint"},chain:Object.assign({},iK),hardfork:Object.assign({},oK),chainId:{format:"uint"},networkId:{format:"uint"},common:{type:"object",properties:{customChain:Object.assign({},{type:"object",properties:{name:{format:"string"},networkId:{format:"uint"},chainId:{format:"uint"}}}),baseChain:Object.assign({},iK),hardfork:Object.assign({},oK)}},gasLimit:{format:"uint"},v:{format:"uint"},r:{format:"bytes32"},s:{format:"bytes32"}}},aK={type:"object",properties:Object.assign(Object.assign({},sK.properties),{blockHash:{format:"bytes32"},blockNumber:{format:"uint"},hash:{format:"bytes32"},transactionIndex:{format:"uint"},from:{format:"address"},to:{oneOf:[{format:"address"},{type:"null"}]},value:{format:"uint"},gas:{format:"uint"},gasPrice:{format:"uint"},effectiveGasPrice:{format:"uint"},type:{format:"uint"},maxFeePerGas:{format:"uint"},maxPriorityFeePerGas:{format:"uint"},accessList:Object.assign({},nK),data:{format:"bytes"},input:{format:"bytes"},nonce:{format:"uint"},gasLimit:{format:"uint"},v:{format:"uint"},r:{format:"bytes32"},s:{format:"bytes32"}})},cK={type:"object",properties:{index:{format:"uint"},validatorIndex:{format:"uint"},address:{format:"address"},amount:{format:"uint"}}},lK={type:"object",properties:{baseFeePerGas:{format:"uint"},blobGasUsed:{format:"uint"},difficulty:{format:"uint"},excessBlobGas:{format:"uint"},extraData:{format:"bytes"},gasLimit:{format:"uint"},gasUsed:{format:"uint"},hash:{format:"bytes32"},logsBloom:{format:"bytes256"},miner:{format:"bytes"},mixHash:{format:"bytes32"},nonce:{format:"uint"},number:{format:"uint"},parentBeaconBlockRoot:{format:"bytes32"},parentHash:{format:"bytes32"},receiptsRoot:{format:"bytes32"},sha3Uncles:{format:"bytes32"},size:{format:"uint"},stateRoot:{format:"bytes32"},timestamp:{format:"uint"},totalDifficulty:{format:"uint"},transactions:{oneOf:[{type:"array",items:Object.assign({},aK)},{type:"array",items:{format:"bytes32"}}]},transactionsRoot:{format:"bytes32"},uncles:{type:"array",items:{format:"bytes32"}},withdrawals:{type:"array",items:Object.assign({},cK)},withdrawalsRoot:{format:"bytes32"}}},uK={type:"object",properties:{author:{format:"bytes32"},excessDataGas:{format:"uint"},baseFeePerGas:{format:"uint"},blobGasUsed:{format:"uint"},difficulty:{format:"uint"},excessBlobGas:{format:"uint"},extraData:{format:"bytes"},gasLimit:{format:"uint"},gasUsed:{format:"uint"},hash:{format:"bytes32"},logsBloom:{format:"bytes256"},miner:{format:"bytes"},mixHash:{format:"bytes32"},nonce:{format:"uint"},number:{format:"uint"},parentBeaconBlockRoot:{format:"bytes32"},parentHash:{format:"bytes32"},receiptsRoot:{format:"bytes32"},sha3Uncles:{format:"bytes32"},size:{format:"uint"},stateRoot:{format:"bytes32"},timestamp:{format:"uint"},totalDifficulty:{format:"uint"},transactions:{type:"array",items:{format:"bytes32"}},transactionsRoot:{format:"bytes32"},uncles:{type:"array",items:{format:"bytes32"}},withdrawals:{type:"array",items:Object.assign({},cK)},withdrawalsRoot:{format:"bytes32"}}},dK={type:"object",properties:{removed:{format:"bool"},logIndex:{format:"uint"},transactionIndex:{format:"uint"},transactionHash:{format:"bytes32"},blockHash:{format:"bytes32"},blockNumber:{format:"uint"},address:{format:"address"},data:{format:"bytes"},topics:{type:"array",items:{format:"bytes32"}}}},hK={type:"object",properties:{startingBlock:{format:"string"},currentBlock:{format:"string"},highestBlock:{format:"string"},knownStates:{format:"string"},pulledStates:{format:"string"}}},fK={type:"object",properties:{transactionHash:{format:"bytes32"},transactionIndex:{format:"uint"},blockHash:{format:"bytes32"},blockNumber:{format:"uint"},from:{format:"address"},to:{format:"address"},cumulativeGasUsed:{format:"uint"},gasUsed:{format:"uint"},effectiveGasPrice:{format:"uint"},contractAddress:{format:"address"},logs:{type:"array",items:Object.assign({},dK)},logsBloom:{format:"bytes"},root:{format:"bytes"},status:{format:"uint"},type:{format:"uint"}}},pK={type:"object",properties:{messageHash:{format:"bytes"},r:{format:"bytes32"},s:{format:"bytes32"},v:{format:"bytes"},message:{format:"bytes"},signature:{format:"bytes"}}},gK={type:"object",properties:{oldestBlock:{format:"uint"},baseFeePerGas:{type:"array",items:{format:"uint"}},reward:{type:"array",items:{type:"array",items:{format:"uint"}}},gasUsedRatio:{type:"array",items:{type:"number"}}}},mK={type:"object",properties:{balance:{format:"uint"},codeHash:{format:"bytes32"},nonce:{format:"uint"},storageHash:{format:"bytes32"},accountProof:{type:"array",items:{format:"bytes32"}},storageProof:{type:"array",items:Object.assign({},{type:"object",properties:{key:{format:"bytes32"},value:{format:"uint"},proof:{type:"array",items:{format:"bytes32"}}}})}}};function vK(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:rH,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{transactionSchema:aK,fillInputAndData:!1};var r,i;let o=Az({},e);if(EH(null===e||void 0===e?void 0:e.common)||(o.common=Object.assign({},e.common),EH(null===(r=e.common)||void 0===r?void 0:r.customChain)||(o.common.customChain=Object.assign({},e.common.customChain))),o=Oz(null!==(i=n.transactionSchema)&&void 0!==i?i:aK,o,t),!EH(o.data)&&!EH(o.input)&&$H(o.data)!==$H(o.input))throw new oM({data:OH(o.data),input:OH(o.input)});return n.fillInputAndData&&(EH(o.data)?EH(o.input)||(o.data=o.input):o.input=o.data),EH(o.gasLimit)||(o.gas=o.gasLimit,delete o.gasLimit),o}var yK=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(BJ){o(BJ)}}function a(e){try{c(r.throw(e))}catch(BJ){o(BJ)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};function wK(e,t){return yK(this,void 0,void 0,(function*(){const n=yield function(e){return WG(this,void 0,void 0,(function*(){return e.send({method:"net_version",params:[]})}))}(e.requestManager);return Oz({format:"uint"},n,t)}))}function bK(e,t){return yK(this,void 0,void 0,(function*(){const n=yield function(e){return WG(this,void 0,void 0,(function*(){return e.send({method:"net_peerCount",params:[]})}))}(e.requestManager);return Oz({format:"uint"},n,t)}))}const EK=e=>yK(void 0,void 0,void 0,(function*(){return function(e){return WG(this,void 0,void 0,(function*(){return e.send({method:"net_listening",params:[]})}))}(e.requestManager)}));var kK=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(BJ){o(BJ)}}function a(e){try{c(r.throw(e))}catch(BJ){o(BJ)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};class AK extends FG{getId(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rH;return kK(this,void 0,void 0,(function*(){return wK(this,e)}))}getPeerCount(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rH;return kK(this,void 0,void 0,(function*(){return bK(this,e)}))}isListening(){return kK(this,void 0,void 0,(function*(){return EK(this)}))}}const SK="ALLEVENTS",xK={name:SK,signature:"",type:"event",inputs:[]},_K={bytes:nH.HEX,number:tH.NUMBER};var IK=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(BJ){o(BJ)}}function a(e){try{c(r.throw(e))}catch(BJ){o(BJ)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};function RK(e,t,n){return IK(this,void 0,void 0,(function*(){const r=PK(e,t);if(!EH(r)){if(r.startsWith("-"))throw new iM(r);if(Number(r)<0||Number(r)>127)throw new iM(r);if(EH(e.gasPrice)&&("0x0"===r||"0x1"===r))return{gasPrice:yield hQ(t,n),maxPriorityFeePerGas:void 0,maxFeePerGas:void 0};if("0x2"===r)return Object.assign({gasPrice:void 0},yield function(e,t,n){var r,i,o;return IK(this,void 0,void 0,(function*(){const s=yield yQ(t,t.defaultBlock,!1,n);if(EH(s.baseFeePerGas))throw new rM;if(!EH(e.gasPrice)){const t=Oz({format:"uint"},e.gasPrice,n);return{maxPriorityFeePerGas:t,maxFeePerGas:t}}return{maxPriorityFeePerGas:Oz({format:"uint"},null!==(r=e.maxPriorityFeePerGas)&&void 0!==r?r:t.defaultMaxPriorityFeePerGas,n),maxFeePerGas:Oz({format:"uint"},null!==(i=e.maxFeePerGas)&&void 0!==i?i:BigInt(s.baseFeePerGas)*BigInt(2)+BigInt(null!==(o=e.maxPriorityFeePerGas)&&void 0!==o?o:t.defaultMaxPriorityFeePerGas),n)}}))}(e,t,n))}}))}var CK=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(BJ){o(BJ)}}function a(e){try{c(r.throw(e))}catch(BJ){o(BJ)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};const TK=(e,t,n,r)=>{if(void 0!==n&&e in n&&void 0!==n[e]){if("string"===typeof n[e]&&eH(n[e]))return n[e];if(!Tj(n[e])&&gH(n[e])){if(t.wallet){const r=t.wallet.get(Oz({format:"uint"},n[e],_K));if(!EH(r))return r.address;throw new fM}throw new fM}throw"from"===e?new ML(n.from):new FL(n.to)}if("from"===e){if(!EH(r))return PG(r);if(!EH(t.defaultAccount))return t.defaultAccount}},PK=(e,t)=>{const n=eK(e,t);return EH(n)?EH(t.defaultTransactionType)?void 0:Oz({format:"uint"},t.defaultTransactionType,iH):n};function NK(e){var t,n;return CK(this,void 0,void 0,(function*(){let r=Oz(sK,e.transaction,rH);if(EH(r.from)&&(r.from=TK("from",e.web3Context,void 0,e.privateKey)),EH(r.nonce)&&(r.nonce=yield function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rH;return CK(void 0,void 0,void 0,(function*(){if(EH(t))throw new nM;return _Q(e,t,e.defaultBlock,n)}))}(e.web3Context,r.from,iH)),EH(r.value)&&(r.value="0x0"),EH(r.data))EH(r.input)?r.input="0x":r.input.startsWith("0x")||(r.input="0x".concat(r.input));else{if(!EH(r.input)&&r.data!==r.input)throw new oM({data:OH(r.data),input:OH(r.input)});r.data.startsWith("0x")||(r.data="0x".concat(r.data))}if(EH(r.common)){if(e.web3Context.defaultCommon){const t=e.web3Context.defaultCommon,n=t.customChain.chainId,i=t.customChain.networkId,o=t.customChain.name;r.common=Object.assign(Object.assign({},t),{customChain:{chainId:n,networkId:i,name:o}})}EH(r.chain)&&(r.chain=e.web3Context.defaultChain),EH(r.hardfork)&&(r.hardfork=e.web3Context.defaultHardfork)}if(EH(r.chainId)&&EH(null===(t=r.common)||void 0===t?void 0:t.customChain.chainId)&&(r.chainId=yield BQ(e.web3Context,iH)),EH(r.networkId)&&(r.networkId=null!==(n=e.web3Context.defaultNetworkId)&&void 0!==n?n:yield wK(e.web3Context,iH)),EH(r.gasLimit)&&!EH(r.gas)&&(r.gasLimit=r.gas),r.type=PK(r,e.web3Context),!EH(r.accessList)||"0x1"!==r.type&&"0x2"!==r.type||(r.accessList=[]),e.fillGasPrice&&(r=Object.assign(Object.assign({},r),yield RK(r,e.web3Context,iH))),EH(r.gas)&&EH(r.gasLimit)&&e.fillGasLimit){const t=yield PQ(e.web3Context,r,"latest",iH);r=Object.assign(Object.assign({},r),{gas:Oz({format:"uint"},t,iH)})}return r}))}var BK=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(BJ){o(BJ)}}function a(e){try{c(r.throw(e))}catch(BJ){o(BJ)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};function DK(e,t,n){const r=e.transactionPollingInterval,[i,o]=nV((()=>BK(this,void 0,void 0,(function*(){let r;try{r=yield pQ(e,_K)}catch(o){return void console.warn("An error happen while trying to get the block number",o)}const i=r-t;if(i>=e.transactionBlockTimeout)return new lM({starterBlockNumber:t,numberOfBlocks:i,transactionHash:n})}))),r);return[o,{clean:()=>{clearInterval(i)}}]}function OK(e,t){var n,r;return BK(this,void 0,void 0,(function*(){const{provider:i}=e.requestManager;let o;const s=yield pQ(e,_K);return o=(null===(r=(n=i).supportsSubscriptions)||void 0===r?void 0:r.call(n))&&e.enableExperimentalFeatures.useSubscriptionWhenCheckingBlockTimeout?yield function(e,t,n){var r;return BK(this,void 0,void 0,(function*(){let i,o,s=!0;function a(r,i){i&&console.warn("error happened at subscription. So revert to polling...",i),o.clean(),s=!1;const[a,c]=DK(e,t,n);o.clean=c.clean,a.catch((e=>r(e)))}try{i=yield null===(r=e.subscriptionManager)||void 0===r?void 0:r.subscribe("newHeads"),o={clean:()=>{var t;i.id&&(null===(t=e.subscriptionManager)||void 0===t||t.removeSubscription(i).then((()=>{})).catch((()=>{})))}}}catch(c){return DK(e,t,n)}return[new Promise(((r,o)=>{try{i.on("data",(r=>{if(s=!1,!(null===r||void 0===r?void 0:r.number))return;const i=Number(BigInt(r.number)-BigInt(t));i>=e.transactionBlockTimeout&&o(new lM({starterBlockNumber:t,numberOfBlocks:i,transactionHash:n}))})),i.on("error",(e=>{a(o,e)}))}catch(c){a(o,c)}setTimeout((()=>{s&&a(o)}),1e3*e.blockHeaderTimeout)})),o]}))}(e,s,t):DK(e,s,t),o}))}var LK=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(BJ){o(BJ)}}function a(e){try{c(r.throw(e))}catch(BJ){o(BJ)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};function MK(e,t,n){return LK(this,void 0,void 0,(function*(){const[r,i]=tV(e.transactionSendTimeout,new sM({numberOfSeconds:e.transactionSendTimeout/1e3,transactionHash:n})),[o,s]=yield OK(e,n);try{return yield Promise.race([t(),i,o])}finally{clearTimeout(r),s.clean()}}))}var FK=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(BJ){o(BJ)}}function a(e){try{c(r.throw(e))}catch(BJ){o(BJ)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};function UK(e,t,n){var r;return FK(this,void 0,void 0,(function*(){const i=null!==(r=e.transactionReceiptPollingInterval)&&void 0!==r?r:e.transactionPollingInterval,[o,s]=$z((()=>FK(this,void 0,void 0,(function*(){try{return xQ(e,t,n)}catch(r){return void console.warn("An error happen while trying to get the transaction receipt",r)}}))),i),[a,c]=tV(e.transactionPollingTimeout,new cM({numberOfSeconds:e.transactionPollingTimeout/1e3,transactionHash:t})),[l,u]=yield OK(e,t);try{return yield Promise.race([o,c,l])}finally{a&&clearTimeout(a),s&&clearInterval(s),u.clean()}}))}var jK=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(BJ){o(BJ)}}function a(e){try{c(r.throw(e))}catch(BJ){o(BJ)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};const HK=e=>{let{web3Context:t,transactionReceipt:n,transactionPromiEvent:r,returnFormat:i}=e;var o;let s=1;const a=setInterval((()=>{jK(void 0,void 0,void 0,(function*(){s>=t.transactionConfirmationBlocks&&clearInterval(a);const e=yield KG(t.requestManager,UH(BigInt(n.blockNumber)+BigInt(s)),!1);(null===e||void 0===e?void 0:e.hash)&&(s+=1,r.emit("confirmation",{confirmations:Oz({format:"uint"},s,i),receipt:Oz(fK,n,i),latestBlockHash:Oz({format:"bytes32"},e.hash,i)}))}))}),null!==(o=t.transactionReceiptPollingInterval)&&void 0!==o?o:t.transactionPollingInterval)};var zK=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(BJ){o(BJ)}}function a(e){try{c(r.throw(e))}catch(BJ){o(BJ)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};function VK(e,t,n,r,i){if(EH(n)||EH(n.blockHash))throw new uM({receipt:n,blockHash:Oz({format:"bytes32"},null===n||void 0===n?void 0:n.blockHash,i),transactionHash:Oz({format:"bytes32"},r,i)});if(!n.blockNumber)throw new dM({receipt:n});t.emit("confirmation",{confirmations:Oz({format:"uint"},1,i),receipt:Oz(fK,n,i),latestBlockHash:Oz({format:"bytes32"},n.blockHash,i)});const o=e.requestManager.provider;o&&"supportsSubscriptions"in o&&o.supportsSubscriptions()?(e=>{let t,{web3Context:n,transactionReceipt:r,transactionPromiEvent:i,returnFormat:o}=e,s=!0;setImmediate((()=>{var e;null===(e=n.subscriptionManager)||void 0===e||e.subscribe("newHeads").then((e=>{e.on("data",(a=>zK(void 0,void 0,void 0,(function*(){var c;if(s=!1,!(null===a||void 0===a?void 0:a.number)||t===(null===a||void 0===a?void 0:a.parentHash))return;t=null===a||void 0===a?void 0:a.parentHash;const l=BigInt(a.number)-BigInt(r.blockNumber)+BigInt(1);i.emit("confirmation",{confirmations:Oz({format:"uint"},l,o),receipt:Oz(fK,r,o),latestBlockHash:Oz({format:"bytes32"},a.parentHash,o)}),l>=n.transactionConfirmationBlocks&&(yield null===(c=n.subscriptionManager)||void 0===c?void 0:c.removeSubscription(e))})))),e.on("error",(()=>zK(void 0,void 0,void 0,(function*(){var t;yield null===(t=n.subscriptionManager)||void 0===t?void 0:t.removeSubscription(e),s=!1,HK({web3Context:n,transactionReceipt:r,transactionPromiEvent:i,returnFormat:o})}))))})).catch((()=>{s=!1,HK({web3Context:n,transactionReceipt:r,transactionPromiEvent:i,returnFormat:o})}))})),setTimeout((()=>{s&&HK({web3Context:n,transactionReceipt:r,transactionPromiEvent:i,returnFormat:o})}),1e3*n.blockHeaderTimeout)})({web3Context:e,transactionReceipt:n,transactionPromiEvent:t,returnFormat:i}):HK({web3Context:e,transactionReceipt:n,transactionPromiEvent:t,returnFormat:i})}const qK=e=>!Ez(e)&&"object"===typeof e&&!Ez(e.type)&&"error"===e.type,GK=e=>!Ez(e)&&"object"===typeof e&&!Ez(e.type)&&"event"===e.type,KK=e=>!Ez(e)&&"object"===typeof e&&!Ez(e.type)&&"function"===e.type,WK=e=>"object"===typeof e&&"undefined"===typeof e.components&&"undefined"===typeof e.name,QK=e=>e.includes("[]")?{type:"tuple[]",name:e.slice(0,-2)}:{type:"tuple",name:e},YK=e=>{const t=[];for(const n of Object.keys(e)){const r=e[n];"object"===typeof r?t.push(Object.assign(Object.assign({},QK(n)),{components:YK(r)})):t.push({name:n,type:e[n]})}return t},ZK=(e,t)=>{const n=[];return t.forEach((t=>{if("object"===typeof t.components){if(!t.type.startsWith("tuple"))throw new SL('Invalid value given "'.concat(t.type,'". Error: components found but type is not tuple.'));const r=t.type.indexOf("["),i=r>=0?t.type.substring(r):"",o=ZK(e,t.components);Array.isArray(o)&&e?n.push("tuple(".concat(o.join(","),")").concat(i)):e?n.push("(".concat(o.join(),")")):n.push("(".concat(o.join(","),")").concat(i))}else n.push(t.type)})),n},JK=e=>{var t,n,r,i;return qK(e)||GK(e)||KK(e)?(null===(t=e.name)||void 0===t?void 0:t.includes("("))?e.name:"".concat(null!==(n=e.name)&&void 0!==n?n:"","(").concat(ZK(!1,null!==(r=e.inputs)&&void 0!==r?r:[]).join(","),")"):"(".concat(ZK(!1,null!==(i=e.inputs)&&void 0!==i?i:[]).join(","),")")},XK=e=>{if("string"!==typeof e&&!GK(e))throw new SL("Invalid parameter value in encodeEventSignature");let t;return t=!e||"function"!==typeof e&&"object"!==typeof e?e:JK(e),Fz(t)};function $K(e,t){const n=e.exec(t);return null===n||void 0===n?void 0:n.groups}var eW=/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/,tW=/^u?int(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/,nW=/^\(.+?\).*?$/,rW=Object.defineProperty,iW=(e,t,n)=>(((e,t,n)=>{t in e?rW(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!==typeof t?t+"":t,n),n),oW=class extends Error{constructor(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=n.cause instanceof oW?n.cause.details:null!==(t=n.cause)&&void 0!==t&&t.message?n.cause.message:n.details,i=n.cause instanceof oW&&n.cause.docsPath||n.docsPath;super([e||"An error occurred.","",...n.metaMessages?[...n.metaMessages,""]:[],...i?["Docs: https://abitype.dev".concat(i)]:[],...r?["Details: ".concat(r)]:[],"Version: ".concat("abitype","@").concat("0.7.1")].join("\n")),iW(this,"details"),iW(this,"docsPath"),iW(this,"metaMessages"),iW(this,"shortMessage"),iW(this,"name","AbiTypeError"),n.cause&&(this.cause=n.cause),this.details=r,this.docsPath=i,this.metaMessages=n.metaMessages,this.shortMessage=e}};var sW=/^struct (?<name>[a-zA-Z0-9_]+) \{(?<properties>.*?)\}$/;function aW(e){return sW.test(e)}function cW(e){return $K(sW,e)}var lW=new Set(["memory","indexed","storage","calldata"]),uW=new Set(["calldata","memory","storage"]);var dW=new Map([["address",{type:"address"}],["bool",{type:"bool"}],["bytes",{type:"bytes"}],["bytes32",{type:"bytes32"}],["int",{type:"int256"}],["int256",{type:"int256"}],["string",{type:"string"}],["uint",{type:"uint256"}],["uint8",{type:"uint8"}],["uint16",{type:"uint16"}],["uint24",{type:"uint24"}],["uint32",{type:"uint32"}],["uint64",{type:"uint64"}],["uint96",{type:"uint96"}],["uint112",{type:"uint112"}],["uint160",{type:"uint160"}],["uint192",{type:"uint192"}],["uint256",{type:"uint256"}],["address owner",{type:"address",name:"owner"}],["address to",{type:"address",name:"to"}],["bool approved",{type:"bool",name:"approved"}],["bytes _data",{type:"bytes",name:"_data"}],["bytes data",{type:"bytes",name:"data"}],["bytes signature",{type:"bytes",name:"signature"}],["bytes32 hash",{type:"bytes32",name:"hash"}],["bytes32 r",{type:"bytes32",name:"r"}],["bytes32 root",{type:"bytes32",name:"root"}],["bytes32 s",{type:"bytes32",name:"s"}],["string name",{type:"string",name:"name"}],["string symbol",{type:"string",name:"symbol"}],["string tokenURI",{type:"string",name:"tokenURI"}],["uint tokenId",{type:"uint256",name:"tokenId"}],["uint8 v",{type:"uint8",name:"v"}],["uint256 balance",{type:"uint256",name:"balance"}],["uint256 tokenId",{type:"uint256",name:"tokenId"}],["uint256 value",{type:"uint256",name:"value"}],["event:address indexed from",{type:"address",name:"from",indexed:!0}],["event:address indexed to",{type:"address",name:"to",indexed:!0}],["event:uint indexed tokenId",{type:"uint256",name:"tokenId",indexed:!0}],["event:uint256 indexed tokenId",{type:"uint256",name:"tokenId",indexed:!0}]]);var hW=/^(?<type>[a-zA-Z0-9_]+?)(?<array>(?:\[\d*?\])+?)?(?:\s(?<modifier>calldata|indexed|memory|storage{1}))?(?:\s(?<name>[a-zA-Z0-9_]+))?$/,fW=/^\((?<type>.+?)\)(?<array>(?:\[\d*?\])+?)?(?:\s(?<modifier>calldata|indexed|memory|storage{1}))?(?:\s(?<name>[a-zA-Z0-9_]+))?$/,pW=/^u?int$/;function gW(e,t){var n,r;const i=function(e,t){return t?"".concat(t,":").concat(e):e}(e,null===t||void 0===t?void 0:t.type);if(dW.has(i))return dW.get(i);const o=nW.test(e),s=$K(o?fW:hW,e);if(!s)throw new oW("Invalid ABI parameter.",{details:e});if(s.name&&function(e){return"address"===e||"bool"===e||"function"===e||"string"===e||"tuple"===e||eW.test(e)||tW.test(e)||yW.test(e)}(s.name))throw new oW("Invalid ABI parameter.",{details:e,metaMessages:['"'.concat(s.name,'" is a protected Solidity keyword. More info: https://docs.soliditylang.org/en/latest/cheatsheet.html')]});const a=s.name?{name:s.name}:{},c="indexed"===s.modifier?{indexed:!0}:{},l=null!==(n=null===t||void 0===t?void 0:t.structs)&&void 0!==n?n:{};let u,d={};if(o){u="tuple";const e=mW(s.type),t=[],n=e.length;for(let r=0;r<n;r++)t.push(gW(e[r],{structs:l}));d={components:t}}else if(s.type in l)u="tuple",d={components:l[s.type]};else if(pW.test(s.type))u="".concat(s.type,"256");else if(u=s.type,"struct"!==(null===t||void 0===t?void 0:t.type)&&!vW(u))throw new oW("Unknown type.",{metaMessages:['Type "'.concat(u,'" is not a valid ABI type.')]});if(s.modifier){var h,f;if(null===t||void 0===t||null===(h=t.modifiers)||void 0===h||null===(f=h.has)||void 0===f||!f.call(h,s.modifier))throw new oW("Invalid ABI parameter.",{details:e,metaMessages:['Modifier "'.concat(s.modifier,'" not allowed').concat(null!==t&&void 0!==t&&t.type?' in "'.concat(t.type,'" type'):"",".")]});if(uW.has(s.modifier)&&!function(e,t){return t||"bytes"===e||"string"===e||"tuple"===e}(u,!!s.array))throw new oW("Invalid ABI parameter.",{details:e,metaMessages:['Modifier "'.concat(s.modifier,'" not allowed').concat(null!==t&&void 0!==t&&t.type?' in "'.concat(t.type,'" type'):"","."),'Data location can only be specified for array, struct, or mapping types, but "'.concat(s.modifier,'" was given.')]})}const p={type:"".concat(u).concat(null!==(r=s.array)&&void 0!==r?r:""),...a,...c,...d};return dW.set(i,p),p}function mW(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(""===e){if(""===n)return t;if(0!==r)throw new oW("Unbalanced parentheses.",{metaMessages:['"'.concat(n.trim(),'" has too many ').concat(r>0?"opening":"closing"," parentheses.")],details:'Depth "'.concat(r,'"')});return[...t,n.trim()]}const i=e.length;for(let o=0;o<i;o++){const i=e[o],s=e.slice(o+1);switch(i){case",":return 0===r?mW(s,[...t,n.trim()]):mW(s,t,"".concat(n).concat(i),r);case"(":return mW(s,t,"".concat(n).concat(i),r+1);case")":return mW(s,t,"".concat(n).concat(i),r-1);default:return mW(s,t,"".concat(n).concat(i),r)}}return[]}function vW(e){return"address"===e||"bool"===e||"function"===e||"string"===e||eW.test(e)||tW.test(e)}var yW=/^(?:after|alias|anonymous|apply|auto|byte|calldata|case|catch|constant|copyof|default|defined|error|event|external|false|final|function|immutable|implements|in|indexed|inline|internal|let|mapping|match|memory|mutable|null|of|override|partial|private|promise|public|pure|reference|relocatable|return|returns|sizeof|static|storage|struct|super|supports|switch|this|true|try|typedef|typeof|var|view|virtual)$/;function wW(e){const t={},n=e.length;for(let s=0;s<n;s++){const n=e[s];if(!aW(n))continue;const r=cW(n);if(!r)throw new oW("Invalid struct signature.",{details:n});const i=r.properties.split(";"),o=[],a=i.length;for(let e=0;e<a;e++){const t=i[e].trim();if(!t)continue;const n=gW(t,{type:"struct"});o.push(n)}if(!o.length)throw new oW("Invalid struct signature.",{details:n,metaMessages:["No properties exist."]});t[r.name]=o}const r={},i=Object.entries(t),o=i.length;for(let s=0;s<o;s++){const[e,n]=i[s];r[e]=EW(n,t)}return r}var bW=/^(?<type>[a-zA-Z0-9_]+?)(?<array>(?:\[\d*?\])+?)?$/;function EW(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;const r=[],i=e.length;for(let s=0;s<i;s++){const i=e[s];if(nW.test(i.type))r.push(i);else{const e=$K(bW,i.type);if(null===e||void 0===e||!e.type)throw new oW("Invalid ABI parameter.",{details:JSON.stringify(i,null,2),metaMessages:["ABI parameter type is invalid."]});const{array:s,type:a}=e;if(a in t){var o;if(n.has(a))throw new oW("Circular reference detected.",{metaMessages:['Struct "'.concat(a,'" is a circular reference.')]});r.push({...i,type:"tuple".concat(null!==s&&void 0!==s?s:""),components:EW(null!==(o=t[a])&&void 0!==o?o:[],t,new Set([...n,a]))})}else{if(!vW(a))throw new oW("Unknown type.",{metaMessages:['Type "'.concat(a,'" is not a valid ABI type. Perhaps you forgot to include a struct signature?')]});r.push(i)}}}return r}const kW=32;function AW(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;var t;if(void 0!==(null===(t=globalThis.Buffer)||void 0===t?void 0:t.alloc)){const t=globalThis.Buffer.alloc(e);return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}return new Uint8Array(e)}function SW(e){var t,n;return Object.assign(Object.assign({},e),{name:null!==(t=e.name)&&void 0!==t?t:"",components:null===(n=e.components)||void 0===n?void 0:n.map((e=>SW(e)))})}function xW(e){return e.map((e=>{var t,n;if(!Ez(n=e)&&"object"===typeof n&&!Ez(n.type)&&"string"===typeof n.type)return e;if("string"===typeof e)return SW(function(e){let t;if("string"===typeof e)t=gW(e,{modifiers:lW});else{const n=wW(e),r=e.length;for(let i=0;i<r;i++){const r=e[i];if(!aW(r)){t=gW(r,{modifiers:lW,structs:n});break}}}if(!t)throw new oW("Failed to parse ABI parameter.",{details:"parseAbiParameter(".concat(JSON.stringify(e,null,2),")"),docsPath:"/api/human.html#parseabiparameter-1"});return t}(e.replace(/tuple/,"")));if(WK(e)){const n=Object.keys(e)[0],r=QK(n);return r.name=null!==(t=r.name)&&void 0!==t?t:"",Object.assign(Object.assign({},r),{components:YK(e[n])})}throw new SL("Invalid abi")}))}function _W(e){const t=e.type.lastIndexOf("["),n=e.type.substring(0,t),r=e.type.substring(t);let i=-1;if("[]"!==r&&(i=Number(r.slice(1,-1)),isNaN(i)))throw new SL("Invalid fixed array size",{size:r});return{param:{type:n,name:"",components:e.components},size:i}}function IW(e){var t,n;return!("string"!==e.type&&"bytes"!==e.type&&!e.type.endsWith("[]"))||("tuple"===e.type?null!==(n=null===(t=e.components)||void 0===t?void 0:t.some(IW))&&void 0!==n&&n:!!e.type.endsWith("]")&&IW(_W(e).param))}const RW=20,CW=kW-RW;const TW=new Map;let PW=BigInt(256);for(let n=8;n<=256;n+=8)TW.set("uint".concat(n),{min:BigInt(0),max:PW-BigInt(1)}),TW.set("int".concat(n),{min:-PW/BigInt(2),max:PW/BigInt(2)-BigInt(1)}),PW*=BigInt(256);TW.set("int",TW.get("int256")),TW.set("uint",TW.get("uint256"));const NW=BigInt(1)<<BigInt(256);function BW(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:kW;return t=e<0?(NW+e).toString(16):e.toString(16),t=Sz(t,2*n),Yj(t)}function DW(e,t){let n;try{n=tz(t)}catch(BJ){throw new SL("provided input is not number value",{type:e.type,value:t,name:e.name})}const r=TW.get(e.type);if(!r)throw new SL("provided abi contains invalid number datatype",{type:e.type});if(n<r.min)throw new SL("provided input is less then minimum for given type",{type:e.type,value:t,name:e.name,minimum:r.min.toString()});if(n>r.max)throw new SL("provided input is greater then maximum for given type",{type:e.type,value:t,name:e.name,maximum:r.max.toString()});return{dynamic:!1,encoded:BW(n)}}function OW(e,t){if(t.length<kW)throw new SL("Not enough bytes left to decode",{param:e,bytesLeft:t.length});const n=t.subarray(0,kW),r=TW.get(e.type);if(!r)throw new SL("provided abi contains invalid number datatype",{type:e.type});const i=function(e,t){const n=Kj(e),r=BigInt(n);return r<=t?r:r-NW}(n,r.max);if(i<r.min)throw new SL("decoded value is less then minimum for given type",{type:e.type,value:i,name:e.name,minimum:r.min.toString()});if(i>r.max)throw new SL("decoded value is greater then maximum for given type",{type:e.type,value:i,name:e.name,maximum:r.max.toString()});return{result:i,encoded:t.subarray(kW),consumed:kW}}const LW=32;function MW(e,t){if("string"===typeof t&&t.length%2!==0&&(t+="0"),!Xj(t))throw new SL("provided input is not valid bytes value",{type:e.type,value:t,name:e.name});const n=BH(t),[,r]=e.type.split("bytes");if(r){if(Number(r)>LW||Number(r)<1)throw new SL("invalid bytes type. Static byte type can have between 1 and 32 bytes",{type:e.type});if(Number(r)<n.length)throw new SL("provided input size is different than type size",{type:e.type,value:t,name:e.name});const i=AW(kW);return i.set(n),{dynamic:!1,encoded:i}}const i=Math.ceil(n.length/kW),o=AW(kW+i*kW);return o.set(DW({type:"uint32",name:""},n.length).encoded),o.set(n,kW),{dynamic:!0,encoded:o}}function FW(e,t){const[,n]=e.type.split("bytes");let r=Number(n),i=t,o=1,s=0;if(!r){const e=OW({type:"uint32",name:""},i);r=Number(e.result),s+=e.consumed,i=e.encoded,o=Math.ceil(r/kW)}if(r>t.length)throw new SL("there is not enough data to decode",{type:e.type,encoded:t,size:r});return{result:OH(i.subarray(0,r)),encoded:i.subarray(o*kW),consumed:s+o*kW}}function UW(e){let t=0,n=0;const r=[],i=[];for(const o of e)o.dynamic?t+=kW:t+=o.encoded.length;for(const o of e)o.dynamic?(r.push(DW({type:"uint256",name:""},t+n)),i.push(o),n+=o.encoded.length):r.push(o);return TH(...r.map((e=>e.encoded)),...i.map((e=>e.encoded)))}function jW(e,t){if("string"===e.type)return function(e,t){if("string"!==typeof t)throw new SL("invalid input, should be string",{input:t});return MW({type:"bytes",name:""},WH(t))}(0,t);if("bool"===e.type)return function(e,t){let n;try{n=oz(t)}catch(BJ){if(BJ instanceof kM)throw new SL("provided input is not valid boolean value",{type:e.type,value:t,name:e.name})}return DW({type:"uint8",name:""},Number(n))}(e,t);if("address"===e.type)return function(e,t){if("string"!==typeof t)throw new SL("address type expects string as input type",{value:t,name:e.name,type:e.type});let n=t.toLowerCase();if(n.startsWith("0x")||(n="0x".concat(n)),!eH(n))throw new SL("provided input is not valid address",{value:t,name:e.name,type:e.type});const r=Yj(n),i=AW(kW);return i.set(r,CW),{dynamic:!1,encoded:i}}(e,t);if("tuple"===e.type)return zW(e,t);if(e.type.endsWith("]"))return function(e,t){if(!Array.isArray(t))throw new SL("Expected value to be array",{abi:e,values:t});const{size:n,param:r}=_W(e),i=t.map((e=>jW(r,e))),o=-1===n,s=i.length>0&&i[0].dynamic;if(!o&&t.length!==n)throw new SL("Given arguments count doesn't match array length",{arrayLength:n,argumentsLength:t.length});if(o||s){const e=UW(i);if(o){const t=DW({type:"uint256",name:""},i.length).encoded;return{dynamic:!0,encoded:i.length>0?TH(t,e):t}}return{dynamic:!0,encoded:e}}return{dynamic:!1,encoded:TH(...i.map((e=>e.encoded)))}}(e,t);if(e.type.startsWith("bytes"))return MW(e,t);if(e.type.startsWith("uint")||e.type.startsWith("int"))return DW(e,t);throw new SL("Unsupported",{param:e,value:t})}function HW(e,t){if("string"===e.type)return function(e,t){const n=FW({type:"bytes",name:""},t);return{result:GH(n.result),encoded:n.encoded,consumed:n.consumed}}(0,t);if("bool"===e.type)return function(e,t){const n=OW({type:"uint8",name:""},t);if(n.result>1||n.result<0)throw new SL("Invalid boolean value encoded",{boolBytes:t.subarray(0,kW),numberResult:n});return{result:n.result===BigInt(1),encoded:n.encoded,consumed:kW}}(0,t);if("address"===e.type)return function(e,t){const n=t.subarray(CW,kW);if(n.length!==RW)throw new SL("Invalid decoding input, not enough bytes to decode address",{bytes:t});const r=Kj(n);return{result:iz(r),encoded:t.subarray(kW),consumed:kW}}(0,t);if("tuple"===e.type)return VW(e,t);if(e.type.endsWith("]"))return function(e,t){let{size:n,param:r}=_W(e),i=0;const o=[];let s=t;if(-1===n){const e=OW({type:"uint32",name:""},t);n=Number(e.result),i=e.consumed,s=e.encoded}if(IW(r)){for(let e=0;e<n;e+=1){const t=OW({type:"uint32",name:""},s.subarray(e*kW));i+=t.consumed;const n=HW(r,s.subarray(Number(t.result)));i+=n.consumed,o.push(n.result)}return{result:o,encoded:s.subarray(i),consumed:i}}for(let a=0;a<n;a+=1){const e=HW(r,t.subarray(i));i+=e.consumed,o.push(e.result)}return{result:o,encoded:t.subarray(i),consumed:i}}(e,t);if(e.type.startsWith("bytes"))return FW(e,t);if(e.type.startsWith("uint")||e.type.startsWith("int"))return OW(e,t);throw new SL("Unsupported",{param:e,bytes:t})}function zW(e,t){var n,r,i;let o=!1;if(!Array.isArray(t)&&"object"!==typeof t)throw new SL("param must be either Array or Object",{param:e,input:t});const s=t,a=[];for(let c=0;c<(null!==(r=null===(n=e.components)||void 0===n?void 0:n.length)&&void 0!==r?r:0);c+=1){const n=e.components[c];let r;if(Array.isArray(s)){if(c>=s.length)throw new SL("input param length missmatch",{param:e,input:t});r=jW(n,s[c])}else{const o=s[null!==(i=n.name)&&void 0!==i?i:""];if(void 0===o||null===o)throw new SL("missing input defined in abi",{param:e,input:t,paramName:n.name});r=jW(n,o)}r.dynamic&&(o=!0),a.push(r)}return o?{dynamic:!0,encoded:UW(a)}:{dynamic:!1,encoded:TH(...a.map((e=>e.encoded)))}}function VW(e,t){const n={__length__:0};let r=0;if(!e.components)return{result:n,encoded:t,consumed:r};let i=0;for(const[o,s]of e.components.entries()){let e;if(IW(s)){const n=OW({type:"uint32",name:""},t.subarray(r));e=HW(s,t.subarray(Number(n.result))),r+=n.consumed,i+=e.consumed}else e=HW(s,t.subarray(r)),r+=e.consumed;n.__length__+=1,n[o]=e.result,s.name&&""!==s.name&&(n[s.name]=e.result)}return{encoded:t.subarray(r+i),result:n,consumed:r+i}}function qW(e){const t=[];return e.forEach((e=>{if(Array.isArray(e)){const n=qW(e);t.push({type:"tuple",components:n,name:""})}else t.push({type:$H(e,!0)})})),t}function GW(e,t){if((null===e||void 0===e?void 0:e.length)!==t.length)throw new SL("Invalid number of values received for given ABI",{expected:null===e||void 0===e?void 0:e.length,received:t.length});return Kj(zW({type:"tuple",name:"",components:xW(e)},t).encoded)}function KW(e){try{return Kj(zW({type:"tuple",name:"",components:qW(e)},e).encoded)}catch(BJ){throw new SL("Could not infer types from given params",{params:e})}}const WW=(e,t)=>GW([e],[t]),QW=(e,t,n)=>{try{if(e.length>0&&(!t||"0x"===t||"0X"===t))throw new SL("Returned values aren't valid, did it run Out of Gas? You might also see this error if you are not using the correct ABI for the contract you are retrieving data from, requesting data from a block number that does not exist, or querying a node which is not fully synced.");return function(e,t,n){return VW({type:"tuple",name:"",components:xW(e)},Yj(t)).result}(e,"0x".concat(t.replace(/0x/i,"")))}catch(r){throw new SL("Parameter decoding error: ".concat(r.message),{internalErr:r})}},YW=(e,t)=>QW(e,t),ZW=(e,t)=>YW([e],t)[0],JW=e=>{if("string"!==typeof e&&!KK(e))throw new SL("Invalid parameter value in encodeFunctionSignature");let t;return t=!e||"function"!==typeof e&&"object"!==typeof e?e:JK(e),Fz(t).slice(0,10)},XW=["bool","string","int","uint","address","fixed","ufixed"],$W=(e,t,n)=>{const r=Array.isArray(n)?n:[n],i={},o={};for(const[h,f]of e.entries())f.indexed?i[h]=f:o[h]=f;const s=t?QW(Object.values(o),t):{__length__:0},a=r.length-Object.keys(i).length,c=Object.values(i).map(((e,t)=>{return XW.some((t=>e.type.startsWith(t)))?(n=e.type,i=r[t+a],"string"===n?i:ZW(n,i)):r[t+a];var n,i})),l={__length__:0};let u=0,d=0;for(const[h,f]of e.entries())l[h]="string"===f.type?"":void 0,i[h]&&(l[h]=c[u],u+=1),o[h]&&(l[h]=s[String(d)],d+=1),f.name&&(l[f.name]=l[h]),l.__length__+=1;return l},eQ=(e,t)=>{if(null===t||void 0===t?void 0:t.data){let r,i,o;try{const n=t.data.slice(0,10),s=e.find((e=>(e=>{if("string"!==typeof e&&!qK(e))throw new SL("Invalid parameter value in encodeErrorSignature");let t;return t=!e||"function"!==typeof e&&"object"!==typeof e?e:JK(e),Fz(t)})(e).startsWith(n)));(null===s||void 0===s?void 0:s.inputs)&&(r=s.name,i=JK(s),o=YW([...s.inputs],t.data.substring(10)))}catch(n){console.error(n)}r&&t.setDecodedProperties(r,i,o)}};var tQ=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(BJ){o(BJ)}}function a(e){try{c(r.throw(e))}catch(BJ){o(BJ)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};const nQ=(e,t)=>{var n,r,i,o,s;if(e instanceof gL&&e.cause instanceof pL){if(void 0!==t){const i=t.filter((e=>qK(e)));return eQ(i,e.cause),{reason:e.cause.message,signature:null===(n=e.cause.data)||void 0===n?void 0:n.slice(0,10),data:null===(r=e.cause.data)||void 0===r?void 0:r.substring(10),customErrorName:e.cause.errorName,customErrorDecodedSignature:e.cause.errorSignature,customErrorArguments:e.cause.errorArgs}}return{reason:e.cause.message,signature:null===(i=e.cause.data)||void 0===i?void 0:i.slice(0,10),data:null===(o=e.cause.data)||void 0===o?void 0:o.substring(10)}}if(e instanceof CM&&!Array.isArray(null===(s=e.cause)||void 0===s?void 0:s.errors)&&void 0!==e.cause)return e.cause.message;throw e};function rQ(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:rH;return tQ(this,void 0,void 0,(function*(){try{return void(yield TQ(e,t,e.defaultBlock,r))}catch(i){return nQ(i,n)}}))}var iQ=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(BJ){o(BJ)}}function a(e){try{c(r.throw(e))}catch(BJ){o(BJ)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};function oQ(e,t,n,r,i,o){return iQ(this,void 0,void 0,(function*(){let s,a=o;if(void 0===a&&(void 0!==r?a=nQ(r):e.handleRevert&&void 0!==t&&(a=yield rQ(e,t,i))),void 0===a)s=new DL(n);else if("string"===typeof a)s=new NL(a,void 0,n);else if(void 0!==a.customErrorName&&void 0!==a.customErrorDecodedSignature&&void 0!==a.customErrorArguments){const e=a;s=new BL(e.reason,e.customErrorName,e.customErrorDecodedSignature,e.customErrorArguments,e.signature,n,e.data)}else s=new NL(a.reason,a.signature,n,a.data);return s}))}const sQ=function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:rH;var i,o,s,a,c;let l=Object.assign({},e);const u=Oz(dK,t,r);if([SK,"allEvents"].includes(l.name)){const e=n.find((e=>e.signature===t.topics[0]));l=e||{anonymous:!0}}if(l.inputs=null!==(o=null!==(i=l.inputs)&&void 0!==i?i:e.inputs)&&void 0!==o?o:[],!l.anonymous){let e=0;(null!==(s=l.inputs)&&void 0!==s?s:[]).forEach((t=>{t.indexed&&(e+=1)})),e>0&&(null===t||void 0===t?void 0:t.topics)&&(null===t||void 0===t?void 0:t.topics.length)!==e+1&&(l=Object.assign(Object.assign({},l),{anonymous:!0,inputs:[]}))}const d=l.anonymous?t.topics:(null!==(a=t.topics)&&void 0!==a?a:[]).slice(1);return Object.assign(Object.assign({},u),{returnValues:$W([...null!==(c=l.inputs)&&void 0!==c?c:[]],t.data,d),event:l.name,signature:!l.anonymous&&t.topics&&0!==t.topics.length&&t.topics[0]?t.topics[0]:void 0,raw:{data:t.data,topics:t.topics}})};var aQ=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(BJ){o(BJ)}}function a(e){try{c(r.throw(e))}catch(BJ){o(BJ)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};class cQ{constructor(e){let{options:t,web3Context:n,promiEvent:r,returnFormat:i}=e;this.options={checkRevertBeforeSending:!0},this.options=t,this.web3Context=n,this.promiEvent=r,this.returnFormat=i}getReceiptWithEvents(e){var t,n;const r=Object.assign({},null!==e&&void 0!==e?e:{});if((null===(t=this.options)||void 0===t?void 0:t.contractAbi)&&r.logs&&r.logs.length>0){r.events={};for(const e of r.logs){const t=sQ(xK,e,null===(n=this.options)||void 0===n?void 0:n.contractAbi,this.returnFormat);t.event&&(r.events[t.event]=t)}}return r}checkRevertBeforeSending(e){return aQ(this,void 0,void 0,(function*(){if(!1!==this.options.checkRevertBeforeSending){const t=yield rQ(this.web3Context,e,this.options.contractAbi);if(void 0!==t)throw yield oQ(this.web3Context,e,void 0,void 0,this.options.contractAbi,t)}}))}emitSending(e){this.promiEvent.listenerCount("sending")>0&&this.promiEvent.emit("sending",e)}populateGasPrice(e){let{transactionFormatted:t,transaction:n}=e;var r;return aQ(this,void 0,void 0,(function*(){let e=t;return!(null===(r=this.options)||void 0===r?void 0:r.ignoreGasPricing)&&EH(t.gasPrice)&&(EH(n.maxPriorityFeePerGas)||EH(n.maxFeePerGas))&&(e=Object.assign(Object.assign({},t),yield RK(t,this.web3Context,iH))),e}))}signAndSend(e){let{wallet:t,tx:n}=e;return aQ(this,void 0,void 0,(function*(){if(t){const e=yield t.signTransaction(n);return MK(this.web3Context,(()=>aQ(this,void 0,void 0,(function*(){return GG(this.web3Context.requestManager,e.rawTransaction)}))),e.transactionHash)}return MK(this.web3Context,(()=>aQ(this,void 0,void 0,(function*(){return function(e,t){return VG(this,void 0,void 0,(function*(){return e.send({method:"eth_sendTransaction",params:[t]})}))}(this.web3Context.requestManager,n)}))))}))}emitSent(e){this.promiEvent.listenerCount("sent")>0&&this.promiEvent.emit("sent",e)}emitTransactionHash(e){this.promiEvent.listenerCount("transactionHash")>0&&this.promiEvent.emit("transactionHash",e)}emitReceipt(e){this.promiEvent.listenerCount("receipt")>0&&this.promiEvent.emit("receipt",e)}handleError(e){let{error:t,tx:n}=e;var r;return aQ(this,void 0,void 0,(function*(){let e=t;return e instanceof gL&&this.web3Context.handleRevert&&(e=yield oQ(this.web3Context,n,void 0,void 0,null===(r=this.options)||void 0===r?void 0:r.contractAbi)),(e instanceof CM||e instanceof gL||e instanceof BL||e instanceof DL||e instanceof NL||e instanceof cM)&&this.promiEvent.listenerCount("error")>0&&this.promiEvent.emit("error",e),e}))}emitConfirmation(e){let{receipt:t,transactionHash:n}=e;this.promiEvent.listenerCount("confirmation")>0&&VK(this.web3Context,this.promiEvent,t,n,this.returnFormat)}handleResolve(e){let{receipt:t,tx:n}=e;var r,i,o;return aQ(this,void 0,void 0,(function*(){if(null===(r=this.options)||void 0===r?void 0:r.transactionResolver)return null===(i=this.options)||void 0===i?void 0:i.transactionResolver(t);if(t.status===BigInt(0)){const e=yield oQ(this.web3Context,n,t,void 0,null===(o=this.options)||void 0===o?void 0:o.contractAbi);throw this.promiEvent.listenerCount("error")>0&&this.promiEvent.emit("error",e),e}return t}))}}var lQ=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(BJ){o(BJ)}}function a(e){try{c(r.throw(e))}catch(BJ){o(BJ)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},uQ=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function dQ(e,t){return lQ(this,void 0,void 0,(function*(){const n=yield function(e){return VG(this,void 0,void 0,(function*(){return e.send({method:"eth_hashrate",params:[]})}))}(e.requestManager);return Oz({format:"uint"},n,t)}))}function hQ(e,t){return lQ(this,void 0,void 0,(function*(){const n=yield function(e){return VG(this,void 0,void 0,(function*(){return e.send({method:"eth_gasPrice",params:[]})}))}(e.requestManager);return Oz({format:"uint"},n,t)}))}function fQ(e,t){return lQ(this,void 0,void 0,(function*(){const n=yield function(e){return VG(this,void 0,void 0,(function*(){return e.send({method:"eth_maxPriorityFeePerGas",params:[]})}))}(e.requestManager);return Oz({format:"uint"},n,t)}))}function pQ(e,t){return lQ(this,void 0,void 0,(function*(){const n=yield function(e){return VG(this,void 0,void 0,(function*(){return e.send({method:"eth_blockNumber",params:[]})}))}(e.requestManager);return Oz({format:"uint"},n,t)}))}function gQ(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.defaultBlock,r=arguments.length>3?arguments[3]:void 0;return lQ(this,void 0,void 0,(function*(){const i=vH(n)?n:Oz({format:"uint"},n,iH),o=yield function(e,t,n){return VG(this,void 0,void 0,(function*(){return RH.validate(["address","blockNumberOrTag"],[t,n]),e.send({method:"eth_getBalance",params:[t,n]})}))}(e.requestManager,t,i);return Oz({format:"uint"},o,r)}))}function mQ(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.defaultBlock,i=arguments.length>4?arguments[4]:void 0;return lQ(this,void 0,void 0,(function*(){const o=Oz({format:"uint"},n,iH),s=vH(r)?r:Oz({format:"uint"},r,iH),a=yield function(e,t,n,r){return VG(this,void 0,void 0,(function*(){return RH.validate(["address","hex","blockNumberOrTag"],[t,n,r]),e.send({method:"eth_getStorageAt",params:[t,n,r]})}))}(e.requestManager,t,o,s);return Oz({format:"bytes"},a,i)}))}function vQ(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.defaultBlock,r=arguments.length>3?arguments[3]:void 0;return lQ(this,void 0,void 0,(function*(){const i=vH(n)?n:Oz({format:"uint"},n,iH),o=yield function(e,t,n){return VG(this,void 0,void 0,(function*(){return RH.validate(["address","blockNumberOrTag"],[t,n]),e.send({method:"eth_getCode",params:[t,n]})}))}(e.requestManager,t,i);return Oz({format:"bytes"},o,r)}))}function yQ(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.defaultBlock,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0;return lQ(this,void 0,void 0,(function*(){let i;if(Xj(t)){const r=Oz({format:"bytes32"},t,iH);i=yield function(e,t,n){return VG(this,void 0,void 0,(function*(){return RH.validate(["bytes32","bool"],[t,n]),e.send({method:"eth_getBlockByHash",params:[t,n]})}))}(e.requestManager,r,n)}else{const r=vH(t)?t:Oz({format:"uint"},t,iH);i=yield KG(e.requestManager,r,n)}return Oz(lK,i,r)}))}function wQ(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.defaultBlock,n=arguments.length>2?arguments[2]:void 0;return lQ(this,void 0,void 0,(function*(){let r;if(Xj(t)){const n=Oz({format:"bytes32"},t,iH);r=yield function(e,t){return VG(this,void 0,void 0,(function*(){return RH.validate(["bytes32"],[t]),e.send({method:"eth_getBlockTransactionCountByHash",params:[t]})}))}(e.requestManager,n)}else{const n=vH(t)?t:Oz({format:"uint"},t,iH);r=yield function(e,t){return VG(this,void 0,void 0,(function*(){return RH.validate(["blockNumberOrTag"],[t]),e.send({method:"eth_getBlockTransactionCountByNumber",params:[t]})}))}(e.requestManager,n)}return Oz({format:"uint"},r,n)}))}function bQ(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.defaultBlock,n=arguments.length>2?arguments[2]:void 0;return lQ(this,void 0,void 0,(function*(){let r;if(Xj(t)){const n=Oz({format:"bytes32"},t,iH);r=yield function(e,t){return VG(this,void 0,void 0,(function*(){return RH.validate(["bytes32"],[t]),e.send({method:"eth_getUncleCountByBlockHash",params:[t]})}))}(e.requestManager,n)}else{const n=vH(t)?t:Oz({format:"uint"},t,iH);r=yield function(e,t){return VG(this,void 0,void 0,(function*(){return RH.validate(["blockNumberOrTag"],[t]),e.send({method:"eth_getUncleCountByBlockNumber",params:[t]})}))}(e.requestManager,n)}return Oz({format:"uint"},r,n)}))}function EQ(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.defaultBlock,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return lQ(this,void 0,void 0,(function*(){const i=Oz({format:"uint"},n,iH);let o;if(Xj(t)){const n=Oz({format:"bytes32"},t,iH);o=yield function(e,t,n){return VG(this,void 0,void 0,(function*(){return RH.validate(["bytes32","hex"],[t,n]),e.send({method:"eth_getUncleByBlockHashAndIndex",params:[t,n]})}))}(e.requestManager,n,i)}else{const n=vH(t)?t:Oz({format:"uint"},t,iH);o=yield function(e,t,n){return VG(this,void 0,void 0,(function*(){return RH.validate(["blockNumberOrTag","hex"],[t,n]),e.send({method:"eth_getUncleByBlockNumberAndIndex",params:[t,n]})}))}(e.requestManager,n,i)}return Oz(lK,o,r)}))}function kQ(e,t,n){return lQ(this,void 0,void 0,(function*(){const r=Oz({format:"bytes32"},t,rH),i=yield function(e,t){return VG(this,void 0,void 0,(function*(){return RH.validate(["bytes32"],[t]),e.send({method:"eth_getTransactionByHash",params:[t]})}))}(e.requestManager,r);return EH(i)?i:vK(i,n,{fillInputAndData:!0})}))}function AQ(e,t){return lQ(this,void 0,void 0,(function*(){return(yield function(e){return VG(this,void 0,void 0,(function*(){return e.send({method:"eth_pendingTransactions",params:[]})}))}(e.requestManager)).map((e=>vK(e,t,{fillInputAndData:!0})))}))}function SQ(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.defaultBlock,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return lQ(this,void 0,void 0,(function*(){const i=Oz({format:"uint"},n,iH);let o;if(Xj(t)){const n=Oz({format:"bytes32"},t,iH);o=yield function(e,t,n){return VG(this,void 0,void 0,(function*(){return RH.validate(["bytes32","hex"],[t,n]),e.send({method:"eth_getTransactionByBlockHashAndIndex",params:[t,n]})}))}(e.requestManager,n,i)}else{const n=vH(t)?t:Oz({format:"uint"},t,iH);o=yield function(e,t,n){return VG(this,void 0,void 0,(function*(){return RH.validate(["blockNumberOrTag","hex"],[t,n]),e.send({method:"eth_getTransactionByBlockNumberAndIndex",params:[t,n]})}))}(e.requestManager,n,i)}return EH(o)?o:vK(o,r,{fillInputAndData:!0})}))}function xQ(e,t,n){return lQ(this,void 0,void 0,(function*(){const r=Oz({format:"bytes32"},t,rH),i=yield function(e,t){return VG(this,void 0,void 0,(function*(){return RH.validate(["bytes32"],[t]),e.send({method:"eth_getTransactionReceipt",params:[t]})}))}(e.requestManager,r);return EH(i)?i:Oz(fK,i,n)}))}function _Q(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.defaultBlock,r=arguments.length>3?arguments[3]:void 0;return lQ(this,void 0,void 0,(function*(){const i=vH(n)?n:Oz({format:"uint"},n,iH),o=yield function(e,t,n){return VG(this,void 0,void 0,(function*(){return RH.validate(["address","blockNumberOrTag"],[t,n]),e.send({method:"eth_getTransactionCount",params:[t,n]})}))}(e.requestManager,t,i);return Oz({format:"uint"},o,r)}))}function IQ(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{checkRevertBeforeSending:!0};const i=new zG(((o,s)=>{setImmediate((()=>{(()=>{lQ(this,void 0,void 0,(function*(){const a=new cQ({web3Context:e,promiEvent:i,options:r,returnFormat:n});let c=vK(Object.assign(Object.assign({},t),{from:TK("from",e,t),to:TK("to",e,t)}),iH);try{let r;c=yield a.populateGasPrice({transaction:t,transactionFormatted:c}),yield a.checkRevertBeforeSending(c),a.emitSending(c),e.wallet&&!EH(c.from)&&(r=e.wallet.get(c.from));const i=yield a.signAndSend({wallet:r,tx:c}),s=Oz({format:"bytes32"},i,n);a.emitSent(c),a.emitTransactionHash(s);const l=yield UK(e,i,n),u=a.getReceiptWithEvents(Oz(fK,l,n));a.emitReceipt(u),o(yield a.handleResolve({receipt:u,tx:c})),a.emitConfirmation({receipt:u,transactionHash:i})}catch(l){s(yield a.handleError({error:l,tx:c}))}}))})()}))}));return i}function RQ(e,t,n,r){var i;return lQ(this,void 0,void 0,(function*(){const o=Oz({format:"bytes"},t,rH);if(null===(i=e.wallet)||void 0===i?void 0:i.get(n)){const t=e.wallet.get(n).sign(o);return Oz(pK,t,r)}if("number"===typeof n)throw new TL(t,'RPC method "eth_sign" does not support index signatures');const s=yield function(e,t,n){return VG(this,void 0,void 0,(function*(){return RH.validate(["address","hex"],[t,n]),e.send({method:"eth_sign",params:[t,n]})}))}(e.requestManager,n,o);return Oz({format:"bytes"},s,r)}))}function CQ(e,t,n){return lQ(this,void 0,void 0,(function*(){const r=yield function(e,t){return VG(this,void 0,void 0,(function*(){return e.send({method:"eth_signTransaction",params:[t]})}))}(e.requestManager,vK(t,iH));return Cj(r)?function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{fillInputAndData:!1};return{raw:Oz({format:"bytes"},e,t),tx:vK(Object.assign(Object.assign({},SG.fromSerializedData(LH(e)).toJSON()),{hash:OH(Uz(LH(e))),type:tK(LH(e))}),t,{fillInputAndData:n.fillInputAndData})}}(r,n,{fillInputAndData:!0}):{raw:Oz({format:"bytes"},r.raw,n),tx:vK(r.tx,n,{fillInputAndData:!0})}}))}function TQ(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.defaultBlock,r=arguments.length>3?arguments[3]:void 0;return lQ(this,void 0,void 0,(function*(){const i=vH(n)?n:Oz({format:"uint"},n,iH),o=yield function(e,t,n){return VG(this,void 0,void 0,(function*(){return RH.validate(["blockNumberOrTag"],[n]),e.send({method:"eth_call",params:[t,n]})}))}(e.requestManager,vK(t,iH),i);return Oz({format:"bytes"},o,r)}))}function PQ(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.defaultBlock,r=arguments.length>3?arguments[3]:void 0;return lQ(this,void 0,void 0,(function*(){const i=vK(t,iH),o=vH(n)?n:Oz({format:"uint"},n,iH),s=yield function(e,t,n){return VG(this,void 0,void 0,(function*(){return RH.validate(["blockNumberOrTag"],[n]),e.send({method:"eth_estimateGas",params:[t,n]})}))}(e.requestManager,i,o);return Oz({format:"uint"},s,r)}))}function NQ(e,t,n){return lQ(this,void 0,void 0,(function*(){let{toBlock:r,fromBlock:i}=t;EH(r)||"number"!==typeof r&&"bigint"!==typeof r||(r=UH(r)),EH(i)||"number"!==typeof i&&"bigint"!==typeof i||(i=UH(i));const o=Object.assign(Object.assign({},t),{fromBlock:i,toBlock:r}),s=yield function(e,t){return VG(this,void 0,void 0,(function*(){return RH.validate(["filter"],[t]),e.send({method:"eth_getLogs",params:[t]})}))}(e.requestManager,o);return s.map((e=>"string"===typeof e?e:Oz(dK,e,n)))}))}function BQ(e,t){return lQ(this,void 0,void 0,(function*(){const n=yield function(e){return VG(this,void 0,void 0,(function*(){return e.send({method:"eth_chainId",params:[]})}))}(e.requestManager);return Oz({format:"uint"},n,t)}))}function DQ(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.defaultBlock,i=arguments.length>4?arguments[4]:void 0;return lQ(this,void 0,void 0,(function*(){const o=n.map((e=>Oz({format:"bytes"},e,iH))),s=vH(r)?r:Oz({format:"uint"},r,iH),a=yield function(e,t,n,r){return VG(this,void 0,void 0,(function*(){return RH.validate(["address","bytes32[]","blockNumberOrTag"],[t,n,r]),e.send({method:"eth_getProof",params:[t,n,r]})}))}(e.requestManager,t,o,s);return Oz(mK,a,i)}))}function OQ(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.defaultBlock,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;return lQ(this,void 0,void 0,(function*(){const o=Oz({format:"uint"},t,iH),s=vH(n)?n:Oz({format:"uint"},n,iH),a=Oz({type:"array",items:{format:"uint"}},r,_K),c=yield function(e,t,n,r){return VG(this,void 0,void 0,(function*(){RH.validate(["hex","blockNumberOrTag"],[t,n]);for(const e of r)RH.validate(["number"],[e]);return e.send({method:"eth_feeHistory",params:[t,n,r]})}))}(e.requestManager,o,s,a);return Oz(gK,c,i)}))}function LQ(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.defaultBlock,r=arguments.length>3?arguments[3]:void 0;return lQ(this,void 0,void 0,(function*(){const i=vH(n)?n:Oz({format:"uint"},n,iH),o=yield function(e,t,n){return VG(this,void 0,void 0,(function*(){return RH.validate(["blockNumberOrTag"],[n]),e.send({method:"eth_createAccessList",params:[t,n]})}))}(e.requestManager,vK(t,iH),i);return Oz(rK,o,r)}))}function MQ(e,t,n,r,i){return lQ(this,void 0,void 0,(function*(){const o=yield function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return VG(this,void 0,void 0,(function*(){return RH.validate(["address"],[t]),e.send({method:"eth_signTypedData".concat(r?"":"_v4"),params:[t,n]})}))}(e.requestManager,t,n,r);return Oz({format:"bytes"},o,i)}))}class FQ extends WV{_buildSubscriptionParams(){return["logs",this.args]}formatSubscriptionResult(e){return Oz(dK,e,super.returnFormat)}}class UQ extends WV{_buildSubscriptionParams(){return["newPendingTransactions"]}formatSubscriptionResult(e){return Oz({format:"string"},e,super.returnFormat)}}class jQ extends WV{_buildSubscriptionParams(){return["newHeads"]}formatSubscriptionResult(e){return Oz(uK,e,super.returnFormat)}}class HQ extends WV{_buildSubscriptionParams(){return["syncing"]}_processSubscriptionResult(e){if("boolean"===typeof e)this.emit("changed",e);else{const t=Object.fromEntries(Object.entries(e.status).map((e=>{let[t,n]=e;return[t.charAt(0).toLowerCase()+t.substring(1),n]})));this.emit("changed",e.syncing),this.emit("data",Oz(hK,t,super.returnFormat))}}}var zQ=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(BJ){o(BJ)}}function a(e){try{c(r.throw(e))}catch(BJ){o(BJ)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};const VQ={logs:FQ,newPendingTransactions:UQ,newHeads:jQ,syncing:HQ,pendingTransactions:UQ,newBlockHeaders:jQ};class qQ extends FG{constructor(e){"string"===typeof e||UV(e)?super({provider:e,registeredSubscriptions:VQ}):e.registeredSubscriptions?super(e):(super(Object.assign(Object.assign({},e),{registeredSubscriptions:VQ})),this.getFeeData=this.calculateFeeData)}getProtocolVersion(){return zQ(this,void 0,void 0,(function*(){return function(e){return VG(this,void 0,void 0,(function*(){return e.send({method:"eth_protocolVersion",params:[]})}))}(this.requestManager)}))}isSyncing(){return zQ(this,void 0,void 0,(function*(){return qG(this.requestManager)}))}getCoinbase(){return zQ(this,void 0,void 0,(function*(){return function(e){return VG(this,void 0,void 0,(function*(){return e.send({method:"eth_coinbase",params:[]})}))}(this.requestManager)}))}isMining(){return zQ(this,void 0,void 0,(function*(){return function(e){return VG(this,void 0,void 0,(function*(){return e.send({method:"eth_mining",params:[]})}))}(this.requestManager)}))}getHashrate(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rH;return zQ(this,void 0,void 0,(function*(){return this.getHashRate(e)}))}getHashRate(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rH;return zQ(this,void 0,void 0,(function*(){return dQ(this,e)}))}getGasPrice(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rH;return zQ(this,void 0,void 0,(function*(){return hQ(this,e)}))}getMaxPriorityFeePerGas(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rH;return zQ(this,void 0,void 0,(function*(){return fQ(this,e)}))}calculateFeeData(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:BigInt(2),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:NH.Gwei;var n;return zQ(this,void 0,void 0,(function*(){const r=yield this.getBlock(void 0,!1),i=null!==(n=null===r||void 0===r?void 0:r.baseFeePerGas)&&void 0!==n?n:void 0;let o,s,a;try{o=yield this.getGasPrice()}catch(c){}try{s=yield this.getMaxPriorityFeePerGas()}catch(c){}return i&&(s=null!==s&&void 0!==s?s:t,a=i*e+s),{gasPrice:o,maxFeePerGas:a,maxPriorityFeePerGas:s,baseFeePerGas:i}}))}getAccounts(){var e;return zQ(this,void 0,void 0,(function*(){return(null!==(e=yield function(e){return VG(this,void 0,void 0,(function*(){return e.send({method:"eth_accounts",params:[]})}))}(this.requestManager))&&void 0!==e?e:[]).map((e=>iz(e)))}))}getBlockNumber(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rH;return zQ(this,void 0,void 0,(function*(){return pQ(this,e)}))}getBalance(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.defaultBlock,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rH;return zQ(this,void 0,void 0,(function*(){return gQ(this,e,t,n)}))}getStorageAt(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.defaultBlock,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:rH;return zQ(this,void 0,void 0,(function*(){return mQ(this,e,t,n,r)}))}getCode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.defaultBlock,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rH;return zQ(this,void 0,void 0,(function*(){return vQ(this,e,t,n)}))}getBlock(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.defaultBlock,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rH;return zQ(this,void 0,void 0,(function*(){return yQ(this,e,t,n)}))}getBlockTransactionCount(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.defaultBlock,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:rH;return zQ(this,void 0,void 0,(function*(){return wQ(this,e,t)}))}getBlockUncleCount(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.defaultBlock,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:rH;return zQ(this,void 0,void 0,(function*(){return bQ(this,e,t)}))}getUncle(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.defaultBlock,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rH;return zQ(this,void 0,void 0,(function*(){return EQ(this,e,t,n)}))}getTransaction(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:rH;return zQ(this,void 0,void 0,(function*(){const n=yield kQ(this,e,t);if(!n)throw new LL;return n}))}getPendingTransactions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rH;return zQ(this,void 0,void 0,(function*(){return AQ(this,e)}))}getTransactionFromBlock(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.defaultBlock,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rH;return zQ(this,void 0,void 0,(function*(){return SQ(this,e,t,n)}))}getTransactionReceipt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:rH;return zQ(this,void 0,void 0,(function*(){const n=yield xQ(this,e,t);if(!n)throw new LL;return n}))}getTransactionCount(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.defaultBlock,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rH;return zQ(this,void 0,void 0,(function*(){return _Q(this,e,t,n)}))}sendTransaction(e){return IQ(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:rH,arguments.length>2?arguments[2]:void 0)}sendSignedTransaction(e){return function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{checkRevertBeforeSending:!0};const i=new zG(((o,s)=>{setImmediate((()=>{(()=>{lQ(this,void 0,void 0,(function*(){const a=new cQ({web3Context:e,promiEvent:i,options:r,returnFormat:n}),c=Oz({format:"bytes"},t,iH),l=SG.fromSerializedData(BH(LH(c))),u=Object.assign(Object.assign({},l.toJSON()),{from:l.getSenderAddress().toString()});try{const{v:t,r:r,s:i}=u,s=uQ(u,["v","r","s"]);yield a.checkRevertBeforeSending(s),a.emitSending(c);const l=yield MK(e,(()=>lQ(this,void 0,void 0,(function*(){return GG(e.requestManager,c)}))));a.emitSent(c);const d=Oz({format:"bytes32"},l,n);a.emitTransactionHash(d);const h=yield UK(e,l,n),f=a.getReceiptWithEvents(Oz(fK,h,n));a.emitReceipt(f),o(yield a.handleResolve({receipt:f,tx:u})),a.emitConfirmation({receipt:f,transactionHash:l})}catch(d){s(yield a.handleError({error:d,tx:u}))}}))})()}))}));return i}(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:rH,arguments.length>2?arguments[2]:void 0)}sign(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rH;return zQ(this,void 0,void 0,(function*(){return RQ(this,e,t,n)}))}signTransaction(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:rH;return zQ(this,void 0,void 0,(function*(){return CQ(this,e,t)}))}call(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.defaultBlock,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rH;return zQ(this,void 0,void 0,(function*(){return TQ(this,e,t,n)}))}estimateGas(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.defaultBlock,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rH;return zQ(this,void 0,void 0,(function*(){return PQ(this,e,t,n)}))}getPastLogs(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:rH;return zQ(this,void 0,void 0,(function*(){return NQ(this,e,t)}))}getWork(){return zQ(this,void 0,void 0,(function*(){return function(e){return VG(this,void 0,void 0,(function*(){return e.send({method:"eth_getWork",params:[]})}))}(this.requestManager)}))}submitWork(e,t,n){return zQ(this,void 0,void 0,(function*(){return function(e,t,n,r){return VG(this,void 0,void 0,(function*(){return RH.validate(["bytes8","bytes32","bytes32"],[t,n,r]),e.send({method:"eth_submitWork",params:[t,n,r]})}))}(this.requestManager,e,t,n)}))}requestAccounts(){return zQ(this,void 0,void 0,(function*(){return function(e){return VG(this,void 0,void 0,(function*(){return e.send({method:"eth_requestAccounts",params:[]})}))}(this.requestManager)}))}getChainId(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rH;return zQ(this,void 0,void 0,(function*(){return BQ(this,e)}))}getNodeInfo(){return zQ(this,void 0,void 0,(function*(){return function(e){return VG(this,void 0,void 0,(function*(){return e.send({method:"web3_clientVersion",params:[]})}))}(this.requestManager)}))}getProof(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.defaultBlock,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:rH;return zQ(this,void 0,void 0,(function*(){return DQ(this,e,t,n,r)}))}getFeeHistory(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.defaultBlock,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:rH;return zQ(this,void 0,void 0,(function*(){return OQ(this,e,t,n,r)}))}createAccessList(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.defaultBlock,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rH;return zQ(this,void 0,void 0,(function*(){return LQ(this,e,t,n)}))}signTypedData(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:rH;return zQ(this,void 0,void 0,(function*(){return MQ(this,e,t,n,r)}))}subscribe(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rH;var r;return zQ(this,void 0,void 0,(function*(){const i=yield null===(r=this.subscriptionManager)||void 0===r?void 0:r.subscribe(e,t,n);return i instanceof FQ&&"logs"===e&&"object"===typeof t&&!Ez(t.fromBlock)&&Number.isFinite(Number(t.fromBlock))&&setImmediate((()=>{this.getPastLogs(t).then((e=>{for(const t of e)i._processSubscriptionResult(t)})).catch((e=>{i._processSubscriptionError(e)}))})),i}))}static shouldClearSubscription(e){let{sub:t}=e;return!(t instanceof HQ)}clearSubscriptions(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t;return null===(t=this.subscriptionManager)||void 0===t?void 0:t.unsubscribe(e?qQ.shouldClearSubscription:void 0)}}const GQ=e=>{if(EH(e.gas)||!fH(e.gas)||EH(e.gasPrice)||!fH(e.gasPrice))throw new ZL({gas:e.gas,gasPrice:e.gasPrice});if(!EH(e.maxFeePerGas)||!EH(e.maxPriorityFeePerGas))throw new $L({maxFeePerGas:e.maxFeePerGas,maxPriorityFeePerGas:e.maxPriorityFeePerGas})},KQ=e=>{if(!EH(e.gasPrice)&&"0x2"===e.type)throw new XL(e.gasPrice);if("0x0"===e.type||"0x1"===e.type)throw new $L({maxFeePerGas:e.maxFeePerGas,maxPriorityFeePerGas:e.maxPriorityFeePerGas});if(EH(e.maxFeePerGas)||!fH(e.maxFeePerGas)||EH(e.maxPriorityFeePerGas)||!fH(e.maxPriorityFeePerGas))throw new JL({maxPriorityFeePerGas:e.maxPriorityFeePerGas,maxFeePerGas:e.maxFeePerGas})},WQ=(e,t)=>{if(!EH(t))return void t(e);if("object"!==typeof e||EH(e))throw new eM(e);(e=>{if(!EH(e.common)){if(EH(e.common.customChain))throw new UL;if(EH(e.common.customChain.chainId))throw new jL;if(!EH(e.chainId)&&e.chainId!==e.common.customChain.chainId)throw new HL({txChainId:e.chainId,customChainId:e.common.customChain.chainId})}})(e),(e=>{if(!EH(e.common)&&!EH(e.chain)&&!EH(e.hardfork))throw new qL;if(!EH(e.chain)&&EH(e.hardfork)||!EH(e.hardfork)&&EH(e.chain))throw new GL({chain:e.chain,hardfork:e.hardfork})})(e),(e=>{if(!EH(e.common)&&!EH(e.common.baseChain)&&!EH(e.chain)&&e.chain!==e.common.baseChain)throw new zL({txChain:e.chain,baseChain:e.common.baseChain})})(e),(e=>{if(!EH(e.common)&&!EH(e.common.hardfork)&&!EH(e.hardfork)&&e.hardfork!==e.common.hardfork)throw new VL({txHardfork:e.hardfork,commonHardfork:e.common.hardfork})})(e);const n=vK(e,iH);if((e=>{const t=!EH(e.gas)||!EH(e.gasLimit),n=t&&!EH(e.gasPrice),r=t&&!EH(e.maxPriorityFeePerGas)&&!EH(e.maxFeePerGas);if(!n&&!r)throw new WL({gas:e.gas,gasPrice:e.gasPrice,maxPriorityFeePerGas:e.maxPriorityFeePerGas,maxFeePerGas:e.maxFeePerGas});if(n&&r)throw new YL({gas:e.gas,gasPrice:e.gasPrice,maxPriorityFeePerGas:e.maxPriorityFeePerGas,maxFeePerGas:e.maxFeePerGas});(n?GQ:KQ)(e),(!EH(e.type)&&e.type>"0x1"?KQ:GQ)(e)})(n),EH(n.nonce)||EH(n.chainId)||n.nonce.startsWith("-")||n.chainId.startsWith("-"))throw new tM({nonce:e.nonce,chainId:e.chainId})};var QQ=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(BJ){o(BJ)}}function a(e){try{c(r.throw(e))}catch(BJ){o(BJ)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};const YQ=function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];return QQ(void 0,void 0,void 0,(function*(){const o=yield(e=>CK(void 0,void 0,void 0,(function*(){var t;return(null!==(t=e.web3Context.transactionBuilder)&&void 0!==t?t:NK)(Object.assign(Object.assign({},e),{transaction:e.transaction}))})))({transaction:e,web3Context:t,privateKey:n,fillGasPrice:r,fillGasLimit:i}),s=vK(o,iH);return WQ(s),SG.fromTxData((e=>{var t,n;return{nonce:e.nonce,gasPrice:e.gasPrice,gasLimit:null!==(t=e.gasLimit)&&void 0!==t?t:e.gas,to:e.to,value:e.value,data:null!==(n=e.data)&&void 0!==n?n:e.input,type:e.type,chainId:e.chainId,accessList:e.accessList,maxPriorityFeePerGas:e.maxPriorityFeePerGas,maxFeePerGas:e.maxFeePerGas}})(s),((e,t)=>{var n,r,i,o,s,a,c,l,u,d,h,f,p,g,m,v,y,w;let b;if((EH(e.chain)||EH(e.hardfork))&&EH(e.common))t.defaultCommon?(b=Object.assign({},t.defaultCommon),EH(b.hardfork)&&(b.hardfork=null!==(n=e.hardfork)&&void 0!==n?n:t.defaultHardfork),EH(b.baseChain)&&(b.baseChain=t.defaultChain)):b=cG.custom({name:"custom-network",chainId:ez(e.chainId),networkId:EH(e.networkId)?void 0:ez(e.networkId),defaultHardfork:null!==(r=e.hardfork)&&void 0!==r?r:t.defaultHardfork},{baseChain:t.defaultChain});else{const n=null!==(a=null!==(s=null===(o=null===(i=null===e||void 0===e?void 0:e.common)||void 0===i?void 0:i.customChain)||void 0===o?void 0:o.name)&&void 0!==s?s:e.chain)&&void 0!==a?a:"custom-network",r=ez(null!==(u=null===(l=null===(c=null===e||void 0===e?void 0:e.common)||void 0===c?void 0:c.customChain)||void 0===l?void 0:l.chainId)&&void 0!==u?u:null===e||void 0===e?void 0:e.chainId),E=ez(null!==(f=null===(h=null===(d=null===e||void 0===e?void 0:e.common)||void 0===d?void 0:d.customChain)||void 0===h?void 0:h.networkId)&&void 0!==f?f:null===e||void 0===e?void 0:e.networkId),k=null!==(m=null!==(g=null===(p=null===e||void 0===e?void 0:e.common)||void 0===p?void 0:p.hardfork)&&void 0!==g?g:null===e||void 0===e?void 0:e.hardfork)&&void 0!==m?m:t.defaultHardfork,A=null!==(w=null!==(y=null===(v=e.common)||void 0===v?void 0:v.baseChain)&&void 0!==y?y:e.chain)&&void 0!==w?w:t.defaultChain;r&&E&&n&&(b=cG.custom({name:n,chainId:r,networkId:E,defaultHardfork:k},{baseChain:A}))}return{common:b}})(s,t))}))},ZQ=(e,t,n)=>{let{address:r}=e;var i,o;const s=null===n||void 0===n?void 0:n.topics,a=null!==(i=null===n||void 0===n?void 0:n.filter)&&void 0!==i?i:{},c={};if(Ez(null===n||void 0===n?void 0:n.fromBlock)||(c.fromBlock=Oz(lK.properties.number,null===n||void 0===n?void 0:n.fromBlock,{number:tH.HEX,bytes:nH.HEX})),Ez(null===n||void 0===n?void 0:n.toBlock)||(c.toBlock=Oz(lK.properties.number,null===n||void 0===n?void 0:n.toBlock,{number:tH.HEX,bytes:nH.HEX})),s&&Array.isArray(s))c.topics=[...s];else if(c.topics=[],!t||t.anonymous||[SK,"allEvents"].includes(t.name)||c.topics.push(null!==(o=t.signature)&&void 0!==o?o:XK(JK(t))),![SK,"allEvents"].includes(t.name)&&t.inputs)for(const l of t.inputs){if(!l.indexed)continue;const e=a[l.name];e?Array.isArray(e)?c.topics.push(e.map((e=>WW(l.type,e)))):"string"===l.type?c.topics.push(Uz(e)):c.topics.push(WW(l.type,e)):c.topics.push(null)}return c.topics.length||delete c.topics,r&&(c.address=r.toLowerCase()),c},JQ=(e,t,n)=>{const r=Array.isArray(e.inputs)?e.inputs.length:0;if(e.inputs&&r!==t.length)throw new hL("The number of arguments is not matching the methods required number. You need to pass ".concat(r," arguments."));let i;if(i=e.inputs?GW(Array.isArray(e.inputs)?e.inputs:[],t).replace("0x",""):KW(t).replace("0x",""),!Ez(o=e)&&"object"===typeof o&&!Ez(o.type)&&"constructor"===o.type){if(!n)throw new hL("The contract has no contract data option set. This is necessary to append the constructor parameters.");return n.startsWith("0x")?"".concat(n).concat(i):"0x".concat(n).concat(i)}var o;return"".concat(JW(e)).concat(i)},XQ=function(e,t){const n=(!(arguments.length>2&&void 0!==arguments[2])||arguments[2])&&t&&t.length>=10&&t.startsWith("0x")?t.slice(10):t;if(!e.inputs)throw new hL("No inputs found in the ABI");return YW([...e.inputs],n)};class $Q extends WV{constructor(e,t){super(e,t),this.address=e.address,this.topics=e.topics,this.abi=e.abi,this.jsonInterface=e.jsonInterface}_buildSubscriptionParams(){return["logs",{address:this.address,topics:this.topics}]}formatSubscriptionResult(e){return sQ(this.abi,e,this.jsonInterface,super.returnFormat)}}const eY=(e,t,n,r)=>{var i,o;const s={};return Ez(e.data)&&"both"!==r||(s.data=JQ(t,n,null!==(i=e.data)&&void 0!==i?i:e.input)),Ez(e.input)&&"both"!==r||(s.input=JQ(t,n,null!==(o=e.input)&&void 0!==o?o:e.data)),Ez(s.input)&&Ez(s.data)&&(s[r]=JQ(t,n)),{data:s.data,input:s.input}},tY=e=>{let{abi:t,params:n,options:r,contractOptions:i}=e;var o,s,a;if(!(null!==(a=null!==(s=null!==(o=null===r||void 0===r?void 0:r.input)&&void 0!==o?o:null===r||void 0===r?void 0:r.data)&&void 0!==s?s:i.input)&&void 0!==a?a:i.data)&&!(null===r||void 0===r?void 0:r.to)&&!i.address)throw new hL("Contract address not specified");if(!(null===r||void 0===r?void 0:r.from)&&!i.from)throw new hL('Contract "from" address not specified');let c=Az({to:i.address,gas:i.gas,gasPrice:i.gasPrice,from:i.from,input:i.input,maxPriorityFeePerGas:i.maxPriorityFeePerGas,maxFeePerGas:i.maxFeePerGas,data:i.data},r);const l=eY(c,t,n,null===r||void 0===r?void 0:r.dataInputFill);return c=Object.assign(Object.assign({},c),{data:l.data,input:l.input}),c},nY=e=>"object"===typeof e&&!Ez(e)&&0!==Object.keys(e).length&&!bz(e);var rY=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(BJ){o(BJ)}}function a(e){try{c(r.throw(e))}catch(BJ){o(BJ)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};const iY={logs:$Q,newHeads:jQ,newBlockHeaders:jQ};class oY extends FG{constructor(e,t,n,r,i){var o,s,a;const c=bz(t)?t:bz(n)?n:void 0;let l,u;if(l=nY(t)?t:nY(n)?n:r,u="object"===typeof t&&"provider"in t?t.provider:"object"===typeof n&&"provider"in n?n.provider:"object"===typeof r&&"provider"in r?r.provider:oY.givenProvider,super(Object.assign(Object.assign({},l),{provider:u,registeredSubscriptions:iY})),this.syncWithContext=!1,this._functions={},(null===l||void 0===l?void 0:l.wallet)&&(this._wallet=l.wallet),(null===l||void 0===l?void 0:l.accountProvider)&&(this._accountProvider=l.accountProvider),!EH(c)&&!EH(c.data)&&!EH(c.input)&&"both"!==this.config.contractDataInputFill)throw new mL({data:c.data,input:c.input});this._overloadedMethodAbis=new Map;const d=Pz(r)?r:Pz(n)?n:null!==i&&void 0!==i?i:rH,h="string"===typeof t?t:void 0;this.config.contractDataInputFill=null!==(o=null===c||void 0===c?void 0:c.dataInputFill)&&void 0!==o?o:this.config.contractDataInputFill,this._parseAndSetJsonInterface(e,d),EH(h)||this._parseAndSetAddress(h,d),this.options={address:h,jsonInterface:this._jsonInterface,gas:null!==(s=null===c||void 0===c?void 0:c.gas)&&void 0!==s?s:null===c||void 0===c?void 0:c.gasLimit,gasPrice:null===c||void 0===c?void 0:c.gasPrice,from:null===c||void 0===c?void 0:c.from,input:null===c||void 0===c?void 0:c.input,data:null===c||void 0===c?void 0:c.data},this.syncWithContext=null!==(a=null===c||void 0===c?void 0:c.syncWithContext)&&void 0!==a&&a,l instanceof FG&&this.subscribeToContextEvents(l),Object.defineProperty(this.options,"address",{set:e=>this._parseAndSetAddress(e,d),get:()=>this._address}),Object.defineProperty(this.options,"jsonInterface",{set:e=>this._parseAndSetJsonInterface(e,d),get:()=>this._jsonInterface}),l instanceof FG&&l.on(IV.CONFIG_CHANGE,(e=>{this.setConfig({[e.name]:e.newValue})}))}get events(){return this._events}get methods(){return this._methods}clone(){let e;return e=this.options.address?new oY([...this._jsonInterface,...this._errorsInterface],this.options.address,{gas:this.options.gas,gasPrice:this.options.gasPrice,from:this.options.from,input:this.options.input,data:this.options.data,provider:this.currentProvider,syncWithContext:this.syncWithContext,dataInputFill:this.config.contractDataInputFill},this.getContextObject()):new oY([...this._jsonInterface,...this._errorsInterface],{gas:this.options.gas,gasPrice:this.options.gasPrice,from:this.options.from,input:this.options.input,data:this.options.data,provider:this.currentProvider,syncWithContext:this.syncWithContext,dataInputFill:this.config.contractDataInputFill},this.getContextObject()),this.context&&e.subscribeToContextEvents(this.context),e}deploy(e){var t,n,r,i=this;let o=this._jsonInterface.find((e=>"constructor"===e.type));o||(o={type:"constructor",stateMutability:""});const s=Oz({format:"bytes"},null!==(t=null===e||void 0===e?void 0:e.input)&&void 0!==t?t:this.options.input,rH),a=Oz({format:"bytes"},null!==(n=null===e||void 0===e?void 0:e.data)&&void 0!==n?n:this.options.data,rH);if((!s||"0x"===s.trim())&&(!a||"0x"===a.trim()))throw new hL("contract creation without any data provided.");const c=null!==(r=null===e||void 0===e?void 0:e.arguments)&&void 0!==r?r:[],l=Object.assign(Object.assign({},this.options),{input:s,data:a}),u=null!==s&&void 0!==s?s:a;return{arguments:c,send:e=>{const t=Object.assign({},e);return this._contractMethodDeploySend(o,c,t,l)},estimateGas:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:rH;return rY(i,void 0,void 0,(function*(){const n=Object.assign({},e);return this._contractMethodEstimateGas({abi:o,params:c,returnFormat:t,options:n,contractOptions:l})}))},encodeABI:()=>JQ(o,c,Oz({format:"bytes"},u,rH)),decodeData:e=>Object.assign(Object.assign({},XQ(o,e.replace(u,""),!1)),{__method__:o.type})}}getPastEvents(e,t,n){var r;return rY(this,void 0,void 0,(function*(){const i="string"===typeof e?e:SK,o="string"===typeof e||Pz(e)?Pz(t)?{}:t:e,s=Pz(e)?e:Pz(t)?t:null!==n&&void 0!==n?n:rH,a="allEvents"===i||i===SK?xK:this._jsonInterface.find((e=>"name"in e&&e.name===i));if(!a)throw new hL("Event ".concat(i," not found."));const{fromBlock:c,toBlock:l,topics:u,address:d}=ZQ(this.options,a,null!==o&&void 0!==o?o:{}),h=yield NQ(this,{fromBlock:c,toBlock:l,topics:u,address:d},s),f=h?h.map((e=>"string"===typeof e?e:sQ(a,e,this._jsonInterface,s))):[],p=null!==(r=null===o||void 0===o?void 0:o.filter)&&void 0!==r?r:{},g=Object.keys(p);return g.length>0?f.filter((e=>"string"===typeof e||g.every((t=>{var n;if(Array.isArray(p[t]))return p[t].some((n=>String(e.returnValues[t]).toUpperCase()===String(n).toUpperCase()));const r=null===(n=a.inputs)||void 0===n?void 0:n.filter((e=>e.name===t))[0];if((null===r||void 0===r?void 0:r.indexed)&&"string"===r.type){if(Uz(p[t])===String(e.returnValues[t]))return!0}return String(e.returnValues[t]).toUpperCase()===String(p[t]).toUpperCase()})))):f}))}_parseAndSetAddress(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:rH;this._address=e?iz(Oz({format:"address"},e,t)):e}decodeMethodData(e){const t=e.slice(0,10),n=this._jsonInterface.filter((e=>"error"!==e.type)).find((e=>t===JW(JK(e))));if(!n)throw new hL("The ABI for the provided method signature ".concat(t," was not found."));return Object.assign(Object.assign({},XQ(n,e)),{__method__:JK(n)})}_parseAndSetJsonInterface(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:rH;var n,r,i,o,s;this._functions={},this._methods={},this._events={};let a=[];const c=e.filter((e=>"error"!==e.type)),l=e.filter((e=>qK(e)));for(const u of c){const e=Object.assign(Object.assign({},u),{signature:""});if(KK(e)){const t=JK(e),a=JW(t);e.methodNameWithInputs=t,e.signature=a,e.constant=null!==(r=null!==(n="view"===e.stateMutability)&&void 0!==n?n:"pure"===e.stateMutability)&&void 0!==r?r:e.constant,e.payable=null!==(i="payable"===e.stateMutability)&&void 0!==i?i:e.payable,this._overloadedMethodAbis.set(e.name,[...null!==(o=this._overloadedMethodAbis.get(e.name))&&void 0!==o?o:[],e]);const c=null!==(s=this._overloadedMethodAbis.get(e.name))&&void 0!==s?s:[],u=this._createContractMethod(c,l),d=this._createContractMethod(c,l,!0);this._functions[t]={signature:a,method:d},this._methods[e.name]=u,this._methods[t]=d,this._methods[a]=d}else if(GK(e)){const n=JK(e),r=XK(n),i=this._createContractEvent(e,t);e.signature=r,n in this._events&&"bound"!==e.name||(this._events[n]=i),this._events[e.name]=i,this._events[r]=i}a=[...a,e]}this._events.allEvents=this._createContractEvent(xK,t),this._jsonInterface=[...a],this._errorsInterface=l}_getAbiParams(e,t){var n;try{return Hj(null!==(n=e.inputs)&&void 0!==n?n:[],t)}catch(r){throw new hL("Invalid parameters for method ".concat(e.name,": ").concat(r.message))}}_createContractMethod(e,t){var n=this;let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=e[e.length-1];return function(){for(var e=arguments.length,o=new Array(e),s=0;s<e;s++)o[s]=arguments[s];var a,c,l;let u;const d=null!==(c=r?null===(a=n._overloadedMethodAbis.get(i.name))||void 0===a?void 0:a.filter((e=>e.signature===i.signature)):n._overloadedMethodAbis.get(i.name))&&void 0!==c?c:[];let h=d[0];const f=t,p=d.filter((e=>{var t;return(null!==(t=e.inputs)&&void 0!==t?t:[]).length===o.length}));if(1===d.length||0===p.length)u=n._getAbiParams(h,o),RH.validate(null!==(l=i.inputs)&&void 0!==l?l:[],u);else{const e=[],t=[];for(const r of p)try{u=n._getAbiParams(r,o),RH.validate(r.inputs,u),t.push(r)}catch(BJ){e.push(BJ)}if(1===t.length?[h]=t:t.length>1&&([h]=t,console.warn("Multiple methods found that is compatible with the given inputs.\n\tFound ".concat(t.length," compatible methods: ").concat(JSON.stringify(t.map((e=>"".concat(e.methodNameWithInputs," (signature: ").concat(e.signature,")"))))," \n\tThe first one will be used: ").concat(h.methodNameWithInputs))),e.length===p.length)throw new _j(e)}const g={arguments:u,call:(e,t)=>rY(n,void 0,void 0,(function*(){return this._contractMethodCall(h,u,f,e,t)})),send:e=>n._contractMethodSend(h,u,f,e),estimateGas:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:rH;return rY(n,void 0,void 0,(function*(){return this._contractMethodEstimateGas({abi:h,params:u,returnFormat:t,options:e})}))},encodeABI:()=>JQ(h,u),decodeData:e=>XQ(h,e),createAccessList:(e,t)=>rY(n,void 0,void 0,(function*(){return this._contractMethodCreateAccessList(h,u,f,e,t)}))};return h.stateMutability,g}}_contractMethodCall(e,t,n,r,i){var o;return rY(this,void 0,void 0,(function*(){const s=(e=>{let{abi:t,params:n,options:r,contractOptions:i}=e;if(!(null===r||void 0===r?void 0:r.to)&&!i.address)throw new hL("Contract address not specified");let o=Az({to:i.address,gas:i.gas,gasPrice:i.gasPrice,from:i.from,input:i.input,maxPriorityFeePerGas:i.maxPriorityFeePerGas,maxFeePerGas:i.maxFeePerGas,data:i.data},r);const s=eY(o,t,n,null===r||void 0===r?void 0:r.dataInputFill);return o=Object.assign(Object.assign({},o),{data:s.data,input:s.input}),o})({abi:e,params:t,options:Object.assign(Object.assign({},r),{dataInputFill:this.config.contractDataInputFill}),contractOptions:Object.assign(Object.assign({},this.options),{from:null!==(o=this.options.from)&&void 0!==o?o:this.config.defaultAccount})});try{const t=yield TQ(this,s,i,rH);return((e,t)=>{if("constructor"===e.type)return t;if(!t)return null;const n=t.length>=2?t.slice(2):t;if(!e.outputs)return null;const r=YW([...e.outputs],n);return 1===r.__length__?r[0]:r})(e,t)}catch(a){throw a instanceof gL&&eQ(n,a.cause),a}}))}_contractMethodCreateAccessList(e,t,n,r,i){var o;return rY(this,void 0,void 0,(function*(){const s=(e=>{let{abi:t,params:n,options:r,contractOptions:i}=e;if(!(null===r||void 0===r?void 0:r.to)&&!i.address)throw new hL("Contract address not specified");if(!(null===r||void 0===r?void 0:r.from)&&!i.from)throw new hL('Contract "from" address not specified');let o=Az({to:i.address,gas:i.gas,gasPrice:i.gasPrice,from:i.from,input:i.input,maxPriorityFeePerGas:i.maxPriorityFeePerGas,maxFeePerGas:i.maxFeePerGas,data:i.data},r);const s=eY(o,t,n,null===r||void 0===r?void 0:r.dataInputFill);return o=Object.assign(Object.assign({},o),{data:s.data,input:s.input}),o})({abi:e,params:t,options:Object.assign(Object.assign({},r),{dataInputFill:this.config.contractDataInputFill}),contractOptions:Object.assign(Object.assign({},this.options),{from:null!==(o=this.options.from)&&void 0!==o?o:this.config.defaultAccount})});try{return LQ(this,s,i,rH)}catch(a){throw a instanceof gL&&eQ(n,a.cause),a}}))}_contractMethodSend(e,t,n,r,i){var o,s;let a=null!==i&&void 0!==i?i:this.options;a=Object.assign(Object.assign({},a),{input:void 0,from:null!==(s=null!==(o=a.from)&&void 0!==o?o:this.defaultAccount)&&void 0!==s?s:void 0});const c=IQ(this,tY({abi:e,params:t,options:Object.assign(Object.assign({},r),{dataInputFill:this.config.contractDataInputFill}),contractOptions:a}),rH,{checkRevertBeforeSending:!1,contractAbi:this._jsonInterface});return c.on("error",(e=>{e instanceof gL&&eQ(n,e.cause)})),c}_contractMethodDeploySend(e,t,n,r){var i,o;let s=null!==r&&void 0!==r?r:this.options;s=Object.assign(Object.assign({},s),{from:null!==(o=null!==(i=s.from)&&void 0!==i?i:this.defaultAccount)&&void 0!==o?o:void 0});return IQ(this,tY({abi:e,params:t,options:Object.assign(Object.assign({},n),{dataInputFill:this.config.contractDataInputFill}),contractOptions:s}),rH,{transactionResolver:e=>{if(e.status===BigInt(0))throw new hL("code couldn't be stored",e);const t=this.clone();return t.options.address=e.contractAddress,t},contractAbi:this._jsonInterface,checkRevertBeforeSending:!1})}_contractMethodEstimateGas(e){let{abi:t,params:n,returnFormat:r,options:i,contractOptions:o}=e;return rY(this,void 0,void 0,(function*(){const e=(e=>{let{abi:t,params:n,options:r,contractOptions:i}=e,o=Az({to:i.address,gas:i.gas,gasPrice:i.gasPrice,from:i.from,input:i.input,data:i.data},r);const s=eY(o,t,n,null===r||void 0===r?void 0:r.dataInputFill);return o=Object.assign(Object.assign({},o),{data:s.data,input:s.input}),o})({abi:t,params:n,options:Object.assign(Object.assign({},i),{dataInputFill:this.config.contractDataInputFill}),contractOptions:null!==o&&void 0!==o?o:this.options});return PQ(this,e,oH.LATEST,r)}))}_createContractEvent(e){var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:rH;return function(){var r;const{topics:i,fromBlock:o}=ZQ(t.options,e,arguments.length<=0?void 0:arguments[0]),s=new $Q({address:t.options.address,topics:i,abi:e,jsonInterface:t._jsonInterface},{subscriptionManager:t.subscriptionManager,returnFormat:n});return EH(o)||t.getPastEvents(e.name,{fromBlock:o,topics:i},n).then((e=>{e&&e.forEach((e=>s.emit("data",e)))})).catch((e=>{s.emit("error",new RL("Failed to get past events.",e))})),null===(r=t.subscriptionManager)||void 0===r||r.addSubscription(s).catch((e=>{s.emit("error",new RL("Failed to subscribe.",e))})),s}}subscribeToContextEvents(e){const t=this;this.context=e,t.syncWithContext&&e.on(IV.CONFIG_CHANGE,(e=>{t.setConfig({[e.name]:e.newValue})}))}}const sY=oY,aY={addr:"0x3b3b57de",name:"0x691f3431",abi:"0x2203ab56",pubkey:"0xc8690233",text:"0x59d1d43c",contenthash:"0xbc1c58d1"},cY="addr",lY="addr",uY="pubkey",dY="contenthash",hY="text",fY="name",pY={main:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",goerli:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e"},gY={"0x1":"main","0x5":"goerli"},mY=[{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"node",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"label",type:"bytes32"},{indexed:!1,internalType:"address",name:"owner",type:"address"}],name:"NewOwner",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"node",type:"bytes32"},{indexed:!1,internalType:"address",name:"resolver",type:"address"}],name:"NewResolver",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"node",type:"bytes32"},{indexed:!1,internalType:"address",name:"owner",type:"address"}],name:"Transfer",type:"event"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"operator",type:"address"}],name:"isApprovedForAll",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"node",type:"bytes32"}],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"node",type:"bytes32"}],name:"recordExists",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"node",type:"bytes32"}],name:"resolver",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"node",type:"bytes32"}],name:"ttl",outputs:[{internalType:"uint64",name:"",type:"uint64"}],stateMutability:"view",type:"function"}],vY=[{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"node",type:"bytes32"},{indexed:!1,internalType:"address",name:"a",type:"address"}],name:"AddrChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"node",type:"bytes32"},{indexed:!1,internalType:"uint256",name:"coinType",type:"uint256"},{indexed:!1,internalType:"bytes",name:"newAddress",type:"bytes"}],name:"AddressChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"operator",type:"address"},{indexed:!1,internalType:"bool",name:"approved",type:"bool"}],name:"ApprovalForAll",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"node",type:"bytes32"},{indexed:!1,internalType:"bytes",name:"hash",type:"bytes"}],name:"ContenthashChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"node",type:"bytes32"},{indexed:!1,internalType:"bytes",name:"name",type:"bytes"},{indexed:!1,internalType:"uint16",name:"resource",type:"uint16"},{indexed:!1,internalType:"bytes",name:"record",type:"bytes"}],name:"DNSRecordChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"node",type:"bytes32"},{indexed:!1,internalType:"bytes",name:"name",type:"bytes"},{indexed:!1,internalType:"uint16",name:"resource",type:"uint16"}],name:"DNSRecordDeleted",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"node",type:"bytes32"}],name:"DNSZoneCleared",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"node",type:"bytes32"},{indexed:!1,internalType:"bytes",name:"lastzonehash",type:"bytes"},{indexed:!1,internalType:"bytes",name:"zonehash",type:"bytes"}],name:"DNSZonehashChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"node",type:"bytes32"},{indexed:!0,internalType:"bytes4",name:"interfaceID",type:"bytes4"},{indexed:!1,internalType:"address",name:"implementer",type:"address"}],name:"InterfaceChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"node",type:"bytes32"},{indexed:!1,internalType:"string",name:"name",type:"string"}],name:"NameChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"node",type:"bytes32"},{indexed:!1,internalType:"bytes32",name:"x",type:"bytes32"},{indexed:!1,internalType:"bytes32",name:"y",type:"bytes32"}],name:"PubkeyChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"node",type:"bytes32"},{indexed:!0,internalType:"string",name:"indexedKey",type:"string"},{indexed:!1,internalType:"string",name:"key",type:"string"}],name:"TextChanged",type:"event"},{inputs:[{internalType:"bytes32",name:"node",type:"bytes32"},{internalType:"uint256",name:"contentTypes",type:"uint256"}],name:"ABI",outputs:[{internalType:"uint256",name:"",type:"uint256"},{internalType:"bytes",name:"",type:"bytes"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"node",type:"bytes32"}],name:"addr",outputs:[{internalType:"address payable",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"node",type:"bytes32"},{internalType:"uint256",name:"coinType",type:"uint256"}],name:"addr",outputs:[{internalType:"bytes",name:"",type:"bytes"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"node",type:"bytes32"}],name:"contenthash",outputs:[{internalType:"bytes",name:"",type:"bytes"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"node",type:"bytes32"},{internalType:"bytes32",name:"name",type:"bytes32"},{internalType:"uint16",name:"resource",type:"uint16"}],name:"dnsRecord",outputs:[{internalType:"bytes",name:"",type:"bytes"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"node",type:"bytes32"},{internalType:"bytes32",name:"name",type:"bytes32"}],name:"hasDNSRecords",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"node",type:"bytes32"},{internalType:"bytes4",name:"interfaceID",type:"bytes4"}],name:"interfaceImplementer",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"},{internalType:"address",name:"operator",type:"address"}],name:"isApprovedForAll",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"node",type:"bytes32"}],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"node",type:"bytes32"}],name:"pubkey",outputs:[{internalType:"bytes32",name:"x",type:"bytes32"},{internalType:"bytes32",name:"y",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes4",name:"interfaceID",type:"bytes4"}],name:"supportsInterface",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"node",type:"bytes32"},{internalType:"string",name:"key",type:"string"}],name:"text",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"node",type:"bytes32"}],name:"zonehash",outputs:[{internalType:"bytes",name:"",type:"bytes"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"node",type:"bytes32"},{internalType:"address",name:"a",type:"address"}],name:"setAddr",outputs:[],stateMutability:"nonpayable",type:"function"}];var yY="AEEUdwmgDS8BxQKKAP4BOgDjATAAngDUAIMAoABoAOAAagCOAEQAhABMAHIAOwA9ACsANgAmAGIAHgAuACgAJwAXAC0AGgAjAB8ALwAUACkAEgAeAAkAGwARABkAFgA5ACgALQArADcAFQApABAAHgAiABAAGgAeABMAGAUhBe8BFxREN8sF2wC5AK5HAW8ArQkDzQCuhzc3NzcBP68NEfMABQdHBuw5BV8FYAA9MzkI9r4ZBg7QyQAWA9CeOwLNCjcCjqkChuA/lm+RAsXTAoP6ASfnEQDytQFJAjWVCkeXAOsA6godAB/cwdAUE0WlBCN/AQUCQRjFD/MRBjHxDQSJbw0jBzUAswBxme+tnIcAYwabAysG8QAjAEMMmxcDqgPKQyDXCMMxA7kUQwD3NXOrAKmFIAAfBC0D3x4BJQDBGdUFAhEgVD8JnwmQJiNWYUzrg0oAGwAUAB0AFnNcACkAFgBP9h3gPfsDOWDKneY2ChglX1UDYD30ABsAFAAdABZzIGRAnwDD8wAjAEEMzRbDqgMB2sAFYwXqAtCnAsS4AwpUJKRtFHsadUz9AMMVbwLpABM1NJEX0ZkCgYMBEyMAxRVvAukAEzUBUFAtmUwSAy4DBTER33EftQHfSwB5MxJ/AjkWKQLzL8E/cwBB6QH9LQDPDtO9ASNriQC5DQANAwCK21EFI91zHwCoL9kBqQcHBwcHKzUDowBvAQohPvU3fAQgHwCyAc8CKQMA5zMSezr7ULgFmDp/LzVQBgEGAi8FYQVgt8AFcTtlQhpCWEmfe5tmZ6IAExsDzQ8t+X8rBKtTAltbAn0jsy8Bl6utPWMDTR8Ei2kRANkDBrNHNysDBzECQWUAcwFpJ3kAiyUhAJ0BUb8AL3EfAbfNAz81KUsFWwF3YQZtAm0A+VEfAzEJDQBRSQCzAQBlAHsAM70GD/v3IZWHBwARKQAxALsjTwHZAeMPEzmXgIHwABIAGQA8AEUAQDt3gdvIEGcQZAkGTRFMdEIVEwK0D64L7REdDNkq09PgADSxB/MDWwfzA1sDWwfzB/MDWwfzA1sDWwNbA1scEvAi28gQZw9QBHUFlgWTBN4IiyZREYkHMAjaVBV0JhxPA00BBCMtSSQ7mzMTJUpMFE0LCAQ2SmyvfUADTzGzVP2QqgPTMlc5dAkGHnkSqAAyD3skNb1OhnpPcagKU0+2tYdJak5vAsY6sEAACikJm2/Dd1YGRRAfJ6kQ+ww3AbkBPw3xS9wE9QY/BM0fgRkdD9GVoAipLeEM8SbnLqWAXiP5KocF8Uv4POELUVFsD10LaQnnOmeBUgMlAREijwrhDT0IcRD3Cs1vDekRSQc9A9lJngCpBwULFR05FbkmFGKwCw05ewb/GvoLkyazEy17AAXXGiUGUQEtGwMA0y7rhbRaNVwgT2MGBwspI8sUrFAkDSlAu3hMGh8HGSWtApVDdEqLUToelyH6PEENai4XUYAH+TwJGVMLhTyiRq9FEhHWPpE9TCJNTDAEOYMsMyePCdMPiQy9fHYBXQklCbUMdRM1ERs3yQg9Bx0xlygnGQglRplgngT7owP3E9UDDwVDCUUHFwO5HDETMhUtBRGBKNsC9zbZLrcCk1aEARsFzw8pH+MQVEfkDu0InwJpA4cl7wAxFSUAGyKfCEdnAGOP3FMJLs8Iy2pwI3gDaxTrZRF3B5UOWwerHDcVwxzlcMxeD4YMKKezCV8BeQmdAWME5wgNNV+MpCBFZ1eLXBifIGVBQ14AAjUMaRWjRMGHfAKPD28SHwE5AXcHPQ0FAnsR8RFvEJkI74YINbkz/DopBFMhhyAVCisDU2zSCysm/Qz8bQGnEmYDEDRBd/Jnr2C6KBgBBx0yyUFkIfULlk/RDKAaxRhGVDIZ6AfDA/ca9yfuQVsGAwOnBxc6UTPyBMELbQiPCUMATQ6nGwfbGG4KdYzUATWPAbudA1uVhwJzkwY7Bw8Aaw+LBX3pACECqwinAAkA0wNbAD0CsQehAB0AiUUBQQMrMwEl6QKTA5cINc8BmTMB9y0EH8cMGQD7O25OAsO1AoBuZqYF4VwCkgJNOQFRKQQJUktVA7N15QDfAE8GF+NLARmvTs8e50cB43MvAMsA/wAJOQcJRQHRAfdxALsBYws1Caa3uQFR7S0AhwAZbwHbAo0A4QA5AIP1AVcAUQVd/QXXAlNNARU1HC9bZQG/AyMBNwERAH0Gz5GpzQsjBHEH1wIQHxXlAu8yB7kFAyLjE9FCyQK94lkAMhoKPAqrCqpgX2Q3CjV2PVQAEh+sPss/UgVVO1c7XDtXO1w7VztcO1c7XDtXO1wDm8Pmw+YKcF9JYe8Mqg3YRMw6TRPfYFVgNhPMLbsUxRXSJVoZQRrAJwkl6FUNDwgt12Y0CDA0eRfAAEMpbINFY4oeNApPHOtTlVT8LR8AtUumM7MNsBsZREQFS3XxYi4WEgomAmSFAmJGX1GzAV83JAKh+wJonAJmDQKfiDgfDwJmPwJmKgRyBIMDfxcDfpY5Cjl7GzmGOicnAmwhAjI6OA4CbcsCbbLzjgM3a0kvAWsA4gDlAE4JB5wMkQECD8YAEbkCdzMCdqZDAnlPRwJ4viFg30WyRvcCfEMCeswCfQ0CfPRIBEiBZygALxlJXEpfGRtK0ALRBQLQ0EsrA4hTA4fqRMmRNgLypV0HAwOyS9JMMSkH001QTbMCi0MCitzFHwshR2sJuwKOOwKOYESbhQKO3QKOYHxRuFM5AQ5S2FSJApP/ApMQAO0AIFUiVbNV1AosHymZijLleGpFPz0Cl6MC77ZYJawAXSkClpMCloCgAK1ZsFoNhVEAPwKWuQKWUlxIXNUCmc8CmWhczl0LHQKcnznGOqECnBoCn58CnryOACETNS4TAp31Ap6WALlBYThh8wKe1wKgcgGtAp6jIwKeUqljzGQrKS8CJ7MCJoICoP8CoFDbAqYzAqXSAqgDAIECp/ZogGi1AAdNaiBq1QKs5wKssgKtawKtBgJXIQJV4AKx5dsDH1JsmwKywRECsuwbbORtZ21MYwMl0QK2YD9DbpQDKUkCuGICuUsZArkue3A6cOUCvR0DLbYDMhUCvoxyBgMzdQK+HnMmc1MCw88CwwhzhnRPOUl05AM8qwEDPJ4DPcMCxYACxksCxhSNAshtVQLISALJUwLJMgJkoQLd1nh9ZXiyeSlL1AMYp2cGAmH4GfeVKHsPXpZevxUCz28Cz3AzT1fW9xejAMqxAs93AS3uA04Wfk8JAtwrAtuOAtJTA1JgA1NjAQUDVZCAjUMEzxrxZEl5A4LSg5EC2ssC2eKEFIRNp0ADhqkAMwNkEoZ1Xf0AWQLfaQLevHd7AuIz7RgB8zQrAfSfAfLWiwLr9wLpdH0DAur9AuroAP1LAb0C7o0C66CWrpcHAu5DA4XkmH1w5HGlAvMHAG0DjhqZlwL3FwORcgOSiwL3nAL53QL4apogmq+/O5siA52HAv7+AR8APZ8gAZ+3AwWRA6ZuA6bdANXJAwZuoYyiCQ0DDE0BEwEjB3EGZb1rCQC/BG/DFY8etxEAG3k9ACcDNxJRA42DAWcrJQCM8wAlAOanC6OVCLsGI6fJBgCvBRnDBvElRUYFFoAFcD9GSDNCKUK8X3kZX8QAls0FOgCQVCGbwTsuYDoZutcONxjOGJHJ/gVfBWAFXwVgBWsFYAVfBWAFXwVgBV8FYAVfBWBOHQjfjW8KCgoKbF7xMwTRA7kGN8PDAMMEr8MA70gxFroFTj5xPnhCR0K+X30/X/AAWBkzswCNBsxzzASm70aCRS4rDDMeLz49fnXfcsH5GcoscQFz13Y4HwVnBXLJycnACNdRYwgICAqEXoWTxgA7P4kACxbZBu21Kw0AjMsTAwkVAOVtJUUsJ1JCuULESUArXy9gPi9AKwnJRQYKTD9LPoA+iT54PnkCkULEUUpDX9NWV3JVEjQAc1w3A3IBE3YnX+g7QiMJb6MKaiszRCUuQrNCxDPMCcwEX9EWJzYREBEEBwIHKn6l33JCNVIfybPJtAltydPUCmhBZw/tEKsZAJOVJU1CLRuxbUHOQAo7P0s+eEJHHA8SJVRPdGM0NVrpvBoKhfUlM0JHHGUQUhEWO1xLSj8MO0ucNAqJIzVCRxv9EFsqKyA4OQgNj2nwZgp5ZNFgE2A1K3YHS2AhQQojJmC7DgpzGG1WYFUZCQYHZO9gHWCdYIVgu2BTYJlwFh8GvRbcXbG8YgtDHrMBwzPVyQonHQgkCyYBgQJ0Ajc4nVqIAwGSCsBPIgDsK3SWEtIVBa5N8gGjAo+kVwVIZwD/AEUSCDweX4ITrRQsJ8K3TwBXFDwEAB0TvzVcAtoTS20RIwDgVgZ9BBImYgA5AL4Coi8LFnezOkCnIQFjAY4KBAPh9RcGsgZSBsEAJctdsWIRu2kTkQstRw7DAcMBKgpPBGIGMDAwKCYnKTQaLg4AKRSVAFwCdl+YUZ0JdicFD3lPAdt1F9ZZKCGxuE3yBxkFVGcA/wBFEgiCBwAOLHQSjxOtQDg1z7deFRMAZ8QTAGtKb1ApIiPHADkAvgKiLy1DFtYCmBiDAlDDWNB0eo7fpaMO/aEVRRv0ATEQZBIODyMEAc8JQhCbDRgzFD4TAEMAu9YBCgCsAOkAm5I3ABwAYxvONnR+MhXJAxgKQyxL2+kkJhMbhQKDBMkSsvF0AD9BNQ6uQC7WqSQHwxEAEEIu1hkhAH2z4iQPwyJPHNWpdyYBRSpnJALzoBAEVPPsH20MxA0CCEQKRgAFyAtFAlMNwwjEDUQJRArELtapMg7DDZgJIw+TGukEIwvDFkMAqAtDEMMMBhioe+QAO3MMRAACrgnEBSPY9Q0FDnbSBoMAB8MSYxkSxAEJAPIJAAB8FWMOFtMc/HcXwxhDAC7DAvOowwAewwJdKDKHAAHDAALrFUQVwwAbwyvzpWMWv8wA/ABpAy++bcYDUKPD0KhDCwKmJ1MAAmMA5+UZwxAagwipBRL/eADfw6fDGOMCGsOjk3l6BwOpo4sAEsMOGxMAA5sAbcMOAAvDp0MJGkMDwgipnNIPAwfIqUMGAOGDAAPzABXDAAcDAAnDAGmTABrDAA7DChjDjnEWAwABYwAOcwAuUyYABsMAF8MIKQANUgC6wy4AA8MADqMq8wCyYgAcIwAB8wqpAAXOCx0V4wAHowBCwwEKAGnDAAuDAB3DAAjDCakABdIAbqcZ3QCZCCkABdIAAAFDAAfjAB2jCCkABqIACYMAGzMAbSMA5sOIAAhjAAhDABTDBAkpAAbSAOOTAAlDC6kOzPtnAAdDAG6kQFAATwAKwwwAA0MACbUDPwAHIwAZgwACE6cDAAojAApDAAoDp/MGwwAJIwADEwAQQwgAFEMAEXMAD5MADfMADcMAGRMOFiMAFUMAbqMWuwHDAMIAE0MLAGkzEgDhUwACQwAEWgAXgwUjAAbYABjDBSYBgzBaAEFNALcQBxUMegAwMngBrA0IZgJ0KxQHBREPd1N0ZzKRJwaIHAZqNT4DqQq8BwngAB4DAwt2AX56T1ocKQNXAh1GATQGC3tOxYNagkgAMQA5CQADAQEAWxLjAIOYNAEzAH7tFRk6TglSAF8NAAlYAQ+S1ACAQwQorQBiAN4dAJ1wPyeTANVzuQDX3AIeEMp9eyMgXiUAEdkBkJizKltbVVAaRMqRAAEAhyQ/SDEz6BmfVwB6ATEsOClKIRcDOF0E/832AFNt5AByAnkCRxGCOs94NjXdAwINGBonDBwPALW2AwICAgAAAAAAAAYDBQMDARrUAwAtAAAAAgEGBgYGBgYFBQUFBQUEBQYHCAkEBQUFBQQAAAICAAAAIgCNAJAAlT0A6gC7ANwApEQAwgCyAK0AqADuAKYA2gCjAOcBCAEDAMcAgQBiANIA1AEDAN4A8gCQAKkBMQDqAN8A3AsBCQ8yO9ra2tq8xuLT1tRJOB0BUgFcNU0BWgFpAWgBWwFMUUlLbhMBUxsNEAs6PhMOACcUKy0vMj5AQENDQ0RFFEYGJFdXV1dZWVhZL1pbXVxcI2NnZ2ZoZypsbnZ1eHh4eHh4enp6enp6enp6enp8fH18e2IARPIASQCaAHgAMgBm+ACOAFcAVwA3AnbvAIsABfj4AGQAk/IAnwBPAGIAZP//sACFAIUAaQBWALEAJAC2AIMCQAJDAPwA5wD+AP4A6AD/AOkA6QDoAOYALwJ7AVEBQAE+AVQBPgE+AT4BOQE4ATgBOAEcAVgXADEQCAEAUx8SHgsdHhYAjgCWAKYAUQBqIAIxAHYAbwCXAxUDJzIDIUlGTzEAkQJPAMcCVwKkAMAClgKWApYClgKWApYCiwKWApYClgKWApYClgKVApUCmAKgApcClgKWApQClAKUApQCkgKVAnUB1AKXAp8ClgKWApUeAIETBQD+DQOfAmECOh8BVBg9AuIZEjMbAU4/G1WZAXusRAFpYQEFA0FPAQYAmTEeIJdyADFoAHEANgCRA5zMk/C2jGINwjMWygIZCaXdfDILBCs5dAE7YnQBugDlhoiHhoiGiYqKhouOjIaNkI6Ij4qQipGGkoaThpSSlYaWhpeKmIaZhpqGm4aci52QnoqfhuIC4XTpAt90AIp0LHSoAIsAdHQEQwRABEIERQRDBEkERgRBBEcESQRIBEQERgRJAJ5udACrA490ALxuAQ10ANFZdHQA13QCFHQA/mJ0AP4BIQD+APwA/AD9APwDhGZ03ASMK23HAP4A/AD8AP0A/CR0dACRYnQA/gCRASEA/gCRAvQA/gCRA4RmdNwEjCttxyR0AP9idAEhAP4A/gD8APwA/QD8AP8A/AD8AP0A/AOEZnTcBIwrbcckdHQAkWJ0ASEA/gCRAP4AkQL0AP4AkQOEZnTcBIwrbcckdAJLAT50AlIBQXQCU8l0dAJfdHQDpgL0A6YDpgOnA6cDpwOnA4RmdNwEjCttxyR0dACRYnQBIQOmAJEDpgCRAvQDpgCRA4RmdNwEjCttxyR0BDh0AJEEOQCRDpU5dSgCADR03gV2CwArdAEFAM5iCnR0AF1iAAYcOgp0dACRCnQAXAEIwWZ0CnRmdHQAkWZ0CnRmdEXgAFF03gp0dEY0tlT2u3SOAQTwscwhjZZKrhYcBSfFp9XNbKiVDOD2b+cpe4/Z17mQnbtzzhaeQtE2GGj0IDNTjRUSyTxxw/RPHW/+vS7d1NfRt9z9QPZg4X7QFfhCnkvgNPIItOsC2eV6hPannZNHlZ9xrwZXIMOlu3jSoQSq78WEjwLjw1ELSlF1aBvfzwk5ZX7AUvQzjPQKbDuQ+sm4wNOp4A6AdVuRS0t1y/DZpg4R6m7FNjM9HgvW7Bi88zaMjOo6lM8wtBBdj8LP4ylv3zCXPhebMKJc066o9sF71oFW/8JXu86HJbwDID5lzw5GWLR/LhT0Qqnp2JQxNZNfcbLIzPy+YypqRm/lBmGmex+82+PisxUumSeJkALIT6rJezxMH+CTJmQtt5uwTVbL3ptmjDUQzlSIvWi8Tl7ng1NpuRn1Ng4n14Qc+3Iil7OwkvNWogLSPkn3pihIFytyIGmMhOe3n1tWsuMy9BdKyqF4Z3v2SgggTL9KVvMXPnCbRe+oOuFFP3HejBG/w9gvmfNYvg6JuWia2lcSSN1uIjBktzoIazOHPJZ7kKHPz8mRWVdW3lA8WGF9dQF6Bm673boov3BUWDU2JNcahR23GtfHKLOz/viZ+rYnZFaIznXO67CYEJ1fXuTRpZhYZkKe54xeoagkNGLs+NTZHE0rX45/XvQ2RGADX6vcAvdxIUBV27wxGm2zjZo4X3ILgAlrOFheuZ6wtsvaIj4yLY7qqawlliaIcrz2G+c3vscAnCkCuMzMmZvMfu9lLwTvfX+3cVSyPdN9ZwgDZhfjRgNJcLiJ67b9xx8JHswprbiE3v9UphotAPIgnXVIN5KmMc0piXhc6cChPnN+MRhG9adtdttQTTwSIpl8I4/j//d3sz1326qTBTpPRM/Hgh3kzqEXs8ZAk4ErQhNO8hzrQ0DLkWMA/N+91tn2MdOJnWC2FCZehkQrwzwbKOjhvZsbM95QoeL9skYyMf4srVPVJSgg7pOLUtr/n9eT99oe9nLtFRpjA9okV2Kj8h9k5HaC0oivRD8VyXkJ81tcd4fHNXPCfloIQasxsuO18/46dR2jgul/UIet2G0kRvnyONMKhHs6J26FEoqSqd+rfYjeEGwHWVDpX1fh1jBBcKGMqRepju9Y00mDVHC+Xdij/j44rKfvfjGinNs1jO/0F3jB83XCDINN/HB84axlP+3E/klktRo+vl3U/aiyMJbIodE1XSsDn6UAzIoMtUObY2+k/4gY/l+AkZJ5Sj2vQrkyLm3FoxjhDX+31UXBFf9XrAH31fFqoBmDEZvhvvpnZ87N+oZEu7U9O/nnk+QWj3x8uyoRbEnf+O5UMr9i0nHP38IF5AvzrBW8YWBUR0mIAzIvndQq9N3v/Jto3aPjPXUPl8ASdPPyAp7jENf8bk7VMM9ol9XGmlBmeDMuGqt+WzuL6CXAxXjIhCPM5vACchgMJ/8XBGLO/D1isVvGhwwHHr1DLaI5mn2Jr/b1pUD90uciDaS8cXNDzCWvNmT/PhQe5e8nTnnnkt8Ds/SIjibcum/fqDhKopxAY8AkSrPn+IGDEKOO+U3XOP6djFs2H5N9+orhOahiQk5KnEUWa+CzkVzhp8bMHRbg81qhjjXuIKbHjSLSIBKWqockGtKinY+z4/RdBUF6pcc3JmnlxVcNgrI4SEzKUZSwcD2QCyxzKve+gAmg6ZuSRkpPFa6mfThu7LJNu3H5K42uCpNvPAsoedolKV/LHe/eJ+BbaG5MG0NaSGVPRUmNFMFFSSpXEcXwbVh7UETOZZtoVNRGOIbbkig3McEtR68cG0RZAoJevWYo7Dg/lZ1CQzblWeUvVHmr8fY4Nqd9JJiH/zEX24mJviH60fAyFr0A3c4bC1j3yZU60VgJxXn8JgJXLUIsiBnmKmMYz+7yBQFBvqb2eYnuW59joZBf56/wXvWIR4R8wTmV80i1mZy+S4+BUES+hzjk0uXpC///z/IlqHZ1monzlXp8aCfhGKMti73FI1KbL1q6IKO4fuBuZ59gagjn5xU79muMpHXg6S+e+gDM/U9BKLHbl9l6o8czQKl4RUkJJiqftQG2i3BMg/TQlUYFkJDYBOOvAugYuzYSDnZbDDd/aSd9x0Oe6F+bJcHfl9+gp6L5/TgA+BdFFovbfCrQ40s5vMPw8866pNX8zyFGeFWdxIpPVp9Rg1UPOVFbFZrvaFq/YAzHQgqMWpahMYfqHpmwXfHL1/kpYmGuHFwT55mQu0dylfNuq2Oq0hTMCPwqfxnuBIPLXfci4Y1ANy+1CUipQxld/izVh16WyG2Q0CQQ9NqtAnx1HCHwDj7sYxOSB0wopZSnOzxQOcExmxrVTF2BkOthVpGfuhaGECfCJpJKpjnihY+xOT2QJxN61+9K6QSqtv2Shr82I3jgJrqBg0wELFZPjvHpvzTtaJnLK6Vb97Yn933koO/saN7fsjwNKzp4l2lJVx2orjCGzC/4ZL4zCver6aQYtC5sdoychuFE6ufOiog+VWi5UDkbmvmtah/3aArEBIi39s5ILUnlFLgilcGuz9CQshEY7fw2ouoILAYPVT/gyAIq3TFAIwVsl+ktkRz/qGfnCDGrm5gsl/l9QdvCWGsjPz3dU7XuqKfdUrr/6XIgjp4rey6AJBmCmUJMjITHVdFb5m1p+dLMCL8t55zD42cmftmLEJC0Da04YiRCVUBLLa8D071/N5UBNBXDh0LFsmhV/5B5ExOB4j3WVG/S3lfK5o+V6ELHvy6RR9n4ac+VsK4VE4yphPvV+kG9FegTBH4ZRXL2HytUHCduJazB/KykjfetYxOXTLws267aGOd+I+JhKP//+VnXmS90OD/jvLcVu0asyqcuYN1mSb6XTlCkqv1vigZPIYwNF/zpWcT1GR/6aEIRjkh0yhg4LXJfaGobYJTY4JI58KiAKgmmgAKWdl5nYCeLqavRJGQNuYuZtZFGx+IkI4w4NS2xwbetNMunOjBu/hmKCI/w7tfiiyUd//4rbTeWt4izBY8YvGIN6vyKYmP/8X8wHKCeN+WRcKM70+tXKNGyevU9H2Dg5BsljnTf8YbsJ1TmMs74Ce2XlHisleguhyeg44rQOHZuw/6HTkhnnurK2d62q6yS7210SsAIaR+jXMQA+svkrLpsUY+F30Uw89uOdGAR6vo4FIME0EfVVeHTu6eKicfhSqOeXJhbftcd08sWEnNUL1C9fnprTgd83IMut8onVUF0hvqzZfHduPjbjwEXIcoYmy+P6tcJZHmeOv6VrvEdkHDJecjHuHeWANe79VG662qTjA/HCvumVv3qL+LrOcpqGps2ZGwQdFJ7PU4iuyRlBrwfO+xnPyr47s2cXVbWzAyznDiBGjCM3ksxjjqM62GE9C8f5U38kB3VjtabKp/nRdvMESPGDG90bWRLAt1Qk5DyLuazRR1YzdC1c+hZXvAWV8xA72S4A8B67vjVhbba3MMop293FeEXpe7zItMWrJG/LOH9ByOXmYnNJfjmfuX9KbrpgLOba4nZ+fl8Gbdv/ihv+6wFGKHCYrVwmhFC0J3V2bn2tIB1wCc1CST3d3X2OyxhguXcs4sm679UngzofuSeBewMFJboIQHbUh/m2JhW2hG9DIvG2t7yZIzKBTz9wBtnNC+2pCRYhSIuQ1j8xsz5VvqnyUIthvuoyyu7fNIrg/KQUVmGQaqkqZk/Vx5b33/gsEs8yX7SC1J+NV4icz6bvIE7C5G6McBaI8rVg56q5QBJWxn/87Q1sPK4+sQa8fLU5gXo4paaq4cOcQ4wR0VBHPGjKh+UlPCbA1nLXyEUX45qZ8J7/Ln4FPJE2TdzD0Z8MLSNQiykMMmSyOCiFfy84Rq60emYB2vD09KjYwsoIpeDcBDTElBbXxND72yhd9pC/1CMid/5HUMvAL27OtcIJDzNKpRPNqPOpyt2aPGz9QWIs9hQ9LiX5s8m9hjTUu/f7MyIatjjd+tSfQ3ufZxPpmJhTaBtZtKLUcfOCUqADuO+QoH8B9v6U+P0HV1GLQmtoNFTb3s74ivZgjES0qfK+8RdGgBbcCMSy8eBvh98+et1KIFqSe1KQPyXULBMTsIYnysIwiZBJYdI20vseV+wuJkcqGemehKjaAb9L57xZm3g2zX0bZ2xk/fU+bCo7TlnbW7JuF1YdURo/2Gw7VclDG1W7LOtas2LX4upifZ/23rzpsnY/ALfRgrcWP5hYmV9VxVOQA1fZvp9F2UNU+7d7xRyVm5wiLp3/0dlV7vdw1PMiZrbDAYzIVqEjRY2YU03sJhPnlwIPcZUG5ltL6S8XCxU1eYS5cjr34veBmXAvy7yN4ZjArIG0dfD/5UpBNlX1ZPoxJOwyqRi3wQWtOzd4oNKh0LkoTm8cwqgIfKhqqGOhwo71I+zXnMemTv2B2AUzABWyFztGgGULjDDzWYwJUVBTjKCn5K2QGMK1CQT7SzziOjo+BhAmqBjzuc3xYym2eedGeOIRJVyTwDw37iCMe4g5Vbnsb5ZBdxOAnMT7HU4DHpxWGuQ7GeiY30Cpbvzss55+5Km1YsbD5ea3NI9QNYIXol5apgSu9dZ8f8xS5dtHpido5BclDuLWY4lhik0tbJa07yJhH0BOyEut/GRbYTS6RfiTYWGMCkNpfSHi7HvdiTglEVHKZXaVhezH4kkXiIvKopYAlPusftpE4a5IZwvw1x/eLvoDIh/zpo9FiQInsTb2SAkKHV42XYBjpJDg4374XiVb3ws4qM0s9eSQ5HzsMU4OZJKuopFjBM+dAZEl8RUMx5uU2N486Kr141tVsGQfGjORYMCJAMsxELeNT4RmWjRcpdTGBwcx6XN9drWqPmJzcrGrH4+DRc7+n1w3kPZwu0BkNr6hQrqgo7JTB9A5kdJ/H7P4cWBMwsmuixAzJB3yrQpnGIq90lxAXLzDCdn1LPibsRt7rHNjgQBklRgPZ8vTbjXdgXrTWQsK5MdrXXQVPp0Rinq3frzZKJ0qD6Qhc40VzAraUXlob1gvkhK3vpmHgI6FRlQZNx6eRqkp0zy4AQlX813fAPtL3jMRaitGFFjo0zmErloC+h+YYdVQ6k4F/epxAoF0BmqEoKNTt6j4vQZNQ2BoqF9Vj53TOIoNmDiu9Xp15RkIgQIGcoLpfoIbenzpGUAtqFJp5W+LLnx38jHeECTJ/navKY1NWfN0sY1T8/pB8kIH3DU3DX+u6W3YwpypBMYOhbSxGjq84RZ84fWJow8pyHqn4S/9J15EcCMsXqrfwyd9mhiu3+rEo9pPpoJkdZqHjra4NvzFwuThNKy6hao/SlLw3ZADUcUp3w3SRVfW2rhl80zOgTYnKE0Hs2qp1J6H3xqPqIkvUDRMFDYyRbsFI3M9MEyovPk8rlw7/0a81cDVLmBsR2ze2pBuKb23fbeZC0uXoIvDppfTwIDxk1Oq2dGesGc+oJXWJLGkOha3CX+DUnzgAp9HGH9RsPZN63Hn4RMA5eSVhPHO+9RcRb/IOgtW31V1Q5IPGtoxPjC+MEJbVlIMYADd9aHYWUIQKopuPOHmoqSkubnAKnzgKHqgIOfW5RdAgotN6BN+O2ZYHkuemLnvQ8U9THVrS1RtLmKbcC7PeeDsYznvqzeg6VCNwmr0Yyx1wnLjyT84BZz3EJyCptD3yeueAyDWIs0L2qs/VQ3HUyqfrja0V1LdDzqAikeWuV4sc7RLIB69jEIBjCkyZedoUHqCrOvShVzyd73OdrJW0hPOuQv2qOoHDc9xVb6Yu6uq3Xqp2ZaH46A7lzevbxQEmfrzvAYSJuZ4WDk1Hz3QX1LVdiUK0EvlAGAYlG3Md30r7dcPN63yqBCIj25prpvZP0nI4+EgWoFG95V596CurXpKRBGRjQlHCvy5Ib/iW8nZJWwrET3mgd6mEhfP4KCuaLjopWs7h+MdXFdIv8dHQJgg1xi1eYqB0uDYjxwVmri0Sv5XKut/onqapC+FQiC2C1lvYJ9MVco6yDYsS3AANUfMtvtbYI2hfwZatiSsnoUeMZd34GVjkMMKA+XnjJpXgRW2SHTZplVowPmJsvXy6w3cfO1AK2dvtZEKTkC/TY9LFiKHCG0DnrMQdGm2lzlBHM9iEYynH2UcVMhUEjsc0oDBTgo2ZSQ1gzkAHeWeBXYFjYLuuf8yzTCy7/RFR81WDjXMbq2BOH5dURnxo6oivmxL3cKzKInlZkD31nvpHB9Kk7GfcfE1t+1V64b9LtgeJGlpRFxQCAqWJ5DoY77ski8gsOEOr2uywZaoO/NGa0X0y1pNQHBi3b2SUGNpcZxDT7rLbBf1FSnQ8guxGW3W+36BW0gBje4DOz6Ba6SVk0xiKgt+q2JOFyr4SYfnu+Ic1QZYIuwHBrgzr6UvOcSCzPTOo7D6IC4ISeS7zkl4h+2VoeHpnG/uWR3+ysNgPcOIXQbv0n4mr3BwQcdKJxgPSeyuP/z1Jjg4e9nUvoXegqQVIE30EHx5GHv+FAVUNTowYDJgyFhf5IvlYmEqRif6+WN1MkEJmDcQITx9FX23a4mxy1AQRsOHO/+eImX9l8EMJI3oPWzVXxSOeHU1dUWYr2uAA7AMb+vAEZSbU3qob9ibCyXeypEMpZ6863o6QPqlqGHZkuWABSTVNd4cOh9hv3qEpSx2Zy/DJMP6cItEmiBJ5PFqQnDEIt3NrA3COlOSgz43D7gpNFNJ5MBh4oFzhDPiglC2ypsNU4ISywY2erkyb1NC3Qh/IfWj0eDgZI4/ln8WPfBsT3meTjq1Uqt1E7Zl/qftqkx6aM9KueMCekSnMrcHj1CqTWWzEzPsZGcDe3Ue4Ws+XFYVxNbOFF8ezkvQGR6ZOtOLU2lQEnMBStx47vE6Pb7AYMBRj2OOfZXfisjJnpTfSNjo6sZ6qSvNxZNmDeS7Gk3yYyCk1HtKN2UnhMIjOXUzAqDv90lx9O/q/AT1ZMnit5XQe9wmQxnE/WSH0CqZ9/2Hy+Sfmpeg8RwsHI5Z8kC8H293m/LHVVM/BA7HaTJYg5Enk7M/xWpq0192ACfBai2LA/qrCjCr6Dh1BIMzMXINBmX96MJ5Hn2nxln/RXPFhwHxUmSV0EV2V0jm86/dxxuYSU1W7sVkEbN9EzkG0QFwPhyHKyb3t+Fj5WoUUTErcazE/N6EW6Lvp0d//SDPj7EV9UdJN+Amnf3Wwk3A0SlJ9Z00yvXZ7n3z70G47Hfsow8Wq1JXcfwnA+Yxa5mFsgV464KKP4T31wqIgzFPd3eCe3j5ory5fBF2hgCFyVFrLzI9eetNXvM7oQqyFgDo4CTp/hDV9NMX9JDHQ/nyHTLvZLNLF6ftn2OxjGm8+PqOwhxnPHWipkE/8wbtyri80Sr7pMNkQGMfo4ZYK9OcCC4ESVFFbLMIvlxSoRqWie0wxqnLfcLSXMSpMMQEJYDVObYsXIQNv4TGNwjq1kvT1UOkicTrG3IaBZ3XdScS3u8sgeZPVpOLkbiF940FjbCeNRINNvDbd01EPBrTCPpm12m43ze1bBB59Ia6Ovhnur/Nvx3IxwSWol+3H2qfCJR8df6aQf4v6WiONxkK+IqT4pKQrZK/LplgDI/PJZbOep8dtbV7oCr6CgfpWa8NczOkPx81iSHbsNhVSJBOtrLIMrL31LK9TqHqAbAHe0RLmmV806kRLDLNEhUEJfm9u0sxpkL93Zgd6rw+tqBfTMi59xqXHLXSHwSbSBl0EK0+loECOPtrl+/nsaFe197di4yUgoe4jKoAJDXc6DGDjrQOoFDWZJ9HXwt8xDrQP+7aRwWKWI1GF8s8O4KzxWBBcwnl3vnl1Oez3oh6Ea1vjR7/z7DDTrFtqU2W/KAEzAuXDNZ7MY73MF216dzdSbWmUp4lcm7keJfWaMHgut9x5C9mj66Z0lJ+yhsjVvyiWrfk1lzPOTdhG15Y7gQlXtacvI7qv/XNSscDwqkgwHT/gUsD5yB7LdRRvJxQGYINn9hTpodKFVSTPrtGvyQw+HlRFXIkodErAGu9Iy1YpfSPc3jkFh5CX3lPxv7aqjE/JAfTIpEjGb/H7MO0e2vsViSW1qa/Lmi4/n4DEI3g7lYrcanspDfEpKkdV1OjSLOy0BCUqVoECaB55vs06rXl4jqmLsPsFM/7vYJ0vrBhDCm/00A/H81l1uekJ/6Lml3Hb9+NKiLqATJmDpyzfYZFHumEjC662L0Bwkxi7E9U4cQA0XMVDuMYAIeLMPgQaMVOd8fmt5SflFIfuBoszeAw7ow5gXPE2Y/yBc/7jExARUf/BxIHQBF5Sn3i61w4z5xJdCyO1F1X3+3ax+JSvMeZ7S6QSKp1Fp/sjYz6Z+VgCZzibGeEoujryfMulH7Rai5kAft9ebcW50DyJr2uo2z97mTWIu45YsSnNSMrrNUuG1XsYBtD9TDYzQffKB87vWbkM4EbPAFgoBV4GQS+vtFDUqOFAoi1nTtmIOvg38N4hT2Sn8r8clmBCXspBlMBYTnrqFJGBT3wZOzAyJDre9dHH7+x7qaaKDOB4UQALD5ecS0DE4obubQEiuJZ0EpBVpLuYcce8Aa4PYd/V4DLDAJBYKQPCWTcrEaZ5HYbJi11Gd6hjGom1ii18VHYnG28NKpkz2UKVPxlhYSp8uZr367iOmoy7zsxehW9wzcy2zG0a80PBMCRQMb32hnaHeOR8fnNDzZhaNYhkOdDsBUZ3loDMa1YP0uS0cjUP3b/6DBlqmZOeNABDsLl5BI5QJups8uxAuWJdkUB/pO6Zax6tsg7fN5mjjDgMGngO+DPcKqiHIDbFIGudxtPTIyDi9SFMKBDcfdGQRv41q1AqmxgkVfJMnP8w/Bc7N9/TR6C7mGObFqFkIEom8sKi2xYqJLTCHK7cxzaZvqODo22c3wisBCP4HeAgcRbNPAsBkNRhSmD48dHupdBRw4mIvtS5oeF6zeT1KMCyhMnmhpkFAGWnGscoNkwvQ8ZM5lE/vgTHFYL99OuNxdFBxTEDd5v2qLR8y9WkXsWgG6kZNndFG+pO/UAkOCipqIhL3hq7cRSdrCq7YhUsTocEcnaFa6nVkhnSeRYUA1YO0z5itF9Sly3VlxYDw239TJJH6f3EUfYO5lb7bcFcz8Bp7Oo8QmnsUHOz/fagVUBtKEw1iT88j+aKkv8cscKNkMxjYr8344D1kFoZ7/td1W6LCNYN594301tUGRmFjAzeRg5vyoM1F6+bJZ/Q54jN/k8SFd3DxPTYaAUsivsBfgTn7Mx8H2SpPt4GOdYRnEJOH6jHM2p6SgB0gzIRq6fHxGMmSmqaPCmlfwxiuloaVIitLGN8wie2CDWhkzLoCJcODh7KIOAqbHEvXdUxaS4TTTs07Clzj/6GmVs9kiZDerMxEnhUB6QQPlcfqkG9882RqHoLiHGBoHfQuXIsAG8GTAtao2KVwRnvvam8jo1e312GQAKWEa4sUVEAMG4G6ckcONDwRcg1e2D3+ohXgY4UAWF8wHKQMrSnzCgfFpsxh+aHXMGtPQroQasRY4U6UdG0rz1Vjbka0MekOGRZQEvqQFlxseFor8zWFgHek3v29+WqN6gaK5gZOTOMZzpQIC1201LkMCXild3vWXSc5UX9xcFYfbRPzGFa1FDcPfPB/jUEq/FeGt419CI3YmBlVoHsa4KdcwQP5ZSwHHhFJ7/Ph/Rap/4vmG91eDwPP0lDfCDRCLszTqfzM71xpmiKi2HwS4WlqvGNwtvwF5Dqpn6KTq8ax00UMPkxDcZrEEEsIvHiUXXEphdb4GB4FymlPwBz4Gperqq5pW7TQ6/yNRhW8VT5NhuP0udlxo4gILq5ZxAZk8ZGh3g4CqxJlPKY7AQxupfUcVpWT5VItp1+30UqoyP4wWsRo3olRRgkWZZ2ZN6VC3OZFeXB8NbnUrSdikNptD1QiGuKkr8EmSR/AK9Rw+FF3s5uwuPbvHGiPeFOViltMK7AUaOsq9+x9cndk3iJEE5LKZRlWJbKOZweROzmPNVPkjE3K/TyA57Rs68TkZ3MR8akKpm7cFjnjPd/DdkWjgYoKHSr5Wu5ssoBYU4acRs5g2DHxUmdq8VXOXRbunD8QN0LhgkssgahcdoYsNvuXGUK/KXD/7oFb+VGdhqIn02veuM5bLudJOc2Ky0GMaG4W/xWBxIJcL7yliJOXOpx0AkBqUgzlDczmLT4iILXDxxtRR1oZa2JWFgiAb43obrJnG/TZC2KSK2wqOzRZTXavZZFMb1f3bXvVaNaK828w9TO610gk8JNf3gMfETzXXsbcvRGCG9JWQZ6+cDPqc4466Yo2RcKH+PILeKOqtnlbInR3MmBeGG3FH10yzkybuqEC2HSQwpA0An7d9+73BkDUTm30bZmoP/RGbgFN+GrCOfADgqr0WbI1a1okpFms8iHYw9hm0zUvlEMivBRxModrbJJ+9/p3jUdQQ9BCtQdxnOGrT5dzRUmw0593/mbRSdBg0nRvRZM5/E16m7ZHmDEtWhwvfdZCZ8J8M12W0yRMszXamWfQTwIZ4ayYktrnscQuWr8idp3PjT2eF/jmtdhIfcpMnb+IfZY2FebW6UY/AK3jP4u3Tu4zE4qlnQgLFbM19EBIsNf7KhjdbqQ/D6yiDb+NlEi2SKD+ivXVUK8ib0oBo366gXkR8ZxGjpJIDcEgZPa9TcYe0TIbiPl/rPUQDu3XBJ9X/GNq3FAUsKsll57DzaGMrjcT+gctp+9MLYXCq+sqP81eVQ0r9lt+gcQfZbACRbEjvlMskztZG8gbC8Qn9tt26Q7y7nDrbZq/LEz7kR6Jc6pg3N9rVX8Y5MJrGlML9p9lU4jbTkKqCveeZUJjHB03m2KRKR2TytoFkTXOLg7keU1s1lrPMQJpoOKLuAAC+y1HlJucU6ysB5hsXhvSPPLq5J7JtnqHKZ4vYjC4Vy8153QY+6780xDuGARsGbOs1WqzH0QS765rnSKEbbKlkO8oI/VDwUd0is13tKpqILu1mDJFNy/iJAWcvDgjxvusIT+PGz3ST/J9r9Mtfd0jpaGeiLYIqXc7DiHSS8TcjFVksi66PEkxW1z6ujbLLUGNNYnzOWpH8BZGK4bCK7iR+MbIv8ncDAz1u4StN3vTTzewr9IQjk9wxFxn+6N1ddKs0vffJiS08N3a4G1SVrlZ97Q/M+8G9fe5AP6d9/Qq4WRnORVhofPIKEdCr3llspUfE0oKIIYoByBRPh+bX1HLS3JWGJRhIvE1aW4NTd8ePi4Z+kXb+Z8snYfSNcqijhAgVsx4RCM54cXUiYkjeBmmC4ajOHrChoELscJJC7+9jjMjw5BagZKlgRMiSNYz7h7vvZIoQqbtQmspc0cUk1G/73iXtSpROl5wtLgQi0mW2Ex8i3WULhcggx6E1LMVHUsdc9GHI1PH3U2Ko0PyGdn9KdVOLm7FPBui0i9a0HpA60MsewVE4z8CAt5d401Gv6zXlIT5Ybit1VIA0FCs7wtvYreru1fUyW3oLAZ/+aTnZrOcYRNVA8spoRtlRoWflsRClFcgzkqiHOrf0/SVw+EpVaFlJ0g4Kxq1MMOmiQdpMNpte8lMMQqm6cIFXlnGbfJllysKDi+0JJMotkqgIxOSQgU9dn/lWkeVf8nUm3iwX2Nl3WDw9i6AUK3vBAbZZrcJpDQ/N64AVwjT07Jef30GSSmtNu2WlW7YoyW2FlWfZFQUwk867EdLYKk9VG6JgEnBiBxkY7LMo4YLQJJlAo9l/oTvJkSARDF/XtyAzM8O2t3eT/iXa6wDN3WewNmQHdPfsxChU/KtLG2Mn8i4ZqKdSlIaBZadxJmRzVS/o4yA65RTSViq60oa395Lqw0pzY4SipwE0SXXsKV+GZraGSkr/RW08wPRvqvSUkYBMA9lPx4m24az+IHmCbXA+0faxTRE9wuGeO06DIXa6QlKJ3puIyiuAVfPr736vzo2pBirS+Vxel3TMm3JKhz9o2ZoRvaFVpIkykb0Hcm4oHFBMcNSNj7/4GJt43ogonY2Vg4nsDQIWxAcorpXACzgBqQPjYsE/VUpXpwNManEru4NwMCFPkXvMoqvoeLN3qyu/N1eWEHttMD65v19l/0kH2mR35iv/FI+yjoHJ9gPMz67af3Mq/BoWXqu3rphiWMXVkmnPSEkpGpUI2h1MThideGFEOK6YZHPwYzMBvpNC7+ZHxPb7epfefGyIB4JzO9DTNEYnDLVVHdQyvOEVefrk6Uv5kTQYVYWWdqrdcIl7yljwwIWdfQ/y+2QB3eR/qxYObuYyB4gTbo2in4PzarU1sO9nETkmj9/AoxDA+JM3GMqQtJR4jtduHtnoCLxd1gQUscHRB/MoRYIEsP2pDZ9KvHgtlk1iTbWWbHhohwFEYX7y51fUV2nuUmnoUcqnWIQAAgl9LTVX+Bc0QGNEhChxHR4YjfE51PUdGfsSFE6ck7BL3/hTf9jLq4G1IafINxOLKeAtO7quulYvH5YOBc+zX7CrMgWnW47/jfRsWnJjYYoE7xMfWV2HN2iyIqLI";const wY=new Map([[8217,"apostrophe"],[8260,"fraction slash"],[12539,"middle dot"]]),bY=4;function EY(e){return function(e){let t=0;return()=>e[t++]}(function(e){let t=0;function n(){return e[t++]<<8|e[t++]}let r=n(),i=1,o=[0,1];for(let b=1;b<r;b++)o.push(i+=n());let s=n(),a=t;t+=s;let c=0,l=0;function u(){return 0==c&&(l=l<<8|e[t++],c=8),l>>--c&1}const d=2**31,h=d>>>1,f=h>>1,p=d-1;let g=0;for(let b=0;b<31;b++)g=g<<1|u();let m=[],v=0,y=d;for(;;){let e=Math.floor(((g-v+1)*i-1)/y),t=0,n=r;for(;n-t>1;){let r=t+n>>>1;e<o[r]?n=r:t=r}if(0==t)break;m.push(t);let s=v+Math.floor(y*o[t]/i),a=v+Math.floor(y*o[t+1]/i)-1;for(;0==((s^a)&h);)g=g<<1&p|u(),s=s<<1&p,a=a<<1&p|1;for(;s&~a&f;)g=g&h|g<<1&p>>>1|u(),s=s<<1^h,a=(a^h)<<1|h|1;v=s,y=1+a-s}let w=r-4;return m.map((t=>{switch(t-w){case 3:return w+65792+(e[a++]<<16|e[a++]<<8|e[a++]);case 2:return w+256+(e[a++]<<8|e[a++]);case 1:return w+e[a++];default:return t-1}}))}(function(e){let t=[];[..."ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"].forEach(((e,n)=>t[e.charCodeAt(0)]=n));let n=e.length,r=new Uint8Array(6*n>>3);for(let i=0,o=0,s=0,a=0;i<n;i++)a=a<<6|t[e.charCodeAt(i)],s+=6,s>=8&&(r[o++]=a>>(s-=8));return r}(e)))}function kY(e){return 1&e?~e>>1:e>>1}function AY(e,t){let n=Array(e);for(let r=0,i=0;r<e;r++)n[r]=i+=kY(t());return n}function SY(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=[];for(;;){let r=e(),i=e();if(!i)break;t+=r;for(let e=0;e<i;e++)n.push(t+e);t+=i+1}return n}function xY(e){return IY((()=>{let t=SY(e);if(t.length)return t}))}function _Y(e){let t=[];for(;;){let n=e();if(0==n)break;t.push(CY(n,e))}for(;;){let n=e()-1;if(n<0)break;t.push(TY(n,e))}return t.flat()}function IY(e){let t=[];for(;;){let n=e(t.length);if(!n)break;t.push(n)}return t}function RY(e,t,n){let r=Array(e).fill().map((()=>[]));for(let i=0;i<t;i++)AY(e,n).forEach(((e,t)=>r[t].push(e)));return r}function CY(e,t){let n=1+t(),r=t(),i=IY(t);return RY(i.length,1+e,t).flatMap(((e,t)=>{let[o,...s]=e;return Array(i[t]).fill().map(((e,t)=>{let i=t*r;return[o+t*n,s.map((e=>e+i))]}))}))}function TY(e,t){return RY(1+t(),1+e,t).map((e=>[e[0],e.slice(1)]))}function PY(e){return"{".concat(function(e){return e.toString(16).toUpperCase().padStart(2,"0")}(e),"}")}function NY(e){let t=[];for(let n=0,r=e.length;n<r;){let r=e.codePointAt(n);n+=r<65536?1:2,t.push(r)}return t}function BY(e){let t=e.length;if(t<4096)return String.fromCodePoint(...e);let n=[];for(let r=0;r<t;)n.push(String.fromCodePoint(...e.slice(r,r+=4096)));return n.join("")}function DY(e,t){let n=e.length,r=n-t.length;for(let i=0;0==r&&i<n;i++)r=e[i]-t[i];return r}var OY="AEUDTAHBCFQATQDRADAAcgAgADQAFAAsABQAHwAOACQADQARAAoAFwAHABIACAAPAAUACwAFAAwABAAQAAMABwAEAAoABQAIAAIACgABAAQAFAALAAIACwABAAIAAQAHAAMAAwAEAAsADAAMAAwACgANAA0AAwAKAAkABAAdAAYAZwDSAdsDJgC0CkMB8xhZAqfoC190UGcThgBurwf7PT09Pb09AjgJum8OjDllxHYUKXAPxzq6tABAxgK8ysUvWAgMPT09PT09PSs6LT2HcgWXWwFLoSMEEEl5RFVMKvO0XQ8ExDdJMnIgsj26PTQyy8FfEQ8AY8IPAGcEbwRwBHEEcgRzBHQEdQR2BHcEeAR6BHsEfAR+BIAEgfndBQoBYgULAWIFDAFiBNcE2ATZBRAFEQUvBdALFAsVDPcNBw13DYcOMA4xDjMB4BllHI0B2grbAMDpHLkQ7QHVAPRNQQFnGRUEg0yEB2uaJF8AJpIBpob5AERSMAKNoAXqaQLUBMCzEiACnwRZEkkVsS7tANAsBG0RuAQLEPABv9HICTUBXigPZwRBApMDOwAamhtaABqEAY8KvKx3LQ4ArAB8UhwEBAVSagD8AEFZADkBIadVj2UMUgx5Il4ANQC9AxIB1BlbEPMAs30CGxlXAhwZKQIECBc6EbsCoxngzv7UzRQA8M0BawL6ZwkN7wABAD33OQRcsgLJCjMCjqUChtw/km+NAsXPAoP2BT84PwURAK0RAvptb6cApQS/OMMey5HJS84UdxpxTPkCogVFITaTOwERAK5pAvkNBOVyA7q3BKlOJSALAgUIBRcEdASpBXqzABXFSWZOawLCOqw//AolCZdvv3dSBkEQGyelEPcMMwG1ATsN7UvYBPEGOwTJH30ZGQ/NlZwIpS3dDO0m4y6hgFoj9SqDBe1L9DzdC01RaA9ZC2UJ4zpjgU4DIQENIosK3Q05CG0Q8wrJaw3lEUUHOQPVSZoApQcBCxEdNRW1JhBirAsJOXcG+xr2C48mrxMpevwF0xohBk0BKRr/AM8u54WwWjFcHE9fBgMLJSPHFKhQIA0lQLd4SBobBxUlqQKRQ3BKh1E2HpMh9jw9DWYuE1F8B/U8BRlPC4E8nkarRQ4R0j6NPUgiSUwsBDV/LC8niwnPD4UMuXxyAVkJIQmxDHETMREXN8UIOQcZLZckJxUIIUaVYJoE958D8xPRAwsFPwlBBxMDtRwtEy4VKQUNgSTXAvM21S6zAo9WgAEXBcsPJR/fEFBH4A7pCJsCZQODJesALRUhABcimwhDYwBfj9hTBS7LCMdqbCN0A2cU52ERcweRDlcHpxwzFb8c4XDIXguGCCijrwlbAXUJmQFfBOMICTVbjKAgQWdTi1gYmyBhQT9d/AIxDGUVn0S9h3gCiw9rEhsBNQFzBzkNAQJ3Ee0RaxCVCOuGBDW1M/g6JQRPIYMgEQonA09szgsnJvkM+GkBoxJiAww0PXfuZ6tgtiQX/QcZMsVBYCHxC5JPzQycGsEYQlQuGeQHvwPzGvMn6kFXBf8DowMTOk0z7gS9C2kIiwk/AEkOoxcH1xhqCnGM0AExiwG3mQNXkYMCb48GNwcLAGcLhwV55QAdAqcIowAFAM8DVwA5Aq0HnQAZAIVBAT0DJy8BIeUCjwOTCDHLAZUvAfMpBBvDDBUA9zduSgLDsQKAamaiBd1YAo4CSTUBTSUEBU5HUQOvceEA2wBLBhPfRwEVq0rLGuNDAd9vKwDHAPsABTUHBUEBzQHzbQC3AV8LMQmis7UBTekpAIMAFWsB1wKJAN0ANQB/8QFTAE0FWfkF0wJPSQERMRgrV2EBuwMfATMBDQB5BsuNpckHHwRtB9MCEBsV4QLvLge1AQMi3xPNQsUCvd5VoWACZIECYkJbTa9bNyACofcCaJgCZgkCn4Q4GwsCZjsCZiYEbgR/A38TA36SOQY5dxc5gjojIwJsHQIyNjgKAm3HAm2u74ozZ0UrAWcA3gDhAEoFB5gMjQD+C8IADbUCdy8CdqI/AnlLQwJ4uh1c20WuRtcCfD8CesgCfQkCfPAFWQUgSABIfWMkAoFtAoAAAoAFAn+uSVhKWxUXSswC0QEC0MxLJwOITwOH5kTFkTIC8qFdAwMDrkvOTC0lA89NTE2vAos/AorYwRsHHUNnBbcCjjcCjlxAl4ECjtkCjlx4UbRTNQpS1FSFApP7ApMMAOkAHFUeVa9V0AYsGymVhjLheGZFOzkCl58C77JYIagAWSUClo8ClnycAKlZrFoJgU0AOwKWtQKWTlxEXNECmcsCmWRcyl0HGQKcmznCOp0CnBYCn5sCnriKAB0PMSoPAp3xAp6SALU9YTRh7wKe0wKgbgGpAp6fHwKeTqVjyGQnJSsCJ68CJn4CoPsCoEwCot0CocQCpi8Cpc4Cp/8AfQKn8mh8aLEAA0lqHGrRAqzjAqyuAq1nAq0CAlcdAlXcArHh1wMfTmyXArK9DQKy6Bds4G1jbUhfAyXNArZcOz9ukAMpRQK4XgK5RxUCuSp3cDZw4QK9GQK72nCWAzIRAr6IcgIDM3ECvhpzInNPAsPLAsMEc4J0SzVFdOADPKcDPJoDPb8CxXwCxkcCxhCJAshpUQLIRALJTwLJLgJknQLd0nh5YXiueSVL0AMYo2cCAmH0GfOVJHsLXpJeuxECz2sCz2wvS1PS8xOfAMatAs9zASnqA04SfksFAtwnAtuKAtJPA1JcA1NfAQEDVYyAiT8AyxbtYEWCHILTgs6DjQLaxwLZ3oQQhEmnPAOGpQAvA2QOhnFZ+QBVAt9lAt64c3cC4i/tFAHzMCcB9JsB8tKHAuvzAulweQLq+QLq5AD5RwG5Au6JAuuclqqXAwLuPwOF4Jh5cOBxoQLzAwBpA44WmZMC9xMDkW4DkocC95gC+dkC+GaaHJqruzebHgOdgwL++gEbADmfHJ+zAwWNA6ZqA6bZANHFAwZqoYiiBQkDDEkCwAA/AwDhQRdTARHzA2sHl2cFAJMtK7evvdsBiZkUfxEEOQH7KQUhDp0JnwCS/SlXxQL3AZ0AtwW5AG8LbUEuFCaNLgFDAYD8AbUmAHUDDgRtACwCFgyhAAAKAj0CagPdA34EkQEgRQUhfAoABQBEABMANhICdwEABdUDa+8KxQIA9wqfJ7+xt+UBkSFBQgHpFH8RNMCJAAQAGwBaAkUChIsABjpTOpSNbQC4Oo860ACNOME63AClAOgAywE6gTo7Ofw5+Tt2iTpbO56JOm85GAFWATMBbAUvNV01njWtNWY1dTW2NcU1gjWRNdI14TWeNa017jX9NbI1wTYCNhE1xjXVNhY2JzXeNe02LjY9Ni41LSE2OjY9Njw2yTcIBJA8VzY4Nt03IDcPNsogN4k3MAoEsDxnNiQ3GTdsOo03IULUQwdC4EMLHA8PCZsobShRVQYA6X8A6bABFCnXAukBowC9BbcAbwNzBL8MDAMMAQgDAAkKCwsLCQoGBAVVBI/DvwDz9b29kaUCb0QtsRTNLt4eGBcSHAMZFhYZEhYEARAEBUEcQRxBHEEcQRxBHEEaQRxBHEFCSTxBPElISUhBNkM2QTYbNklISVmBVIgBFLWZAu0BhQCjBcEAbykBvwGJAaQcEZ0ePCklMAAhMvAIMAL54gC7Bm8EescjzQMpARQpKgDUABavAj626xQAJP0A3etzuf4NNRA7efy2Z9NQrCnC0OSyANz5BBIbJ5IFDR6miIavYS6tprjjmuKebxm5C74Q225X1pkaYYPb6f1DK4k3xMEBb9S2WMjEibTNWhsRJIA+vwNVEiXTE5iXs/wezV66oFLfp9NZGYW+Gk19J2+bCT6Ye2w6LDYdgzKMUabk595eLBCXANz9HUpWbATq9vqXVx9XDg+Pc9Xp4+bsS005SVM/BJBM4687WUuf+Uj9dEi8aDNaPxtpbDxcG1THTImUMZq4UCaaNYpsVqraNyKLJXDYsFZ/5jl7bLRtO88t7P3xZaAxhb5OdPMXqsSkp1WCieG8jXm1U99+blvLlXzPCS+M93VnJCiK+09LfaSaBAVBomyDgJua8dfUzR7ga34IvR2Nvj+A9heJ6lsl1KG4NkI1032Cnff1m1wof2B9oHJK4bi6JkEdSqeNeiuo6QoZZincoc73/TH9SXF8sCE7XyuYyW8WSgbGFCjPV0ihLKhdPs08Tx82fYAkLLc4I2wdl4apY7GU5lHRFzRWJep7Ww3wbeA3qmd59/86P4xuNaqDpygXt6M85glSBHOCGgJDnt+pN9bK7HApMguX6+06RZNjzVmcZJ+wcUrJ9//bpRNxNuKpNl9uFds+S9tdx7LaM5ZkIrPj6nIU9mnbFtVbs9s/uLgl8MVczAwet+iOEzzBlYW7RCMgE6gyNLeq6+1tIx4dpgZnd0DksJS5f+JNDpwwcPNXaaVspq1fbQajOrJgK0ofKtJ1Ne90L6VO4MOl5S886p7u6xo7OLjG8TGL+HU1JXGJgppg4nNbNJ5nlzSpuPYy21JUEcUA94PoFiZfjZue+QnyQ80ekOuZVkxx4g+cvhJfHgNl4hy1/a6+RKcKlar/J29y//EztlbVPHVUeQ1zX86eQVAjR/M3dA9w4W8LfaXp4EgM85wOWasli837PzVMOnsLzR+k3o75/lRPAJSE1xAKQzEi5v10ke+VBvRt1cwQRMd+U5mLCTGVd6XiZtgBG5cDi0w22GKcVNvHiu5LQbZEDVtz0onn7k5+heuKXVsZtSzilkLRAUmjMXEMB3J9YC50XBxPiz53SC+EhnPl9WsKCv92SM/OFFIMJZYfl0WW8tIO3UxYcwdMAj7FSmgrsZ2aAZO03BOhP1bNNZItyXYQFTpC3SG1VuPDqH9GkiCDmE+JwxyIVSO5siDErAOpEXFgjy6PQtOVDj+s6e1r8heWVvmZnTciuf4EiNZzCAd7SOMhXERIOlsHIMG399i9aLTy3m2hRLZjJVDNLS53iGIK11dPqQt0zBDyg6qc7YqkDm2M5Ve6dCWCaCbTXX2rToaIgz6+zh4lYUi/+6nqcFMAkQJKHYLK0wYk5N9szV6xihDbDDFr45lN1K4aCXBq/FitPSud9gLt5ZVn+ZqGX7cwm2z5EGMgfFpIFyhGGuDPmso6TItTMwny+7uPnLCf4W6goFQFV0oQSsc9VfMmVLcLr6ZetDZbaSFTLqnSO/bIPjA3/zAUoqgGFAEQS4IhuMzEp2I3jJzbzkk/IEmyax+rhZTwd6f+CGtwPixu8IvzACquPWPREu9ZvGkUzpRwvRRuaNN6cr0W1wWits9ICdYJ7ltbgMiSL3sTPeufgNcVqMVWFkCPDH4jG2jA0XcVgQj62Cb29v9f/z/+2KbYvIv/zzjpQAPkliaVDzNrW57TZ/ZOyZD0nlfMmAIBIAGAI0D3k/mdN4xr9v85ZbZbbqfH2jGd5hUqNZWwl5SPfoGmfElmazUIeNL1j/mkF7VNAzTq4jNt8JoQ11NQOcmhprXoxSxfRGJ9LDEOAQ+dmxAQH90iti9e2u/MoeuaGcDTHoC+xsmEeWmxEKefQuIzHbpw5Tc5cEocboAD09oipWQhtTO1wivf/O+DRe2rpl/E9wlrzBorjJsOeG1B/XPW4EaJEFdNlECEZga5ZoGRHXgYouGRuVkm8tDESiEyFNo+3s5M5puSdTyUL2llnINVHEt91XUNW4ewdMgJ4boJfEyt/iY5WXqbA+A2Fkt5Z0lutiWhe9nZIyIUjyXDC3UsaG1t+eNx6z4W/OYoTB7A6x+dNSTOi9AInctbESqm5gvOLww7OWXPrmHwVZasrl4eD113pm+JtT7JVOvnCXqdzzdTRHgJ0PiGTFYW5Gvt9R9LD6Lzfs0v/TZZHSmyVNq7viIHE6DBK7Qp07Iz55EM8SYtQvZf/obBniTWi5C2/ovHfw4VndkE5XYdjOhCMRjDeOEfXeN/CwfGduiUIfsoFeUxXeQXba7c7972XNv8w+dTjjUM0QeNAReW+J014dKAD/McQYXT7c0GQPIkn3Ll6R7gGjuiQoZD0TEeEqQpKoZ15g/0OPQI17QiSv9AUROa/V/TQN3dvLArec3RrsYlvBm1b8LWzltdugsC50lNKYLEp2a+ZZYqPejULRlOJh5zj/LVMyTDvwKhMxxwuDkxJ1QpoNI0OTWLom4Z71SNzI9TV1iXJrIu9Wcnd+MCaAw8o1jSXd94YU/1gnkrC9BUEOtQvEIQ7g0i6h+KL2JKk8Ydl7HruvgWMSAmNe+LshGhV4qnWHhO9/RIPQzY1tHRj2VqOyNsDpK0cww+56AdDC4gsWwY0XxoucIWIqs/GcwnWqlaT0KPr8mbK5U94/301i1WLt4YINTVvCFBrFZbIbY8eycOdeJ2teD5IfPLCRg7jjcFTwlMFNl9zdh/o3E/hHPwj7BWg0MU09pPrBLbrCgm54A6H+I6v27+jL5gkjWg/iYdks9jbfVP5y/n0dlgWEMlKasl7JvFZd56LfybW1eeaVO0gxTfXZwD8G4SI116yx7UKVRgui6Ya1YpixqXeNLc8IxtAwCU5IhwQgn+NqHnRaDv61CxKhOq4pOX7M6pkA+Pmpd4j1vn6ACUALoLLc4vpXci8VidLxzm7qFBe7s+quuJs6ETYmnpgS3LwSZxPIltgBDXz8M1k/W2ySNv2f9/NPhxLGK2D21dkHeSGmenRT3Yqcdl0m/h3OYr8V+lXNYGf8aCCpd4bWjE4QIPj7vUKN4Nrfs7ML6Y2OyS830JCnofg/k7lpFpt4SqZc5HGg1HCOrHvOdC8bP6FGDbE/VV0mX4IakzbdS/op+Kt3G24/8QbBV7y86sGSQ/vZzU8FXs7u6jIvwchsEP2BpIhW3G8uWNwa3HmjfH/ZjhhCWvluAcF+nMf14ClKg5hGgtPLJ98ueNAkc5Hs2WZlk2QHvfreCK1CCGO6nMZVSb99VM/ajr8WHTte9JSmkXq/i/U943HEbdzW6Re/S88dKgg8pGOLlAeNiqrcLkUR3/aClFpMXcOUP3rmETcWSfMXZE3TUOi8i+fqRnTYLflVx/Vb/6GJ7eIRZUA6k3RYR3iFSK9c4iDdNwJuZL2FKz/IK5VimcNWEqdXjSoxSgmF0UPlDoUlNrPcM7ftmA8Y9gKiqKEHuWN+AZRIwtVSxye2Kf8rM3lhJ5XcBXU9n4v0Oy1RU2M+4qM8AQPVwse8ErNSob5oFPWxuqZnVzo1qB/IBxkM3EVUKFUUlO3e51259GgNcJbCmlvrdjtoTW7rChm1wyCKzpCTwozUUEOIcWLneRLgMXh+SjGSFkAllzbGS5HK7LlfCMRNRDSvbQPjcXaenNYxCvu2Qyznz6StuxVj66SgI0T8B6/sfHAJYZaZ78thjOSIFumNWLQbeZixDCCC+v0YBtkxiBB3jefHqZ/dFHU+crbj6OvS1x/JDD7vlm7zOVPwpUC01nhxZuY/63E7g";const LY=44032,MY=4352,FY=4449,UY=4519,jY=28,HY=21*jY,zY=LY+19*HY,VY=MY+19,qY=FY+21,GY=UY+jY;function KY(e){return e>>24&255}function WY(e){return 16777215&e}let QY,YY,ZY,JY;function XY(e){return e>=LY&&e<zY}function $Y(e,t){if(e>=MY&&e<VY&&t>=FY&&t<qY)return LY+(e-MY)*HY+(t-FY)*jY;if(XY(e)&&t>UY&&t<GY&&(e-LY)%jY==0)return e+(t-UY);{let n=JY.get(e);return n&&(n=n.get(t),n)?n:-1}}function eZ(e){QY||function(){let e=EY(OY);QY=new Map(xY(e).flatMap(((e,t)=>e.map((e=>[e,t+1<<24]))))),YY=new Set(SY(e)),ZY=new Map,JY=new Map;for(let[t,n]of _Y(e)){if(!YY.has(t)&&2==n.length){let[e,r]=n,i=JY.get(e);i||(i=new Map,JY.set(e,i)),i.set(r,t)}ZY.set(t,n.reverse())}}();let t=[],n=[],r=!1;function i(e){let n=QY.get(e);n&&(r=!0,e|=n),t.push(e)}for(let o of e)for(;;){if(o<128)t.push(o);else if(XY(o)){let e=o-LY,t=e%HY/jY|0,n=e%jY;i(MY+(e/HY|0)),i(FY+t),n>0&&i(UY+n)}else{let e=ZY.get(o);e?n.push(...e):i(o)}if(!n.length)break;o=n.pop()}if(r&&t.length>1){let e=KY(t[0]);for(let n=1;n<t.length;n++){let r=KY(t[n]);if(0==r||e<=r){e=r;continue}let i=n-1;for(;;){let n=t[i+1];if(t[i+1]=t[i],t[i]=n,!i)break;if(e=KY(t[--i]),e<=r)break}e=KY(t[n])}}return t}function tZ(e){return eZ(e).map(WY)}function nZ(e){return function(e){let t=[],n=[],r=-1,i=0;for(let o of e){let e=KY(o),s=WY(o);if(-1==r)0==e?r=s:t.push(s);else if(i>0&&i>=e)0==e?(t.push(r,...n),n.length=0,r=s):n.push(s),i=e;else{let o=$Y(r,s);o>=0?r=o:0==i&&0==e?(t.push(r),r=s):(n.push(s),i=e)}}return r>=0&&t.push(r,...n),t}(eZ(e))}const rZ=45,iZ=".",oZ=65039,sZ=1,aZ=e=>Array.from(e);function cZ(e,t){return e.P.has(t)||e.Q.has(t)}class lZ extends Array{get is_emoji(){return!0}}let uZ,dZ,hZ,fZ,pZ,gZ,mZ,vZ,yZ,wZ,bZ,EZ;function kZ(){if(uZ)return;let e=EY(yY);const t=()=>SY(e),n=()=>new Set(t()),r=(e,t)=>t.forEach((t=>e.add(t)));uZ=new Map(_Y(e)),dZ=n(),hZ=t(),fZ=new Set(t().map((e=>hZ[e]))),hZ=new Set(hZ),pZ=n(),gZ=n();let i=xY(e),o=e();const s=()=>{let e=new Set;return t().forEach((t=>r(e,i[t]))),r(e,t()),e};mZ=IY((t=>{let n=IY(e).map((e=>e+96));if(n.length){let r=t>=o;return n[0]-=32,n=BY(n),r&&(n="Restricted[".concat(n,"]")),{N:n,P:s(),Q:s(),M:!e(),R:r}}})),vZ=n(),yZ=new Map;let a=t().concat(aZ(vZ)).sort(((e,t)=>e-t));a.forEach(((t,n)=>{let r=e(),i=a[n]=r?a[n-r]:{V:[],M:new Map};i.V.push(t),vZ.has(t)||yZ.set(t,i)}));for(let{V:u,M:d}of new Set(yZ.values())){let e=[];for(let n of u){let t=mZ.filter((e=>cZ(e,n))),i=e.find((e=>{let{G:n}=e;return t.some((e=>n.has(e)))}));i||(i={G:new Set,V:[]},e.push(i)),i.V.push(n),r(i.G,t)}let t=e.flatMap((e=>aZ(e.G)));for(let{G:n,V:r}of e){let e=new Set(t.filter((e=>!n.has(e))));for(let t of r)d.set(t,e)}}wZ=new Set;let c=new Set;const l=e=>wZ.has(e)?c.add(e):wZ.add(e);for(let u of mZ){for(let e of u.P)l(e);for(let e of u.Q)l(e)}for(let u of wZ)yZ.has(u)||c.has(u)||yZ.set(u,sZ);r(wZ,tZ(wZ)),bZ=function(e){let t=[],n=SY(e);return function e(n,r,i){let{S:o,B:s}=n;if(!(4&o&&i===r[r.length-1])){2&o&&(i=r[r.length-1]),1&o&&t.push(r);for(let t of s)for(let n of t.Q)e(t,[...r,n],i)}}(function t(r){return{S:e(),B:IY((()=>{let r=SY(e).map((e=>n[e]));if(r.length)return t(r)})),Q:r}}([]),[]),t}(e).map((e=>lZ.from(e))).sort(DY),EZ=new Map;for(let u of bZ){let e=[EZ];for(let t of u){let n=e.map((e=>{let n=e.get(t);return n||(n=new Map,e.set(t,n)),n}));t===oZ?e.push(...n):e=n}for(let t of e)t.V=u}}function AZ(e){return(_Z(e)?"":"".concat(SZ(xZ([e]))," "))+PY(e)}function SZ(e){return'"'.concat(e,'"\u200e')}function xZ(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:PY,r=[];(function(e){return kZ(),hZ.has(e)})(e[0])&&r.push("\u25cc"),e.length>t&&(t>>=1,e=[...e.slice(0,t),8230,...e.slice(-t)]);let i=0,o=e.length;for(let s=0;s<o;s++){let t=e[s];_Z(t)&&(r.push(BY(e.slice(i,s))),r.push(n(t)),i=s+1)}return r.push(BY(e.slice(i,o))),r.join("")}function _Z(e){return kZ(),pZ.has(e)}function IZ(e,t,n){if(!e)return[];kZ();let r=0;return e.split(iZ).map((e=>{let i=NY(e),o={input:i,offset:r};r+=i.length+1;try{let e,r=o.tokens=NZ(i,t,n),s=r.length;if(!s)throw new Error("empty label");let a=o.output=r.flat();if(function(e){for(let t=e.lastIndexOf(95);t>0;)if(95!==e[--t])throw new Error("underscore allowed only at start")}(a),!(o.emoji=s>1||r[0].is_emoji)&&a.every((e=>e<128)))!function(e){if(e.length>=4&&e[2]==rZ&&e[3]==rZ)throw new Error('invalid label extension: "'.concat(BY(e.slice(0,4)),'"'))}(a),e="ASCII";else{let t=r.flatMap((e=>e.is_emoji?[]:e));if(t.length){if(hZ.has(a[0]))throw PZ("leading combining mark");for(let e=1;e<s;e++){let t=r[e];if(!t.is_emoji&&hZ.has(t[0]))throw PZ('emoji + combining mark: "'.concat(BY(r[e-1])," + ").concat(xZ([t[0]]),'"'))}!function(e){let t=e[0],n=wY.get(t);if(n)throw PZ("leading ".concat(n));let r=e.length,i=-1;for(let o=1;o<r;o++){t=e[o];let r=wY.get(t);if(r){if(i==o)throw PZ("".concat(n," + ").concat(r));i=o+1,n=r}}if(i==r)throw PZ("trailing ".concat(n))}(a);let n=aZ(new Set(t)),[i]=function(e){let t=mZ;for(let n of e){let e=t.filter((e=>cZ(e,n)));if(!e.length)throw mZ.some((e=>cZ(e,n)))?TZ(t[0],n):CZ(n);if(t=e,1==e.length)break}return t}(n);!function(e,t){for(let n of t)if(!cZ(e,n))throw TZ(e,n);if(e.M){let e=tZ(t);for(let t=1,n=e.length;t<n;t++)if(fZ.has(e[t])){let r=t+1;for(let i;r<n&&fZ.has(i=e[r]);r++)for(let n=t;n<r;n++)if(e[n]==i)throw new Error("duplicate non-spacing marks: ".concat(AZ(i)));if(r-t>bY)throw new Error("excessive non-spacing marks: ".concat(SZ(xZ(e.slice(t-1,r)))," (").concat(r-t,"/").concat(bY,")"));t=r}}}(i,t),function(e,t){let n,r=[];for(let i of t){let e=yZ.get(i);if(e===sZ)return;if(e){let t=e.M.get(i);if(n=n?n.filter((e=>t.has(e))):aZ(t),!n.length)return}else r.push(i)}if(n)for(let i of n)if(r.every((e=>cZ(i,e))))throw new Error("whole-script confusable: ".concat(e.N,"/").concat(i.N))}(i,n),e=i.N}else e="Emoji"}o.type=e}catch(s){o.error=s}return o}))}function RZ(e){return e.map((t=>{let{input:n,error:r,output:i}=t;if(r){let t=r.message;throw new Error(1==e.length?t:"Invalid label ".concat(SZ(xZ(n,63)),": ").concat(t))}return BY(i)})).join(iZ)}function CZ(e){return new Error("disallowed character: ".concat(AZ(e)))}function TZ(e,t){let n=AZ(t),r=mZ.find((e=>e.P.has(t)));return r&&(n="".concat(r.N," ").concat(n)),new Error("illegal mixture: ".concat(e.N," + ").concat(n))}function PZ(e){return new Error("illegal placement: ".concat(e))}function NZ(e,t,n){let r=[],i=[];for(e=e.slice().reverse();e.length;){let o=DZ(e);if(o)i.length&&(r.push(t(i)),i=[]),r.push(n(o));else{let t=e.pop();if(wZ.has(t))i.push(t);else{let e=uZ.get(t);if(e)i.push(...e);else if(!dZ.has(t))throw CZ(t)}}}return i.length&&r.push(t(i)),r}function BZ(e){return e.filter((e=>e!=oZ))}function DZ(e,t){let n,r=EZ,i=e.length;for(;i&&(r=r.get(e[--i]),r);){let{V:o}=r;o&&(n=o,t&&t.push(...e.slice(i).reverse()),e.length=i)}return n}const OZ=e=>function(e){return RZ(IZ(e,nZ,BZ))}(e),LZ=e=>{let t="";for(let n=0;n<32;n+=1)t+="00";if(e){const n=OZ(e).split(".");for(let e=n.length-1;e>=0;e-=1){const r=Fz(n[e]).slice(2);t=Fz("0x".concat(t).concat(r)).slice(2)}}return"0x".concat(t)};var MZ=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(BJ){o(BJ)}}function a(e){try{c(r.throw(e))}catch(BJ){o(BJ)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};class FZ{constructor(e,t){this.contract=new oY(mY,null!==t&&void 0!==t?t:pY.main,e),this.context=e}getOwner(e){return MZ(this,void 0,void 0,(function*(){try{return this.contract.methods.owner(LZ(e)).call()}catch(t){throw new Error}}))}getTTL(e){return MZ(this,void 0,void 0,(function*(){try{return this.contract.methods.ttl(LZ(e)).call()}catch(t){throw new Error}}))}recordExists(e){return MZ(this,void 0,void 0,(function*(){try{return this.contract.methods.recordExists(LZ(e)).call()}catch(t){throw new Error}}))}getResolver(e){return MZ(this,void 0,void 0,(function*(){try{return this.contract.methods.resolver(LZ(e)).call().then((e=>{if("string"===typeof e){return new oY(vY,e,this.context)}throw new Error}))}catch(t){throw new Error}}))}get events(){return this.contract.events}}var UZ=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(BJ){o(BJ)}}function a(e){try{c(r.throw(e))}catch(BJ){o(BJ)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};class jZ{constructor(e){this.registry=e}getResolverContractAdapter(e){return UZ(this,void 0,void 0,(function*(){return this.registry.getResolver(e)}))}checkInterfaceSupport(e,t){var n,r;return UZ(this,void 0,void 0,(function*(){if(Ez(aY[t]))throw new fL(null!==(n=e.options.address)&&void 0!==n?n:"",t);if(!(yield e.methods.supportsInterface(aY[t]).call()))throw new fL(null!==(r=e.options.address)&&void 0!==r?r:"",t)}))}supportsInterface(e,t){var n;return UZ(this,void 0,void 0,(function*(){const r=yield this.getResolverContractAdapter(e);let i=t;if(!Tj(i)){if(i=null!==(n=Mz(t))&&void 0!==n?n:"",""===t)throw new Error("Invalid interface Id");i=i.slice(0,10)}return r.methods.supportsInterface(i).call()}))}getAddress(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:60;return UZ(this,void 0,void 0,(function*(){const n=yield this.getResolverContractAdapter(e);return yield this.checkInterfaceSupport(n,lY),n.methods.addr(LZ(e),t).call()}))}getPubkey(e){return UZ(this,void 0,void 0,(function*(){const t=yield this.getResolverContractAdapter(e);return yield this.checkInterfaceSupport(t,uY),t.methods.pubkey(LZ(e)).call()}))}getContenthash(e){return UZ(this,void 0,void 0,(function*(){const t=yield this.getResolverContractAdapter(e);return yield this.checkInterfaceSupport(t,dY),t.methods.contenthash(LZ(e)).call()}))}setAddress(e,t,n){return UZ(this,void 0,void 0,(function*(){const r=yield this.getResolverContractAdapter(e);return yield this.checkInterfaceSupport(r,cY),r.methods.setAddr(LZ(e),t).send(n)}))}getText(e,t){return UZ(this,void 0,void 0,(function*(){const n=yield this.getResolverContractAdapter(e);return yield this.checkInterfaceSupport(n,hY),n.methods.text(LZ(e),t).call()}))}getName(e){return UZ(this,void 0,void 0,(function*(){const t=yield this.getResolverContractAdapter(e);return yield this.checkInterfaceSupport(t,fY),t.methods.name(LZ(e)).call()}))}}var HZ=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(BJ){o(BJ)}}function a(e){try{c(r.throw(e))}catch(BJ){o(BJ)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};class zZ extends FG{constructor(e,t){super(null!==t&&void 0!==t?t:""),this.registryAddress=null!==e&&void 0!==e?e:pY.main,this._registry=new FZ(this.getContextObject(),e),this._resolver=new jZ(this._registry)}getResolver(e){return HZ(this,void 0,void 0,(function*(){return this._registry.getResolver(e)}))}recordExists(e){return HZ(this,void 0,void 0,(function*(){return this._registry.recordExists(e)}))}getTTL(e){return HZ(this,void 0,void 0,(function*(){return this._registry.getTTL(e)}))}getOwner(e){return HZ(this,void 0,void 0,(function*(){return this._registry.getOwner(e)}))}getAddress(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:60;return HZ(this,void 0,void 0,(function*(){return this._resolver.getAddress(e,t)}))}getText(e,t){return HZ(this,void 0,void 0,(function*(){return this._resolver.getText(e,t)}))}getName(e){return HZ(this,void 0,void 0,(function*(){return this._resolver.getName(e)}))}getPubkey(e){return HZ(this,void 0,void 0,(function*(){return this._resolver.getPubkey(e)}))}getContenthash(e){return HZ(this,void 0,void 0,(function*(){return this._resolver.getContenthash(e)}))}checkNetwork(){return HZ(this,void 0,void 0,(function*(){const e=Date.now()/1e3;if(!this._lastSyncCheck||e-this._lastSyncCheck>3600){const n=yield(t=this,lQ(void 0,void 0,void 0,(function*(){return qG(t.requestManager)})));if("boolean"!==typeof n||n)throw new yL;this._lastSyncCheck=e}var t;if(this._detectedAddress)return this._detectedAddress;const n=yield wK(this,Object.assign(Object.assign({},rH),{number:tH.HEX})),r=pY[gY[n]];if("undefined"===typeof r)throw new vL(n);return this._detectedAddress=r,this._detectedAddress}))}supportsInterface(e,t){return HZ(this,void 0,void 0,(function*(){return this._resolver.supportsInterface(e,t)}))}get events(){return this._registry.events}setAddress(e,t,n){return HZ(this,void 0,void 0,(function*(){return this._resolver.setAddress(e,t,n)}))}}var VZ=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(BJ){o(BJ)}}function a(e){try{c(r.throw(e))}catch(BJ){o(BJ)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};const qZ=e=>VZ(void 0,void 0,void 0,(function*(){const t=yield(e=>QG(void 0,void 0,void 0,(function*(){return e.send({method:"personal_listAccounts",params:[]})})))(e);return t.map(iz)})),GZ=(e,t)=>VZ(void 0,void 0,void 0,(function*(){RH.validate(["string"],[t]);const n=yield((e,t)=>QG(void 0,void 0,void 0,(function*(){return e.send({method:"personal_newAccount",params:[t]})})))(e,t);return iz(n)})),KZ=(e,t,n,r)=>VZ(void 0,void 0,void 0,(function*(){return RH.validate(["address","string","uint"],[t,n,r]),((e,t,n,r)=>QG(void 0,void 0,void 0,(function*(){return e.send({method:"personal_unlockAccount",params:[t,n,r]})})))(e,t,n,r)})),WZ=(e,t)=>VZ(void 0,void 0,void 0,(function*(){return RH.validate(["address"],[t]),((e,t)=>QG(void 0,void 0,void 0,(function*(){return e.send({method:"personal_lockAccount",params:[t]})})))(e,t)})),QZ=(e,t,n)=>VZ(void 0,void 0,void 0,(function*(){return RH.validate(["string","string"],[t,n]),((e,t,n)=>QG(void 0,void 0,void 0,(function*(){return e.send({method:"personal_importRawKey",params:[t,n]})})))(e,t,n)})),YZ=(e,t,n)=>VZ(void 0,void 0,void 0,(function*(){const r=vK(t,iH);return((e,t,n)=>QG(void 0,void 0,void 0,(function*(){return e.send({method:"personal_sendTransaction",params:[t,n]})})))(e,r,n)})),ZZ=(e,t,n)=>VZ(void 0,void 0,void 0,(function*(){const r=vK(t,iH);return((e,t,n)=>QG(void 0,void 0,void 0,(function*(){return e.send({method:"personal_signTransaction",params:[t,n]})})))(e,r,n)})),JZ=(e,t,n,r)=>VZ(void 0,void 0,void 0,(function*(){RH.validate(["string","address","string"],[t,n,r]);const i=Tj(t)?t:zH(t);return((e,t,n,r)=>QG(void 0,void 0,void 0,(function*(){return e.send({method:"personal_sign",params:[t,n,r]})})))(e,i,n,r)})),XZ=(e,t,n)=>VZ(void 0,void 0,void 0,(function*(){RH.validate(["string","string"],[t,n]);const r=Tj(t)?t:zH(t);return((e,t,n)=>QG(void 0,void 0,void 0,(function*(){return e.send({method:"personal_ecRecover",params:[t,n]})})))(e,r,n)}));var $Z=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(BJ){o(BJ)}}function a(e){try{c(r.throw(e))}catch(BJ){o(BJ)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};class eJ extends FG{getAccounts(){return $Z(this,void 0,void 0,(function*(){return qZ(this.requestManager)}))}newAccount(e){return $Z(this,void 0,void 0,(function*(){return GZ(this.requestManager,e)}))}unlockAccount(e,t,n){return $Z(this,void 0,void 0,(function*(){return KZ(this.requestManager,e,t,n)}))}lockAccount(e){return $Z(this,void 0,void 0,(function*(){return WZ(this.requestManager,e)}))}importRawKey(e,t){return $Z(this,void 0,void 0,(function*(){return QZ(this.requestManager,e,t)}))}sendTransaction(e,t){return $Z(this,void 0,void 0,(function*(){return YZ(this.requestManager,e,t)}))}signTransaction(e,t){return $Z(this,void 0,void 0,(function*(){return ZZ(this.requestManager,e,t)}))}sign(e,t,n){return $Z(this,void 0,void 0,(function*(){return JZ(this.requestManager,e,t,n)}))}ecRecover(e,t){return $Z(this,void 0,void 0,(function*(){return XZ(this.requestManager,e,t)}))}}const tJ={encodeEventSignature:XK,encodeFunctionCall:(e,t)=>{var n;if(!KK(e))throw new SL("Invalid parameter value in encodeFunctionCall");return"".concat(JW(e)).concat(GW(null!==(n=e.inputs)&&void 0!==n?n:[],null!==t&&void 0!==t?t:[]).replace("0x",""))},encodeFunctionSignature:JW,encodeParameter:WW,encodeParameters:GW,decodeParameter:ZW,decodeParameters:YW,decodeLog:$W};var nJ=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(BJ){o(BJ)}}function a(e){try{c(r.throw(e))}catch(BJ){o(BJ)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};const rJ=e=>{const t=(t,n)=>nJ(void 0,void 0,void 0,(function*(){return((e,t)=>xG(void 0,void 0,void 0,(function*(){const n=e.sign(LH(t));if(EH(n.v)||EH(n.r)||EH(n.s))throw new hM("Signer Error");const r=n.validate(!0);if(r.length>0){let e="Signer Error ";for(const t of r)e+="".concat(e," ").concat(t,".");throw new hM(e)}const i=OH(n.serialize()),o=Fz(i);return{messageHash:OH(n.getMessageToSign(!0)),v:"0x".concat(n.v.toString(16)),r:"0x".concat(n.r.toString(16).padStart(64,"0")),s:"0x".concat(n.s.toString(16).padStart(64,"0")),rawTransaction:i,transactionHash:OH(o)}})))(yield YQ(t,e),Oz({format:"bytes"},n,iH))})),n=e=>{const n=DG(e);return Object.assign(Object.assign({},n),{signTransaction:e=>nJ(void 0,void 0,void 0,(function*(){return t(e,n.privateKey)}))})},r=(e,n,r)=>nJ(void 0,void 0,void 0,(function*(){var i;const o=yield((e,t,n)=>xG(void 0,void 0,void 0,(function*(){const r="object"===typeof e?e:JSON.parse(n?e.toLowerCase():e);if(RH.validateJSONSchema(Bq,r),3!==r.version)throw new rL;const i="string"===typeof t?LH(zH(t)):t;let o;if(RH.validate(["bytes"],[i]),"scrypt"===r.crypto.kdf){const e=r.crypto.kdfparams;o=uq(i,"string"===typeof e.salt?LH(e.salt):e.salt,e.n,e.p,e.r,e.dklen)}else{if("pbkdf2"!==r.crypto.kdf)throw new tL;{const e=r.crypto.kdfparams;o=iq(i,"string"===typeof e.salt?LH(e.salt):e.salt,e.c,e.dklen,"sha256")}}const s=LH(r.crypto.ciphertext);if(Fz(TH(o.slice(16,32),s)).replace("0x","")!==r.crypto.mac)throw new nL;const a=yield eq(LH(r.crypto.ciphertext),o.slice(0,16),LH(r.crypto.cipherparams.iv));return DG(a)})))(e,n,null===(i=null===r||void 0===r?void 0:r.nonStrict)||void 0===i||i);return Object.assign(Object.assign({},o),{signTransaction:e=>nJ(void 0,void 0,void 0,(function*(){return t(e,o.privateKey)}))})})),i=()=>{const e=(()=>{const e=Cq.utils.randomPrivateKey();return DG("".concat(OH(e)))})();return Object.assign(Object.assign({},e),{signTransaction:n=>nJ(void 0,void 0,void 0,(function*(){return t(n,e.privateKey)}))})},o=new YV({create:i,privateKeyToAccount:n,decrypt:r});return{signTransaction:t,create:i,privateKeyToAccount:n,decrypt:r,recoverTransaction:CG,hashMessage:IG,sign:RG,recover:TG,encrypt:BG,wallet:o,privateKeyToAddress:PG,parseAndValidatePrivateKey:_G,privateKeyToPublicKey:NG}};var iJ,oJ=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(BJ){o(BJ)}}function a(e){try{c(r.throw(e))}catch(BJ){o(BJ)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};!function(e){e.eip6963announceProvider="eip6963:announceProvider",e.eip6963requestProvider="eip6963:requestProvider"}(iJ||(iJ={}));const sJ=new Map,aJ="web3:providersMapUpdated";class cJ extends FG{constructor(e){var t;(Ez(e)||"string"===typeof e&&""===e.trim()||"string"!==typeof e&&!UV(e)&&!e.provider)&&console.warn("NOTE: web3.js is running without provider. You need to pass a provider in order to interact with the network!");let n={};"string"===typeof e||UV(e)?n.provider=e:n=e||{},n.registeredSubscriptions=Object.assign(Object.assign({},VQ),null!==(t=n.registeredSubscriptions)&&void 0!==t?t:{}),super(n);const r=rJ(this);this._wallet=r.wallet,this._accountProvider=r,this.utils=S;const i=this;const o=i.use(qQ);this.eth=Object.assign(o,{ens:i.use(zZ,pY.main),Iban:UG,net:i.use(AK),personal:i.use(eJ),Contract:class extends sY{constructor(e,t,n,r,o){if(bz(t)&&bz(n))throw new wL("Should not provide options at both 2nd and 3rd parameters");let s,a,c={},l=rH;if(!Ez(t)&&"object"!==typeof t&&"string"!==typeof t)throw new wL;"string"===typeof t&&(s=t),c=bz(t)?t:bz(n)?n:{},a=t instanceof FG?t:n instanceof FG?n:r instanceof FG?r:i.getContextObject(),o?l=o:Pz(n)?l=n:Pz(r)&&(l=r),super(e,s,c,a,l),super.subscribeToContextEvents(i)}},abi:tJ,accounts:r})}}cJ.version="4.8.0",cJ.utils=S,cJ.requestEIP6963Providers=()=>oJ(void 0,void 0,void 0,(function*(){return new Promise(((e,t)=>{"undefined"===typeof window&&t(new Error("window object not available, EIP-6963 is intended to be used within a browser")),window.addEventListener(iJ.eip6963announceProvider,(t=>{sJ.set(t.detail.info.uuid,t.detail);const n=new CustomEvent(aJ,{detail:sJ});window.dispatchEvent(n),e(sJ)})),window.dispatchEvent(new Event(iJ.eip6963requestProvider))}))})),cJ.onNewProviderDiscovered=e=>{if("undefined"===typeof window)throw new Error("window object not available, EIP-6963 is intended to be used within a browser");window.addEventListener(aJ,e)},cJ.modules={Web3Eth:qQ,Iban:UG,Net:AK,ENS:zZ,Personal:eJ};const lJ=cJ,uJ=n(5903).HV,dJ={11155111:"0x4C327Faf044B323472C71E212808396e1BF26fB5",31337:"0x4C327Faf044B323472C71E212808396e1BF26fB5"},hJ=(0,_.createContext)(null),fJ=!0,pJ=async(e,t)=>{const n=new TextDecoder;let r="";for await(const i of e.cat(t))r+=n.decode(i,{stream:!0});return JSON.parse(r)},gJ=e=>{const t=e.split("/");return t[t.length-1]},mJ=e=>{let{children:t}=e;const[n,r]=(0,_.useState)(null),[i,o]=(0,_.useState)(null),[s,a]=(0,_.useState)(null),[c,l]=(0,_.useState)(null),[u,d]=(0,_.useState)(null);(0,_.useEffect)((()=>{const e=async()=>{const e=await async function(){var e,t,n;let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const i=null!==(e=r.datastore)&&void 0!==e?e:new Fv,o=null!==(t=r.blockstore)&&void 0!==t?t:new Rv;let s;a=r.libp2p,s=null!=a&&["dial","dialProtocol","hangUp","handle","unhandle","getMultiaddrs","getProtocols"].every((e=>"function"===typeof a[e]))?r.libp2p:await NO({...r,libp2p:{dns:r.dns,...r.libp2p,start:void 0},datastore:i});var a;const c=new Gy({...r,libp2p:s,datastore:i,blockstore:o,blockBrokers:null!==(n=r.blockBrokers)&&void 0!==n?n:[jm(),qp()],routers:[zm(s),yv()],metrics:s.metrics});return!1!==r.start&&await c.start(),c}(),t=function(e){return new Kh(e)}(e);e.libp2p.addEventListener("peer:discovery",(e=>{})),e.libp2p.addEventListener("peer:connect",(e=>{})),e.libp2p.addEventListener("peer:disconnect",(e=>{})),l(t)};e(),(async()=>{if(window.ethereum){const t=await window.ethereum.request({method:"eth_chainId"}),n=parseInt(t,16);if(dJ[n])try{const e=new lJ(window.ethereum);r(e),((e,t)=>{console.log("NFTABI ",uJ),o(new e.eth.Contract(uJ,dJ[t]))})(e,n),(async e=>{try{await window.ethereum.request({method:"eth_requestAccounts"});const t=await e.eth.getAccounts();a(t[0]),window.ethereum.on("accountsChanged",(e=>{a(e[0])}))}catch(t){console.error(t),d(t.message," Check if you are connected to sepolia network")}})(e)}catch(e){console.error(e),d(e.message," Check if you are connected to sepolia network")}else d("Contract has not deployed on this network, Please connect to the Sepolia network")}else d("Non-Ethereum browser detected. You should consider trying MetaMask!")})()}),[]),(0,_.useEffect)((()=>{console.log("web3 ",n)}),[n]),(0,_.useEffect)((()=>{console.log("contract ",i)}),[i]),(0,_.useEffect)((()=>{console.log("ethAddress ",s)}),[s]);const h={web3:n,contract:i,ethAddress:s,ipfs:c,errorMsg:u};return(0,j.jsx)(hJ.Provider,{value:h,children:t})},vJ=hJ;const yJ=function(){const{web3:e,contract:t,ethAddress:n}=(0,_.useContext)(vJ),[r,i]=(0,_.useState)(""),[o,s]=(0,_.useState)(""),[a,c]=(0,_.useState)(""),l=e=>{console.log("isipfsuri:",e);return/^ipfs:\/\/(Qm|bafy)[a-zA-Z0-9]+$/.test(e)};return e&&t?(0,j.jsxs)("div",{className:"centered-div",children:[(0,j.jsx)("h1",{children:"CreateNFT"}),(0,j.jsxs)(xr,{onSubmit:async e=>{e.preventDefault(),console.log("Token ID:",r),console.log("IPFS URI:",o),r&&o?(await(async e=>{try{if(!l(e))throw new Error("Invalid URI");let t=null;const n=(e=>{const t=e.split("/");return t[t.length-1]})(e);if(console.log(ipfs,ipfs.cat),t=await pJ(ipfs,n),!l(t.image))throw console.log("metadata_json_uri",e,"Invalid image",t),new Error("Invalid image");return!0}catch(t){return console.error("There was a problem fetching the JSON data:",t),!1}})(o)?await t.methods.create(o,r).send({from:n}):c("Invalid URI"),i(""),s("")):c("Token ID and IPFS URI are required")},children:[(0,j.jsx)(Pr,{className:"mb-3",children:(0,j.jsx)(xr.Control,{placeholder:"Token ID",value:r,onChange:e=>{i(e.target.value)},"aria-label":"Token ID","aria-describedby":"basic-addon1"})}),(0,j.jsx)(Pr,{className:"mb-3",children:(0,j.jsx)(xr.Control,{placeholder:"IPFS URI",value:o,onChange:e=>{s(e.target.value)},"aria-label":"IPFS URI","aria-describedby":"basic-addon3"})}),a&&(0,j.jsx)(qn,{variant:"warning",children:a},"warning"),(0,j.jsx)(Kn,{variant:"primary",type:"submit",children:"Create"})]})]}):(0,j.jsx)("div",{className:"centered-div",children:"Loading..."})},wJ={bsPrefix:Pt().string,fluid:Pt().bool,rounded:Pt().bool,roundedCircle:Pt().bool,thumbnail:Pt().bool},bJ=_.forwardRef(((e,t)=>{let{bsPrefix:n,className:r,fluid:i=!1,rounded:o=!1,roundedCircle:s=!1,thumbnail:a=!1,...c}=e;return n=K(n,"img"),(0,j.jsx)("img",{ref:t,...c,className:C()(r,i&&"".concat(n,"-fluid"),o&&"rounded",s&&"rounded-circle",a&&"".concat(n,"-thumbnail"))})}));bJ.displayName="Image";const EJ=bJ,kJ=_.forwardRef(((e,t)=>{let{className:n,fluid:r=!0,...i}=e;return(0,j.jsx)(EJ,{ref:t,...i,fluid:r,className:C()(n,"figure-img")})}));kJ.displayName="FigureImage",kJ.propTypes=wJ;const AJ=kJ,SJ=_.forwardRef(((e,t)=>{let{className:n,bsPrefix:r,as:i="figcaption",...o}=e;return r=K(r,"figure-caption"),(0,j.jsx)(i,{ref:t,className:C()(n,r),...o})}));SJ.displayName="FigureCaption";const xJ=SJ,_J=_.forwardRef(((e,t)=>{let{className:n,bsPrefix:r,as:i="figure",...o}=e;return r=K(r,"figure"),(0,j.jsx)(i,{ref:t,className:C()(n,r),...o})}));_J.displayName="Figure";const IJ=Object.assign(_J,{Image:AJ,Caption:xJ}),RJ=_.forwardRef(((e,t)=>{let{bsPrefix:n,className:r,as:i="div",...o}=e;const s=K(n,"row"),a=W(),c=Q(),l="".concat(s,"-cols"),u=[];return a.forEach((e=>{const t=o[e];let n;delete o[e],null!=t&&"object"===typeof t?({cols:n}=t):n=t;const r=e!==c?"-".concat(e):"";null!=n&&u.push("".concat(l).concat(r,"-").concat(n))})),(0,j.jsx)(i,{ref:t,...o,className:C()(r,s,...u)})}));RJ.displayName="Row";const CJ=RJ;const TJ=function(){const{web3:e,contract:t,ethAddress:n,ipfs:r,errorMsg:i}=(0,_.useContext)(vJ),[o,s]=(0,_.useState)(new Map),[a,c]=(0,_.useState)(null);return(0,_.useEffect)((()=>{new TextDecoder;const e=async e=>{try{const n=await t.methods.tokenByIndex(e).call(),i=await t.methods.tokenURI(n).call(),a=gJ(i);let c=null;console.log("enable_ipfs:",fJ),c=await pJ(r,a);const l=gJ(c.image);let u=null;u=await(async(e,t)=>{console.log("readFromIPFSIMAGE:",t);let n=new Uint8Array;for await(const i of e.cat(t))n=new Uint8Array([...n,...i]);const r=new Blob([n],{type:"image/jpeg"});return console.log("blob:",r),r})(r,l),c.imageUrl=URL.createObjectURL(u),console.log("newMetadata.imageUrl:",c.imageUrl),s(new Map(o.set(n,c)))}catch(n){console.error("Error fetching content from IPFS:",n)}};(async()=>{if(r||console.log("IPFS is not ready"),t){console.log(r,fJ);const n=await t.methods.totalSupply().call();for(let t=0;t<n;t++)e(t)}})()}),[t,r]),(0,_.useEffect)((()=>{if(o){const e=Array.from(o).map((e=>{let[t,n]=e;return(0,j.jsx)(ur,{xs:6,md:3,children:(0,j.jsxs)(IJ,{children:[(0,j.jsx)(IJ.Image,{width:200,height:200,alt:"200x200",src:n.imageUrl,rounded:!0}),(0,j.jsx)(IJ.Caption,{children:n.name})]})},t)}));c(e)}}),[o]),(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(un,{children:(0,j.jsx)(CJ,{children:a})})})};const PJ=function(){const[e,t]=(0,_.useState)("home"),{web3:n,contract:r,ethAddress:i,ipfs:o,errorMsg:s}=(0,_.useContext)(vJ),[a,c]=(0,_.useState)("null"),[l,u]=(0,_.useState)(0),[d,h]=(0,_.useState)("");return(0,_.useEffect)((()=>{(async()=>{if(r&&i){const e=await r.methods.balanceOf(i).call();u(Number(e))}})()}),[r,i]),(0,_.useEffect)((()=>{console.log("fetchName Effect:",r),(async()=>{if(r){const e=await r.methods.symbol().call();console.log("name: ",e),c(String(e))}})()}),[r]),(0,_.useEffect)((()=>{console.log("balance:",l)}),[l]),(0,_.useEffect)((()=>{if(console.log("errorMsg:",s),s)h((0,j.jsx)("div",{className:"centered-div",children:s}));else switch(e){case"home":default:return void h((0,j.jsx)(TJ,{}));case"CreateNFT":return void h((0,j.jsx)(yJ,{}))}}),[e,s]),(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(cn,{expand:"lg",className:"bg-body-tertiary",children:(0,j.jsxs)(un,{children:[(0,j.jsx)(cn.Brand,{href:"#home",children:a}),(0,j.jsx)(cn.Toggle,{"aria-controls":"basic-navbar-nav"}),(0,j.jsxs)(cn.Collapse,{id:"basic-navbar-nav",children:[(0,j.jsxs)(Mn,{className:"me-auto",children:[(0,j.jsx)(Mn.Link,{href:"#home",onClick:()=>t("home"),children:"Home"}),(0,j.jsx)(Mn.Link,{href:"#CreateNFT",onClick:()=>t("CreateNFT"),children:"CreateNFT"})]}),(0,j.jsxs)(Mn,{className:"ml-auto",children:[(0,j.jsxs)(cn.Text,{style:{marginRight:"10px"},children:["Address : ",(f=i,f?f.substring(0,7)+"..."+f.slice(-5):"0x0")]}),(0,j.jsxs)(cn.Text,{children:["Balance : ",l]})]})]})]})}),(0,j.jsx)("br",{}),d]});var f},NJ=document.getElementById("root");(0,I.H)(NJ).render((0,j.jsx)(mJ,{children:(0,j.jsx)(PJ,{})}))})()})();
//# sourceMappingURL=main.50564205.js.map